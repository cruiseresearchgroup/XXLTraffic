Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=4, c_out=130, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems06_d.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='TimesNet', model_id='pems06_d_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=2, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_d_96_192_TimesNet_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 3367
val 332
test 853
	iters: 100, epoch: 1 | loss: 0.8416614
	speed: 1.8673s/iter; left time: 2955.9322s
	iters: 200, epoch: 1 | loss: 0.8152012
	speed: 1.9420s/iter; left time: 2880.0551s
	iters: 300, epoch: 1 | loss: 0.9245917
	speed: 1.9897s/iter; left time: 2751.6982s
	iters: 400, epoch: 1 | loss: 0.4210779
	speed: 1.9946s/iter; left time: 2559.0091s
	iters: 500, epoch: 1 | loss: 0.4488594
	speed: 1.9986s/iter; left time: 2364.3478s
	iters: 600, epoch: 1 | loss: 0.4084004
	speed: 1.9962s/iter; left time: 2161.8699s
	iters: 700, epoch: 1 | loss: 0.2699814
	speed: 1.9951s/iter; left time: 1961.1973s
	iters: 800, epoch: 1 | loss: 0.3478402
	speed: 1.9852s/iter; left time: 1752.9122s
Epoch: 1 cost time: 1659.2172317504883
Epoch: 1, Steps: 841 | Train Loss: 0.6160371 Vali Loss: 0.8558795 Test Loss: 0.6664093
Validation loss decreased (inf --> 0.855880).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9514544
	speed: 6.4552s/iter; left time: 4789.7746s
	iters: 200, epoch: 2 | loss: 0.4111990
	speed: 1.9903s/iter; left time: 1277.7839s
	iters: 300, epoch: 2 | loss: 0.2199781
	speed: 1.9862s/iter; left time: 1076.5256s
	iters: 400, epoch: 2 | loss: 0.1645673
	speed: 1.9853s/iter; left time: 877.4867s
	iters: 500, epoch: 2 | loss: 0.4730896
	speed: 1.9906s/iter; left time: 680.7780s
	iters: 600, epoch: 2 | loss: 0.1679652
	speed: 1.9985s/iter; left time: 483.6277s
	iters: 700, epoch: 2 | loss: 0.7905523
	speed: 1.9921s/iter; left time: 282.8723s
	iters: 800, epoch: 2 | loss: 0.4922850
	speed: 1.9927s/iter; left time: 83.6949s
Epoch: 2 cost time: 1674.6189432144165
Epoch: 2, Steps: 841 | Train Loss: 0.3466586 Vali Loss: 0.9340697 Test Loss: 0.6948109
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
>>>>>>>testing : long_term_forecast_pems06_d_96_192_TimesNet_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 853
test shape: (853, 1, 192, 130) (853, 1, 192, 130)
test shape: (853, 192, 130) (853, 192, 130)
mse:0.6664100289344788, mae:0.4661121964454651
>>>>>>>Overall time: 4404 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
