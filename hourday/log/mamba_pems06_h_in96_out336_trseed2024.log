Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=130, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems06_h.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=130, expand=2, factor=1, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems06_h_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=336, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_h_96_336_Mamba_custom_ftM_sl336_ll48_pl336_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 87041
val 12197
test 24725
	iters: 100, epoch: 1 | loss: 0.2417847
	speed: 0.0453s/iter; left time: 1226.6841s
	iters: 200, epoch: 1 | loss: 0.1598913
	speed: 0.0184s/iter; left time: 497.5691s
	iters: 300, epoch: 1 | loss: 0.1775674
	speed: 0.0184s/iter; left time: 493.7332s
	iters: 400, epoch: 1 | loss: 0.2434663
	speed: 0.0188s/iter; left time: 503.6270s
	iters: 500, epoch: 1 | loss: 0.1346037
	speed: 0.0184s/iter; left time: 491.5449s
	iters: 600, epoch: 1 | loss: 0.1535858
	speed: 0.0184s/iter; left time: 488.3030s
	iters: 700, epoch: 1 | loss: 0.0964778
	speed: 0.0184s/iter; left time: 487.6924s
	iters: 800, epoch: 1 | loss: 0.1258914
	speed: 0.0185s/iter; left time: 488.4240s
	iters: 900, epoch: 1 | loss: 0.1065824
	speed: 0.0188s/iter; left time: 495.0592s
	iters: 1000, epoch: 1 | loss: 0.1287499
	speed: 0.0184s/iter; left time: 481.5083s
	iters: 1100, epoch: 1 | loss: 0.1397971
	speed: 0.0186s/iter; left time: 484.5302s
	iters: 1200, epoch: 1 | loss: 0.1366236
	speed: 0.0181s/iter; left time: 471.7293s
	iters: 1300, epoch: 1 | loss: 0.1371375
	speed: 0.0182s/iter; left time: 472.3824s
	iters: 1400, epoch: 1 | loss: 0.1282283
	speed: 0.0182s/iter; left time: 470.5809s
	iters: 1500, epoch: 1 | loss: 0.1113490
	speed: 0.0180s/iter; left time: 462.4257s
	iters: 1600, epoch: 1 | loss: 0.1539537
	speed: 0.0186s/iter; left time: 475.3986s
	iters: 1700, epoch: 1 | loss: 0.1144641
	speed: 0.0176s/iter; left time: 447.7156s
	iters: 1800, epoch: 1 | loss: 0.1204112
	speed: 0.0174s/iter; left time: 441.4153s
	iters: 1900, epoch: 1 | loss: 0.1378073
	speed: 0.0175s/iter; left time: 443.0233s
	iters: 2000, epoch: 1 | loss: 0.0894576
	speed: 0.0173s/iter; left time: 437.0854s
	iters: 2100, epoch: 1 | loss: 0.1326869
	speed: 0.0172s/iter; left time: 432.9540s
	iters: 2200, epoch: 1 | loss: 0.1044130
	speed: 0.0172s/iter; left time: 430.0343s
	iters: 2300, epoch: 1 | loss: 0.1217565
	speed: 0.0175s/iter; left time: 435.8688s
	iters: 2400, epoch: 1 | loss: 0.1426583
	speed: 0.0169s/iter; left time: 419.9233s
	iters: 2500, epoch: 1 | loss: 0.1219868
	speed: 0.0165s/iter; left time: 407.1126s
	iters: 2600, epoch: 1 | loss: 0.1381481
	speed: 0.0166s/iter; left time: 407.7875s
	iters: 2700, epoch: 1 | loss: 0.0991733
	speed: 0.0165s/iter; left time: 403.9964s
Epoch: 1 cost time: 51.37355589866638
Epoch: 1, Steps: 2720 | Train Loss: 0.1449579 Vali Loss: 0.0929951 Test Loss: 0.1364675
Validation loss decreased (inf --> 0.092995).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1324045
	speed: 0.7372s/iter; left time: 17974.0423s
	iters: 200, epoch: 2 | loss: 0.1054425
	speed: 0.0185s/iter; left time: 449.9911s
	iters: 300, epoch: 2 | loss: 0.1293934
	speed: 0.0180s/iter; left time: 436.0675s
	iters: 400, epoch: 2 | loss: 0.1107175
	speed: 0.0178s/iter; left time: 427.6597s
	iters: 500, epoch: 2 | loss: 0.1188950
	speed: 0.0174s/iter; left time: 417.1967s
	iters: 600, epoch: 2 | loss: 0.1380849
	speed: 0.0168s/iter; left time: 401.5272s
	iters: 700, epoch: 2 | loss: 0.1022562
	speed: 0.0172s/iter; left time: 409.0861s
	iters: 800, epoch: 2 | loss: 0.0959817
	speed: 0.0174s/iter; left time: 411.7477s
	iters: 900, epoch: 2 | loss: 0.1079395
	speed: 0.0178s/iter; left time: 418.9321s
	iters: 1000, epoch: 2 | loss: 0.0942059
	speed: 0.0174s/iter; left time: 409.4769s
	iters: 1100, epoch: 2 | loss: 0.1578650
	speed: 0.0174s/iter; left time: 406.5151s
	iters: 1200, epoch: 2 | loss: 0.1305109
	speed: 0.0169s/iter; left time: 394.5815s
	iters: 1300, epoch: 2 | loss: 0.1406821
	speed: 0.0174s/iter; left time: 403.2322s
	iters: 1400, epoch: 2 | loss: 0.1392031
	speed: 0.0170s/iter; left time: 392.4835s
	iters: 1500, epoch: 2 | loss: 0.1190801
	speed: 0.0165s/iter; left time: 378.7562s
	iters: 1600, epoch: 2 | loss: 0.1643323
	speed: 0.0169s/iter; left time: 387.4940s
	iters: 1700, epoch: 2 | loss: 0.1000551
	speed: 0.0172s/iter; left time: 392.5906s
	iters: 1800, epoch: 2 | loss: 0.1402924
	speed: 0.0173s/iter; left time: 391.2869s
	iters: 1900, epoch: 2 | loss: 0.1267515
	speed: 0.0167s/iter; left time: 376.3504s
	iters: 2000, epoch: 2 | loss: 0.0964380
	speed: 0.0170s/iter; left time: 382.1606s
	iters: 2100, epoch: 2 | loss: 0.0786295
	speed: 0.0170s/iter; left time: 380.2134s
	iters: 2200, epoch: 2 | loss: 0.1200536
	speed: 0.0164s/iter; left time: 364.9504s
	iters: 2300, epoch: 2 | loss: 0.1064428
	speed: 0.0166s/iter; left time: 368.9068s
	iters: 2400, epoch: 2 | loss: 0.0976479
	speed: 0.0168s/iter; left time: 371.8124s
	iters: 2500, epoch: 2 | loss: 0.1044336
	speed: 0.0167s/iter; left time: 366.0950s
	iters: 2600, epoch: 2 | loss: 0.1030707
	speed: 0.0169s/iter; left time: 369.2127s
	iters: 2700, epoch: 2 | loss: 0.0960417
	speed: 0.0177s/iter; left time: 386.1395s
Epoch: 2 cost time: 48.11778473854065
Epoch: 2, Steps: 2720 | Train Loss: 0.1111678 Vali Loss: 0.0927117 Test Loss: 0.1368606
Validation loss decreased (0.092995 --> 0.092712).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1011266
	speed: 0.8177s/iter; left time: 17711.9991s
	iters: 200, epoch: 3 | loss: 0.1034193
	speed: 0.0182s/iter; left time: 392.0522s
	iters: 300, epoch: 3 | loss: 0.0985633
	speed: 0.0191s/iter; left time: 409.2954s
	iters: 400, epoch: 3 | loss: 0.1011011
	speed: 0.0184s/iter; left time: 393.1046s
	iters: 500, epoch: 3 | loss: 0.0965728
	speed: 0.0173s/iter; left time: 368.8342s
	iters: 600, epoch: 3 | loss: 0.0990929
	speed: 0.0178s/iter; left time: 377.4521s
	iters: 700, epoch: 3 | loss: 0.1027693
	speed: 0.0180s/iter; left time: 378.5211s
	iters: 800, epoch: 3 | loss: 0.1060839
	speed: 0.0182s/iter; left time: 382.1103s
	iters: 900, epoch: 3 | loss: 0.1047626
	speed: 0.0186s/iter; left time: 388.1821s
	iters: 1000, epoch: 3 | loss: 0.0919780
	speed: 0.0186s/iter; left time: 385.1905s
	iters: 1100, epoch: 3 | loss: 0.1018289
	speed: 0.0180s/iter; left time: 371.2204s
	iters: 1200, epoch: 3 | loss: 0.0784849
	speed: 0.0180s/iter; left time: 370.1591s
	iters: 1300, epoch: 3 | loss: 0.1156046
	speed: 0.0181s/iter; left time: 369.9142s
	iters: 1400, epoch: 3 | loss: 0.1275721
	speed: 0.0173s/iter; left time: 351.3926s
	iters: 1500, epoch: 3 | loss: 0.1045980
	speed: 0.0167s/iter; left time: 338.5359s
	iters: 1600, epoch: 3 | loss: 0.1066214
	speed: 0.0175s/iter; left time: 352.0681s
	iters: 1700, epoch: 3 | loss: 0.1244034
	speed: 0.0173s/iter; left time: 347.5303s
	iters: 1800, epoch: 3 | loss: 0.0937671
	speed: 0.0182s/iter; left time: 362.8972s
	iters: 1900, epoch: 3 | loss: 0.0963614
	speed: 0.0179s/iter; left time: 356.1152s
	iters: 2000, epoch: 3 | loss: 0.0808878
	speed: 0.0179s/iter; left time: 354.3302s
	iters: 2100, epoch: 3 | loss: 0.1012383
	speed: 0.0167s/iter; left time: 327.6798s
	iters: 2200, epoch: 3 | loss: 0.0957900
	speed: 0.0168s/iter; left time: 329.2172s
	iters: 2300, epoch: 3 | loss: 0.1117743
	speed: 0.0173s/iter; left time: 336.4044s
	iters: 2400, epoch: 3 | loss: 0.0882308
	speed: 0.0181s/iter; left time: 350.6029s
	iters: 2500, epoch: 3 | loss: 0.0901681
	speed: 0.0178s/iter; left time: 342.2304s
	iters: 2600, epoch: 3 | loss: 0.0987698
	speed: 0.0178s/iter; left time: 340.2220s
	iters: 2700, epoch: 3 | loss: 0.1176283
	speed: 0.0176s/iter; left time: 335.0360s
Epoch: 3 cost time: 49.894752502441406
Epoch: 3, Steps: 2720 | Train Loss: 0.1021895 Vali Loss: 0.0922756 Test Loss: 0.1367252
Validation loss decreased (0.092712 --> 0.092276).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0937492
	speed: 0.7139s/iter; left time: 13521.7235s
	iters: 200, epoch: 4 | loss: 0.0903938
	speed: 0.0171s/iter; left time: 321.6182s
	iters: 300, epoch: 4 | loss: 0.0876125
	speed: 0.0181s/iter; left time: 338.8358s
	iters: 400, epoch: 4 | loss: 0.0917407
	speed: 0.0181s/iter; left time: 336.6147s
	iters: 500, epoch: 4 | loss: 0.0925260
	speed: 0.0175s/iter; left time: 323.9471s
	iters: 600, epoch: 4 | loss: 0.0908904
	speed: 0.0175s/iter; left time: 322.3072s
	iters: 700, epoch: 4 | loss: 0.1048913
	speed: 0.0180s/iter; left time: 329.8664s
	iters: 800, epoch: 4 | loss: 0.0889781
	speed: 0.0177s/iter; left time: 322.7939s
	iters: 900, epoch: 4 | loss: 0.1104151
	speed: 0.0177s/iter; left time: 320.5346s
	iters: 1000, epoch: 4 | loss: 0.0869094
	speed: 0.0187s/iter; left time: 338.2423s
	iters: 1100, epoch: 4 | loss: 0.0897157
	speed: 0.0182s/iter; left time: 326.4588s
	iters: 1200, epoch: 4 | loss: 0.0893091
	speed: 0.0187s/iter; left time: 333.9734s
	iters: 1300, epoch: 4 | loss: 0.1221214
	speed: 0.0180s/iter; left time: 319.7755s
	iters: 1400, epoch: 4 | loss: 0.1068824
	speed: 0.0180s/iter; left time: 318.0832s
	iters: 1500, epoch: 4 | loss: 0.0937351
	speed: 0.0181s/iter; left time: 317.4158s
	iters: 1600, epoch: 4 | loss: 0.0933070
	speed: 0.0179s/iter; left time: 312.1442s
	iters: 1700, epoch: 4 | loss: 0.0889999
	speed: 0.0176s/iter; left time: 305.4791s
	iters: 1800, epoch: 4 | loss: 0.1000030
	speed: 0.0179s/iter; left time: 308.2626s
	iters: 1900, epoch: 4 | loss: 0.1024980
	speed: 0.0178s/iter; left time: 305.5626s
	iters: 2000, epoch: 4 | loss: 0.0951087
	speed: 0.0174s/iter; left time: 296.4421s
	iters: 2100, epoch: 4 | loss: 0.0830831
	speed: 0.0181s/iter; left time: 305.8441s
	iters: 2200, epoch: 4 | loss: 0.1005631
	speed: 0.0181s/iter; left time: 304.6889s
	iters: 2300, epoch: 4 | loss: 0.0913667
	speed: 0.0181s/iter; left time: 302.2393s
	iters: 2400, epoch: 4 | loss: 0.0976544
	speed: 0.0182s/iter; left time: 302.8969s
	iters: 2500, epoch: 4 | loss: 0.0874376
	speed: 0.0177s/iter; left time: 293.0203s
	iters: 2600, epoch: 4 | loss: 0.1050397
	speed: 0.0183s/iter; left time: 300.3763s
	iters: 2700, epoch: 4 | loss: 0.0897763
	speed: 0.0179s/iter; left time: 293.1505s
Epoch: 4 cost time: 50.01958703994751
Epoch: 4, Steps: 2720 | Train Loss: 0.0984276 Vali Loss: 0.0923873 Test Loss: 0.1368656
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1149356
	speed: 0.8489s/iter; left time: 13769.2610s
	iters: 200, epoch: 5 | loss: 0.0906605
	speed: 0.0197s/iter; left time: 318.2514s
	iters: 300, epoch: 5 | loss: 0.0837709
	speed: 0.0192s/iter; left time: 308.1948s
	iters: 400, epoch: 5 | loss: 0.0964067
	speed: 0.0184s/iter; left time: 292.9032s
	iters: 500, epoch: 5 | loss: 0.0865442
	speed: 0.0174s/iter; left time: 274.8964s
	iters: 600, epoch: 5 | loss: 0.1060187
	speed: 0.0177s/iter; left time: 278.9655s
	iters: 700, epoch: 5 | loss: 0.1285413
	speed: 0.0183s/iter; left time: 285.6275s
	iters: 800, epoch: 5 | loss: 0.0862334
	speed: 0.0184s/iter; left time: 285.2449s
	iters: 900, epoch: 5 | loss: 0.0966474
	speed: 0.0183s/iter; left time: 281.9401s
	iters: 1000, epoch: 5 | loss: 0.0968572
	speed: 0.0178s/iter; left time: 272.4991s
	iters: 1100, epoch: 5 | loss: 0.0977433
	speed: 0.0193s/iter; left time: 293.6976s
	iters: 1200, epoch: 5 | loss: 0.0838960
	speed: 0.0180s/iter; left time: 272.1966s
	iters: 1300, epoch: 5 | loss: 0.0866646
	speed: 0.0187s/iter; left time: 281.2233s
	iters: 1400, epoch: 5 | loss: 0.1078875
	speed: 0.0179s/iter; left time: 267.4319s
	iters: 1500, epoch: 5 | loss: 0.1100670
	speed: 0.0172s/iter; left time: 254.9833s
	iters: 1600, epoch: 5 | loss: 0.1087229
	speed: 0.0190s/iter; left time: 279.2156s
	iters: 1700, epoch: 5 | loss: 0.0949411
	speed: 0.0186s/iter; left time: 271.6080s
	iters: 1800, epoch: 5 | loss: 0.0914469
	speed: 0.0168s/iter; left time: 243.5296s
	iters: 1900, epoch: 5 | loss: 0.0916360
	speed: 0.0174s/iter; left time: 251.4135s
	iters: 2000, epoch: 5 | loss: 0.1166592
	speed: 0.0178s/iter; left time: 255.2105s
	iters: 2100, epoch: 5 | loss: 0.0977528
	speed: 0.0173s/iter; left time: 246.1363s
	iters: 2200, epoch: 5 | loss: 0.0829148
	speed: 0.0167s/iter; left time: 235.3987s
	iters: 2300, epoch: 5 | loss: 0.0885570
	speed: 0.0190s/iter; left time: 266.5281s
	iters: 2400, epoch: 5 | loss: 0.0863808
	speed: 0.0172s/iter; left time: 239.4816s
	iters: 2500, epoch: 5 | loss: 0.1017519
	speed: 0.0171s/iter; left time: 235.7473s
	iters: 2600, epoch: 5 | loss: 0.1226400
	speed: 0.0168s/iter; left time: 230.0560s
	iters: 2700, epoch: 5 | loss: 0.0978003
	speed: 0.0168s/iter; left time: 229.2694s
Epoch: 5 cost time: 50.16646099090576
Epoch: 5, Steps: 2720 | Train Loss: 0.0966925 Vali Loss: 0.0921291 Test Loss: 0.1375284
Validation loss decreased (0.092276 --> 0.092129).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0773577
	speed: 0.7161s/iter; left time: 9668.2120s
	iters: 200, epoch: 6 | loss: 0.0923847
	speed: 0.0179s/iter; left time: 239.7363s
	iters: 300, epoch: 6 | loss: 0.0777982
	speed: 0.0176s/iter; left time: 234.2016s
	iters: 400, epoch: 6 | loss: 0.0855119
	speed: 0.0178s/iter; left time: 235.6115s
	iters: 500, epoch: 6 | loss: 0.0902339
	speed: 0.0184s/iter; left time: 240.5540s
	iters: 600, epoch: 6 | loss: 0.0900165
	speed: 0.0185s/iter; left time: 239.9313s
	iters: 700, epoch: 6 | loss: 0.0989028
	speed: 0.0176s/iter; left time: 227.5568s
	iters: 800, epoch: 6 | loss: 0.0890882
	speed: 0.0169s/iter; left time: 216.6097s
	iters: 900, epoch: 6 | loss: 0.0864452
	speed: 0.0169s/iter; left time: 214.3826s
	iters: 1000, epoch: 6 | loss: 0.0763469
	speed: 0.0174s/iter; left time: 218.7334s
	iters: 1100, epoch: 6 | loss: 0.1309546
	speed: 0.0175s/iter; left time: 218.6641s
	iters: 1200, epoch: 6 | loss: 0.1057322
	speed: 0.0170s/iter; left time: 210.5974s
	iters: 1300, epoch: 6 | loss: 0.0999195
	speed: 0.0171s/iter; left time: 210.6691s
	iters: 1400, epoch: 6 | loss: 0.0984931
	speed: 0.0170s/iter; left time: 208.0088s
	iters: 1500, epoch: 6 | loss: 0.0921445
	speed: 0.0169s/iter; left time: 204.8430s
	iters: 1600, epoch: 6 | loss: 0.1055926
	speed: 0.0171s/iter; left time: 204.8748s
	iters: 1700, epoch: 6 | loss: 0.1109868
	speed: 0.0169s/iter; left time: 201.1721s
	iters: 1800, epoch: 6 | loss: 0.0948271
	speed: 0.0173s/iter; left time: 204.3852s
	iters: 1900, epoch: 6 | loss: 0.1122161
	speed: 0.0172s/iter; left time: 200.9308s
	iters: 2000, epoch: 6 | loss: 0.1174024
	speed: 0.0169s/iter; left time: 196.0047s
	iters: 2100, epoch: 6 | loss: 0.1019388
	speed: 0.0170s/iter; left time: 195.0218s
	iters: 2200, epoch: 6 | loss: 0.0902609
	speed: 0.0167s/iter; left time: 190.9620s
	iters: 2300, epoch: 6 | loss: 0.1021399
	speed: 0.0169s/iter; left time: 190.4777s
	iters: 2400, epoch: 6 | loss: 0.0718137
	speed: 0.0168s/iter; left time: 187.6412s
	iters: 2500, epoch: 6 | loss: 0.0961678
	speed: 0.0167s/iter; left time: 185.3185s
	iters: 2600, epoch: 6 | loss: 0.0929612
	speed: 0.0167s/iter; left time: 183.6002s
	iters: 2700, epoch: 6 | loss: 0.0789199
	speed: 0.0169s/iter; left time: 183.7313s
Epoch: 6 cost time: 48.221282720565796
Epoch: 6, Steps: 2720 | Train Loss: 0.0958262 Vali Loss: 0.0918358 Test Loss: 0.1368428
Validation loss decreased (0.092129 --> 0.091836).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0849714
	speed: 0.8168s/iter; left time: 8805.3953s
	iters: 200, epoch: 7 | loss: 0.1036945
	speed: 0.0172s/iter; left time: 184.0027s
	iters: 300, epoch: 7 | loss: 0.0842538
	speed: 0.0171s/iter; left time: 181.4555s
	iters: 400, epoch: 7 | loss: 0.0879037
	speed: 0.0172s/iter; left time: 179.8168s
	iters: 500, epoch: 7 | loss: 0.1016289
	speed: 0.0186s/iter; left time: 193.5823s
	iters: 600, epoch: 7 | loss: 0.0831116
	speed: 0.0188s/iter; left time: 193.1000s
	iters: 700, epoch: 7 | loss: 0.0980505
	speed: 0.0178s/iter; left time: 181.6017s
	iters: 800, epoch: 7 | loss: 0.0873323
	speed: 0.0184s/iter; left time: 185.8546s
	iters: 900, epoch: 7 | loss: 0.0881167
	speed: 0.0178s/iter; left time: 178.0151s
	iters: 1000, epoch: 7 | loss: 0.1070510
	speed: 0.0168s/iter; left time: 165.9543s
	iters: 1100, epoch: 7 | loss: 0.0932511
	speed: 0.0164s/iter; left time: 160.8717s
	iters: 1200, epoch: 7 | loss: 0.0951641
	speed: 0.0182s/iter; left time: 175.8799s
	iters: 1300, epoch: 7 | loss: 0.1010110
	speed: 0.0180s/iter; left time: 172.6141s
	iters: 1400, epoch: 7 | loss: 0.0981374
	speed: 0.0183s/iter; left time: 173.8109s
	iters: 1500, epoch: 7 | loss: 0.1008853
	speed: 0.0181s/iter; left time: 169.9703s
	iters: 1600, epoch: 7 | loss: 0.0865143
	speed: 0.0180s/iter; left time: 167.0662s
	iters: 1700, epoch: 7 | loss: 0.0945998
	speed: 0.0165s/iter; left time: 151.6894s
	iters: 1800, epoch: 7 | loss: 0.1024250
	speed: 0.0167s/iter; left time: 151.8066s
	iters: 1900, epoch: 7 | loss: 0.0913397
	speed: 0.0178s/iter; left time: 159.5588s
	iters: 2000, epoch: 7 | loss: 0.0943299
	speed: 0.0166s/iter; left time: 147.1524s
	iters: 2100, epoch: 7 | loss: 0.0982975
	speed: 0.0164s/iter; left time: 144.1104s
	iters: 2200, epoch: 7 | loss: 0.0915077
	speed: 0.0165s/iter; left time: 143.1293s
	iters: 2300, epoch: 7 | loss: 0.0940227
	speed: 0.0164s/iter; left time: 140.5480s
	iters: 2400, epoch: 7 | loss: 0.1036578
	speed: 0.0165s/iter; left time: 140.3062s
	iters: 2500, epoch: 7 | loss: 0.1038447
	speed: 0.0164s/iter; left time: 137.2547s
	iters: 2600, epoch: 7 | loss: 0.0935834
	speed: 0.0167s/iter; left time: 138.1271s
	iters: 2700, epoch: 7 | loss: 0.1058180
	speed: 0.0173s/iter; left time: 141.3521s
Epoch: 7 cost time: 48.73771643638611
Epoch: 7, Steps: 2720 | Train Loss: 0.0953911 Vali Loss: 0.0923412 Test Loss: 0.1377437
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0991798
	speed: 0.8499s/iter; left time: 6851.1723s
	iters: 200, epoch: 8 | loss: 0.0777709
	speed: 0.0182s/iter; left time: 144.6994s
	iters: 300, epoch: 8 | loss: 0.0826690
	speed: 0.0174s/iter; left time: 136.9613s
	iters: 400, epoch: 8 | loss: 0.0901004
	speed: 0.0179s/iter; left time: 138.8248s
	iters: 500, epoch: 8 | loss: 0.0930735
	speed: 0.0183s/iter; left time: 140.5103s
	iters: 600, epoch: 8 | loss: 0.0817243
	speed: 0.0175s/iter; left time: 132.1644s
	iters: 700, epoch: 8 | loss: 0.1065377
	speed: 0.0182s/iter; left time: 136.1048s
	iters: 800, epoch: 8 | loss: 0.0856394
	speed: 0.0177s/iter; left time: 130.3717s
	iters: 900, epoch: 8 | loss: 0.0979922
	speed: 0.0185s/iter; left time: 134.4956s
	iters: 1000, epoch: 8 | loss: 0.0858402
	speed: 0.0180s/iter; left time: 128.6633s
	iters: 1100, epoch: 8 | loss: 0.0911655
	speed: 0.0175s/iter; left time: 123.6584s
	iters: 1200, epoch: 8 | loss: 0.0965011
	speed: 0.0188s/iter; left time: 130.7515s
	iters: 1300, epoch: 8 | loss: 0.0917602
	speed: 0.0185s/iter; left time: 127.0609s
	iters: 1400, epoch: 8 | loss: 0.0916275
	speed: 0.0181s/iter; left time: 122.1422s
	iters: 1500, epoch: 8 | loss: 0.0860609
	speed: 0.0182s/iter; left time: 120.9108s
	iters: 1600, epoch: 8 | loss: 0.0945951
	speed: 0.0183s/iter; left time: 119.8011s
	iters: 1700, epoch: 8 | loss: 0.1006197
	speed: 0.0168s/iter; left time: 108.2946s
	iters: 1800, epoch: 8 | loss: 0.0900437
	speed: 0.0166s/iter; left time: 105.3988s
	iters: 1900, epoch: 8 | loss: 0.0836189
	speed: 0.0166s/iter; left time: 103.8789s
	iters: 2000, epoch: 8 | loss: 0.0860666
	speed: 0.0166s/iter; left time: 102.2147s
	iters: 2100, epoch: 8 | loss: 0.1105223
	speed: 0.0166s/iter; left time: 100.4373s
	iters: 2200, epoch: 8 | loss: 0.0826627
	speed: 0.0166s/iter; left time: 98.7351s
	iters: 2300, epoch: 8 | loss: 0.0812884
	speed: 0.0169s/iter; left time: 98.7666s
	iters: 2400, epoch: 8 | loss: 0.0852067
	speed: 0.0168s/iter; left time: 96.9255s
	iters: 2500, epoch: 8 | loss: 0.1047108
	speed: 0.0175s/iter; left time: 99.2896s
	iters: 2600, epoch: 8 | loss: 0.1061205
	speed: 0.0186s/iter; left time: 103.4829s
	iters: 2700, epoch: 8 | loss: 0.0920520
	speed: 0.0193s/iter; left time: 105.5879s
Epoch: 8 cost time: 49.5487642288208
Epoch: 8, Steps: 2720 | Train Loss: 0.0951717 Vali Loss: 0.0921455 Test Loss: 0.1374039
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0924172
	speed: 0.7341s/iter; left time: 3920.8114s
	iters: 200, epoch: 9 | loss: 0.0967994
	speed: 0.0181s/iter; left time: 95.0183s
	iters: 300, epoch: 9 | loss: 0.0973798
	speed: 0.0180s/iter; left time: 92.2928s
	iters: 400, epoch: 9 | loss: 0.0874779
	speed: 0.0173s/iter; left time: 87.0091s
	iters: 500, epoch: 9 | loss: 0.1080076
	speed: 0.0171s/iter; left time: 84.5005s
	iters: 600, epoch: 9 | loss: 0.1372033
	speed: 0.0180s/iter; left time: 87.1390s
	iters: 700, epoch: 9 | loss: 0.0933994
	speed: 0.0171s/iter; left time: 81.1806s
	iters: 800, epoch: 9 | loss: 0.0924455
	speed: 0.0175s/iter; left time: 81.0554s
	iters: 900, epoch: 9 | loss: 0.0849550
	speed: 0.0181s/iter; left time: 82.3689s
	iters: 1000, epoch: 9 | loss: 0.0860582
	speed: 0.0173s/iter; left time: 76.6678s
	iters: 1100, epoch: 9 | loss: 0.0826289
	speed: 0.0175s/iter; left time: 76.1323s
	iters: 1200, epoch: 9 | loss: 0.0909437
	speed: 0.0170s/iter; left time: 71.9021s
	iters: 1300, epoch: 9 | loss: 0.0882995
	speed: 0.0168s/iter; left time: 69.5932s
	iters: 1400, epoch: 9 | loss: 0.0810496
	speed: 0.0172s/iter; left time: 69.4576s
	iters: 1500, epoch: 9 | loss: 0.0979764
	speed: 0.0168s/iter; left time: 66.1645s
	iters: 1600, epoch: 9 | loss: 0.1034553
	speed: 0.0169s/iter; left time: 65.0540s
	iters: 1700, epoch: 9 | loss: 0.0935238
	speed: 0.0166s/iter; left time: 61.9233s
	iters: 1800, epoch: 9 | loss: 0.0969510
	speed: 0.0166s/iter; left time: 60.4846s
	iters: 1900, epoch: 9 | loss: 0.0987741
	speed: 0.0182s/iter; left time: 64.3644s
	iters: 2000, epoch: 9 | loss: 0.0998708
	speed: 0.0180s/iter; left time: 61.8620s
	iters: 2100, epoch: 9 | loss: 0.0861928
	speed: 0.0174s/iter; left time: 58.1785s
	iters: 2200, epoch: 9 | loss: 0.1071382
	speed: 0.0178s/iter; left time: 57.7746s
	iters: 2300, epoch: 9 | loss: 0.1090406
	speed: 0.0184s/iter; left time: 57.7136s
	iters: 2400, epoch: 9 | loss: 0.0987090
	speed: 0.0184s/iter; left time: 55.9298s
	iters: 2500, epoch: 9 | loss: 0.0894354
	speed: 0.0176s/iter; left time: 51.6199s
	iters: 2600, epoch: 9 | loss: 0.0878914
	speed: 0.0178s/iter; left time: 50.5543s
	iters: 2700, epoch: 9 | loss: 0.0892670
	speed: 0.0176s/iter; left time: 48.2560s
Epoch: 9 cost time: 49.04183530807495
Epoch: 9, Steps: 2720 | Train Loss: 0.0950628 Vali Loss: 0.0921108 Test Loss: 0.1373937
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems06_h_96_336_Mamba_custom_ftM_sl336_ll48_pl336_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 24725
test shape: (24725, 1, 336, 130) (24725, 1, 336, 130)
test shape: (24725, 336, 130) (24725, 336, 130)
mse:0.13684235513210297, mae:0.20659101009368896
>>>>>>>Overall time: 1239 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
