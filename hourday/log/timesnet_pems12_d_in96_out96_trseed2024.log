Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=4, c_out=1543, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems12_d.csv', dec_in=1543, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=1543, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='TimesNet', model_id='pems12_d_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=2, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems12_d_96_96_TimesNet_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 5489
val 717
test 1528
	iters: 100, epoch: 1 | loss: 0.7236686
	speed: 1.5769s/iter; left time: 4171.0324s
	iters: 200, epoch: 1 | loss: 0.6888270
	speed: 1.7738s/iter; left time: 4514.2022s
	iters: 300, epoch: 1 | loss: 0.3862849
	speed: 1.7929s/iter; left time: 4383.6439s
	iters: 400, epoch: 1 | loss: 0.7350503
	speed: 1.7933s/iter; left time: 4205.2507s
	iters: 500, epoch: 1 | loss: 0.5213675
	speed: 1.7882s/iter; left time: 4014.4001s
	iters: 600, epoch: 1 | loss: 0.5937442
	speed: 1.8282s/iter; left time: 3921.4420s
	iters: 700, epoch: 1 | loss: 0.6153959
	speed: 1.8276s/iter; left time: 3737.4188s
	iters: 800, epoch: 1 | loss: 0.4957342
	speed: 1.8280s/iter; left time: 3555.5147s
	iters: 900, epoch: 1 | loss: 0.5008432
	speed: 1.8227s/iter; left time: 3362.9488s
	iters: 1000, epoch: 1 | loss: 0.5455056
	speed: 1.8250s/iter; left time: 3184.6252s
	iters: 1100, epoch: 1 | loss: 0.5287064
	speed: 1.8230s/iter; left time: 2998.9045s
	iters: 1200, epoch: 1 | loss: 0.4520502
	speed: 1.8346s/iter; left time: 2834.5015s
	iters: 1300, epoch: 1 | loss: 0.5159142
	speed: 1.8330s/iter; left time: 2648.6677s
Epoch: 1 cost time: 2468.297103881836
Epoch: 1, Steps: 1372 | Train Loss: 0.6034756 Vali Loss: 0.6464282 Test Loss: 1.6354038
Validation loss decreased (inf --> 0.646428).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4206081
	speed: 10.0229s/iter; left time: 12759.2103s
	iters: 200, epoch: 2 | loss: 0.6044040
	speed: 1.8432s/iter; left time: 2162.0428s
	iters: 300, epoch: 2 | loss: 0.4661564
	speed: 1.8517s/iter; left time: 1986.8482s
	iters: 400, epoch: 2 | loss: 0.4616508
	speed: 1.8495s/iter; left time: 1799.6114s
	iters: 500, epoch: 2 | loss: 0.4665473
	speed: 1.8425s/iter; left time: 1608.5354s
	iters: 600, epoch: 2 | loss: 0.5167970
	speed: 1.8547s/iter; left time: 1433.7154s
	iters: 700, epoch: 2 | loss: 0.5316674
	speed: 1.8442s/iter; left time: 1241.1462s
	iters: 800, epoch: 2 | loss: 0.5345201
	speed: 1.8141s/iter; left time: 1039.5029s
	iters: 900, epoch: 2 | loss: 0.5774652
	speed: 1.8196s/iter; left time: 860.6509s
	iters: 1000, epoch: 2 | loss: 0.4865071
	speed: 1.8312s/iter; left time: 683.0446s
	iters: 1100, epoch: 2 | loss: 0.3960519
	speed: 1.8484s/iter; left time: 504.6140s
	iters: 1200, epoch: 2 | loss: 0.4710320
	speed: 1.8577s/iter; left time: 321.3824s
	iters: 1300, epoch: 2 | loss: 0.5031852
	speed: 1.8649s/iter; left time: 136.1373s
Epoch: 2 cost time: 2531.115210533142
Epoch: 2, Steps: 1372 | Train Loss: 0.4761190 Vali Loss: 0.6812530 Test Loss: 1.8171613
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
>>>>>>>testing : long_term_forecast_pems12_d_96_96_TimesNet_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1528
test shape: (1528, 1, 96, 1543) (1528, 1, 96, 1543)
test shape: (1528, 96, 1543) (1528, 96, 1543)
mse:1.6353970766067505, mae:0.5682762265205383
>>>>>>>Overall time: 6997 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=4, c_out=1543, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems12_d.csv', dec_in=1543, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=1543, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='TimesNet', model_id='pems12_d_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=2, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems12_d_96_192_TimesNet_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 5393
val 621
test 1432
	iters: 100, epoch: 1 | loss: 0.6247239
	speed: 1.9852s/iter; left time: 5155.5663s
	iters: 200, epoch: 1 | loss: 0.9566767
	speed: 2.1886s/iter; left time: 5464.9476s
	iters: 300, epoch: 1 | loss: 0.7763128
	speed: 2.2498s/iter; left time: 5392.7323s
	iters: 400, epoch: 1 | loss: 0.6318023
	speed: 2.2662s/iter; left time: 5205.5207s
	iters: 500, epoch: 1 | loss: 0.7404172
	speed: 2.2618s/iter; left time: 4969.2056s
	iters: 600, epoch: 1 | loss: 0.4700377
	speed: 2.2953s/iter; left time: 4813.2816s
	iters: 700, epoch: 1 | loss: 0.6079771
	speed: 2.2909s/iter; left time: 4574.8625s
	iters: 800, epoch: 1 | loss: 0.6845632
	speed: 2.2877s/iter; left time: 4339.8319s
	iters: 900, epoch: 1 | loss: 0.7711180
	speed: 2.2794s/iter; left time: 4096.1123s
	iters: 1000, epoch: 1 | loss: 0.8751646
	speed: 2.3009s/iter; left time: 3904.5857s
	iters: 1100, epoch: 1 | loss: 0.6996334
	speed: 2.2755s/iter; left time: 3634.0061s
	iters: 1200, epoch: 1 | loss: 0.5243673
	speed: 2.2609s/iter; left time: 3384.6209s
	iters: 1300, epoch: 1 | loss: 0.7250603
	speed: 2.2552s/iter; left time: 3150.4890s
Epoch: 1 cost time: 3030.2942299842834
Epoch: 1, Steps: 1348 | Train Loss: 0.6990174 Vali Loss: 0.7899117 Test Loss: 1.9491209
Validation loss decreased (inf --> 0.789912).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5644489
	speed: 10.0905s/iter; left time: 12603.0431s
	iters: 200, epoch: 2 | loss: 0.6361079
	speed: 2.2991s/iter; left time: 2641.7050s
	iters: 300, epoch: 2 | loss: 0.5768219
	speed: 2.2941s/iter; left time: 2406.4771s
	iters: 400, epoch: 2 | loss: 0.5065228
	speed: 2.2922s/iter; left time: 2175.3382s
	iters: 500, epoch: 2 | loss: 0.4906223
	speed: 2.2890s/iter; left time: 1943.3352s
	iters: 600, epoch: 2 | loss: 0.5444846
	speed: 2.2841s/iter; left time: 1710.7692s
	iters: 700, epoch: 2 | loss: 0.5086643
	speed: 2.2789s/iter; left time: 1479.0258s
	iters: 800, epoch: 2 | loss: 0.5294128
	speed: 2.2728s/iter; left time: 1247.7905s
	iters: 900, epoch: 2 | loss: 0.3881465
	speed: 2.2305s/iter; left time: 1001.4895s
	iters: 1000, epoch: 2 | loss: 0.3374722
	speed: 2.2384s/iter; left time: 781.2100s
	iters: 1100, epoch: 2 | loss: 0.3713957
	speed: 2.2281s/iter; left time: 554.8033s
	iters: 1200, epoch: 2 | loss: 0.3805965
	speed: 2.2044s/iter; left time: 328.4607s
	iters: 1300, epoch: 2 | loss: 0.5003654
	speed: 2.2317s/iter; left time: 109.3555s
Epoch: 2 cost time: 3049.6136264801025
Epoch: 2, Steps: 1348 | Train Loss: 0.4911535 Vali Loss: 0.8921936 Test Loss: 2.2157607
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
>>>>>>>testing : long_term_forecast_pems12_d_96_192_TimesNet_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1432
test shape: (1432, 1, 192, 1543) (1432, 1, 192, 1543)
test shape: (1432, 192, 1543) (1432, 192, 1543)
mse:1.949109673500061, mae:0.6422222256660461
>>>>>>>Overall time: 8030 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=4, c_out=1543, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems12_d.csv', dec_in=1543, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=1543, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='TimesNet', model_id='pems12_d_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=2, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems12_d_96_336_TimesNet_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 5249
val 477
test 1288
	iters: 100, epoch: 1 | loss: 0.9270965
	speed: 1.8809s/iter; left time: 4749.2330s
	iters: 200, epoch: 1 | loss: 1.0079608
	speed: 1.7538s/iter; left time: 4252.9002s
	iters: 300, epoch: 1 | loss: 0.7811366
	speed: 1.7507s/iter; left time: 4070.3040s
	iters: 400, epoch: 1 | loss: 0.7414960
	speed: 1.7473s/iter; left time: 3887.6899s
	iters: 500, epoch: 1 | loss: 0.8142601
	speed: 1.7478s/iter; left time: 3714.1812s
	iters: 600, epoch: 1 | loss: 1.3395929
	speed: 1.7517s/iter; left time: 3547.2146s
	iters: 700, epoch: 1 | loss: 0.9359233
	speed: 1.7472s/iter; left time: 3363.3477s
	iters: 800, epoch: 1 | loss: 0.7751300
	speed: 1.7426s/iter; left time: 3180.2602s
	iters: 900, epoch: 1 | loss: 0.6780765
	speed: 1.7432s/iter; left time: 3007.0439s
	iters: 1000, epoch: 1 | loss: 0.8049732
	speed: 1.7415s/iter; left time: 2829.9205s
	iters: 1100, epoch: 1 | loss: 0.6231570
	speed: 1.7411s/iter; left time: 2655.1260s
	iters: 1200, epoch: 1 | loss: 0.6211299
	speed: 1.7505s/iter; left time: 2494.5091s
	iters: 1300, epoch: 1 | loss: 0.7183045
	speed: 1.7795s/iter; left time: 2357.8880s
Epoch: 1 cost time: 2309.9736025333405
Epoch: 1, Steps: 1312 | Train Loss: 0.8311368 Vali Loss: 0.9215054 Test Loss: 2.1279020
Validation loss decreased (inf --> 0.921505).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6620454
	speed: 7.8286s/iter; left time: 9496.0503s
	iters: 200, epoch: 2 | loss: 1.0331819
	speed: 1.7421s/iter; left time: 1938.9995s
	iters: 300, epoch: 2 | loss: 0.7525500
	speed: 1.7433s/iter; left time: 1765.9549s
	iters: 400, epoch: 2 | loss: 1.2110668
	speed: 1.7458s/iter; left time: 1593.9508s
	iters: 500, epoch: 2 | loss: 0.8782362
	speed: 1.7431s/iter; left time: 1417.1430s
	iters: 600, epoch: 2 | loss: 0.8723908
	speed: 1.7418s/iter; left time: 1241.8686s
	iters: 700, epoch: 2 | loss: 0.6275136
	speed: 1.7415s/iter; left time: 1067.5525s
	iters: 800, epoch: 2 | loss: 0.5769341
	speed: 1.7426s/iter; left time: 893.9693s
	iters: 900, epoch: 2 | loss: 0.6466281
	speed: 1.7455s/iter; left time: 720.8964s
	iters: 1000, epoch: 2 | loss: 0.7595918
	speed: 1.7516s/iter; left time: 548.2545s
	iters: 1100, epoch: 2 | loss: 0.8015671
	speed: 1.7507s/iter; left time: 372.9009s
	iters: 1200, epoch: 2 | loss: 0.6723841
	speed: 1.7495s/iter; left time: 197.6895s
	iters: 1300, epoch: 2 | loss: 0.8898265
	speed: 1.7502s/iter; left time: 22.7520s
Epoch: 2 cost time: 2290.511933326721
Epoch: 2, Steps: 1312 | Train Loss: 0.7595197 Vali Loss: 0.9081994 Test Loss: 2.1572080
Validation loss decreased (0.921505 --> 0.908199).  Saving model ...
Updating learning rate to 5e-05
>>>>>>>testing : long_term_forecast_pems12_d_96_336_TimesNet_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1288
test shape: (1288, 1, 336, 1543) (1288, 1, 336, 1543)
test shape: (1288, 336, 1543) (1288, 336, 1543)
mse:2.1572060585021973, mae:0.6827516555786133
>>>>>>>Overall time: 6336 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=4, c_out=1543, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems12_d.csv', dec_in=1543, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=1543, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='TimesNet', model_id='pems12_d_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=720, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=2, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems12_d_96_720_TimesNet_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4865
val 93
test 904
	iters: 100, epoch: 1 | loss: 1.3854417
	speed: 2.9237s/iter; left time: 6820.8962s
	iters: 200, epoch: 1 | loss: 1.1828303
	speed: 2.9260s/iter; left time: 6533.8344s
	iters: 300, epoch: 1 | loss: 0.9904426
	speed: 2.8093s/iter; left time: 5992.2353s
	iters: 400, epoch: 1 | loss: 0.8510132
	speed: 2.8044s/iter; left time: 5701.2544s
	iters: 500, epoch: 1 | loss: 0.9467226
	speed: 2.7826s/iter; left time: 5378.8457s
	iters: 600, epoch: 1 | loss: 1.0119772
	speed: 2.7748s/iter; left time: 5086.2484s
	iters: 700, epoch: 1 | loss: 1.0103720
	speed: 2.7755s/iter; left time: 4810.0262s
	iters: 800, epoch: 1 | loss: 1.1210523
	speed: 2.7901s/iter; left time: 4556.2479s
	iters: 900, epoch: 1 | loss: 0.9123579
	speed: 2.7940s/iter; left time: 4283.2576s
	iters: 1000, epoch: 1 | loss: 0.7491276
	speed: 2.8291s/iter; left time: 4054.0738s
	iters: 1100, epoch: 1 | loss: 0.8596931
	speed: 2.9165s/iter; left time: 3887.6441s
	iters: 1200, epoch: 1 | loss: 1.1017461
	speed: 2.8810s/iter; left time: 3552.3109s
Epoch: 1 cost time: 3448.0255167484283
Epoch: 1, Steps: 1216 | Train Loss: 1.0116139 Vali Loss: 0.9934886 Test Loss: 2.7628031
Validation loss decreased (inf --> 0.993489).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7326207
	speed: 8.2508s/iter; left time: 9216.1565s
	iters: 200, epoch: 2 | loss: 0.7136959
	speed: 2.9004s/iter; left time: 2949.6685s
	iters: 300, epoch: 2 | loss: 0.8850023
	speed: 2.9495s/iter; left time: 2704.6943s
	iters: 400, epoch: 2 | loss: 0.7059430
	speed: 2.9048s/iter; left time: 2373.2103s
	iters: 500, epoch: 2 | loss: 0.8392190
	speed: 2.9529s/iter; left time: 2117.2558s
	iters: 600, epoch: 2 | loss: 0.7582232
	speed: 2.9897s/iter; left time: 1844.6371s
	iters: 700, epoch: 2 | loss: 0.8114066
	speed: 3.0273s/iter; left time: 1565.1091s
	iters: 800, epoch: 2 | loss: 0.8922175
	speed: 3.0343s/iter; left time: 1265.2995s
	iters: 900, epoch: 2 | loss: 0.8574727
	speed: 3.0361s/iter; left time: 962.4350s
	iters: 1000, epoch: 2 | loss: 0.7910417
	speed: 3.0280s/iter; left time: 657.0858s
	iters: 1100, epoch: 2 | loss: 0.7549948
	speed: 2.8702s/iter; left time: 335.8104s
	iters: 1200, epoch: 2 | loss: 0.8328723
	speed: 2.9858s/iter; left time: 50.7588s
Epoch: 2 cost time: 3601.0399191379547
Epoch: 2, Steps: 1216 | Train Loss: 0.8600435 Vali Loss: 1.1414231 Test Loss: 3.0149829
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
>>>>>>>testing : long_term_forecast_pems12_d_96_720_TimesNet_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 904
test shape: (904, 1, 720, 1543) (904, 1, 720, 1543)
test shape: (904, 720, 1543) (904, 720, 1543)
mse:2.762800455093384, mae:0.8187416195869446
>>>>>>>Overall time: 8670 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
