Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=521, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems11_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=521, expand=2, factor=1, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems11_all_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=192, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems11_all_96_192_Mamba_custom_ftM_sl192_ll48_pl192_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1253608
val 347726
test 347726
	iters: 100, epoch: 1 | loss: 0.8122795
	speed: 0.0815s/iter; left time: 3183.2667s
	iters: 200, epoch: 1 | loss: 0.6841041
	speed: 0.0584s/iter; left time: 2277.0592s
	iters: 300, epoch: 1 | loss: 0.4852345
	speed: 0.0583s/iter; left time: 2266.1299s
	iters: 400, epoch: 1 | loss: 0.6382853
	speed: 0.0582s/iter; left time: 2256.0668s
	iters: 500, epoch: 1 | loss: 0.5583007
	speed: 0.0578s/iter; left time: 2234.9330s
	iters: 600, epoch: 1 | loss: 0.5837505
	speed: 0.0576s/iter; left time: 2222.3492s
	iters: 700, epoch: 1 | loss: 0.4685640
	speed: 0.0576s/iter; left time: 2217.6579s
	iters: 800, epoch: 1 | loss: 0.5236489
	speed: 0.0571s/iter; left time: 2190.9644s
	iters: 900, epoch: 1 | loss: 0.4532488
	speed: 0.0570s/iter; left time: 2181.9344s
	iters: 1000, epoch: 1 | loss: 0.6262752
	speed: 0.0570s/iter; left time: 2174.3048s
	iters: 1100, epoch: 1 | loss: 0.4036115
	speed: 0.0570s/iter; left time: 2170.5311s
	iters: 1200, epoch: 1 | loss: 0.6338409
	speed: 0.0569s/iter; left time: 2161.1301s
	iters: 1300, epoch: 1 | loss: 0.5303723
	speed: 0.0569s/iter; left time: 2156.4536s
	iters: 1400, epoch: 1 | loss: 0.4874425
	speed: 0.0595s/iter; left time: 2245.9047s
	iters: 1500, epoch: 1 | loss: 0.5962844
	speed: 0.0601s/iter; left time: 2265.2338s
	iters: 1600, epoch: 1 | loss: 0.4899112
	speed: 0.0591s/iter; left time: 2222.1587s
	iters: 1700, epoch: 1 | loss: 0.4674881
	speed: 0.0569s/iter; left time: 2130.3913s
	iters: 1800, epoch: 1 | loss: 0.5474604
	speed: 0.0569s/iter; left time: 2127.4539s
	iters: 1900, epoch: 1 | loss: 0.5913042
	speed: 0.0569s/iter; left time: 2121.6919s
	iters: 2000, epoch: 1 | loss: 0.3967265
	speed: 0.0568s/iter; left time: 2111.0026s
	iters: 2100, epoch: 1 | loss: 0.4025389
	speed: 0.0569s/iter; left time: 2109.6447s
	iters: 2200, epoch: 1 | loss: 0.4261074
	speed: 0.0608s/iter; left time: 2248.3129s
	iters: 2300, epoch: 1 | loss: 0.5017442
	speed: 0.0681s/iter; left time: 2511.7229s
	iters: 2400, epoch: 1 | loss: 0.4872731
	speed: 0.0635s/iter; left time: 2333.2112s
	iters: 2500, epoch: 1 | loss: 0.4627001
	speed: 0.0614s/iter; left time: 2250.8143s
	iters: 2600, epoch: 1 | loss: 0.4198836
	speed: 0.0578s/iter; left time: 2113.7593s
	iters: 2700, epoch: 1 | loss: 0.5431183
	speed: 0.0572s/iter; left time: 2085.6191s
	iters: 2800, epoch: 1 | loss: 0.5668681
	speed: 0.0571s/iter; left time: 2078.3673s
	iters: 2900, epoch: 1 | loss: 0.4230443
	speed: 0.0566s/iter; left time: 2052.3952s
	iters: 3000, epoch: 1 | loss: 0.4729746
	speed: 0.0571s/iter; left time: 2064.7592s
	iters: 3100, epoch: 1 | loss: 0.3976765
	speed: 0.0587s/iter; left time: 2116.8652s
	iters: 3200, epoch: 1 | loss: 0.4387647
	speed: 0.0582s/iter; left time: 2095.1163s
	iters: 3300, epoch: 1 | loss: 0.4567684
	speed: 0.0627s/iter; left time: 2249.3187s
	iters: 3400, epoch: 1 | loss: 0.4175758
	speed: 0.0591s/iter; left time: 2114.3883s
	iters: 3500, epoch: 1 | loss: 0.4365679
	speed: 0.0658s/iter; left time: 2346.0426s
	iters: 3600, epoch: 1 | loss: 0.5245397
	speed: 0.0634s/iter; left time: 2256.5876s
	iters: 3700, epoch: 1 | loss: 0.5681716
	speed: 0.0658s/iter; left time: 2334.7204s
	iters: 3800, epoch: 1 | loss: 0.4743359
	speed: 0.0652s/iter; left time: 2304.4969s
	iters: 3900, epoch: 1 | loss: 0.4544898
	speed: 0.0645s/iter; left time: 2276.0993s
Epoch: 1 cost time: 235.13694381713867
Epoch: 1, Steps: 3917 | Train Loss: 0.5257092 Vali Loss: 1.2211641 Test Loss: 5.2999611
Validation loss decreased (inf --> 1.221164).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3563653
	speed: 2.4129s/iter; left time: 84823.5134s
	iters: 200, epoch: 2 | loss: 0.4122963
	speed: 0.0591s/iter; left time: 2070.0757s
	iters: 300, epoch: 2 | loss: 0.3822640
	speed: 0.0580s/iter; left time: 2025.8173s
	iters: 400, epoch: 2 | loss: 0.5446281
	speed: 0.0581s/iter; left time: 2024.8359s
	iters: 500, epoch: 2 | loss: 0.4709994
	speed: 0.0578s/iter; left time: 2009.7466s
	iters: 600, epoch: 2 | loss: 0.4190228
	speed: 0.0579s/iter; left time: 2006.5531s
	iters: 700, epoch: 2 | loss: 0.3788742
	speed: 0.0653s/iter; left time: 2257.0999s
	iters: 800, epoch: 2 | loss: 0.5024496
	speed: 0.0636s/iter; left time: 2190.7598s
	iters: 900, epoch: 2 | loss: 0.4964634
	speed: 0.0594s/iter; left time: 2040.2433s
	iters: 1000, epoch: 2 | loss: 0.4689920
	speed: 0.0587s/iter; left time: 2009.2198s
	iters: 1100, epoch: 2 | loss: 0.5081084
	speed: 0.0610s/iter; left time: 2082.2280s
	iters: 1200, epoch: 2 | loss: 0.4433345
	speed: 0.0664s/iter; left time: 2262.1663s
	iters: 1300, epoch: 2 | loss: 0.4062996
	speed: 0.0677s/iter; left time: 2299.4281s
	iters: 1400, epoch: 2 | loss: 0.3794750
	speed: 0.0611s/iter; left time: 2068.8410s
	iters: 1500, epoch: 2 | loss: 0.4489156
	speed: 0.0584s/iter; left time: 1969.9884s
	iters: 1600, epoch: 2 | loss: 0.3332991
	speed: 0.0583s/iter; left time: 1962.9542s
	iters: 1700, epoch: 2 | loss: 0.3437740
	speed: 0.0572s/iter; left time: 1920.2065s
	iters: 1800, epoch: 2 | loss: 0.3753713
	speed: 0.0596s/iter; left time: 1994.6363s
	iters: 1900, epoch: 2 | loss: 0.4797648
	speed: 0.0664s/iter; left time: 2215.1643s
	iters: 2000, epoch: 2 | loss: 0.3994378
	speed: 0.0666s/iter; left time: 2213.5394s
	iters: 2100, epoch: 2 | loss: 0.5009527
	speed: 0.0648s/iter; left time: 2148.0615s
	iters: 2200, epoch: 2 | loss: 0.4881780
	speed: 0.0645s/iter; left time: 2130.9440s
	iters: 2300, epoch: 2 | loss: 0.4450711
	speed: 0.0644s/iter; left time: 2123.4612s
	iters: 2400, epoch: 2 | loss: 0.4669685
	speed: 0.0690s/iter; left time: 2266.3906s
	iters: 2500, epoch: 2 | loss: 0.4714002
	speed: 0.0658s/iter; left time: 2156.8320s
	iters: 2600, epoch: 2 | loss: 0.4812095
	speed: 0.0612s/iter; left time: 1998.2500s
	iters: 2700, epoch: 2 | loss: 0.4029332
	speed: 0.0595s/iter; left time: 1937.8616s
	iters: 2800, epoch: 2 | loss: 0.3764748
	speed: 0.0590s/iter; left time: 1913.8121s
	iters: 2900, epoch: 2 | loss: 0.4081685
	speed: 0.0589s/iter; left time: 1906.4637s
	iters: 3000, epoch: 2 | loss: 0.4109861
	speed: 0.0584s/iter; left time: 1884.2909s
	iters: 3100, epoch: 2 | loss: 0.4526298
	speed: 0.0588s/iter; left time: 1890.0025s
	iters: 3200, epoch: 2 | loss: 0.5159071
	speed: 0.0584s/iter; left time: 1871.3994s
	iters: 3300, epoch: 2 | loss: 0.3844676
	speed: 0.0583s/iter; left time: 1863.4034s
	iters: 3400, epoch: 2 | loss: 0.4653044
	speed: 0.0584s/iter; left time: 1859.6351s
	iters: 3500, epoch: 2 | loss: 0.4828166
	speed: 0.0593s/iter; left time: 1883.8948s
	iters: 3600, epoch: 2 | loss: 0.3006937
	speed: 0.0580s/iter; left time: 1835.9470s
	iters: 3700, epoch: 2 | loss: 0.4753309
	speed: 0.0575s/iter; left time: 1815.8673s
	iters: 3800, epoch: 2 | loss: 0.3665019
	speed: 0.0571s/iter; left time: 1795.9525s
	iters: 3900, epoch: 2 | loss: 0.3117451
	speed: 0.0571s/iter; left time: 1791.5930s
Epoch: 2 cost time: 239.28686928749084
Epoch: 2, Steps: 3917 | Train Loss: 0.4419776 Vali Loss: 1.3076702 Test Loss: 5.3209333
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4038739
	speed: 2.0910s/iter; left time: 65316.4824s
	iters: 200, epoch: 3 | loss: 0.4602987
	speed: 0.0582s/iter; left time: 1812.6791s
	iters: 300, epoch: 3 | loss: 0.4141190
	speed: 0.0578s/iter; left time: 1794.9302s
	iters: 400, epoch: 3 | loss: 0.4062413
	speed: 0.0579s/iter; left time: 1792.4258s
	iters: 500, epoch: 3 | loss: 0.4699863
	speed: 0.0579s/iter; left time: 1786.0714s
	iters: 600, epoch: 3 | loss: 0.5510859
	speed: 0.0579s/iter; left time: 1779.8724s
	iters: 700, epoch: 3 | loss: 0.4676582
	speed: 0.0584s/iter; left time: 1790.2306s
	iters: 800, epoch: 3 | loss: 0.4524034
	speed: 0.0582s/iter; left time: 1775.8612s
	iters: 900, epoch: 3 | loss: 0.5595082
	speed: 0.0601s/iter; left time: 1829.1250s
	iters: 1000, epoch: 3 | loss: 0.3678852
	speed: 0.0591s/iter; left time: 1794.0375s
	iters: 1100, epoch: 3 | loss: 0.4231290
	speed: 0.0596s/iter; left time: 1802.9735s
	iters: 1200, epoch: 3 | loss: 0.4654278
	speed: 0.0586s/iter; left time: 1766.6093s
	iters: 1300, epoch: 3 | loss: 0.3632566
	speed: 0.0589s/iter; left time: 1768.9963s
	iters: 1400, epoch: 3 | loss: 0.4880812
	speed: 0.0606s/iter; left time: 1814.5648s
	iters: 1500, epoch: 3 | loss: 0.3384634
	speed: 0.0606s/iter; left time: 1806.9614s
	iters: 1600, epoch: 3 | loss: 0.5125148
	speed: 0.0621s/iter; left time: 1845.5847s
	iters: 1700, epoch: 3 | loss: 0.3853297
	speed: 0.0672s/iter; left time: 1992.2805s
	iters: 1800, epoch: 3 | loss: 0.4340514
	speed: 0.0672s/iter; left time: 1985.3146s
	iters: 1900, epoch: 3 | loss: 0.4114040
	speed: 0.0632s/iter; left time: 1859.9055s
	iters: 2000, epoch: 3 | loss: 0.4147756
	speed: 0.0611s/iter; left time: 1791.4527s
	iters: 2100, epoch: 3 | loss: 0.6113011
	speed: 0.0675s/iter; left time: 1972.2935s
	iters: 2200, epoch: 3 | loss: 0.4040471
	speed: 0.0615s/iter; left time: 1790.7488s
	iters: 2300, epoch: 3 | loss: 0.4217659
	speed: 0.0597s/iter; left time: 1732.7729s
	iters: 2400, epoch: 3 | loss: 0.4168214
	speed: 0.0592s/iter; left time: 1711.7674s
	iters: 2500, epoch: 3 | loss: 0.3970605
	speed: 0.0591s/iter; left time: 1703.2328s
	iters: 2600, epoch: 3 | loss: 0.4330842
	speed: 0.0597s/iter; left time: 1714.6781s
	iters: 2700, epoch: 3 | loss: 0.3289373
	speed: 0.0584s/iter; left time: 1671.8946s
	iters: 2800, epoch: 3 | loss: 0.3858982
	speed: 0.0589s/iter; left time: 1680.0817s
	iters: 2900, epoch: 3 | loss: 0.3825533
	speed: 0.0584s/iter; left time: 1662.1350s
	iters: 3000, epoch: 3 | loss: 0.3609117
	speed: 0.0586s/iter; left time: 1661.4613s
	iters: 3100, epoch: 3 | loss: 0.3954042
	speed: 0.0622s/iter; left time: 1756.4283s
	iters: 3200, epoch: 3 | loss: 0.4765050
	speed: 0.0602s/iter; left time: 1693.7147s
	iters: 3300, epoch: 3 | loss: 0.3828763
	speed: 0.0661s/iter; left time: 1854.5455s
	iters: 3400, epoch: 3 | loss: 0.3444342
	speed: 0.0650s/iter; left time: 1816.5135s
	iters: 3500, epoch: 3 | loss: 0.5016754
	speed: 0.0655s/iter; left time: 1823.3823s
	iters: 3600, epoch: 3 | loss: 0.6747669
	speed: 0.0639s/iter; left time: 1771.7537s
	iters: 3700, epoch: 3 | loss: 0.3877894
	speed: 0.0632s/iter; left time: 1745.8094s
	iters: 3800, epoch: 3 | loss: 0.4355905
	speed: 0.0652s/iter; left time: 1794.5103s
	iters: 3900, epoch: 3 | loss: 0.4058124
	speed: 0.0628s/iter; left time: 1723.0679s
Epoch: 3 cost time: 239.92451453208923
Epoch: 3, Steps: 3917 | Train Loss: 0.4184083 Vali Loss: 1.2412977 Test Loss: 5.2343140
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3836758
	speed: 2.3121s/iter; left time: 63165.3215s
	iters: 200, epoch: 4 | loss: 0.3379181
	speed: 0.0589s/iter; left time: 1602.1024s
	iters: 300, epoch: 4 | loss: 0.4253725
	speed: 0.0571s/iter; left time: 1547.4943s
	iters: 400, epoch: 4 | loss: 0.4239383
	speed: 0.0573s/iter; left time: 1549.1927s
	iters: 500, epoch: 4 | loss: 0.3854479
	speed: 0.0591s/iter; left time: 1590.2482s
	iters: 600, epoch: 4 | loss: 0.3211989
	speed: 0.0634s/iter; left time: 1701.1309s
	iters: 700, epoch: 4 | loss: 0.3901770
	speed: 0.0642s/iter; left time: 1714.8561s
	iters: 800, epoch: 4 | loss: 0.3988347
	speed: 0.0599s/iter; left time: 1593.5044s
	iters: 900, epoch: 4 | loss: 0.3474256
	speed: 0.0613s/iter; left time: 1626.8521s
	iters: 1000, epoch: 4 | loss: 0.4306934
	speed: 0.0675s/iter; left time: 1782.0616s
	iters: 1100, epoch: 4 | loss: 0.3945997
	speed: 0.0617s/iter; left time: 1623.3708s
	iters: 1200, epoch: 4 | loss: 0.3519871
	speed: 0.0588s/iter; left time: 1541.7614s
	iters: 1300, epoch: 4 | loss: 0.4126495
	speed: 0.0581s/iter; left time: 1517.4817s
	iters: 1400, epoch: 4 | loss: 0.3714413
	speed: 0.0577s/iter; left time: 1502.2049s
	iters: 1500, epoch: 4 | loss: 0.3980401
	speed: 0.0579s/iter; left time: 1499.5004s
	iters: 1600, epoch: 4 | loss: 0.5211348
	speed: 0.0590s/iter; left time: 1523.7056s
	iters: 1700, epoch: 4 | loss: 0.5090976
	speed: 0.0595s/iter; left time: 1530.1234s
	iters: 1800, epoch: 4 | loss: 0.4168563
	speed: 0.0584s/iter; left time: 1497.4378s
	iters: 1900, epoch: 4 | loss: 0.3553168
	speed: 0.0585s/iter; left time: 1491.9463s
	iters: 2000, epoch: 4 | loss: 0.3896678
	speed: 0.0591s/iter; left time: 1503.3416s
	iters: 2100, epoch: 4 | loss: 0.3542752
	speed: 0.0578s/iter; left time: 1462.8431s
	iters: 2200, epoch: 4 | loss: 0.4085213
	speed: 0.0684s/iter; left time: 1725.0031s
	iters: 2300, epoch: 4 | loss: 0.3262089
	speed: 0.0699s/iter; left time: 1755.2672s
	iters: 2400, epoch: 4 | loss: 0.3467363
	speed: 0.0678s/iter; left time: 1696.9559s
	iters: 2500, epoch: 4 | loss: 0.3889993
	speed: 0.0690s/iter; left time: 1719.1771s
	iters: 2600, epoch: 4 | loss: 0.5185428
	speed: 0.0675s/iter; left time: 1675.2006s
	iters: 2700, epoch: 4 | loss: 0.4675590
	speed: 0.0676s/iter; left time: 1669.9344s
	iters: 2800, epoch: 4 | loss: 0.3383759
	speed: 0.0679s/iter; left time: 1671.6078s
	iters: 2900, epoch: 4 | loss: 0.4452856
	speed: 0.0679s/iter; left time: 1665.5513s
	iters: 3000, epoch: 4 | loss: 0.3894386
	speed: 0.0601s/iter; left time: 1468.1966s
	iters: 3100, epoch: 4 | loss: 0.5072510
	speed: 0.0582s/iter; left time: 1414.2364s
	iters: 3200, epoch: 4 | loss: 0.4185339
	speed: 0.0575s/iter; left time: 1391.5321s
	iters: 3300, epoch: 4 | loss: 0.3585022
	speed: 0.0573s/iter; left time: 1381.2164s
	iters: 3400, epoch: 4 | loss: 0.3772287
	speed: 0.0574s/iter; left time: 1379.5462s
	iters: 3500, epoch: 4 | loss: 0.3630369
	speed: 0.0577s/iter; left time: 1381.3230s
	iters: 3600, epoch: 4 | loss: 0.4529171
	speed: 0.0578s/iter; left time: 1377.6630s
	iters: 3700, epoch: 4 | loss: 0.5452974
	speed: 0.0580s/iter; left time: 1375.1522s
	iters: 3800, epoch: 4 | loss: 0.4266507
	speed: 0.0592s/iter; left time: 1397.8584s
	iters: 3900, epoch: 4 | loss: 0.3879114
	speed: 0.0585s/iter; left time: 1375.6930s
Epoch: 4 cost time: 240.47110247612
Epoch: 4, Steps: 3917 | Train Loss: 0.4094436 Vali Loss: 1.2774980 Test Loss: 5.2626858
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems11_all_96_192_Mamba_custom_ftM_sl192_ll48_pl192_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 347726
test shape: (34772, 1, 192, 521) (34772, 1, 192, 521)
test shape: (34772, 192, 521) (34772, 192, 521)
mse:5.299892902374268, mae:0.9197571277618408
>>>>>>>Overall time: 2536 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
