Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=212, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems08_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=212, expand=2, factor=1, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems08_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems08_all_96_96_Mamba_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1348628
val 379433
test 379431
	iters: 100, epoch: 1 | loss: 1.8436010
	speed: 0.0382s/iter; left time: 1604.0426s
	iters: 200, epoch: 1 | loss: 1.5398962
	speed: 0.0165s/iter; left time: 693.9405s
	iters: 300, epoch: 1 | loss: 1.2544320
	speed: 0.0163s/iter; left time: 679.9341s
	iters: 400, epoch: 1 | loss: 1.2228520
	speed: 0.0161s/iter; left time: 672.5024s
	iters: 500, epoch: 1 | loss: 0.9710048
	speed: 0.0166s/iter; left time: 691.6033s
	iters: 600, epoch: 1 | loss: 0.9254119
	speed: 0.0162s/iter; left time: 672.1790s
	iters: 700, epoch: 1 | loss: 1.0334930
	speed: 0.0159s/iter; left time: 659.5904s
	iters: 800, epoch: 1 | loss: 0.9901981
	speed: 0.0160s/iter; left time: 661.1344s
	iters: 900, epoch: 1 | loss: 0.9019431
	speed: 0.0176s/iter; left time: 724.2956s
	iters: 1000, epoch: 1 | loss: 1.0143781
	speed: 0.0182s/iter; left time: 749.4091s
	iters: 1100, epoch: 1 | loss: 0.8740823
	speed: 0.0174s/iter; left time: 712.7629s
	iters: 1200, epoch: 1 | loss: 1.0506002
	speed: 0.0176s/iter; left time: 720.0736s
	iters: 1300, epoch: 1 | loss: 0.9590569
	speed: 0.0162s/iter; left time: 661.8989s
	iters: 1400, epoch: 1 | loss: 0.8723642
	speed: 0.0158s/iter; left time: 643.6659s
	iters: 1500, epoch: 1 | loss: 0.7704735
	speed: 0.0158s/iter; left time: 642.6636s
	iters: 1600, epoch: 1 | loss: 0.8701787
	speed: 0.0159s/iter; left time: 642.9977s
	iters: 1700, epoch: 1 | loss: 0.7223794
	speed: 0.0159s/iter; left time: 643.7527s
	iters: 1800, epoch: 1 | loss: 0.8581913
	speed: 0.0159s/iter; left time: 642.6244s
	iters: 1900, epoch: 1 | loss: 0.7517275
	speed: 0.0159s/iter; left time: 638.9843s
	iters: 2000, epoch: 1 | loss: 0.8897178
	speed: 0.0159s/iter; left time: 638.6184s
	iters: 2100, epoch: 1 | loss: 0.7513450
	speed: 0.0159s/iter; left time: 637.0274s
	iters: 2200, epoch: 1 | loss: 0.8864773
	speed: 0.0160s/iter; left time: 638.5534s
	iters: 2300, epoch: 1 | loss: 0.8019210
	speed: 0.0176s/iter; left time: 703.0072s
	iters: 2400, epoch: 1 | loss: 0.8451898
	speed: 0.0176s/iter; left time: 701.3013s
	iters: 2500, epoch: 1 | loss: 0.8600784
	speed: 0.0171s/iter; left time: 678.7361s
	iters: 2600, epoch: 1 | loss: 0.7784618
	speed: 0.0189s/iter; left time: 748.0625s
	iters: 2700, epoch: 1 | loss: 0.7554155
	speed: 0.0178s/iter; left time: 702.4807s
	iters: 2800, epoch: 1 | loss: 0.8265370
	speed: 0.0181s/iter; left time: 713.4375s
	iters: 2900, epoch: 1 | loss: 0.7464572
	speed: 0.0178s/iter; left time: 697.8300s
	iters: 3000, epoch: 1 | loss: 0.7516656
	speed: 0.0181s/iter; left time: 706.6304s
	iters: 3100, epoch: 1 | loss: 0.6886759
	speed: 0.0179s/iter; left time: 699.9309s
	iters: 3200, epoch: 1 | loss: 0.7357605
	speed: 0.0176s/iter; left time: 686.7450s
	iters: 3300, epoch: 1 | loss: 0.8051257
	speed: 0.0178s/iter; left time: 692.7193s
	iters: 3400, epoch: 1 | loss: 0.7740147
	speed: 0.0172s/iter; left time: 665.2801s
	iters: 3500, epoch: 1 | loss: 0.7316735
	speed: 0.0171s/iter; left time: 661.8507s
	iters: 3600, epoch: 1 | loss: 0.6675606
	speed: 0.0176s/iter; left time: 680.1383s
	iters: 3700, epoch: 1 | loss: 0.8129853
	speed: 0.0170s/iter; left time: 653.8082s
	iters: 3800, epoch: 1 | loss: 0.7566070
	speed: 0.0167s/iter; left time: 640.7180s
	iters: 3900, epoch: 1 | loss: 0.7000400
	speed: 0.0168s/iter; left time: 644.2964s
	iters: 4000, epoch: 1 | loss: 0.7899554
	speed: 0.0165s/iter; left time: 629.9448s
	iters: 4100, epoch: 1 | loss: 0.7188489
	speed: 0.0166s/iter; left time: 633.1766s
	iters: 4200, epoch: 1 | loss: 0.7504597
	speed: 0.0181s/iter; left time: 687.2273s
Epoch: 1 cost time: 73.63014888763428
Epoch: 1, Steps: 4214 | Train Loss: 0.9038549 Vali Loss: 3.4344873 Test Loss: 5.4111300
Validation loss decreased (inf --> 3.434487).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6866983
	speed: 1.0527s/iter; left time: 39820.2542s
	iters: 200, epoch: 2 | loss: 0.7524946
	speed: 0.0165s/iter; left time: 620.7478s
	iters: 300, epoch: 2 | loss: 0.7044399
	speed: 0.0165s/iter; left time: 619.7110s
	iters: 400, epoch: 2 | loss: 0.7533874
	speed: 0.0165s/iter; left time: 617.9134s
	iters: 500, epoch: 2 | loss: 0.6580400
	speed: 0.0165s/iter; left time: 615.9251s
	iters: 600, epoch: 2 | loss: 0.6977718
	speed: 0.0165s/iter; left time: 617.3532s
	iters: 700, epoch: 2 | loss: 0.6336933
	speed: 0.0165s/iter; left time: 612.6574s
	iters: 800, epoch: 2 | loss: 0.6923541
	speed: 0.0165s/iter; left time: 611.1723s
	iters: 900, epoch: 2 | loss: 0.6480626
	speed: 0.0165s/iter; left time: 611.2502s
	iters: 1000, epoch: 2 | loss: 0.9039919
	speed: 0.0166s/iter; left time: 611.2681s
	iters: 1100, epoch: 2 | loss: 0.6675986
	speed: 0.0165s/iter; left time: 608.7818s
	iters: 1200, epoch: 2 | loss: 0.7269138
	speed: 0.0166s/iter; left time: 608.8072s
	iters: 1300, epoch: 2 | loss: 0.7440186
	speed: 0.0166s/iter; left time: 609.7332s
	iters: 1400, epoch: 2 | loss: 0.7439598
	speed: 0.0166s/iter; left time: 605.6687s
	iters: 1500, epoch: 2 | loss: 0.7215056
	speed: 0.0166s/iter; left time: 604.7840s
	iters: 1600, epoch: 2 | loss: 0.7822922
	speed: 0.0168s/iter; left time: 609.3886s
	iters: 1700, epoch: 2 | loss: 0.6895260
	speed: 0.0182s/iter; left time: 659.1720s
	iters: 1800, epoch: 2 | loss: 0.6402900
	speed: 0.0168s/iter; left time: 608.6785s
	iters: 1900, epoch: 2 | loss: 0.7770850
	speed: 0.0166s/iter; left time: 596.4239s
	iters: 2000, epoch: 2 | loss: 0.8670496
	speed: 0.0177s/iter; left time: 635.2584s
	iters: 2100, epoch: 2 | loss: 0.6771307
	speed: 0.0166s/iter; left time: 595.0304s
	iters: 2200, epoch: 2 | loss: 0.6965245
	speed: 0.0176s/iter; left time: 629.3831s
	iters: 2300, epoch: 2 | loss: 0.6751538
	speed: 0.0163s/iter; left time: 580.3755s
	iters: 2400, epoch: 2 | loss: 0.6403132
	speed: 0.0166s/iter; left time: 590.0994s
	iters: 2500, epoch: 2 | loss: 0.7560104
	speed: 0.0162s/iter; left time: 574.6617s
	iters: 2600, epoch: 2 | loss: 0.7778283
	speed: 0.0159s/iter; left time: 559.9738s
	iters: 2700, epoch: 2 | loss: 0.7387497
	speed: 0.0164s/iter; left time: 578.9178s
	iters: 2800, epoch: 2 | loss: 0.7360775
	speed: 0.0166s/iter; left time: 583.6616s
	iters: 2900, epoch: 2 | loss: 0.7703464
	speed: 0.0167s/iter; left time: 584.6078s
	iters: 3000, epoch: 2 | loss: 0.6886776
	speed: 0.0169s/iter; left time: 589.4288s
	iters: 3100, epoch: 2 | loss: 0.7470170
	speed: 0.0157s/iter; left time: 545.2732s
	iters: 3200, epoch: 2 | loss: 0.6845519
	speed: 0.0158s/iter; left time: 547.1719s
	iters: 3300, epoch: 2 | loss: 0.7048392
	speed: 0.0162s/iter; left time: 559.8679s
	iters: 3400, epoch: 2 | loss: 0.7069054
	speed: 0.0161s/iter; left time: 554.9303s
	iters: 3500, epoch: 2 | loss: 0.7042906
	speed: 0.0161s/iter; left time: 554.8372s
	iters: 3600, epoch: 2 | loss: 0.8908193
	speed: 0.0155s/iter; left time: 532.7932s
	iters: 3700, epoch: 2 | loss: 0.6653574
	speed: 0.0157s/iter; left time: 538.9509s
	iters: 3800, epoch: 2 | loss: 0.6325290
	speed: 0.0159s/iter; left time: 543.8739s
	iters: 3900, epoch: 2 | loss: 0.6812764
	speed: 0.0157s/iter; left time: 532.6876s
	iters: 4000, epoch: 2 | loss: 0.6705406
	speed: 0.0165s/iter; left time: 561.2946s
	iters: 4100, epoch: 2 | loss: 0.6916162
	speed: 0.0172s/iter; left time: 582.6393s
	iters: 4200, epoch: 2 | loss: 0.7422664
	speed: 0.0163s/iter; left time: 551.1968s
Epoch: 2 cost time: 69.85400605201721
Epoch: 2, Steps: 4214 | Train Loss: 0.7128181 Vali Loss: 8.0156860 Test Loss: 11.5874901
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7203808
	speed: 1.0336s/iter; left time: 34742.6529s
	iters: 200, epoch: 3 | loss: 0.5904367
	speed: 0.0164s/iter; left time: 549.2044s
	iters: 300, epoch: 3 | loss: 0.7066464
	speed: 0.0163s/iter; left time: 545.6694s
	iters: 400, epoch: 3 | loss: 0.6618640
	speed: 0.0166s/iter; left time: 553.5706s
	iters: 500, epoch: 3 | loss: 0.6428707
	speed: 0.0171s/iter; left time: 568.9229s
	iters: 600, epoch: 3 | loss: 0.6282105
	speed: 0.0171s/iter; left time: 565.2578s
	iters: 700, epoch: 3 | loss: 0.6120304
	speed: 0.0170s/iter; left time: 562.2498s
	iters: 800, epoch: 3 | loss: 0.6795414
	speed: 0.0171s/iter; left time: 561.7727s
	iters: 900, epoch: 3 | loss: 0.7164927
	speed: 0.0169s/iter; left time: 555.1375s
	iters: 1000, epoch: 3 | loss: 0.6699082
	speed: 0.0169s/iter; left time: 554.0472s
	iters: 1100, epoch: 3 | loss: 0.6102807
	speed: 0.0169s/iter; left time: 552.5395s
	iters: 1200, epoch: 3 | loss: 0.5881103
	speed: 0.0170s/iter; left time: 554.0746s
	iters: 1300, epoch: 3 | loss: 0.6636183
	speed: 0.0168s/iter; left time: 544.1850s
	iters: 1400, epoch: 3 | loss: 0.6491285
	speed: 0.0170s/iter; left time: 549.6653s
	iters: 1500, epoch: 3 | loss: 0.7328023
	speed: 0.0170s/iter; left time: 547.1282s
	iters: 1600, epoch: 3 | loss: 0.6533271
	speed: 0.0170s/iter; left time: 544.7669s
	iters: 1700, epoch: 3 | loss: 0.6745239
	speed: 0.0170s/iter; left time: 543.5746s
	iters: 1800, epoch: 3 | loss: 0.6048800
	speed: 0.0170s/iter; left time: 542.0856s
	iters: 1900, epoch: 3 | loss: 0.6027178
	speed: 0.0175s/iter; left time: 558.1172s
	iters: 2000, epoch: 3 | loss: 0.7003098
	speed: 0.0182s/iter; left time: 578.3056s
	iters: 2100, epoch: 3 | loss: 0.6252890
	speed: 0.0172s/iter; left time: 542.5380s
	iters: 2200, epoch: 3 | loss: 0.6652143
	speed: 0.0168s/iter; left time: 530.9009s
	iters: 2300, epoch: 3 | loss: 0.6858220
	speed: 0.0171s/iter; left time: 538.2306s
	iters: 2400, epoch: 3 | loss: 0.6675150
	speed: 0.0175s/iter; left time: 546.7877s
	iters: 2500, epoch: 3 | loss: 0.7165355
	speed: 0.0171s/iter; left time: 532.1892s
	iters: 2600, epoch: 3 | loss: 0.7971407
	speed: 0.0170s/iter; left time: 527.8798s
	iters: 2700, epoch: 3 | loss: 0.6179266
	speed: 0.0161s/iter; left time: 499.7798s
	iters: 2800, epoch: 3 | loss: 0.6717811
	speed: 0.0164s/iter; left time: 508.2755s
	iters: 2900, epoch: 3 | loss: 0.5819760
	speed: 0.0165s/iter; left time: 507.3963s
	iters: 3000, epoch: 3 | loss: 0.6641181
	speed: 0.0167s/iter; left time: 513.9560s
	iters: 3100, epoch: 3 | loss: 0.5907735
	speed: 0.0166s/iter; left time: 509.2334s
	iters: 3200, epoch: 3 | loss: 0.6634897
	speed: 0.0169s/iter; left time: 514.7129s
	iters: 3300, epoch: 3 | loss: 0.6677890
	speed: 0.0168s/iter; left time: 510.4910s
	iters: 3400, epoch: 3 | loss: 0.6432207
	speed: 0.0177s/iter; left time: 536.4751s
	iters: 3500, epoch: 3 | loss: 0.6445807
	speed: 0.0171s/iter; left time: 515.3075s
	iters: 3600, epoch: 3 | loss: 0.7029726
	speed: 0.0173s/iter; left time: 520.5722s
	iters: 3700, epoch: 3 | loss: 0.6236006
	speed: 0.0169s/iter; left time: 507.7258s
	iters: 3800, epoch: 3 | loss: 0.6418945
	speed: 0.0172s/iter; left time: 515.0018s
	iters: 3900, epoch: 3 | loss: 0.6850743
	speed: 0.0179s/iter; left time: 533.3472s
	iters: 4000, epoch: 3 | loss: 0.6267233
	speed: 0.0179s/iter; left time: 530.7191s
	iters: 4100, epoch: 3 | loss: 0.6462783
	speed: 0.0175s/iter; left time: 518.7268s
	iters: 4200, epoch: 3 | loss: 0.5879360
	speed: 0.0171s/iter; left time: 504.5055s
Epoch: 3 cost time: 72.12726330757141
Epoch: 3, Steps: 4214 | Train Loss: 0.6652321 Vali Loss: 11.5041809 Test Loss: 15.9800949
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6923363
	speed: 1.2338s/iter; left time: 36272.3997s
	iters: 200, epoch: 4 | loss: 0.7080762
	speed: 0.0159s/iter; left time: 465.9246s
	iters: 300, epoch: 4 | loss: 0.6421006
	speed: 0.0155s/iter; left time: 451.1604s
	iters: 400, epoch: 4 | loss: 0.6256348
	speed: 0.0145s/iter; left time: 421.0757s
	iters: 500, epoch: 4 | loss: 0.6163999
	speed: 0.0145s/iter; left time: 420.2915s
	iters: 600, epoch: 4 | loss: 0.7993954
	speed: 0.0160s/iter; left time: 462.9955s
	iters: 700, epoch: 4 | loss: 0.6396627
	speed: 0.0161s/iter; left time: 464.5393s
	iters: 800, epoch: 4 | loss: 0.5989252
	speed: 0.0152s/iter; left time: 437.5734s
	iters: 900, epoch: 4 | loss: 0.6868260
	speed: 0.0150s/iter; left time: 429.4489s
	iters: 1000, epoch: 4 | loss: 0.6482368
	speed: 0.0149s/iter; left time: 423.8393s
	iters: 1100, epoch: 4 | loss: 0.5693901
	speed: 0.0159s/iter; left time: 451.3391s
	iters: 1200, epoch: 4 | loss: 0.6494096
	speed: 0.0156s/iter; left time: 442.7388s
	iters: 1300, epoch: 4 | loss: 0.5539699
	speed: 0.0157s/iter; left time: 442.5651s
	iters: 1400, epoch: 4 | loss: 0.6175522
	speed: 0.0156s/iter; left time: 437.6608s
	iters: 1500, epoch: 4 | loss: 0.7712060
	speed: 0.0159s/iter; left time: 445.5885s
	iters: 1600, epoch: 4 | loss: 0.6494781
	speed: 0.0166s/iter; left time: 464.1810s
	iters: 1700, epoch: 4 | loss: 0.6028078
	speed: 0.0162s/iter; left time: 449.5163s
	iters: 1800, epoch: 4 | loss: 0.6478345
	speed: 0.0166s/iter; left time: 459.5965s
	iters: 1900, epoch: 4 | loss: 0.7204304
	speed: 0.0155s/iter; left time: 428.1758s
	iters: 2000, epoch: 4 | loss: 0.6807874
	speed: 0.0172s/iter; left time: 472.8522s
	iters: 2100, epoch: 4 | loss: 0.7513761
	speed: 0.0168s/iter; left time: 460.4782s
	iters: 2200, epoch: 4 | loss: 0.6800103
	speed: 0.0162s/iter; left time: 442.9390s
	iters: 2300, epoch: 4 | loss: 0.7259802
	speed: 0.0176s/iter; left time: 477.6493s
	iters: 2400, epoch: 4 | loss: 0.6172237
	speed: 0.0165s/iter; left time: 445.8165s
	iters: 2500, epoch: 4 | loss: 0.6055021
	speed: 0.0165s/iter; left time: 444.3925s
	iters: 2600, epoch: 4 | loss: 0.7401227
	speed: 0.0175s/iter; left time: 471.0013s
	iters: 2700, epoch: 4 | loss: 0.6925296
	speed: 0.0171s/iter; left time: 457.6882s
	iters: 2800, epoch: 4 | loss: 0.6502895
	speed: 0.0160s/iter; left time: 427.6324s
	iters: 2900, epoch: 4 | loss: 0.6128758
	speed: 0.0154s/iter; left time: 410.8959s
	iters: 3000, epoch: 4 | loss: 0.5755919
	speed: 0.0163s/iter; left time: 432.2525s
	iters: 3100, epoch: 4 | loss: 0.5991140
	speed: 0.0161s/iter; left time: 424.0484s
	iters: 3200, epoch: 4 | loss: 0.6217614
	speed: 0.0147s/iter; left time: 387.1169s
	iters: 3300, epoch: 4 | loss: 0.6122053
	speed: 0.0152s/iter; left time: 399.0982s
	iters: 3400, epoch: 4 | loss: 0.6743439
	speed: 0.0162s/iter; left time: 421.5273s
	iters: 3500, epoch: 4 | loss: 0.6062871
	speed: 0.0152s/iter; left time: 395.4169s
	iters: 3600, epoch: 4 | loss: 0.7292743
	speed: 0.0157s/iter; left time: 406.2437s
	iters: 3700, epoch: 4 | loss: 0.7241715
	speed: 0.0163s/iter; left time: 420.3181s
	iters: 3800, epoch: 4 | loss: 0.6789604
	speed: 0.0148s/iter; left time: 381.2443s
	iters: 3900, epoch: 4 | loss: 0.5846624
	speed: 0.0154s/iter; left time: 394.2842s
	iters: 4000, epoch: 4 | loss: 0.5978054
	speed: 0.0164s/iter; left time: 418.3494s
	iters: 4100, epoch: 4 | loss: 0.6679087
	speed: 0.0163s/iter; left time: 414.5240s
	iters: 4200, epoch: 4 | loss: 0.6559453
	speed: 0.0154s/iter; left time: 389.5926s
Epoch: 4 cost time: 67.52523064613342
Epoch: 4, Steps: 4214 | Train Loss: 0.6468540 Vali Loss: 14.4138975 Test Loss: 19.7177429
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems08_all_96_96_Mamba_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 379431
test shape: (37943, 1, 96, 212) (37943, 1, 96, 212)
test shape: (37943, 96, 212) (37943, 96, 212)
mse:5.41115665435791, mae:1.3194727897644043
>>>>>>>Overall time: 1023 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
