Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=107, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems10_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=107, expand=2, factor=1, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems10_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=336, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_all_96_336_Mamba_custom_ftM_sl336_ll48_pl336_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 949191
val 246207
test 246205
	iters: 100, epoch: 1 | loss: 0.7436954
	speed: 0.0402s/iter; left time: 1189.8063s
	iters: 200, epoch: 1 | loss: 0.7519737
	speed: 0.0201s/iter; left time: 590.8230s
	iters: 300, epoch: 1 | loss: 0.7909482
	speed: 0.0201s/iter; left time: 589.5698s
	iters: 400, epoch: 1 | loss: 0.7103353
	speed: 0.0211s/iter; left time: 616.9965s
	iters: 500, epoch: 1 | loss: 0.6621167
	speed: 0.0211s/iter; left time: 615.3868s
	iters: 600, epoch: 1 | loss: 0.7849239
	speed: 0.0220s/iter; left time: 638.1926s
	iters: 700, epoch: 1 | loss: 0.7454839
	speed: 0.0230s/iter; left time: 665.5001s
	iters: 800, epoch: 1 | loss: 0.6725785
	speed: 0.0207s/iter; left time: 597.4038s
	iters: 900, epoch: 1 | loss: 0.6869327
	speed: 0.0204s/iter; left time: 588.1592s
	iters: 1000, epoch: 1 | loss: 0.6681566
	speed: 0.0194s/iter; left time: 555.9703s
	iters: 1100, epoch: 1 | loss: 0.6433152
	speed: 0.0202s/iter; left time: 576.4009s
	iters: 1200, epoch: 1 | loss: 0.6114787
	speed: 0.0195s/iter; left time: 554.4275s
	iters: 1300, epoch: 1 | loss: 0.7120494
	speed: 0.0208s/iter; left time: 589.5467s
	iters: 1400, epoch: 1 | loss: 0.6352324
	speed: 0.0204s/iter; left time: 575.6598s
	iters: 1500, epoch: 1 | loss: 0.5983063
	speed: 0.0209s/iter; left time: 589.8171s
	iters: 1600, epoch: 1 | loss: 0.5781145
	speed: 0.0210s/iter; left time: 588.0405s
	iters: 1700, epoch: 1 | loss: 0.7176660
	speed: 0.0211s/iter; left time: 590.6548s
	iters: 1800, epoch: 1 | loss: 0.6846316
	speed: 0.0214s/iter; left time: 595.5575s
	iters: 1900, epoch: 1 | loss: 0.6561034
	speed: 0.0216s/iter; left time: 600.9272s
	iters: 2000, epoch: 1 | loss: 0.6612753
	speed: 0.0196s/iter; left time: 541.7427s
	iters: 2100, epoch: 1 | loss: 0.6461104
	speed: 0.0196s/iter; left time: 539.4709s
	iters: 2200, epoch: 1 | loss: 0.6640719
	speed: 0.0196s/iter; left time: 537.4183s
	iters: 2300, epoch: 1 | loss: 0.7219626
	speed: 0.0194s/iter; left time: 531.3150s
	iters: 2400, epoch: 1 | loss: 0.5387198
	speed: 0.0193s/iter; left time: 525.4768s
	iters: 2500, epoch: 1 | loss: 0.5915904
	speed: 0.0204s/iter; left time: 554.1330s
	iters: 2600, epoch: 1 | loss: 0.6547455
	speed: 0.0214s/iter; left time: 577.9569s
	iters: 2700, epoch: 1 | loss: 0.5793989
	speed: 0.0208s/iter; left time: 561.0948s
	iters: 2800, epoch: 1 | loss: 0.6437063
	speed: 0.0201s/iter; left time: 540.8284s
	iters: 2900, epoch: 1 | loss: 0.5858822
	speed: 0.0201s/iter; left time: 536.8906s
Epoch: 1 cost time: 63.00517678260803
Epoch: 1, Steps: 2966 | Train Loss: 0.6642576 Vali Loss: 2.1445241 Test Loss: 2.6449573
Validation loss decreased (inf --> 2.144524).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6027893
	speed: 0.7590s/iter; left time: 20184.8747s
	iters: 200, epoch: 2 | loss: 0.5827695
	speed: 0.0195s/iter; left time: 516.3286s
	iters: 300, epoch: 2 | loss: 0.6078659
	speed: 0.0197s/iter; left time: 521.1695s
	iters: 400, epoch: 2 | loss: 0.4698482
	speed: 0.0202s/iter; left time: 530.3137s
	iters: 500, epoch: 2 | loss: 0.5612115
	speed: 0.0198s/iter; left time: 518.5836s
	iters: 600, epoch: 2 | loss: 0.4980262
	speed: 0.0218s/iter; left time: 568.2112s
	iters: 700, epoch: 2 | loss: 0.5761893
	speed: 0.0201s/iter; left time: 523.2658s
	iters: 800, epoch: 2 | loss: 0.5312523
	speed: 0.0220s/iter; left time: 570.2236s
	iters: 900, epoch: 2 | loss: 0.5494365
	speed: 0.0214s/iter; left time: 550.7884s
	iters: 1000, epoch: 2 | loss: 0.6400977
	speed: 0.0209s/iter; left time: 537.7789s
	iters: 1100, epoch: 2 | loss: 0.5748808
	speed: 0.0209s/iter; left time: 533.6977s
	iters: 1200, epoch: 2 | loss: 0.4802125
	speed: 0.0216s/iter; left time: 550.3828s
	iters: 1300, epoch: 2 | loss: 0.6252851
	speed: 0.0216s/iter; left time: 548.6771s
	iters: 1400, epoch: 2 | loss: 0.5143206
	speed: 0.0207s/iter; left time: 524.6489s
	iters: 1500, epoch: 2 | loss: 0.5304049
	speed: 0.0212s/iter; left time: 535.3699s
	iters: 1600, epoch: 2 | loss: 0.5830782
	speed: 0.0225s/iter; left time: 564.6279s
	iters: 1700, epoch: 2 | loss: 0.5781111
	speed: 0.0211s/iter; left time: 526.3217s
	iters: 1800, epoch: 2 | loss: 0.4668067
	speed: 0.0213s/iter; left time: 529.3748s
	iters: 1900, epoch: 2 | loss: 0.5718977
	speed: 0.0210s/iter; left time: 520.0244s
	iters: 2000, epoch: 2 | loss: 0.5323692
	speed: 0.0198s/iter; left time: 487.8434s
	iters: 2100, epoch: 2 | loss: 0.5235301
	speed: 0.0198s/iter; left time: 485.8669s
	iters: 2200, epoch: 2 | loss: 0.6204578
	speed: 0.0205s/iter; left time: 501.7025s
	iters: 2300, epoch: 2 | loss: 0.5502885
	speed: 0.0202s/iter; left time: 492.9209s
	iters: 2400, epoch: 2 | loss: 0.5047188
	speed: 0.0188s/iter; left time: 456.6543s
	iters: 2500, epoch: 2 | loss: 0.6095248
	speed: 0.0198s/iter; left time: 479.2814s
	iters: 2600, epoch: 2 | loss: 0.6073312
	speed: 0.0200s/iter; left time: 481.3281s
	iters: 2700, epoch: 2 | loss: 0.5862189
	speed: 0.0206s/iter; left time: 494.7607s
	iters: 2800, epoch: 2 | loss: 0.4814736
	speed: 0.0202s/iter; left time: 482.4556s
	iters: 2900, epoch: 2 | loss: 0.5108646
	speed: 0.0203s/iter; left time: 483.5823s
Epoch: 2 cost time: 61.4035542011261
Epoch: 2, Steps: 2966 | Train Loss: 0.5300367 Vali Loss: 2.0287838 Test Loss: 2.6353588
Validation loss decreased (2.144524 --> 2.028784).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5673957
	speed: 0.7749s/iter; left time: 18309.5946s
	iters: 200, epoch: 3 | loss: 0.5582253
	speed: 0.0199s/iter; left time: 467.7559s
	iters: 300, epoch: 3 | loss: 0.4918081
	speed: 0.0199s/iter; left time: 466.6219s
	iters: 400, epoch: 3 | loss: 0.5642078
	speed: 0.0202s/iter; left time: 470.1299s
	iters: 500, epoch: 3 | loss: 0.4974777
	speed: 0.0199s/iter; left time: 461.3674s
	iters: 600, epoch: 3 | loss: 0.4389533
	speed: 0.0199s/iter; left time: 460.3468s
	iters: 700, epoch: 3 | loss: 0.5846316
	speed: 0.0197s/iter; left time: 453.6367s
	iters: 800, epoch: 3 | loss: 0.4421832
	speed: 0.0195s/iter; left time: 448.2120s
	iters: 900, epoch: 3 | loss: 0.5026534
	speed: 0.0196s/iter; left time: 447.7507s
	iters: 1000, epoch: 3 | loss: 0.4951033
	speed: 0.0195s/iter; left time: 443.3657s
	iters: 1100, epoch: 3 | loss: 0.4521734
	speed: 0.0195s/iter; left time: 442.3070s
	iters: 1200, epoch: 3 | loss: 0.4500622
	speed: 0.0196s/iter; left time: 440.9585s
	iters: 1300, epoch: 3 | loss: 0.4422622
	speed: 0.0196s/iter; left time: 439.0445s
	iters: 1400, epoch: 3 | loss: 0.5122008
	speed: 0.0195s/iter; left time: 436.4459s
	iters: 1500, epoch: 3 | loss: 0.5080456
	speed: 0.0207s/iter; left time: 460.8267s
	iters: 1600, epoch: 3 | loss: 0.4078721
	speed: 0.0201s/iter; left time: 445.1399s
	iters: 1700, epoch: 3 | loss: 0.5252390
	speed: 0.0195s/iter; left time: 428.7561s
	iters: 1800, epoch: 3 | loss: 0.4279713
	speed: 0.0202s/iter; left time: 442.4603s
	iters: 1900, epoch: 3 | loss: 0.4432760
	speed: 0.0212s/iter; left time: 462.7206s
	iters: 2000, epoch: 3 | loss: 0.5159634
	speed: 0.0214s/iter; left time: 465.7276s
	iters: 2100, epoch: 3 | loss: 0.4113247
	speed: 0.0211s/iter; left time: 456.1240s
	iters: 2200, epoch: 3 | loss: 0.4778875
	speed: 0.0205s/iter; left time: 440.4248s
	iters: 2300, epoch: 3 | loss: 0.4565277
	speed: 0.0201s/iter; left time: 431.3792s
	iters: 2400, epoch: 3 | loss: 0.3847597
	speed: 0.0207s/iter; left time: 442.2146s
	iters: 2500, epoch: 3 | loss: 0.4440148
	speed: 0.0206s/iter; left time: 437.7363s
	iters: 2600, epoch: 3 | loss: 0.5602420
	speed: 0.0211s/iter; left time: 446.2950s
	iters: 2700, epoch: 3 | loss: 0.4956903
	speed: 0.0216s/iter; left time: 453.4005s
	iters: 2800, epoch: 3 | loss: 0.6097092
	speed: 0.0206s/iter; left time: 430.9269s
	iters: 2900, epoch: 3 | loss: 0.5082016
	speed: 0.0202s/iter; left time: 420.0427s
Epoch: 3 cost time: 60.2746307849884
Epoch: 3, Steps: 2966 | Train Loss: 0.4836409 Vali Loss: 1.9687290 Test Loss: 2.5953004
Validation loss decreased (2.028784 --> 1.968729).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4367262
	speed: 0.7172s/iter; left time: 14818.6455s
	iters: 200, epoch: 4 | loss: 0.4214486
	speed: 0.0187s/iter; left time: 383.7364s
	iters: 300, epoch: 4 | loss: 0.3997799
	speed: 0.0196s/iter; left time: 400.3994s
	iters: 400, epoch: 4 | loss: 0.4969977
	speed: 0.0207s/iter; left time: 422.0374s
	iters: 500, epoch: 4 | loss: 0.4995800
	speed: 0.0194s/iter; left time: 393.2795s
	iters: 600, epoch: 4 | loss: 0.5549866
	speed: 0.0192s/iter; left time: 386.3642s
	iters: 700, epoch: 4 | loss: 0.4573708
	speed: 0.0204s/iter; left time: 408.5015s
	iters: 800, epoch: 4 | loss: 0.4263966
	speed: 0.0208s/iter; left time: 414.4822s
	iters: 900, epoch: 4 | loss: 0.4753919
	speed: 0.0216s/iter; left time: 428.5638s
	iters: 1000, epoch: 4 | loss: 0.5487846
	speed: 0.0206s/iter; left time: 406.7643s
	iters: 1100, epoch: 4 | loss: 0.4413713
	speed: 0.0196s/iter; left time: 386.2729s
	iters: 1200, epoch: 4 | loss: 0.4707089
	speed: 0.0213s/iter; left time: 416.3265s
	iters: 1300, epoch: 4 | loss: 0.4822523
	speed: 0.0206s/iter; left time: 401.7693s
	iters: 1400, epoch: 4 | loss: 0.4595152
	speed: 0.0203s/iter; left time: 392.1701s
	iters: 1500, epoch: 4 | loss: 0.4062400
	speed: 0.0215s/iter; left time: 414.2018s
	iters: 1600, epoch: 4 | loss: 0.4211933
	speed: 0.0207s/iter; left time: 396.0013s
	iters: 1700, epoch: 4 | loss: 0.4972405
	speed: 0.0214s/iter; left time: 407.6593s
	iters: 1800, epoch: 4 | loss: 0.5116916
	speed: 0.0213s/iter; left time: 404.1712s
	iters: 1900, epoch: 4 | loss: 0.4670635
	speed: 0.0213s/iter; left time: 401.9595s
	iters: 2000, epoch: 4 | loss: 0.6397351
	speed: 0.0217s/iter; left time: 407.8899s
	iters: 2100, epoch: 4 | loss: 0.4756316
	speed: 0.0204s/iter; left time: 379.9746s
	iters: 2200, epoch: 4 | loss: 0.3971966
	speed: 0.0201s/iter; left time: 372.4425s
	iters: 2300, epoch: 4 | loss: 0.6090635
	speed: 0.0193s/iter; left time: 356.7883s
	iters: 2400, epoch: 4 | loss: 0.4780485
	speed: 0.0207s/iter; left time: 381.0038s
	iters: 2500, epoch: 4 | loss: 0.4797785
	speed: 0.0198s/iter; left time: 360.9072s
	iters: 2600, epoch: 4 | loss: 0.4469694
	speed: 0.0203s/iter; left time: 368.6062s
	iters: 2700, epoch: 4 | loss: 0.4372287
	speed: 0.0205s/iter; left time: 371.1600s
	iters: 2800, epoch: 4 | loss: 0.4713916
	speed: 0.0214s/iter; left time: 383.7295s
	iters: 2900, epoch: 4 | loss: 0.4526170
	speed: 0.0209s/iter; left time: 374.1249s
Epoch: 4 cost time: 61.12723469734192
Epoch: 4, Steps: 2966 | Train Loss: 0.4668570 Vali Loss: 2.0121272 Test Loss: 2.5322111
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4965541
	speed: 0.8175s/iter; left time: 14466.5987s
	iters: 200, epoch: 5 | loss: 0.4174390
	speed: 0.0192s/iter; left time: 337.8042s
	iters: 300, epoch: 5 | loss: 0.5068810
	speed: 0.0192s/iter; left time: 336.3616s
	iters: 400, epoch: 5 | loss: 0.4686676
	speed: 0.0193s/iter; left time: 336.2245s
	iters: 500, epoch: 5 | loss: 0.6005641
	speed: 0.0192s/iter; left time: 332.9611s
	iters: 600, epoch: 5 | loss: 0.4580492
	speed: 0.0191s/iter; left time: 328.4760s
	iters: 700, epoch: 5 | loss: 0.4130343
	speed: 0.0191s/iter; left time: 326.0217s
	iters: 800, epoch: 5 | loss: 0.3837244
	speed: 0.0191s/iter; left time: 324.1682s
	iters: 900, epoch: 5 | loss: 0.5232573
	speed: 0.0191s/iter; left time: 322.7964s
	iters: 1000, epoch: 5 | loss: 0.4513208
	speed: 0.0191s/iter; left time: 320.7030s
	iters: 1100, epoch: 5 | loss: 0.5236518
	speed: 0.0192s/iter; left time: 321.1791s
	iters: 1200, epoch: 5 | loss: 0.4317741
	speed: 0.0191s/iter; left time: 317.2441s
	iters: 1300, epoch: 5 | loss: 0.5369480
	speed: 0.0191s/iter; left time: 315.3484s
	iters: 1400, epoch: 5 | loss: 0.4669935
	speed: 0.0192s/iter; left time: 315.1755s
	iters: 1500, epoch: 5 | loss: 0.4655121
	speed: 0.0191s/iter; left time: 311.9871s
	iters: 1600, epoch: 5 | loss: 0.4193164
	speed: 0.0191s/iter; left time: 309.1247s
	iters: 1700, epoch: 5 | loss: 0.3968338
	speed: 0.0192s/iter; left time: 309.1382s
	iters: 1800, epoch: 5 | loss: 0.3773803
	speed: 0.0211s/iter; left time: 338.1249s
	iters: 1900, epoch: 5 | loss: 0.4333977
	speed: 0.0211s/iter; left time: 335.3778s
	iters: 2000, epoch: 5 | loss: 0.4433733
	speed: 0.0206s/iter; left time: 325.1958s
	iters: 2100, epoch: 5 | loss: 0.4631338
	speed: 0.0203s/iter; left time: 319.0562s
	iters: 2200, epoch: 5 | loss: 0.4263547
	speed: 0.0210s/iter; left time: 327.0772s
	iters: 2300, epoch: 5 | loss: 0.5011007
	speed: 0.0212s/iter; left time: 328.4992s
	iters: 2400, epoch: 5 | loss: 0.4427744
	speed: 0.0210s/iter; left time: 323.8740s
	iters: 2500, epoch: 5 | loss: 0.5937663
	speed: 0.0210s/iter; left time: 321.7047s
	iters: 2600, epoch: 5 | loss: 0.5183132
	speed: 0.0210s/iter; left time: 319.8873s
	iters: 2700, epoch: 5 | loss: 0.4147145
	speed: 0.0205s/iter; left time: 309.4389s
	iters: 2800, epoch: 5 | loss: 0.4691968
	speed: 0.0204s/iter; left time: 305.9237s
	iters: 2900, epoch: 5 | loss: 0.5236539
	speed: 0.0212s/iter; left time: 315.1110s
Epoch: 5 cost time: 59.43834733963013
Epoch: 5, Steps: 2966 | Train Loss: 0.4592552 Vali Loss: 1.9921980 Test Loss: 2.5443511
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3933506
	speed: 1.1433s/iter; left time: 16842.4499s
	iters: 200, epoch: 6 | loss: 0.4051457
	speed: 0.0176s/iter; left time: 257.9964s
	iters: 300, epoch: 6 | loss: 0.3804717
	speed: 0.0177s/iter; left time: 256.9684s
	iters: 400, epoch: 6 | loss: 0.4547668
	speed: 0.0176s/iter; left time: 254.4103s
	iters: 500, epoch: 6 | loss: 0.3825498
	speed: 0.0177s/iter; left time: 253.1784s
	iters: 600, epoch: 6 | loss: 0.4256166
	speed: 0.0178s/iter; left time: 252.7953s
	iters: 700, epoch: 6 | loss: 0.5183658
	speed: 0.0177s/iter; left time: 249.5416s
	iters: 800, epoch: 6 | loss: 0.4170045
	speed: 0.0178s/iter; left time: 249.1820s
	iters: 900, epoch: 6 | loss: 0.5057737
	speed: 0.0176s/iter; left time: 245.7709s
	iters: 1000, epoch: 6 | loss: 0.3725375
	speed: 0.0177s/iter; left time: 245.1963s
	iters: 1100, epoch: 6 | loss: 0.4866557
	speed: 0.0176s/iter; left time: 241.7962s
	iters: 1200, epoch: 6 | loss: 0.4708506
	speed: 0.0176s/iter; left time: 240.4380s
	iters: 1300, epoch: 6 | loss: 0.4671094
	speed: 0.0176s/iter; left time: 238.0802s
	iters: 1400, epoch: 6 | loss: 0.4605708
	speed: 0.0176s/iter; left time: 236.8626s
	iters: 1500, epoch: 6 | loss: 0.4586195
	speed: 0.0177s/iter; left time: 235.7475s
	iters: 1600, epoch: 6 | loss: 0.4353681
	speed: 0.0177s/iter; left time: 233.6809s
	iters: 1700, epoch: 6 | loss: 0.4937594
	speed: 0.0176s/iter; left time: 231.1434s
	iters: 1800, epoch: 6 | loss: 0.4872692
	speed: 0.0177s/iter; left time: 230.4540s
	iters: 1900, epoch: 6 | loss: 0.4043797
	speed: 0.0176s/iter; left time: 227.3132s
	iters: 2000, epoch: 6 | loss: 0.5300648
	speed: 0.0176s/iter; left time: 225.5094s
	iters: 2100, epoch: 6 | loss: 0.4184028
	speed: 0.0176s/iter; left time: 223.9049s
	iters: 2200, epoch: 6 | loss: 0.4588025
	speed: 0.0177s/iter; left time: 223.0896s
	iters: 2300, epoch: 6 | loss: 0.4650728
	speed: 0.0176s/iter; left time: 220.6799s
	iters: 2400, epoch: 6 | loss: 0.4890901
	speed: 0.0176s/iter; left time: 218.5060s
	iters: 2500, epoch: 6 | loss: 0.5081956
	speed: 0.0177s/iter; left time: 218.2211s
	iters: 2600, epoch: 6 | loss: 0.4892839
	speed: 0.0206s/iter; left time: 251.8736s
	iters: 2700, epoch: 6 | loss: 0.4442403
	speed: 0.0184s/iter; left time: 223.7028s
	iters: 2800, epoch: 6 | loss: 0.4257554
	speed: 0.0176s/iter; left time: 212.0780s
	iters: 2900, epoch: 6 | loss: 0.3878165
	speed: 0.0177s/iter; left time: 210.7079s
Epoch: 6 cost time: 53.221872329711914
Epoch: 6, Steps: 2966 | Train Loss: 0.4556158 Vali Loss: 1.9635320 Test Loss: 2.5835340
Validation loss decreased (1.968729 --> 1.963532).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4158425
	speed: 0.6968s/iter; left time: 8198.0012s
	iters: 200, epoch: 7 | loss: 0.4452384
	speed: 0.0176s/iter; left time: 205.2503s
	iters: 300, epoch: 7 | loss: 0.5428266
	speed: 0.0176s/iter; left time: 203.2035s
	iters: 400, epoch: 7 | loss: 0.4472742
	speed: 0.0176s/iter; left time: 201.6222s
	iters: 500, epoch: 7 | loss: 0.4961187
	speed: 0.0176s/iter; left time: 200.4745s
	iters: 600, epoch: 7 | loss: 0.4191270
	speed: 0.0177s/iter; left time: 199.1693s
	iters: 700, epoch: 7 | loss: 0.5110936
	speed: 0.0176s/iter; left time: 195.9737s
	iters: 800, epoch: 7 | loss: 0.4581623
	speed: 0.0176s/iter; left time: 194.6606s
	iters: 900, epoch: 7 | loss: 0.5007063
	speed: 0.0177s/iter; left time: 193.9002s
	iters: 1000, epoch: 7 | loss: 0.4277651
	speed: 0.0176s/iter; left time: 190.6905s
	iters: 1100, epoch: 7 | loss: 0.5286942
	speed: 0.0177s/iter; left time: 191.0387s
	iters: 1200, epoch: 7 | loss: 0.4510821
	speed: 0.0176s/iter; left time: 187.6294s
	iters: 1300, epoch: 7 | loss: 0.4785076
	speed: 0.0176s/iter; left time: 185.6606s
	iters: 1400, epoch: 7 | loss: 0.4183967
	speed: 0.0177s/iter; left time: 184.9127s
	iters: 1500, epoch: 7 | loss: 0.4294576
	speed: 0.0176s/iter; left time: 182.5353s
	iters: 1600, epoch: 7 | loss: 0.4208809
	speed: 0.0176s/iter; left time: 180.6040s
	iters: 1700, epoch: 7 | loss: 0.4965344
	speed: 0.0177s/iter; left time: 179.5434s
	iters: 1800, epoch: 7 | loss: 0.3886934
	speed: 0.0176s/iter; left time: 177.1909s
	iters: 1900, epoch: 7 | loss: 0.5283179
	speed: 0.0176s/iter; left time: 175.3489s
	iters: 2000, epoch: 7 | loss: 0.5467999
	speed: 0.0176s/iter; left time: 173.3369s
	iters: 2100, epoch: 7 | loss: 0.4708124
	speed: 0.0176s/iter; left time: 171.7867s
	iters: 2200, epoch: 7 | loss: 0.4128063
	speed: 0.0177s/iter; left time: 170.8950s
	iters: 2300, epoch: 7 | loss: 0.4104577
	speed: 0.0176s/iter; left time: 168.6652s
	iters: 2400, epoch: 7 | loss: 0.4373714
	speed: 0.0176s/iter; left time: 166.9031s
	iters: 2500, epoch: 7 | loss: 0.4462149
	speed: 0.0178s/iter; left time: 166.5972s
	iters: 2600, epoch: 7 | loss: 0.3791865
	speed: 0.0177s/iter; left time: 163.5569s
	iters: 2700, epoch: 7 | loss: 0.4236282
	speed: 0.0177s/iter; left time: 161.8870s
	iters: 2800, epoch: 7 | loss: 0.4274858
	speed: 0.0176s/iter; left time: 159.5009s
	iters: 2900, epoch: 7 | loss: 0.3911692
	speed: 0.0176s/iter; left time: 157.7879s
Epoch: 7 cost time: 52.65559792518616
Epoch: 7, Steps: 2966 | Train Loss: 0.4537553 Vali Loss: 1.9809939 Test Loss: 2.5900099
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4359622
	speed: 0.6854s/iter; left time: 6030.8392s
	iters: 200, epoch: 8 | loss: 0.5194567
	speed: 0.0176s/iter; left time: 153.4501s
	iters: 300, epoch: 8 | loss: 0.4015224
	speed: 0.0177s/iter; left time: 152.1948s
	iters: 400, epoch: 8 | loss: 0.4476723
	speed: 0.0176s/iter; left time: 149.7950s
	iters: 500, epoch: 8 | loss: 0.3525767
	speed: 0.0177s/iter; left time: 148.4401s
	iters: 600, epoch: 8 | loss: 0.5201186
	speed: 0.0177s/iter; left time: 146.6535s
	iters: 700, epoch: 8 | loss: 0.4307298
	speed: 0.0177s/iter; left time: 145.3659s
	iters: 800, epoch: 8 | loss: 0.4762788
	speed: 0.0176s/iter; left time: 142.9322s
	iters: 900, epoch: 8 | loss: 0.4068783
	speed: 0.0196s/iter; left time: 156.6342s
	iters: 1000, epoch: 8 | loss: 0.4169635
	speed: 0.0176s/iter; left time: 138.8814s
	iters: 1100, epoch: 8 | loss: 0.4667308
	speed: 0.0177s/iter; left time: 138.1455s
	iters: 1200, epoch: 8 | loss: 0.4094104
	speed: 0.0177s/iter; left time: 136.5737s
	iters: 1300, epoch: 8 | loss: 0.3928907
	speed: 0.0177s/iter; left time: 134.8568s
	iters: 1400, epoch: 8 | loss: 0.4065437
	speed: 0.0178s/iter; left time: 133.5170s
	iters: 1500, epoch: 8 | loss: 0.5127253
	speed: 0.0178s/iter; left time: 131.9415s
	iters: 1600, epoch: 8 | loss: 0.4494601
	speed: 0.0179s/iter; left time: 130.5835s
	iters: 1700, epoch: 8 | loss: 0.4938325
	speed: 0.0178s/iter; left time: 127.9119s
	iters: 1800, epoch: 8 | loss: 0.4597118
	speed: 0.0178s/iter; left time: 126.1127s
	iters: 1900, epoch: 8 | loss: 0.4932109
	speed: 0.0178s/iter; left time: 124.6990s
	iters: 2000, epoch: 8 | loss: 0.4615307
	speed: 0.0178s/iter; left time: 122.7656s
	iters: 2100, epoch: 8 | loss: 0.4065129
	speed: 0.0177s/iter; left time: 120.3327s
	iters: 2200, epoch: 8 | loss: 0.4443615
	speed: 0.0178s/iter; left time: 119.1431s
	iters: 2300, epoch: 8 | loss: 0.4756833
	speed: 0.0177s/iter; left time: 116.8443s
	iters: 2400, epoch: 8 | loss: 0.4425312
	speed: 0.0178s/iter; left time: 115.4502s
	iters: 2500, epoch: 8 | loss: 0.4666988
	speed: 0.0177s/iter; left time: 113.4361s
	iters: 2600, epoch: 8 | loss: 0.4641982
	speed: 0.0177s/iter; left time: 111.3845s
	iters: 2700, epoch: 8 | loss: 0.5345448
	speed: 0.0178s/iter; left time: 110.0371s
	iters: 2800, epoch: 8 | loss: 0.4453852
	speed: 0.0176s/iter; left time: 107.5412s
	iters: 2900, epoch: 8 | loss: 0.5498771
	speed: 0.0177s/iter; left time: 105.9042s
Epoch: 8 cost time: 53.12141466140747
Epoch: 8, Steps: 2966 | Train Loss: 0.4528597 Vali Loss: 1.9741188 Test Loss: 2.5705333
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5513470
	speed: 0.6873s/iter; left time: 4008.8433s
	iters: 200, epoch: 9 | loss: 0.4065214
	speed: 0.0175s/iter; left time: 100.5199s
	iters: 300, epoch: 9 | loss: 0.4731686
	speed: 0.0175s/iter; left time: 98.6879s
	iters: 400, epoch: 9 | loss: 0.4032220
	speed: 0.0175s/iter; left time: 96.8171s
	iters: 500, epoch: 9 | loss: 0.4409572
	speed: 0.0175s/iter; left time: 95.0949s
	iters: 600, epoch: 9 | loss: 0.4266061
	speed: 0.0175s/iter; left time: 93.5431s
	iters: 700, epoch: 9 | loss: 0.4208766
	speed: 0.0175s/iter; left time: 91.4629s
	iters: 800, epoch: 9 | loss: 0.3856604
	speed: 0.0175s/iter; left time: 89.8772s
	iters: 900, epoch: 9 | loss: 0.5317206
	speed: 0.0175s/iter; left time: 87.9375s
	iters: 1000, epoch: 9 | loss: 0.3718732
	speed: 0.0175s/iter; left time: 86.2333s
	iters: 1100, epoch: 9 | loss: 0.4727277
	speed: 0.0175s/iter; left time: 84.5015s
	iters: 1200, epoch: 9 | loss: 0.4682741
	speed: 0.0175s/iter; left time: 82.7878s
	iters: 1300, epoch: 9 | loss: 0.4467130
	speed: 0.0176s/iter; left time: 81.3098s
	iters: 1400, epoch: 9 | loss: 0.4777623
	speed: 0.0176s/iter; left time: 79.7831s
	iters: 1500, epoch: 9 | loss: 0.4427656
	speed: 0.0176s/iter; left time: 78.2188s
	iters: 1600, epoch: 9 | loss: 0.3990634
	speed: 0.0175s/iter; left time: 75.8319s
	iters: 1700, epoch: 9 | loss: 0.4408057
	speed: 0.0175s/iter; left time: 74.0393s
	iters: 1800, epoch: 9 | loss: 0.4427485
	speed: 0.0175s/iter; left time: 72.2327s
	iters: 1900, epoch: 9 | loss: 0.5573003
	speed: 0.0175s/iter; left time: 70.5531s
	iters: 2000, epoch: 9 | loss: 0.3693976
	speed: 0.0175s/iter; left time: 68.7364s
	iters: 2100, epoch: 9 | loss: 0.4772716
	speed: 0.0175s/iter; left time: 67.2354s
	iters: 2200, epoch: 9 | loss: 0.3694663
	speed: 0.0175s/iter; left time: 65.2335s
	iters: 2300, epoch: 9 | loss: 0.4330387
	speed: 0.0175s/iter; left time: 63.4303s
	iters: 2400, epoch: 9 | loss: 0.4639996
	speed: 0.0176s/iter; left time: 62.0462s
	iters: 2500, epoch: 9 | loss: 0.4014033
	speed: 0.0175s/iter; left time: 60.1023s
	iters: 2600, epoch: 9 | loss: 0.5540844
	speed: 0.0176s/iter; left time: 58.5768s
	iters: 2700, epoch: 9 | loss: 0.3813019
	speed: 0.0175s/iter; left time: 56.6434s
	iters: 2800, epoch: 9 | loss: 0.4292535
	speed: 0.0175s/iter; left time: 54.9185s
	iters: 2900, epoch: 9 | loss: 0.5084196
	speed: 0.0175s/iter; left time: 53.0625s
Epoch: 9 cost time: 52.30754494667053
Epoch: 9, Steps: 2966 | Train Loss: 0.4523987 Vali Loss: 1.9868159 Test Loss: 2.5832357
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems10_all_96_336_Mamba_custom_ftM_sl336_ll48_pl336_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 246205
test shape: (24620, 1, 336, 107) (24620, 1, 336, 107)
test shape: (24620, 336, 107) (24620, 336, 107)
mse:2.583538055419922, mae:1.3269580602645874
>>>>>>>Overall time: 1326 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
