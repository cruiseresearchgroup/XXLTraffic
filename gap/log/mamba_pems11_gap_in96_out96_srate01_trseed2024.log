Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=521, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems11_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=521, expand=2, factor=1, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems11_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems11_all_96_96_Mamba_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1253800
val 347822
test 347822
	iters: 100, epoch: 1 | loss: 1.5096681
	speed: 0.0572s/iter; left time: 2235.7944s
	iters: 200, epoch: 1 | loss: 1.1114100
	speed: 0.0337s/iter; left time: 1313.9765s
	iters: 300, epoch: 1 | loss: 0.8755173
	speed: 0.0335s/iter; left time: 1303.1249s
	iters: 400, epoch: 1 | loss: 1.0837318
	speed: 0.0330s/iter; left time: 1280.1223s
	iters: 500, epoch: 1 | loss: 0.8102756
	speed: 0.0331s/iter; left time: 1280.1754s
	iters: 600, epoch: 1 | loss: 1.0216290
	speed: 0.0330s/iter; left time: 1273.5714s
	iters: 700, epoch: 1 | loss: 0.8187394
	speed: 0.0347s/iter; left time: 1333.8306s
	iters: 800, epoch: 1 | loss: 0.7590603
	speed: 0.0338s/iter; left time: 1295.8347s
	iters: 900, epoch: 1 | loss: 0.8519139
	speed: 0.0337s/iter; left time: 1290.2053s
	iters: 1000, epoch: 1 | loss: 0.7542488
	speed: 0.0336s/iter; left time: 1282.2078s
	iters: 1100, epoch: 1 | loss: 0.6606209
	speed: 0.0334s/iter; left time: 1272.1698s
	iters: 1200, epoch: 1 | loss: 0.8826525
	speed: 0.0340s/iter; left time: 1290.6469s
	iters: 1300, epoch: 1 | loss: 0.6184798
	speed: 0.0335s/iter; left time: 1270.4137s
	iters: 1400, epoch: 1 | loss: 0.5829306
	speed: 0.0339s/iter; left time: 1281.6518s
	iters: 1500, epoch: 1 | loss: 0.7137609
	speed: 0.0331s/iter; left time: 1248.5754s
	iters: 1600, epoch: 1 | loss: 0.6332660
	speed: 0.0335s/iter; left time: 1257.1060s
	iters: 1700, epoch: 1 | loss: 0.5178663
	speed: 0.0333s/iter; left time: 1248.7742s
	iters: 1800, epoch: 1 | loss: 0.6963782
	speed: 0.0333s/iter; left time: 1245.7846s
	iters: 1900, epoch: 1 | loss: 0.5198410
	speed: 0.0331s/iter; left time: 1234.9914s
	iters: 2000, epoch: 1 | loss: 0.7531537
	speed: 0.0331s/iter; left time: 1230.3639s
	iters: 2100, epoch: 1 | loss: 0.7749398
	speed: 0.0329s/iter; left time: 1219.0652s
	iters: 2200, epoch: 1 | loss: 0.6246282
	speed: 0.0332s/iter; left time: 1227.9207s
	iters: 2300, epoch: 1 | loss: 0.6637099
	speed: 0.0332s/iter; left time: 1224.9823s
	iters: 2400, epoch: 1 | loss: 0.6018764
	speed: 0.0334s/iter; left time: 1226.8563s
	iters: 2500, epoch: 1 | loss: 0.6009651
	speed: 0.0353s/iter; left time: 1295.7175s
	iters: 2600, epoch: 1 | loss: 0.6727048
	speed: 0.0400s/iter; left time: 1464.5434s
	iters: 2700, epoch: 1 | loss: 0.7159537
	speed: 0.0389s/iter; left time: 1420.4324s
	iters: 2800, epoch: 1 | loss: 0.8056784
	speed: 0.0392s/iter; left time: 1425.7501s
	iters: 2900, epoch: 1 | loss: 0.5668424
	speed: 0.0387s/iter; left time: 1402.6949s
	iters: 3000, epoch: 1 | loss: 0.6300867
	speed: 0.0388s/iter; left time: 1405.4162s
	iters: 3100, epoch: 1 | loss: 0.7488012
	speed: 0.0390s/iter; left time: 1405.5974s
	iters: 3200, epoch: 1 | loss: 0.5920697
	speed: 0.0392s/iter; left time: 1410.4375s
	iters: 3300, epoch: 1 | loss: 0.6497478
	speed: 0.0389s/iter; left time: 1397.3057s
	iters: 3400, epoch: 1 | loss: 0.5080994
	speed: 0.0386s/iter; left time: 1380.6896s
	iters: 3500, epoch: 1 | loss: 0.5248324
	speed: 0.0387s/iter; left time: 1381.2347s
	iters: 3600, epoch: 1 | loss: 0.7385417
	speed: 0.0394s/iter; left time: 1402.1832s
	iters: 3700, epoch: 1 | loss: 0.5061387
	speed: 0.0367s/iter; left time: 1303.1843s
	iters: 3800, epoch: 1 | loss: 0.6889884
	speed: 0.0351s/iter; left time: 1243.3674s
	iters: 3900, epoch: 1 | loss: 0.6190136
	speed: 0.0343s/iter; left time: 1211.6321s
Epoch: 1 cost time: 140.57960033416748
Epoch: 1, Steps: 3918 | Train Loss: 0.7519930 Vali Loss: 1.2676053 Test Loss: 5.2459097
Validation loss decreased (inf --> 1.267605).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6145170
	speed: 1.6730s/iter; left time: 58827.1025s
	iters: 200, epoch: 2 | loss: 0.5158020
	speed: 0.0336s/iter; left time: 1179.3057s
	iters: 300, epoch: 2 | loss: 0.5838913
	speed: 0.0336s/iter; left time: 1173.2220s
	iters: 400, epoch: 2 | loss: 0.6392194
	speed: 0.0334s/iter; left time: 1165.1236s
	iters: 500, epoch: 2 | loss: 0.5955632
	speed: 0.0335s/iter; left time: 1163.9104s
	iters: 600, epoch: 2 | loss: 0.7451230
	speed: 0.0333s/iter; left time: 1154.7895s
	iters: 700, epoch: 2 | loss: 0.5407831
	speed: 0.0334s/iter; left time: 1152.7089s
	iters: 800, epoch: 2 | loss: 0.5260078
	speed: 0.0335s/iter; left time: 1153.0497s
	iters: 900, epoch: 2 | loss: 0.5478884
	speed: 0.0334s/iter; left time: 1149.2452s
	iters: 1000, epoch: 2 | loss: 0.7548587
	speed: 0.0331s/iter; left time: 1135.3813s
	iters: 1100, epoch: 2 | loss: 0.5481114
	speed: 0.0337s/iter; left time: 1150.8295s
	iters: 1200, epoch: 2 | loss: 0.6993195
	speed: 0.0340s/iter; left time: 1157.6521s
	iters: 1300, epoch: 2 | loss: 0.6046975
	speed: 0.0334s/iter; left time: 1133.3055s
	iters: 1400, epoch: 2 | loss: 0.5467053
	speed: 0.0333s/iter; left time: 1125.9960s
	iters: 1500, epoch: 2 | loss: 0.5880668
	speed: 0.0333s/iter; left time: 1123.9022s
	iters: 1600, epoch: 2 | loss: 0.6008635
	speed: 0.0328s/iter; left time: 1104.5122s
	iters: 1700, epoch: 2 | loss: 0.6889293
	speed: 0.0338s/iter; left time: 1135.7741s
	iters: 1800, epoch: 2 | loss: 0.5287532
	speed: 0.0339s/iter; left time: 1133.6609s
	iters: 1900, epoch: 2 | loss: 0.5184528
	speed: 0.0329s/iter; left time: 1099.2918s
	iters: 2000, epoch: 2 | loss: 0.5104035
	speed: 0.0327s/iter; left time: 1088.1716s
	iters: 2100, epoch: 2 | loss: 0.5259544
	speed: 0.0328s/iter; left time: 1086.3544s
	iters: 2200, epoch: 2 | loss: 0.5855240
	speed: 0.0324s/iter; left time: 1070.5545s
	iters: 2300, epoch: 2 | loss: 0.7017140
	speed: 0.0323s/iter; left time: 1063.2981s
	iters: 2400, epoch: 2 | loss: 0.4683203
	speed: 0.0327s/iter; left time: 1074.4650s
	iters: 2500, epoch: 2 | loss: 0.7059281
	speed: 0.0326s/iter; left time: 1069.0145s
	iters: 2600, epoch: 2 | loss: 0.5319883
	speed: 0.0325s/iter; left time: 1061.9351s
	iters: 2700, epoch: 2 | loss: 0.6874899
	speed: 0.0326s/iter; left time: 1060.0667s
	iters: 2800, epoch: 2 | loss: 0.6025407
	speed: 0.0325s/iter; left time: 1054.0002s
	iters: 2900, epoch: 2 | loss: 0.6482273
	speed: 0.0330s/iter; left time: 1068.7457s
	iters: 3000, epoch: 2 | loss: 0.5574372
	speed: 0.0326s/iter; left time: 1051.0562s
	iters: 3100, epoch: 2 | loss: 0.5388261
	speed: 0.0323s/iter; left time: 1039.8556s
	iters: 3200, epoch: 2 | loss: 0.5339324
	speed: 0.0345s/iter; left time: 1105.9206s
	iters: 3300, epoch: 2 | loss: 0.6341962
	speed: 0.0381s/iter; left time: 1217.9891s
	iters: 3400, epoch: 2 | loss: 0.6270679
	speed: 0.0384s/iter; left time: 1222.5887s
	iters: 3500, epoch: 2 | loss: 0.5958612
	speed: 0.0361s/iter; left time: 1146.5928s
	iters: 3600, epoch: 2 | loss: 0.5651799
	speed: 0.0349s/iter; left time: 1105.3015s
	iters: 3700, epoch: 2 | loss: 0.5239275
	speed: 0.0334s/iter; left time: 1052.7786s
	iters: 3800, epoch: 2 | loss: 0.5435896
	speed: 0.0339s/iter; left time: 1067.4320s
	iters: 3900, epoch: 2 | loss: 0.6587777
	speed: 0.0344s/iter; left time: 1079.1044s
Epoch: 2 cost time: 132.42639660835266
Epoch: 2, Steps: 3918 | Train Loss: 0.5765926 Vali Loss: 1.2382567 Test Loss: 5.2448859
Validation loss decreased (1.267605 --> 1.238257).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7029450
	speed: 1.6349s/iter; left time: 51082.8373s
	iters: 200, epoch: 3 | loss: 0.6320898
	speed: 0.0341s/iter; left time: 1061.1367s
	iters: 300, epoch: 3 | loss: 0.4182599
	speed: 0.0342s/iter; left time: 1062.7844s
	iters: 400, epoch: 3 | loss: 0.4889143
	speed: 0.0343s/iter; left time: 1060.4076s
	iters: 500, epoch: 3 | loss: 0.4498545
	speed: 0.0336s/iter; left time: 1037.6091s
	iters: 600, epoch: 3 | loss: 0.3974956
	speed: 0.0333s/iter; left time: 1023.4901s
	iters: 700, epoch: 3 | loss: 0.6731628
	speed: 0.0332s/iter; left time: 1017.0292s
	iters: 800, epoch: 3 | loss: 0.5732535
	speed: 0.0334s/iter; left time: 1020.5517s
	iters: 900, epoch: 3 | loss: 0.5873243
	speed: 0.0335s/iter; left time: 1020.9564s
	iters: 1000, epoch: 3 | loss: 0.5386195
	speed: 0.0336s/iter; left time: 1019.9945s
	iters: 1100, epoch: 3 | loss: 0.6482670
	speed: 0.0336s/iter; left time: 1017.4872s
	iters: 1200, epoch: 3 | loss: 0.5171088
	speed: 0.0337s/iter; left time: 1014.8462s
	iters: 1300, epoch: 3 | loss: 0.4629478
	speed: 0.0344s/iter; left time: 1033.6905s
	iters: 1400, epoch: 3 | loss: 0.5711464
	speed: 0.0345s/iter; left time: 1034.3683s
	iters: 1500, epoch: 3 | loss: 0.5549242
	speed: 0.0340s/iter; left time: 1013.4716s
	iters: 1600, epoch: 3 | loss: 0.4771046
	speed: 0.0340s/iter; left time: 1012.5402s
	iters: 1700, epoch: 3 | loss: 0.4481981
	speed: 0.0338s/iter; left time: 1001.0156s
	iters: 1800, epoch: 3 | loss: 0.4404318
	speed: 0.0335s/iter; left time: 989.5111s
	iters: 1900, epoch: 3 | loss: 0.4272818
	speed: 0.0334s/iter; left time: 984.8264s
	iters: 2000, epoch: 3 | loss: 0.5688630
	speed: 0.0335s/iter; left time: 983.9521s
	iters: 2100, epoch: 3 | loss: 0.5136519
	speed: 0.0335s/iter; left time: 979.0118s
	iters: 2200, epoch: 3 | loss: 0.4882742
	speed: 0.0376s/iter; left time: 1095.5730s
	iters: 2300, epoch: 3 | loss: 0.3969483
	speed: 0.0356s/iter; left time: 1032.9191s
	iters: 2400, epoch: 3 | loss: 0.5231045
	speed: 0.0393s/iter; left time: 1137.1494s
	iters: 2500, epoch: 3 | loss: 0.5971547
	speed: 0.0392s/iter; left time: 1131.4695s
	iters: 2600, epoch: 3 | loss: 0.5560638
	speed: 0.0379s/iter; left time: 1088.9564s
	iters: 2700, epoch: 3 | loss: 0.7542651
	speed: 0.0366s/iter; left time: 1047.6731s
	iters: 2800, epoch: 3 | loss: 0.5680146
	speed: 0.0351s/iter; left time: 1002.6129s
	iters: 2900, epoch: 3 | loss: 0.5187668
	speed: 0.0386s/iter; left time: 1097.6764s
	iters: 3000, epoch: 3 | loss: 0.6287619
	speed: 0.0394s/iter; left time: 1118.1537s
	iters: 3100, epoch: 3 | loss: 0.4104176
	speed: 0.0391s/iter; left time: 1104.4642s
	iters: 3200, epoch: 3 | loss: 0.5012794
	speed: 0.0394s/iter; left time: 1107.8557s
	iters: 3300, epoch: 3 | loss: 0.5894332
	speed: 0.0406s/iter; left time: 1137.3659s
	iters: 3400, epoch: 3 | loss: 0.6301743
	speed: 0.0395s/iter; left time: 1103.0848s
	iters: 3500, epoch: 3 | loss: 0.5747748
	speed: 0.0375s/iter; left time: 1043.7715s
	iters: 3600, epoch: 3 | loss: 0.4993373
	speed: 0.0370s/iter; left time: 1027.4088s
	iters: 3700, epoch: 3 | loss: 0.4571965
	speed: 0.0377s/iter; left time: 1042.4086s
	iters: 3800, epoch: 3 | loss: 0.4021939
	speed: 0.0387s/iter; left time: 1066.1402s
	iters: 3900, epoch: 3 | loss: 0.5259705
	speed: 0.0366s/iter; left time: 1004.0198s
Epoch: 3 cost time: 140.95879292488098
Epoch: 3, Steps: 3918 | Train Loss: 0.5395256 Vali Loss: 1.2169349 Test Loss: 5.1994157
Validation loss decreased (1.238257 --> 1.216935).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6194703
	speed: 1.6236s/iter; left time: 44367.0721s
	iters: 200, epoch: 4 | loss: 0.4600751
	speed: 0.0383s/iter; left time: 1044.1006s
	iters: 300, epoch: 4 | loss: 0.4724769
	speed: 0.0377s/iter; left time: 1022.0171s
	iters: 400, epoch: 4 | loss: 0.4681688
	speed: 0.0374s/iter; left time: 1011.8641s
	iters: 500, epoch: 4 | loss: 0.6454381
	speed: 0.0359s/iter; left time: 966.8585s
	iters: 600, epoch: 4 | loss: 0.5460522
	speed: 0.0380s/iter; left time: 1020.2380s
	iters: 700, epoch: 4 | loss: 0.4255074
	speed: 0.0368s/iter; left time: 983.3270s
	iters: 800, epoch: 4 | loss: 0.6191738
	speed: 0.0358s/iter; left time: 952.0639s
	iters: 900, epoch: 4 | loss: 0.4879295
	speed: 0.0361s/iter; left time: 958.0437s
	iters: 1000, epoch: 4 | loss: 0.4316958
	speed: 0.0363s/iter; left time: 960.2568s
	iters: 1100, epoch: 4 | loss: 0.4596356
	speed: 0.0351s/iter; left time: 925.1809s
	iters: 1200, epoch: 4 | loss: 0.5817921
	speed: 0.0353s/iter; left time: 925.9984s
	iters: 1300, epoch: 4 | loss: 0.5903574
	speed: 0.0356s/iter; left time: 929.9515s
	iters: 1400, epoch: 4 | loss: 0.4937443
	speed: 0.0358s/iter; left time: 931.8871s
	iters: 1500, epoch: 4 | loss: 0.5033194
	speed: 0.0353s/iter; left time: 915.0645s
	iters: 1600, epoch: 4 | loss: 0.4966275
	speed: 0.0354s/iter; left time: 913.6827s
	iters: 1700, epoch: 4 | loss: 0.6423857
	speed: 0.0353s/iter; left time: 908.8318s
	iters: 1800, epoch: 4 | loss: 0.5348791
	speed: 0.0363s/iter; left time: 929.5786s
	iters: 1900, epoch: 4 | loss: 0.6047155
	speed: 0.0356s/iter; left time: 908.9738s
	iters: 2000, epoch: 4 | loss: 0.5103787
	speed: 0.0354s/iter; left time: 900.0025s
	iters: 2100, epoch: 4 | loss: 0.6276673
	speed: 0.0365s/iter; left time: 923.6369s
	iters: 2200, epoch: 4 | loss: 0.6136232
	speed: 0.0373s/iter; left time: 940.9737s
	iters: 2300, epoch: 4 | loss: 0.6074497
	speed: 0.0376s/iter; left time: 945.1603s
	iters: 2400, epoch: 4 | loss: 0.3928010
	speed: 0.0390s/iter; left time: 975.5389s
	iters: 2500, epoch: 4 | loss: 0.5341158
	speed: 0.0373s/iter; left time: 929.9418s
	iters: 2600, epoch: 4 | loss: 0.4227647
	speed: 0.0403s/iter; left time: 1001.0876s
	iters: 2700, epoch: 4 | loss: 0.4950528
	speed: 0.0377s/iter; left time: 932.5303s
	iters: 2800, epoch: 4 | loss: 0.5254495
	speed: 0.0373s/iter; left time: 918.2203s
	iters: 2900, epoch: 4 | loss: 0.5174952
	speed: 0.0360s/iter; left time: 883.9159s
	iters: 3000, epoch: 4 | loss: 0.4873779
	speed: 0.0358s/iter; left time: 875.4208s
	iters: 3100, epoch: 4 | loss: 0.4320360
	speed: 0.0365s/iter; left time: 888.6653s
	iters: 3200, epoch: 4 | loss: 0.6845064
	speed: 0.0353s/iter; left time: 855.7510s
	iters: 3300, epoch: 4 | loss: 0.4450674
	speed: 0.0352s/iter; left time: 850.1247s
	iters: 3400, epoch: 4 | loss: 0.5250435
	speed: 0.0354s/iter; left time: 851.2307s
	iters: 3500, epoch: 4 | loss: 0.4917322
	speed: 0.0361s/iter; left time: 864.1956s
	iters: 3600, epoch: 4 | loss: 0.5958317
	speed: 0.0363s/iter; left time: 865.2601s
	iters: 3700, epoch: 4 | loss: 0.6016740
	speed: 0.0390s/iter; left time: 925.6437s
	iters: 3800, epoch: 4 | loss: 0.4976368
	speed: 0.0392s/iter; left time: 925.6487s
	iters: 3900, epoch: 4 | loss: 0.4590268
	speed: 0.0378s/iter; left time: 889.9640s
Epoch: 4 cost time: 144.79269909858704
Epoch: 4, Steps: 3918 | Train Loss: 0.5252207 Vali Loss: 1.2281641 Test Loss: 5.2312641
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6641073
	speed: 1.9107s/iter; left time: 44727.7100s
	iters: 200, epoch: 5 | loss: 0.5838861
	speed: 0.0336s/iter; left time: 784.1204s
	iters: 300, epoch: 5 | loss: 0.4195988
	speed: 0.0338s/iter; left time: 784.7003s
	iters: 400, epoch: 5 | loss: 0.3929618
	speed: 0.0335s/iter; left time: 773.4616s
	iters: 500, epoch: 5 | loss: 0.4967257
	speed: 0.0339s/iter; left time: 780.1046s
	iters: 600, epoch: 5 | loss: 0.5544390
	speed: 0.0341s/iter; left time: 780.1510s
	iters: 700, epoch: 5 | loss: 0.6366042
	speed: 0.0335s/iter; left time: 764.5746s
	iters: 800, epoch: 5 | loss: 0.5316359
	speed: 0.0333s/iter; left time: 756.0513s
	iters: 900, epoch: 5 | loss: 0.4364853
	speed: 0.0333s/iter; left time: 753.2529s
	iters: 1000, epoch: 5 | loss: 0.5931157
	speed: 0.0334s/iter; left time: 750.8290s
	iters: 1100, epoch: 5 | loss: 0.4815691
	speed: 0.0337s/iter; left time: 756.1252s
	iters: 1200, epoch: 5 | loss: 0.3851733
	speed: 0.0334s/iter; left time: 746.0935s
	iters: 1300, epoch: 5 | loss: 0.4613018
	speed: 0.0333s/iter; left time: 738.5547s
	iters: 1400, epoch: 5 | loss: 0.5264673
	speed: 0.0332s/iter; left time: 733.8134s
	iters: 1500, epoch: 5 | loss: 0.3866886
	speed: 0.0333s/iter; left time: 732.8952s
	iters: 1600, epoch: 5 | loss: 0.4571775
	speed: 0.0334s/iter; left time: 731.0622s
	iters: 1700, epoch: 5 | loss: 0.5766664
	speed: 0.0333s/iter; left time: 727.2292s
	iters: 1800, epoch: 5 | loss: 0.4164036
	speed: 0.0332s/iter; left time: 721.0204s
	iters: 1900, epoch: 5 | loss: 0.5743663
	speed: 0.0333s/iter; left time: 719.4042s
	iters: 2000, epoch: 5 | loss: 0.5698124
	speed: 0.0334s/iter; left time: 719.4249s
	iters: 2100, epoch: 5 | loss: 0.4742592
	speed: 0.0334s/iter; left time: 714.7378s
	iters: 2200, epoch: 5 | loss: 0.5188164
	speed: 0.0333s/iter; left time: 710.6169s
	iters: 2300, epoch: 5 | loss: 0.6066234
	speed: 0.0335s/iter; left time: 710.7627s
	iters: 2400, epoch: 5 | loss: 0.6083258
	speed: 0.0336s/iter; left time: 710.2799s
	iters: 2500, epoch: 5 | loss: 0.4607959
	speed: 0.0337s/iter; left time: 708.8028s
	iters: 2600, epoch: 5 | loss: 0.4898118
	speed: 0.0334s/iter; left time: 697.9150s
	iters: 2700, epoch: 5 | loss: 0.5521078
	speed: 0.0337s/iter; left time: 700.6715s
	iters: 2800, epoch: 5 | loss: 0.5967836
	speed: 0.0332s/iter; left time: 688.1946s
	iters: 2900, epoch: 5 | loss: 0.4735681
	speed: 0.0330s/iter; left time: 680.5042s
	iters: 3000, epoch: 5 | loss: 0.6254261
	speed: 0.0333s/iter; left time: 682.4044s
	iters: 3100, epoch: 5 | loss: 0.4133398
	speed: 0.0337s/iter; left time: 687.3057s
	iters: 3200, epoch: 5 | loss: 0.4164053
	speed: 0.0337s/iter; left time: 685.0909s
	iters: 3300, epoch: 5 | loss: 0.4315408
	speed: 0.0334s/iter; left time: 675.6226s
	iters: 3400, epoch: 5 | loss: 0.4639461
	speed: 0.0328s/iter; left time: 658.6905s
	iters: 3500, epoch: 5 | loss: 0.4879744
	speed: 0.0329s/iter; left time: 657.5365s
	iters: 3600, epoch: 5 | loss: 0.6444519
	speed: 0.0330s/iter; left time: 657.3992s
	iters: 3700, epoch: 5 | loss: 0.5328433
	speed: 0.0327s/iter; left time: 647.2387s
	iters: 3800, epoch: 5 | loss: 0.5124462
	speed: 0.0327s/iter; left time: 643.8638s
	iters: 3900, epoch: 5 | loss: 0.5292737
	speed: 0.0327s/iter; left time: 641.7695s
Epoch: 5 cost time: 131.69678783416748
Epoch: 5, Steps: 3918 | Train Loss: 0.5183409 Vali Loss: 1.2497891 Test Loss: 5.2410884
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5586122
	speed: 1.6885s/iter; left time: 32911.1105s
	iters: 200, epoch: 6 | loss: 0.4964976
	speed: 0.0336s/iter; left time: 651.1519s
	iters: 300, epoch: 6 | loss: 0.6212642
	speed: 0.0335s/iter; left time: 646.9004s
	iters: 400, epoch: 6 | loss: 0.4604818
	speed: 0.0336s/iter; left time: 644.2050s
	iters: 500, epoch: 6 | loss: 0.5730265
	speed: 0.0336s/iter; left time: 641.2125s
	iters: 600, epoch: 6 | loss: 0.5361801
	speed: 0.0336s/iter; left time: 637.9695s
	iters: 700, epoch: 6 | loss: 0.4357117
	speed: 0.0336s/iter; left time: 634.5379s
	iters: 800, epoch: 6 | loss: 0.5223467
	speed: 0.0336s/iter; left time: 631.5719s
	iters: 900, epoch: 6 | loss: 0.4899601
	speed: 0.0338s/iter; left time: 631.9470s
	iters: 1000, epoch: 6 | loss: 0.5088157
	speed: 0.0341s/iter; left time: 633.9043s
	iters: 1100, epoch: 6 | loss: 0.6005676
	speed: 0.0337s/iter; left time: 622.3426s
	iters: 1200, epoch: 6 | loss: 0.5461334
	speed: 0.0337s/iter; left time: 620.0042s
	iters: 1300, epoch: 6 | loss: 0.4637855
	speed: 0.0336s/iter; left time: 615.0139s
	iters: 1400, epoch: 6 | loss: 0.5036567
	speed: 0.0336s/iter; left time: 611.4397s
	iters: 1500, epoch: 6 | loss: 0.4752316
	speed: 0.0338s/iter; left time: 611.4367s
	iters: 1600, epoch: 6 | loss: 0.4276192
	speed: 0.0339s/iter; left time: 609.2799s
	iters: 1700, epoch: 6 | loss: 0.5601714
	speed: 0.0338s/iter; left time: 604.9732s
	iters: 1800, epoch: 6 | loss: 0.4588708
	speed: 0.0337s/iter; left time: 599.0394s
	iters: 1900, epoch: 6 | loss: 0.5897590
	speed: 0.0342s/iter; left time: 605.2162s
	iters: 2000, epoch: 6 | loss: 0.5565915
	speed: 0.0339s/iter; left time: 597.1697s
	iters: 2100, epoch: 6 | loss: 0.4518459
	speed: 0.0339s/iter; left time: 593.7164s
	iters: 2200, epoch: 6 | loss: 0.5288640
	speed: 0.0342s/iter; left time: 594.6343s
	iters: 2300, epoch: 6 | loss: 0.5781322
	speed: 0.0344s/iter; left time: 594.5305s
	iters: 2400, epoch: 6 | loss: 0.5731769
	speed: 0.0339s/iter; left time: 582.2623s
	iters: 2500, epoch: 6 | loss: 0.5840392
	speed: 0.0340s/iter; left time: 580.7288s
	iters: 2600, epoch: 6 | loss: 0.3885046
	speed: 0.0345s/iter; left time: 586.3746s
	iters: 2700, epoch: 6 | loss: 0.5255492
	speed: 0.0340s/iter; left time: 574.1176s
	iters: 2800, epoch: 6 | loss: 0.4930932
	speed: 0.0337s/iter; left time: 565.0451s
	iters: 2900, epoch: 6 | loss: 0.5404074
	speed: 0.0341s/iter; left time: 569.7003s
	iters: 3000, epoch: 6 | loss: 0.5094747
	speed: 0.0341s/iter; left time: 565.5871s
	iters: 3100, epoch: 6 | loss: 0.6238107
	speed: 0.0338s/iter; left time: 557.0858s
	iters: 3200, epoch: 6 | loss: 0.4967980
	speed: 0.0334s/iter; left time: 548.0522s
	iters: 3300, epoch: 6 | loss: 0.4168948
	speed: 0.0341s/iter; left time: 555.3433s
	iters: 3400, epoch: 6 | loss: 0.4616635
	speed: 0.0332s/iter; left time: 537.5372s
	iters: 3500, epoch: 6 | loss: 0.4610188
	speed: 0.0330s/iter; left time: 530.8086s
	iters: 3600, epoch: 6 | loss: 0.5711533
	speed: 0.0329s/iter; left time: 525.3946s
	iters: 3700, epoch: 6 | loss: 0.4394832
	speed: 0.0325s/iter; left time: 515.9982s
	iters: 3800, epoch: 6 | loss: 0.3292319
	speed: 0.0326s/iter; left time: 514.9062s
	iters: 3900, epoch: 6 | loss: 0.7341691
	speed: 0.0327s/iter; left time: 512.5912s
Epoch: 6 cost time: 132.77145886421204
Epoch: 6, Steps: 3918 | Train Loss: 0.5149430 Vali Loss: 1.2383828 Test Loss: 5.2186384
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems11_all_96_96_Mamba_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 347822
test shape: (34782, 1, 96, 521) (34782, 1, 96, 521)
test shape: (34782, 96, 521) (34782, 96, 521)
mse:5.199441909790039, mae:0.8906739354133606
>>>>>>>Overall time: 2407 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
