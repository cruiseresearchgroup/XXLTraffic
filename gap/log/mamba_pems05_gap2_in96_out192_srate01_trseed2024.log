Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=103, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems05_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=103, expand=2, factor=1, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems05_all_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=192, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_192_Mamba_custom_ftM_sl192_ll48_pl192_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 548167
val 42500
test 42499
	iters: 100, epoch: 1 | loss: 1.0989449
	speed: 0.0291s/iter; left time: 494.9649s
	iters: 200, epoch: 1 | loss: 1.0070887
	speed: 0.0118s/iter; left time: 199.0376s
	iters: 300, epoch: 1 | loss: 1.0439252
	speed: 0.0117s/iter; left time: 197.6682s
	iters: 400, epoch: 1 | loss: 0.9927276
	speed: 0.0118s/iter; left time: 196.6828s
	iters: 500, epoch: 1 | loss: 1.0211424
	speed: 0.0118s/iter; left time: 195.5811s
	iters: 600, epoch: 1 | loss: 0.9213038
	speed: 0.0118s/iter; left time: 194.7356s
	iters: 700, epoch: 1 | loss: 0.8614643
	speed: 0.0118s/iter; left time: 193.4089s
	iters: 800, epoch: 1 | loss: 0.9275735
	speed: 0.0118s/iter; left time: 192.2712s
	iters: 900, epoch: 1 | loss: 0.8569791
	speed: 0.0118s/iter; left time: 191.5318s
	iters: 1000, epoch: 1 | loss: 0.8382554
	speed: 0.0118s/iter; left time: 190.0716s
	iters: 1100, epoch: 1 | loss: 0.8993890
	speed: 0.0118s/iter; left time: 188.9731s
	iters: 1200, epoch: 1 | loss: 0.8162625
	speed: 0.0118s/iter; left time: 188.0381s
	iters: 1300, epoch: 1 | loss: 0.8675686
	speed: 0.0118s/iter; left time: 186.8165s
	iters: 1400, epoch: 1 | loss: 0.8404892
	speed: 0.0118s/iter; left time: 185.2739s
	iters: 1500, epoch: 1 | loss: 0.7526343
	speed: 0.0118s/iter; left time: 184.1878s
	iters: 1600, epoch: 1 | loss: 0.9167271
	speed: 0.0118s/iter; left time: 182.9940s
	iters: 1700, epoch: 1 | loss: 0.8526041
	speed: 0.0118s/iter; left time: 182.5561s
Epoch: 1 cost time: 21.97446346282959
Epoch: 1, Steps: 1713 | Train Loss: 0.9052409 Vali Loss: 1.3151920 Test Loss: 2.2375603
Validation loss decreased (inf --> 1.315192).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8015278
	speed: 0.1159s/iter; left time: 1776.0346s
	iters: 200, epoch: 2 | loss: 0.8232167
	speed: 0.0123s/iter; left time: 187.1530s
	iters: 300, epoch: 2 | loss: 0.9039224
	speed: 0.0123s/iter; left time: 185.5302s
	iters: 400, epoch: 2 | loss: 0.7637125
	speed: 0.0123s/iter; left time: 185.3046s
	iters: 500, epoch: 2 | loss: 0.7525399
	speed: 0.0123s/iter; left time: 183.1736s
	iters: 600, epoch: 2 | loss: 0.7046083
	speed: 0.0123s/iter; left time: 181.8465s
	iters: 700, epoch: 2 | loss: 0.7258937
	speed: 0.0123s/iter; left time: 180.8850s
	iters: 800, epoch: 2 | loss: 0.6996500
	speed: 0.0123s/iter; left time: 179.5801s
	iters: 900, epoch: 2 | loss: 0.6851314
	speed: 0.0123s/iter; left time: 179.1775s
	iters: 1000, epoch: 2 | loss: 0.7802240
	speed: 0.0123s/iter; left time: 176.9847s
	iters: 1100, epoch: 2 | loss: 0.7399352
	speed: 0.0123s/iter; left time: 176.0051s
	iters: 1200, epoch: 2 | loss: 0.7572865
	speed: 0.0123s/iter; left time: 174.9853s
	iters: 1300, epoch: 2 | loss: 0.7080862
	speed: 0.0123s/iter; left time: 173.6450s
	iters: 1400, epoch: 2 | loss: 0.5954700
	speed: 0.0123s/iter; left time: 172.1374s
	iters: 1500, epoch: 2 | loss: 0.7678335
	speed: 0.0123s/iter; left time: 170.9496s
	iters: 1600, epoch: 2 | loss: 0.6530636
	speed: 0.0123s/iter; left time: 169.6578s
	iters: 1700, epoch: 2 | loss: 0.6619492
	speed: 0.0123s/iter; left time: 168.3555s
Epoch: 2 cost time: 21.36023712158203
Epoch: 2, Steps: 1713 | Train Loss: 0.7388658 Vali Loss: 1.4763782 Test Loss: 2.3298953
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6925662
	speed: 0.1150s/iter; left time: 1564.1331s
	iters: 200, epoch: 3 | loss: 0.7712325
	speed: 0.0123s/iter; left time: 166.1501s
	iters: 300, epoch: 3 | loss: 0.6374329
	speed: 0.0123s/iter; left time: 164.9945s
	iters: 400, epoch: 3 | loss: 0.6434687
	speed: 0.0123s/iter; left time: 163.7528s
	iters: 500, epoch: 3 | loss: 0.7255888
	speed: 0.0123s/iter; left time: 161.8714s
	iters: 600, epoch: 3 | loss: 0.6491072
	speed: 0.0122s/iter; left time: 160.5117s
	iters: 700, epoch: 3 | loss: 0.6553763
	speed: 0.0123s/iter; left time: 159.7740s
	iters: 800, epoch: 3 | loss: 0.6567792
	speed: 0.0122s/iter; left time: 158.0572s
	iters: 900, epoch: 3 | loss: 0.7114321
	speed: 0.0122s/iter; left time: 156.7950s
	iters: 1000, epoch: 3 | loss: 0.6365735
	speed: 0.0122s/iter; left time: 155.3849s
	iters: 1100, epoch: 3 | loss: 0.8105053
	speed: 0.0122s/iter; left time: 154.2552s
	iters: 1200, epoch: 3 | loss: 0.6356050
	speed: 0.0122s/iter; left time: 152.8732s
	iters: 1300, epoch: 3 | loss: 0.5529180
	speed: 0.0123s/iter; left time: 152.0904s
	iters: 1400, epoch: 3 | loss: 0.6682467
	speed: 0.0122s/iter; left time: 150.7070s
	iters: 1500, epoch: 3 | loss: 0.6840318
	speed: 0.0123s/iter; left time: 149.5208s
	iters: 1600, epoch: 3 | loss: 0.6854450
	speed: 0.0122s/iter; left time: 148.0683s
	iters: 1700, epoch: 3 | loss: 0.7381491
	speed: 0.0122s/iter; left time: 146.8021s
Epoch: 3 cost time: 21.30425190925598
Epoch: 3, Steps: 1713 | Train Loss: 0.6713518 Vali Loss: 1.2571111 Test Loss: 2.1664877
Validation loss decreased (1.315192 --> 1.257111).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7096148
	speed: 0.1156s/iter; left time: 1375.0090s
	iters: 200, epoch: 4 | loss: 0.6774035
	speed: 0.0121s/iter; left time: 142.5863s
	iters: 300, epoch: 4 | loss: 0.6286430
	speed: 0.0121s/iter; left time: 141.5001s
	iters: 400, epoch: 4 | loss: 0.6075477
	speed: 0.0121s/iter; left time: 140.2382s
	iters: 500, epoch: 4 | loss: 0.6207082
	speed: 0.0121s/iter; left time: 138.7638s
	iters: 600, epoch: 4 | loss: 0.6627523
	speed: 0.0121s/iter; left time: 137.4766s
	iters: 700, epoch: 4 | loss: 0.6789345
	speed: 0.0121s/iter; left time: 136.5889s
	iters: 800, epoch: 4 | loss: 0.6074020
	speed: 0.0121s/iter; left time: 135.3558s
	iters: 900, epoch: 4 | loss: 0.6565712
	speed: 0.0121s/iter; left time: 134.0473s
	iters: 1000, epoch: 4 | loss: 0.6561227
	speed: 0.0121s/iter; left time: 132.8768s
	iters: 1100, epoch: 4 | loss: 0.6558173
	speed: 0.0121s/iter; left time: 131.7169s
	iters: 1200, epoch: 4 | loss: 0.7101227
	speed: 0.0121s/iter; left time: 130.4513s
	iters: 1300, epoch: 4 | loss: 0.7215307
	speed: 0.0121s/iter; left time: 129.0808s
	iters: 1400, epoch: 4 | loss: 0.6517227
	speed: 0.0121s/iter; left time: 128.3229s
	iters: 1500, epoch: 4 | loss: 0.6630650
	speed: 0.0121s/iter; left time: 126.6516s
	iters: 1600, epoch: 4 | loss: 0.6690487
	speed: 0.0121s/iter; left time: 125.5482s
	iters: 1700, epoch: 4 | loss: 0.5628042
	speed: 0.0121s/iter; left time: 124.2901s
Epoch: 4 cost time: 20.969927310943604
Epoch: 4, Steps: 1713 | Train Loss: 0.6476851 Vali Loss: 1.2616609 Test Loss: 2.3002999
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6222744
	speed: 0.1155s/iter; left time: 1175.6503s
	iters: 200, epoch: 5 | loss: 0.6165003
	speed: 0.0124s/iter; left time: 124.7365s
	iters: 300, epoch: 5 | loss: 0.6670249
	speed: 0.0124s/iter; left time: 123.3886s
	iters: 400, epoch: 5 | loss: 0.6388399
	speed: 0.0123s/iter; left time: 121.5945s
	iters: 500, epoch: 5 | loss: 0.6628478
	speed: 0.0123s/iter; left time: 120.0798s
	iters: 600, epoch: 5 | loss: 0.6698151
	speed: 0.0123s/iter; left time: 119.1707s
	iters: 700, epoch: 5 | loss: 0.6338847
	speed: 0.0123s/iter; left time: 117.6387s
	iters: 800, epoch: 5 | loss: 0.5459426
	speed: 0.0123s/iter; left time: 116.2940s
	iters: 900, epoch: 5 | loss: 0.6236243
	speed: 0.0123s/iter; left time: 114.9645s
	iters: 1000, epoch: 5 | loss: 0.6754908
	speed: 0.0123s/iter; left time: 113.6972s
	iters: 1100, epoch: 5 | loss: 0.5525309
	speed: 0.0123s/iter; left time: 112.5896s
	iters: 1200, epoch: 5 | loss: 0.6518658
	speed: 0.0122s/iter; left time: 111.0777s
	iters: 1300, epoch: 5 | loss: 0.5638328
	speed: 0.0123s/iter; left time: 110.0398s
	iters: 1400, epoch: 5 | loss: 0.6299531
	speed: 0.0123s/iter; left time: 109.3149s
	iters: 1500, epoch: 5 | loss: 0.7082776
	speed: 0.0123s/iter; left time: 107.8093s
	iters: 1600, epoch: 5 | loss: 0.5980438
	speed: 0.0123s/iter; left time: 106.4860s
	iters: 1700, epoch: 5 | loss: 0.6320565
	speed: 0.0123s/iter; left time: 105.1574s
Epoch: 5 cost time: 21.31041669845581
Epoch: 5, Steps: 1713 | Train Loss: 0.6368478 Vali Loss: 1.2371726 Test Loss: 2.2370977
Validation loss decreased (1.257111 --> 1.237173).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6022071
	speed: 0.1142s/iter; left time: 966.7283s
	iters: 200, epoch: 6 | loss: 0.6746724
	speed: 0.0123s/iter; left time: 103.1066s
	iters: 300, epoch: 6 | loss: 0.6103178
	speed: 0.0123s/iter; left time: 101.7978s
	iters: 400, epoch: 6 | loss: 0.6462692
	speed: 0.0123s/iter; left time: 100.7104s
	iters: 500, epoch: 6 | loss: 0.6600726
	speed: 0.0123s/iter; left time: 99.0804s
	iters: 600, epoch: 6 | loss: 0.6253752
	speed: 0.0123s/iter; left time: 97.6240s
	iters: 700, epoch: 6 | loss: 0.6366297
	speed: 0.0123s/iter; left time: 96.4209s
	iters: 800, epoch: 6 | loss: 0.6307684
	speed: 0.0122s/iter; left time: 94.9832s
	iters: 900, epoch: 6 | loss: 0.5961931
	speed: 0.0122s/iter; left time: 93.8560s
	iters: 1000, epoch: 6 | loss: 0.6099085
	speed: 0.0123s/iter; left time: 92.8833s
	iters: 1100, epoch: 6 | loss: 0.6732332
	speed: 0.0122s/iter; left time: 91.3172s
	iters: 1200, epoch: 6 | loss: 0.6277053
	speed: 0.0122s/iter; left time: 90.0461s
	iters: 1300, epoch: 6 | loss: 0.6787231
	speed: 0.0122s/iter; left time: 88.8971s
	iters: 1400, epoch: 6 | loss: 0.5819632
	speed: 0.0122s/iter; left time: 87.6401s
	iters: 1500, epoch: 6 | loss: 0.6654049
	speed: 0.0122s/iter; left time: 86.4119s
	iters: 1600, epoch: 6 | loss: 0.6334329
	speed: 0.0122s/iter; left time: 85.1407s
	iters: 1700, epoch: 6 | loss: 0.6968814
	speed: 0.0122s/iter; left time: 84.0039s
Epoch: 6 cost time: 21.23027515411377
Epoch: 6, Steps: 1713 | Train Loss: 0.6314510 Vali Loss: 1.2108155 Test Loss: 2.2186875
Validation loss decreased (1.237173 --> 1.210816).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5763103
	speed: 0.1157s/iter; left time: 781.1590s
	iters: 200, epoch: 7 | loss: 0.6845008
	speed: 0.0121s/iter; left time: 80.7972s
	iters: 300, epoch: 7 | loss: 0.6155480
	speed: 0.0121s/iter; left time: 79.4811s
	iters: 400, epoch: 7 | loss: 0.6652869
	speed: 0.0122s/iter; left time: 78.5103s
	iters: 500, epoch: 7 | loss: 0.6419341
	speed: 0.0122s/iter; left time: 77.7193s
	iters: 600, epoch: 7 | loss: 0.5690292
	speed: 0.0122s/iter; left time: 76.0687s
	iters: 700, epoch: 7 | loss: 0.6181001
	speed: 0.0121s/iter; left time: 74.6801s
	iters: 800, epoch: 7 | loss: 0.6085247
	speed: 0.0121s/iter; left time: 73.2469s
	iters: 900, epoch: 7 | loss: 0.5819507
	speed: 0.0121s/iter; left time: 72.1832s
	iters: 1000, epoch: 7 | loss: 0.5511113
	speed: 0.0121s/iter; left time: 70.8770s
	iters: 1100, epoch: 7 | loss: 0.5398408
	speed: 0.0121s/iter; left time: 69.8307s
	iters: 1200, epoch: 7 | loss: 0.6054398
	speed: 0.0121s/iter; left time: 68.3654s
	iters: 1300, epoch: 7 | loss: 0.6765537
	speed: 0.0121s/iter; left time: 67.3998s
	iters: 1400, epoch: 7 | loss: 0.5645430
	speed: 0.0121s/iter; left time: 66.0169s
	iters: 1500, epoch: 7 | loss: 0.5644681
	speed: 0.0121s/iter; left time: 64.7458s
	iters: 1600, epoch: 7 | loss: 0.6837958
	speed: 0.0121s/iter; left time: 63.5639s
	iters: 1700, epoch: 7 | loss: 0.7386867
	speed: 0.0121s/iter; left time: 62.3077s
Epoch: 7 cost time: 21.07913303375244
Epoch: 7, Steps: 1713 | Train Loss: 0.6287702 Vali Loss: 1.2367547 Test Loss: 2.2450273
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6138606
	speed: 0.1157s/iter; left time: 583.1830s
	iters: 200, epoch: 8 | loss: 0.6671105
	speed: 0.0123s/iter; left time: 60.7366s
	iters: 300, epoch: 8 | loss: 0.6471514
	speed: 0.0123s/iter; left time: 59.4440s
	iters: 400, epoch: 8 | loss: 0.6295936
	speed: 0.0123s/iter; left time: 58.1975s
	iters: 500, epoch: 8 | loss: 0.6955814
	speed: 0.0123s/iter; left time: 57.0379s
	iters: 600, epoch: 8 | loss: 0.5341653
	speed: 0.0123s/iter; left time: 55.8652s
	iters: 700, epoch: 8 | loss: 0.5590956
	speed: 0.0123s/iter; left time: 54.6077s
	iters: 800, epoch: 8 | loss: 0.6421421
	speed: 0.0123s/iter; left time: 53.4799s
	iters: 900, epoch: 8 | loss: 0.5969576
	speed: 0.0123s/iter; left time: 52.2303s
	iters: 1000, epoch: 8 | loss: 0.5940244
	speed: 0.0124s/iter; left time: 51.3022s
	iters: 1100, epoch: 8 | loss: 0.6448972
	speed: 0.0124s/iter; left time: 49.9828s
	iters: 1200, epoch: 8 | loss: 0.6944717
	speed: 0.0123s/iter; left time: 48.4693s
	iters: 1300, epoch: 8 | loss: 0.6280921
	speed: 0.0123s/iter; left time: 47.2094s
	iters: 1400, epoch: 8 | loss: 0.5760866
	speed: 0.0123s/iter; left time: 46.0114s
	iters: 1500, epoch: 8 | loss: 0.6807025
	speed: 0.0123s/iter; left time: 44.7740s
	iters: 1600, epoch: 8 | loss: 0.6290110
	speed: 0.0123s/iter; left time: 43.5495s
	iters: 1700, epoch: 8 | loss: 0.6709748
	speed: 0.0123s/iter; left time: 42.2734s
Epoch: 8 cost time: 21.37704873085022
Epoch: 8, Steps: 1713 | Train Loss: 0.6274408 Vali Loss: 1.2392969 Test Loss: 2.2700131
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5910746
	speed: 0.1154s/iter; left time: 384.0396s
	iters: 200, epoch: 9 | loss: 0.6748003
	speed: 0.0123s/iter; left time: 39.6914s
	iters: 300, epoch: 9 | loss: 0.6549497
	speed: 0.0123s/iter; left time: 38.4179s
	iters: 400, epoch: 9 | loss: 0.5800641
	speed: 0.0123s/iter; left time: 37.2415s
	iters: 500, epoch: 9 | loss: 0.6077849
	speed: 0.0123s/iter; left time: 35.9527s
	iters: 600, epoch: 9 | loss: 0.7034262
	speed: 0.0122s/iter; left time: 34.5840s
	iters: 700, epoch: 9 | loss: 0.6334842
	speed: 0.0122s/iter; left time: 33.3837s
	iters: 800, epoch: 9 | loss: 0.6683884
	speed: 0.0123s/iter; left time: 32.1856s
	iters: 900, epoch: 9 | loss: 0.6093800
	speed: 0.0122s/iter; left time: 30.8885s
	iters: 1000, epoch: 9 | loss: 0.5794632
	speed: 0.0123s/iter; left time: 29.7363s
	iters: 1100, epoch: 9 | loss: 0.6589786
	speed: 0.0122s/iter; left time: 28.4749s
	iters: 1200, epoch: 9 | loss: 0.6283299
	speed: 0.0123s/iter; left time: 27.3255s
	iters: 1300, epoch: 9 | loss: 0.6067902
	speed: 0.0122s/iter; left time: 26.0251s
	iters: 1400, epoch: 9 | loss: 0.6443340
	speed: 0.0122s/iter; left time: 24.8260s
	iters: 1500, epoch: 9 | loss: 0.5818911
	speed: 0.0122s/iter; left time: 23.5242s
	iters: 1600, epoch: 9 | loss: 0.6662250
	speed: 0.0122s/iter; left time: 22.3586s
	iters: 1700, epoch: 9 | loss: 0.5855076
	speed: 0.0122s/iter; left time: 21.1541s
Epoch: 9 cost time: 21.25940251350403
Epoch: 9, Steps: 1713 | Train Loss: 0.6267930 Vali Loss: 1.2283485 Test Loss: 2.2598212
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems05_all_96_192_Mamba_custom_ftM_sl192_ll48_pl192_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 42499
test shape: (4249, 1, 192, 103) (4249, 1, 192, 103)
test shape: (4249, 192, 103) (4249, 192, 103)
mse:2.218693494796753, mae:1.2744500637054443
>>>>>>>Overall time: 341 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
