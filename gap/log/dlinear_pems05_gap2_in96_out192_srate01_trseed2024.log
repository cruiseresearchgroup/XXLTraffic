Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=103, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems05_all_common_flow.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems05_all_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_192_DLinear_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 548263
val 42500
test 42499
	iters: 100, epoch: 1 | loss: 1.3169028
	speed: 0.0136s/iter; left time: 4645.4223s
	iters: 200, epoch: 1 | loss: 1.4287698
	speed: 0.0103s/iter; left time: 3518.9235s
	iters: 300, epoch: 1 | loss: 1.2948848
	speed: 0.0103s/iter; left time: 3535.0300s
	iters: 400, epoch: 1 | loss: 1.3114461
	speed: 0.0102s/iter; left time: 3477.8302s
	iters: 500, epoch: 1 | loss: 1.3707130
	speed: 0.0103s/iter; left time: 3529.1123s
	iters: 600, epoch: 1 | loss: 1.3117220
	speed: 0.0102s/iter; left time: 3489.4604s
	iters: 700, epoch: 1 | loss: 1.2618215
	speed: 0.0102s/iter; left time: 3496.9054s
	iters: 800, epoch: 1 | loss: 1.2396204
	speed: 0.0103s/iter; left time: 3508.0005s
	iters: 900, epoch: 1 | loss: 1.2020892
	speed: 0.0103s/iter; left time: 3512.3958s
	iters: 1000, epoch: 1 | loss: 1.2007308
	speed: 0.0104s/iter; left time: 3539.3936s
	iters: 1100, epoch: 1 | loss: 1.1873367
	speed: 0.0103s/iter; left time: 3504.9085s
	iters: 1200, epoch: 1 | loss: 1.2072045
	speed: 0.0102s/iter; left time: 3480.5849s
	iters: 1300, epoch: 1 | loss: 1.1930037
	speed: 0.0102s/iter; left time: 3485.3770s
	iters: 1400, epoch: 1 | loss: 1.5077378
	speed: 0.0103s/iter; left time: 3503.8087s
	iters: 1500, epoch: 1 | loss: 1.3191792
	speed: 0.0103s/iter; left time: 3500.6104s
	iters: 1600, epoch: 1 | loss: 1.2627906
	speed: 0.0103s/iter; left time: 3501.2923s
	iters: 1700, epoch: 1 | loss: 1.2966639
	speed: 0.0102s/iter; left time: 3489.7970s
Epoch: 1 cost time: 17.961484909057617
Epoch: 1, Steps: 1713 | Train Loss: 1.3285350 Vali Loss: 1.3923171 Test Loss: 1.6749823
Validation loss decreased (inf --> 1.392317).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4770761
	speed: 0.0887s/iter; left time: 30236.8929s
	iters: 200, epoch: 2 | loss: 1.3013059
	speed: 0.0101s/iter; left time: 3436.9849s
	iters: 300, epoch: 2 | loss: 1.1532100
	speed: 0.0101s/iter; left time: 3423.5058s
	iters: 400, epoch: 2 | loss: 1.3040136
	speed: 0.0101s/iter; left time: 3423.8044s
	iters: 500, epoch: 2 | loss: 1.3658596
	speed: 0.0102s/iter; left time: 3487.4094s
	iters: 600, epoch: 2 | loss: 1.3174357
	speed: 0.0102s/iter; left time: 3469.8909s
	iters: 700, epoch: 2 | loss: 1.1220722
	speed: 0.0102s/iter; left time: 3475.9827s
	iters: 800, epoch: 2 | loss: 1.4517211
	speed: 0.0102s/iter; left time: 3478.0478s
	iters: 900, epoch: 2 | loss: 1.4258317
	speed: 0.0102s/iter; left time: 3477.6047s
	iters: 1000, epoch: 2 | loss: 1.3492975
	speed: 0.0102s/iter; left time: 3472.2561s
	iters: 1100, epoch: 2 | loss: 1.2931509
	speed: 0.0103s/iter; left time: 3495.0301s
	iters: 1200, epoch: 2 | loss: 1.2047786
	speed: 0.0102s/iter; left time: 3454.7896s
	iters: 1300, epoch: 2 | loss: 1.1174635
	speed: 0.0102s/iter; left time: 3477.9687s
	iters: 1400, epoch: 2 | loss: 1.2567922
	speed: 0.0102s/iter; left time: 3475.9538s
	iters: 1500, epoch: 2 | loss: 1.2997644
	speed: 0.0101s/iter; left time: 3440.7864s
	iters: 1600, epoch: 2 | loss: 1.2184764
	speed: 0.0102s/iter; left time: 3466.9865s
	iters: 1700, epoch: 2 | loss: 1.2325608
	speed: 0.0102s/iter; left time: 3451.4616s
Epoch: 2 cost time: 17.577681303024292
Epoch: 2, Steps: 1713 | Train Loss: 1.3160554 Vali Loss: 1.4455202 Test Loss: 1.7287357
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 1.4168447
	speed: 0.0882s/iter; left time: 29919.4748s
	iters: 200, epoch: 3 | loss: 1.2425535
	speed: 0.0102s/iter; left time: 3444.5438s
	iters: 300, epoch: 3 | loss: 1.3066550
	speed: 0.0101s/iter; left time: 3434.9885s
	iters: 400, epoch: 3 | loss: 1.4402454
	speed: 0.0102s/iter; left time: 3451.3768s
	iters: 500, epoch: 3 | loss: 1.3162270
	speed: 0.0102s/iter; left time: 3456.1096s
	iters: 600, epoch: 3 | loss: 1.3891294
	speed: 0.0102s/iter; left time: 3462.2798s
	iters: 700, epoch: 3 | loss: 1.3494475
	speed: 0.0103s/iter; left time: 3476.6780s
	iters: 800, epoch: 3 | loss: 1.2409339
	speed: 0.0102s/iter; left time: 3467.9455s
	iters: 900, epoch: 3 | loss: 1.3342897
	speed: 0.0104s/iter; left time: 3502.1200s
	iters: 1000, epoch: 3 | loss: 1.1511543
	speed: 0.0103s/iter; left time: 3477.7633s
	iters: 1100, epoch: 3 | loss: 1.2600477
	speed: 0.0103s/iter; left time: 3469.7700s
	iters: 1200, epoch: 3 | loss: 1.5283250
	speed: 0.0104s/iter; left time: 3513.4556s
	iters: 1300, epoch: 3 | loss: 1.2101399
	speed: 0.0103s/iter; left time: 3488.9107s
	iters: 1400, epoch: 3 | loss: 1.5575165
	speed: 0.0103s/iter; left time: 3463.7741s
	iters: 1500, epoch: 3 | loss: 1.5286257
	speed: 0.0103s/iter; left time: 3467.6620s
	iters: 1600, epoch: 3 | loss: 1.5282959
	speed: 0.0103s/iter; left time: 3462.2149s
	iters: 1700, epoch: 3 | loss: 1.4605515
	speed: 0.0103s/iter; left time: 3485.4449s
Epoch: 3 cost time: 17.70846438407898
Epoch: 3, Steps: 1713 | Train Loss: 1.3164701 Vali Loss: 1.3702129 Test Loss: 1.6501429
Validation loss decreased (1.392317 --> 1.370213).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5262458
	speed: 0.0883s/iter; left time: 29799.9671s
	iters: 200, epoch: 4 | loss: 1.4745065
	speed: 0.0103s/iter; left time: 3479.2117s
	iters: 300, epoch: 4 | loss: 1.3820707
	speed: 0.0103s/iter; left time: 3478.6174s
	iters: 400, epoch: 4 | loss: 1.2755548
	speed: 0.0104s/iter; left time: 3489.9606s
	iters: 500, epoch: 4 | loss: 1.3598281
	speed: 0.0102s/iter; left time: 3453.0205s
	iters: 600, epoch: 4 | loss: 1.3816636
	speed: 0.0103s/iter; left time: 3476.3590s
	iters: 700, epoch: 4 | loss: 1.4004074
	speed: 0.0103s/iter; left time: 3453.6286s
	iters: 800, epoch: 4 | loss: 1.4020832
	speed: 0.0103s/iter; left time: 3479.2596s
	iters: 900, epoch: 4 | loss: 1.2790467
	speed: 0.0103s/iter; left time: 3475.7105s
	iters: 1000, epoch: 4 | loss: 1.2915241
	speed: 0.0103s/iter; left time: 3465.1863s
	iters: 1100, epoch: 4 | loss: 1.1918039
	speed: 0.0103s/iter; left time: 3476.9507s
	iters: 1200, epoch: 4 | loss: 1.0970067
	speed: 0.0103s/iter; left time: 3465.9926s
	iters: 1300, epoch: 4 | loss: 1.1152481
	speed: 0.0103s/iter; left time: 3469.8725s
	iters: 1400, epoch: 4 | loss: 1.2676512
	speed: 0.0103s/iter; left time: 3464.1635s
	iters: 1500, epoch: 4 | loss: 1.1968832
	speed: 0.0104s/iter; left time: 3483.0991s
	iters: 1600, epoch: 4 | loss: 1.3208334
	speed: 0.0103s/iter; left time: 3445.0610s
	iters: 1700, epoch: 4 | loss: 1.3399357
	speed: 0.0104s/iter; left time: 3497.4338s
Epoch: 4 cost time: 17.796504020690918
Epoch: 4, Steps: 1713 | Train Loss: 1.3160051 Vali Loss: 1.3538197 Test Loss: 1.5894935
Validation loss decreased (1.370213 --> 1.353820).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2593505
	speed: 0.0881s/iter; left time: 29557.0036s
	iters: 200, epoch: 5 | loss: 1.2509289
	speed: 0.0102s/iter; left time: 3426.7062s
	iters: 300, epoch: 5 | loss: 1.3700390
	speed: 0.0103s/iter; left time: 3442.7065s
	iters: 400, epoch: 5 | loss: 1.2070097
	speed: 0.0101s/iter; left time: 3400.3915s
	iters: 500, epoch: 5 | loss: 1.3779447
	speed: 0.0102s/iter; left time: 3414.4698s
	iters: 600, epoch: 5 | loss: 1.3556805
	speed: 0.0102s/iter; left time: 3416.0163s
	iters: 700, epoch: 5 | loss: 1.3448077
	speed: 0.0103s/iter; left time: 3437.7458s
	iters: 800, epoch: 5 | loss: 1.2749221
	speed: 0.0102s/iter; left time: 3415.9319s
	iters: 900, epoch: 5 | loss: 1.4251260
	speed: 0.0103s/iter; left time: 3439.9393s
	iters: 1000, epoch: 5 | loss: 1.3312130
	speed: 0.0103s/iter; left time: 3431.3699s
	iters: 1100, epoch: 5 | loss: 1.3393945
	speed: 0.0102s/iter; left time: 3408.3333s
	iters: 1200, epoch: 5 | loss: 1.3845439
	speed: 0.0102s/iter; left time: 3406.1790s
	iters: 1300, epoch: 5 | loss: 1.2874457
	speed: 0.0102s/iter; left time: 3427.0269s
	iters: 1400, epoch: 5 | loss: 1.4395252
	speed: 0.0102s/iter; left time: 3403.4022s
	iters: 1500, epoch: 5 | loss: 1.3066794
	speed: 0.0102s/iter; left time: 3396.9988s
	iters: 1600, epoch: 5 | loss: 1.2803386
	speed: 0.0102s/iter; left time: 3417.0752s
	iters: 1700, epoch: 5 | loss: 1.3346348
	speed: 0.0102s/iter; left time: 3419.7042s
Epoch: 5 cost time: 17.637739658355713
Epoch: 5, Steps: 1713 | Train Loss: 1.3162115 Vali Loss: 1.3893142 Test Loss: 1.6622558
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 6 | loss: 1.2625703
	speed: 0.0883s/iter; left time: 29476.4603s
	iters: 200, epoch: 6 | loss: 1.3021243
	speed: 0.0101s/iter; left time: 3384.3789s
	iters: 300, epoch: 6 | loss: 1.2762980
	speed: 0.0101s/iter; left time: 3374.3054s
	iters: 400, epoch: 6 | loss: 1.2716792
	speed: 0.0101s/iter; left time: 3370.3886s
	iters: 500, epoch: 6 | loss: 1.3920708
	speed: 0.0101s/iter; left time: 3378.0390s
	iters: 600, epoch: 6 | loss: 1.3408422
	speed: 0.0101s/iter; left time: 3378.8873s
	iters: 700, epoch: 6 | loss: 1.3785187
	speed: 0.0102s/iter; left time: 3399.7545s
	iters: 800, epoch: 6 | loss: 1.3008560
	speed: 0.0103s/iter; left time: 3438.8313s
	iters: 900, epoch: 6 | loss: 1.3077922
	speed: 0.0103s/iter; left time: 3432.2157s
	iters: 1000, epoch: 6 | loss: 1.3132123
	speed: 0.0103s/iter; left time: 3438.7604s
	iters: 1100, epoch: 6 | loss: 1.3178527
	speed: 0.0103s/iter; left time: 3427.4071s
	iters: 1200, epoch: 6 | loss: 1.2206382
	speed: 0.0103s/iter; left time: 3432.7894s
	iters: 1300, epoch: 6 | loss: 1.2047656
	speed: 0.0103s/iter; left time: 3432.0111s
	iters: 1400, epoch: 6 | loss: 1.2286694
	speed: 0.0103s/iter; left time: 3425.6963s
	iters: 1500, epoch: 6 | loss: 1.3144102
	speed: 0.0103s/iter; left time: 3432.1293s
	iters: 1600, epoch: 6 | loss: 1.3083212
	speed: 0.0102s/iter; left time: 3406.1290s
	iters: 1700, epoch: 6 | loss: 1.2742249
	speed: 0.0102s/iter; left time: 3394.5670s
Epoch: 6 cost time: 17.654714107513428
Epoch: 6, Steps: 1713 | Train Loss: 1.3162454 Vali Loss: 1.3581789 Test Loss: 1.6184925
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 7 | loss: 1.2660230
	speed: 0.0880s/iter; left time: 29231.5335s
	iters: 200, epoch: 7 | loss: 1.2961973
	speed: 0.0101s/iter; left time: 3364.1012s
	iters: 300, epoch: 7 | loss: 1.2992475
	speed: 0.0101s/iter; left time: 3360.0873s
	iters: 400, epoch: 7 | loss: 1.5741730
	speed: 0.0101s/iter; left time: 3355.0504s
	iters: 500, epoch: 7 | loss: 1.3769339
	speed: 0.0101s/iter; left time: 3364.1020s
	iters: 600, epoch: 7 | loss: 1.2591168
	speed: 0.0103s/iter; left time: 3405.1611s
	iters: 700, epoch: 7 | loss: 1.4100733
	speed: 0.0103s/iter; left time: 3411.1508s
	iters: 800, epoch: 7 | loss: 1.2701524
	speed: 0.0102s/iter; left time: 3394.8972s
	iters: 900, epoch: 7 | loss: 1.4878803
	speed: 0.0102s/iter; left time: 3376.9524s
	iters: 1000, epoch: 7 | loss: 1.1826718
	speed: 0.0101s/iter; left time: 3361.0290s
	iters: 1100, epoch: 7 | loss: 1.3042551
	speed: 0.0101s/iter; left time: 3349.4390s
	iters: 1200, epoch: 7 | loss: 1.3013217
	speed: 0.0101s/iter; left time: 3353.7952s
	iters: 1300, epoch: 7 | loss: 1.1760639
	speed: 0.0102s/iter; left time: 3360.3226s
	iters: 1400, epoch: 7 | loss: 1.2674685
	speed: 0.0102s/iter; left time: 3370.2325s
	iters: 1500, epoch: 7 | loss: 1.1733949
	speed: 0.0102s/iter; left time: 3371.1181s
	iters: 1600, epoch: 7 | loss: 1.3926172
	speed: 0.0101s/iter; left time: 3353.5689s
	iters: 1700, epoch: 7 | loss: 1.4362056
	speed: 0.0101s/iter; left time: 3352.6565s
Epoch: 7 cost time: 17.553155183792114
Epoch: 7, Steps: 1713 | Train Loss: 1.3160613 Vali Loss: 1.4155558 Test Loss: 1.7083627
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 8 | loss: 1.3429980
	speed: 0.0881s/iter; left time: 29119.5052s
	iters: 200, epoch: 8 | loss: 1.1772093
	speed: 0.0101s/iter; left time: 3347.7568s
	iters: 300, epoch: 8 | loss: 1.2705821
	speed: 0.0100s/iter; left time: 3318.7535s
	iters: 400, epoch: 8 | loss: 1.3338288
	speed: 0.0101s/iter; left time: 3345.4399s
	iters: 500, epoch: 8 | loss: 1.4890528
	speed: 0.0102s/iter; left time: 3372.9610s
	iters: 600, epoch: 8 | loss: 1.3168396
	speed: 0.0102s/iter; left time: 3363.5692s
	iters: 700, epoch: 8 | loss: 1.2508855
	speed: 0.0102s/iter; left time: 3358.6777s
	iters: 800, epoch: 8 | loss: 1.2887924
	speed: 0.0102s/iter; left time: 3359.5295s
	iters: 900, epoch: 8 | loss: 1.3440772
	speed: 0.0103s/iter; left time: 3380.3957s
	iters: 1000, epoch: 8 | loss: 1.2490736
	speed: 0.0103s/iter; left time: 3381.9802s
	iters: 1100, epoch: 8 | loss: 1.2374078
	speed: 0.0102s/iter; left time: 3365.3676s
	iters: 1200, epoch: 8 | loss: 1.4154127
	speed: 0.0103s/iter; left time: 3405.9586s
	iters: 1300, epoch: 8 | loss: 1.2843679
	speed: 0.0102s/iter; left time: 3356.0240s
	iters: 1400, epoch: 8 | loss: 1.3064966
	speed: 0.0102s/iter; left time: 3356.8078s
	iters: 1500, epoch: 8 | loss: 1.2918745
	speed: 0.0103s/iter; left time: 3375.8597s
	iters: 1600, epoch: 8 | loss: 1.4223206
	speed: 0.0102s/iter; left time: 3350.2651s
	iters: 1700, epoch: 8 | loss: 1.3558074
	speed: 0.0102s/iter; left time: 3370.0551s
Epoch: 8 cost time: 17.592509508132935
Epoch: 8, Steps: 1713 | Train Loss: 1.3161207 Vali Loss: 1.3626245 Test Loss: 1.6399534
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 9 | loss: 1.3775346
	speed: 0.0881s/iter; left time: 28979.9015s
	iters: 200, epoch: 9 | loss: 1.2339926
	speed: 0.0103s/iter; left time: 3380.0322s
	iters: 300, epoch: 9 | loss: 1.3051963
	speed: 0.0103s/iter; left time: 3393.0227s
	iters: 400, epoch: 9 | loss: 1.3271612
	speed: 0.0103s/iter; left time: 3373.2168s
	iters: 500, epoch: 9 | loss: 1.3694949
	speed: 0.0103s/iter; left time: 3368.2830s
	iters: 600, epoch: 9 | loss: 1.3828210
	speed: 0.0103s/iter; left time: 3369.8505s
	iters: 700, epoch: 9 | loss: 1.4254919
	speed: 0.0103s/iter; left time: 3367.9108s
	iters: 800, epoch: 9 | loss: 1.4604487
	speed: 0.0103s/iter; left time: 3386.3868s
	iters: 900, epoch: 9 | loss: 1.3019699
	speed: 0.0103s/iter; left time: 3376.8105s
	iters: 1000, epoch: 9 | loss: 1.1344129
	speed: 0.0104s/iter; left time: 3418.0894s
	iters: 1100, epoch: 9 | loss: 1.1111733
	speed: 0.0103s/iter; left time: 3368.0365s
	iters: 1200, epoch: 9 | loss: 1.2651182
	speed: 0.0103s/iter; left time: 3367.9888s
	iters: 1300, epoch: 9 | loss: 1.2154387
	speed: 0.0103s/iter; left time: 3376.7148s
	iters: 1400, epoch: 9 | loss: 1.2447203
	speed: 0.0103s/iter; left time: 3367.3098s
	iters: 1500, epoch: 9 | loss: 1.2786784
	speed: 0.0103s/iter; left time: 3372.5504s
	iters: 1600, epoch: 9 | loss: 1.3245425
	speed: 0.0103s/iter; left time: 3364.4177s
	iters: 1700, epoch: 9 | loss: 1.3151996
	speed: 0.0103s/iter; left time: 3354.6160s
Epoch: 9 cost time: 17.763962268829346
Epoch: 9, Steps: 1713 | Train Loss: 1.3163478 Vali Loss: 1.3847538 Test Loss: 1.6674517
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems05_all_96_192_DLinear_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 42499
test shape: (4249, 1, 192, 103) (4249, 1, 192, 103)
test shape: (4249, 192, 103) (4249, 192, 103)
mse:1.5894973278045654, mae:1.026651382446289
>>>>>>>Overall time: 286 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
