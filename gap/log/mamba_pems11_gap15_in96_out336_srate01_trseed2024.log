Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=521, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems11_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=521, expand=2, factor=1, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems11_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=336, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems11_all_96_336_Mamba_custom_ftM_sl336_ll48_pl336_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1200616
val 294878
test 294878
	iters: 100, epoch: 1 | loss: 0.7983310
	speed: 0.1136s/iter; left time: 4250.6871s
	iters: 200, epoch: 1 | loss: 0.6433750
	speed: 0.0849s/iter; left time: 3167.9653s
	iters: 300, epoch: 1 | loss: 0.7478519
	speed: 0.0850s/iter; left time: 3161.5577s
	iters: 400, epoch: 1 | loss: 0.6405323
	speed: 0.0851s/iter; left time: 3157.5828s
	iters: 500, epoch: 1 | loss: 0.6552203
	speed: 0.0853s/iter; left time: 3156.5079s
	iters: 600, epoch: 1 | loss: 0.6180778
	speed: 0.0854s/iter; left time: 3153.2126s
	iters: 700, epoch: 1 | loss: 0.5920891
	speed: 0.0854s/iter; left time: 3142.3457s
	iters: 800, epoch: 1 | loss: 0.6515978
	speed: 0.0855s/iter; left time: 3137.0704s
	iters: 900, epoch: 1 | loss: 0.6199560
	speed: 0.0857s/iter; left time: 3136.2295s
	iters: 1000, epoch: 1 | loss: 0.6474032
	speed: 0.0857s/iter; left time: 3128.4403s
	iters: 1100, epoch: 1 | loss: 0.5228997
	speed: 0.0848s/iter; left time: 3085.9386s
	iters: 1200, epoch: 1 | loss: 0.5437112
	speed: 0.0845s/iter; left time: 3068.4268s
	iters: 1300, epoch: 1 | loss: 0.4976749
	speed: 0.0848s/iter; left time: 3072.1170s
	iters: 1400, epoch: 1 | loss: 0.5582222
	speed: 0.0845s/iter; left time: 3051.7753s
	iters: 1500, epoch: 1 | loss: 0.5130285
	speed: 0.0846s/iter; left time: 3045.8109s
	iters: 1600, epoch: 1 | loss: 0.5127757
	speed: 0.0849s/iter; left time: 3049.7110s
	iters: 1700, epoch: 1 | loss: 0.5361913
	speed: 0.0850s/iter; left time: 3042.9248s
	iters: 1800, epoch: 1 | loss: 0.4845084
	speed: 0.0853s/iter; left time: 3044.6197s
	iters: 1900, epoch: 1 | loss: 0.5402682
	speed: 0.0850s/iter; left time: 3027.6625s
	iters: 2000, epoch: 1 | loss: 0.7423384
	speed: 0.0845s/iter; left time: 3001.1935s
	iters: 2100, epoch: 1 | loss: 0.5972453
	speed: 0.0850s/iter; left time: 3011.3079s
	iters: 2200, epoch: 1 | loss: 0.4654610
	speed: 0.0847s/iter; left time: 2990.7470s
	iters: 2300, epoch: 1 | loss: 0.6014189
	speed: 0.0851s/iter; left time: 2997.6772s
	iters: 2400, epoch: 1 | loss: 0.5933728
	speed: 0.0850s/iter; left time: 2986.0607s
	iters: 2500, epoch: 1 | loss: 0.5741807
	speed: 0.0849s/iter; left time: 2971.9289s
	iters: 2600, epoch: 1 | loss: 0.5637817
	speed: 0.0854s/iter; left time: 2981.5999s
	iters: 2700, epoch: 1 | loss: 0.5635890
	speed: 0.0849s/iter; left time: 2954.8140s
	iters: 2800, epoch: 1 | loss: 0.6162072
	speed: 0.0857s/iter; left time: 2973.0393s
	iters: 2900, epoch: 1 | loss: 0.4348388
	speed: 0.0848s/iter; left time: 2933.5370s
	iters: 3000, epoch: 1 | loss: 0.5433473
	speed: 0.0847s/iter; left time: 2921.9632s
	iters: 3100, epoch: 1 | loss: 0.5289326
	speed: 0.0848s/iter; left time: 2919.4342s
	iters: 3200, epoch: 1 | loss: 0.5514501
	speed: 0.0851s/iter; left time: 2920.2624s
	iters: 3300, epoch: 1 | loss: 0.5043690
	speed: 0.0851s/iter; left time: 2912.9192s
	iters: 3400, epoch: 1 | loss: 0.5653931
	speed: 0.0852s/iter; left time: 2906.0784s
	iters: 3500, epoch: 1 | loss: 0.5296042
	speed: 0.0854s/iter; left time: 2904.9348s
	iters: 3600, epoch: 1 | loss: 0.4257396
	speed: 0.0854s/iter; left time: 2894.4689s
	iters: 3700, epoch: 1 | loss: 0.4845198
	speed: 0.0857s/iter; left time: 2896.3935s
Epoch: 1 cost time: 322.17835807800293
Epoch: 1, Steps: 3751 | Train Loss: 0.5957765 Vali Loss: 1.3801486 Test Loss: 6.0579658
Validation loss decreased (inf --> 1.380149).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6148324
	speed: 2.1397s/iter; left time: 72020.9133s
	iters: 200, epoch: 2 | loss: 0.5088947
	speed: 0.0883s/iter; left time: 2962.5957s
	iters: 300, epoch: 2 | loss: 0.4696742
	speed: 0.0881s/iter; left time: 2947.0130s
	iters: 400, epoch: 2 | loss: 0.4265723
	speed: 0.0883s/iter; left time: 2944.6398s
	iters: 500, epoch: 2 | loss: 0.6183795
	speed: 0.0882s/iter; left time: 2933.9072s
	iters: 600, epoch: 2 | loss: 0.5326285
	speed: 0.0881s/iter; left time: 2920.8841s
	iters: 700, epoch: 2 | loss: 0.4104321
	speed: 0.0882s/iter; left time: 2915.3539s
	iters: 800, epoch: 2 | loss: 0.5156100
	speed: 0.0882s/iter; left time: 2907.3190s
	iters: 900, epoch: 2 | loss: 0.3876525
	speed: 0.0884s/iter; left time: 2905.9864s
	iters: 1000, epoch: 2 | loss: 0.5739330
	speed: 0.0884s/iter; left time: 2897.5634s
	iters: 1100, epoch: 2 | loss: 0.5246391
	speed: 0.0884s/iter; left time: 2886.1200s
	iters: 1200, epoch: 2 | loss: 0.4435041
	speed: 0.0884s/iter; left time: 2877.2897s
	iters: 1300, epoch: 2 | loss: 0.4396635
	speed: 0.0881s/iter; left time: 2858.9867s
	iters: 1400, epoch: 2 | loss: 0.4169932
	speed: 0.0881s/iter; left time: 2851.4432s
	iters: 1500, epoch: 2 | loss: 0.4692666
	speed: 0.0880s/iter; left time: 2839.5537s
	iters: 1600, epoch: 2 | loss: 0.6022762
	speed: 0.0887s/iter; left time: 2852.6094s
	iters: 1700, epoch: 2 | loss: 0.4852055
	speed: 0.0885s/iter; left time: 2836.5886s
	iters: 1800, epoch: 2 | loss: 0.5285650
	speed: 0.0882s/iter; left time: 2820.3347s
	iters: 1900, epoch: 2 | loss: 0.5020141
	speed: 0.0884s/iter; left time: 2814.8488s
	iters: 2000, epoch: 2 | loss: 0.5374813
	speed: 0.0882s/iter; left time: 2799.9527s
	iters: 2100, epoch: 2 | loss: 0.4106843
	speed: 0.0881s/iter; left time: 2788.1146s
	iters: 2200, epoch: 2 | loss: 0.5157452
	speed: 0.0882s/iter; left time: 2783.3745s
	iters: 2300, epoch: 2 | loss: 0.4171591
	speed: 0.0885s/iter; left time: 2783.4403s
	iters: 2400, epoch: 2 | loss: 0.4504927
	speed: 0.0882s/iter; left time: 2767.4742s
	iters: 2500, epoch: 2 | loss: 0.5195563
	speed: 0.0884s/iter; left time: 2764.5766s
	iters: 2600, epoch: 2 | loss: 0.5595938
	speed: 0.0883s/iter; left time: 2752.4481s
	iters: 2700, epoch: 2 | loss: 0.3991136
	speed: 0.0881s/iter; left time: 2736.7474s
	iters: 2800, epoch: 2 | loss: 0.5334197
	speed: 0.0880s/iter; left time: 2723.7202s
	iters: 2900, epoch: 2 | loss: 0.4375612
	speed: 0.0880s/iter; left time: 2716.3322s
	iters: 3000, epoch: 2 | loss: 0.5294974
	speed: 0.0881s/iter; left time: 2711.4568s
	iters: 3100, epoch: 2 | loss: 0.5604247
	speed: 0.0883s/iter; left time: 2707.3560s
	iters: 3200, epoch: 2 | loss: 0.4364555
	speed: 0.0882s/iter; left time: 2695.7109s
	iters: 3300, epoch: 2 | loss: 0.5350831
	speed: 0.0880s/iter; left time: 2679.0091s
	iters: 3400, epoch: 2 | loss: 0.5857265
	speed: 0.0882s/iter; left time: 2678.4002s
	iters: 3500, epoch: 2 | loss: 0.4807420
	speed: 0.0879s/iter; left time: 2660.0530s
	iters: 3600, epoch: 2 | loss: 0.5382603
	speed: 0.0881s/iter; left time: 2656.4389s
	iters: 3700, epoch: 2 | loss: 0.5877331
	speed: 0.0879s/iter; left time: 2642.4867s
Epoch: 2 cost time: 332.0914714336395
Epoch: 2, Steps: 3751 | Train Loss: 0.5091560 Vali Loss: 1.4083965 Test Loss: 6.2159395
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4243433
	speed: 2.2078s/iter; left time: 66034.3372s
	iters: 200, epoch: 3 | loss: 0.5105959
	speed: 0.0882s/iter; left time: 2628.3663s
	iters: 300, epoch: 3 | loss: 0.5305734
	speed: 0.0882s/iter; left time: 2619.3528s
	iters: 400, epoch: 3 | loss: 0.6090457
	speed: 0.0882s/iter; left time: 2611.5676s
	iters: 500, epoch: 3 | loss: 0.6468744
	speed: 0.0885s/iter; left time: 2611.0477s
	iters: 600, epoch: 3 | loss: 0.4949759
	speed: 0.0885s/iter; left time: 2602.6706s
	iters: 700, epoch: 3 | loss: 0.4707315
	speed: 0.0885s/iter; left time: 2592.8574s
	iters: 800, epoch: 3 | loss: 0.4859262
	speed: 0.0882s/iter; left time: 2576.0221s
	iters: 900, epoch: 3 | loss: 0.4070016
	speed: 0.0883s/iter; left time: 2569.0424s
	iters: 1000, epoch: 3 | loss: 0.4622214
	speed: 0.0885s/iter; left time: 2566.6027s
	iters: 1100, epoch: 3 | loss: 0.4172424
	speed: 0.0883s/iter; left time: 2552.5239s
	iters: 1200, epoch: 3 | loss: 0.4501458
	speed: 0.0883s/iter; left time: 2544.2923s
	iters: 1300, epoch: 3 | loss: 0.4902754
	speed: 0.0882s/iter; left time: 2531.8475s
	iters: 1400, epoch: 3 | loss: 0.5448475
	speed: 0.0882s/iter; left time: 2523.0402s
	iters: 1500, epoch: 3 | loss: 0.5273450
	speed: 0.0883s/iter; left time: 2516.1106s
	iters: 1600, epoch: 3 | loss: 0.4404320
	speed: 0.0888s/iter; left time: 2523.3493s
	iters: 1700, epoch: 3 | loss: 0.5959875
	speed: 0.0885s/iter; left time: 2505.6576s
	iters: 1800, epoch: 3 | loss: 0.4239970
	speed: 0.0883s/iter; left time: 2491.9145s
	iters: 1900, epoch: 3 | loss: 0.4072298
	speed: 0.0885s/iter; left time: 2488.5420s
	iters: 2000, epoch: 3 | loss: 0.4858939
	speed: 0.0882s/iter; left time: 2469.5244s
	iters: 2100, epoch: 3 | loss: 0.3999084
	speed: 0.0882s/iter; left time: 2462.0299s
	iters: 2200, epoch: 3 | loss: 0.4718176
	speed: 0.0882s/iter; left time: 2452.8959s
	iters: 2300, epoch: 3 | loss: 0.5317945
	speed: 0.0889s/iter; left time: 2464.0391s
	iters: 2400, epoch: 3 | loss: 0.5588663
	speed: 0.0885s/iter; left time: 2442.6159s
	iters: 2500, epoch: 3 | loss: 0.5227014
	speed: 0.0885s/iter; left time: 2435.1855s
	iters: 2600, epoch: 3 | loss: 0.3838151
	speed: 0.0885s/iter; left time: 2424.6400s
	iters: 2700, epoch: 3 | loss: 0.4195150
	speed: 0.0883s/iter; left time: 2410.0243s
	iters: 2800, epoch: 3 | loss: 0.5777218
	speed: 0.0882s/iter; left time: 2399.0254s
	iters: 2900, epoch: 3 | loss: 0.5149275
	speed: 0.0883s/iter; left time: 2393.7542s
	iters: 3000, epoch: 3 | loss: 0.3709225
	speed: 0.0887s/iter; left time: 2396.7277s
	iters: 3100, epoch: 3 | loss: 0.4314453
	speed: 0.0885s/iter; left time: 2381.0067s
	iters: 3200, epoch: 3 | loss: 0.4941284
	speed: 0.0886s/iter; left time: 2374.8144s
	iters: 3300, epoch: 3 | loss: 0.3887794
	speed: 0.0887s/iter; left time: 2370.0191s
	iters: 3400, epoch: 3 | loss: 0.4370588
	speed: 0.0883s/iter; left time: 2350.1609s
	iters: 3500, epoch: 3 | loss: 0.5197396
	speed: 0.0882s/iter; left time: 2339.2759s
	iters: 3600, epoch: 3 | loss: 0.4917292
	speed: 0.0882s/iter; left time: 2330.4491s
	iters: 3700, epoch: 3 | loss: 0.3559505
	speed: 0.0887s/iter; left time: 2333.9735s
Epoch: 3 cost time: 332.72840881347656
Epoch: 3, Steps: 3751 | Train Loss: 0.4838010 Vali Loss: 1.3891057 Test Loss: 6.1801901
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4356227
	speed: 2.1838s/iter; left time: 57124.2060s
	iters: 200, epoch: 4 | loss: 0.5722371
	speed: 0.0879s/iter; left time: 2291.4438s
	iters: 300, epoch: 4 | loss: 0.5289544
	speed: 0.0882s/iter; left time: 2290.4217s
	iters: 400, epoch: 4 | loss: 0.5021748
	speed: 0.0880s/iter; left time: 2275.0159s
	iters: 500, epoch: 4 | loss: 0.3888970
	speed: 0.0882s/iter; left time: 2272.0948s
	iters: 600, epoch: 4 | loss: 0.5240359
	speed: 0.0880s/iter; left time: 2256.7337s
	iters: 700, epoch: 4 | loss: 0.4844190
	speed: 0.0880s/iter; left time: 2248.0930s
	iters: 800, epoch: 4 | loss: 0.5541331
	speed: 0.0879s/iter; left time: 2238.5788s
	iters: 900, epoch: 4 | loss: 0.4698151
	speed: 0.0880s/iter; left time: 2232.1348s
	iters: 1000, epoch: 4 | loss: 0.4540150
	speed: 0.0882s/iter; left time: 2226.9040s
	iters: 1100, epoch: 4 | loss: 0.4549596
	speed: 0.0881s/iter; left time: 2215.8097s
	iters: 1200, epoch: 4 | loss: 0.4401575
	speed: 0.0880s/iter; left time: 2204.8013s
	iters: 1300, epoch: 4 | loss: 0.4253072
	speed: 0.0881s/iter; left time: 2198.5413s
	iters: 1400, epoch: 4 | loss: 0.5511075
	speed: 0.0881s/iter; left time: 2189.3364s
	iters: 1500, epoch: 4 | loss: 0.5533960
	speed: 0.0883s/iter; left time: 2185.4579s
	iters: 1600, epoch: 4 | loss: 0.4242002
	speed: 0.0882s/iter; left time: 2176.0616s
	iters: 1700, epoch: 4 | loss: 0.3526464
	speed: 0.0882s/iter; left time: 2166.9710s
	iters: 1800, epoch: 4 | loss: 0.4447992
	speed: 0.0879s/iter; left time: 2151.0021s
	iters: 1900, epoch: 4 | loss: 0.4281517
	speed: 0.0880s/iter; left time: 2142.2919s
	iters: 2000, epoch: 4 | loss: 0.3964005
	speed: 0.0880s/iter; left time: 2133.7429s
	iters: 2100, epoch: 4 | loss: 0.4338902
	speed: 0.0883s/iter; left time: 2133.9969s
	iters: 2200, epoch: 4 | loss: 0.4364306
	speed: 0.0885s/iter; left time: 2127.9458s
	iters: 2300, epoch: 4 | loss: 0.4570968
	speed: 0.0882s/iter; left time: 2114.1410s
	iters: 2400, epoch: 4 | loss: 0.5684645
	speed: 0.0883s/iter; left time: 2106.3205s
	iters: 2500, epoch: 4 | loss: 0.4662393
	speed: 0.0879s/iter; left time: 2087.9623s
	iters: 2600, epoch: 4 | loss: 0.5066897
	speed: 0.0879s/iter; left time: 2080.4207s
	iters: 2700, epoch: 4 | loss: 0.5395145
	speed: 0.0880s/iter; left time: 2073.2660s
	iters: 2800, epoch: 4 | loss: 0.3968840
	speed: 0.0883s/iter; left time: 2071.4659s
	iters: 2900, epoch: 4 | loss: 0.5074454
	speed: 0.0883s/iter; left time: 2062.4635s
	iters: 3000, epoch: 4 | loss: 0.4451135
	speed: 0.0883s/iter; left time: 2053.8978s
	iters: 3100, epoch: 4 | loss: 0.4190603
	speed: 0.0883s/iter; left time: 2044.3656s
	iters: 3200, epoch: 4 | loss: 0.5672901
	speed: 0.0880s/iter; left time: 2029.5837s
	iters: 3300, epoch: 4 | loss: 0.4598011
	speed: 0.0881s/iter; left time: 2022.8066s
	iters: 3400, epoch: 4 | loss: 0.4307419
	speed: 0.0880s/iter; left time: 2010.8762s
	iters: 3500, epoch: 4 | loss: 0.4725991
	speed: 0.0880s/iter; left time: 2001.9913s
	iters: 3600, epoch: 4 | loss: 0.4677775
	speed: 0.0887s/iter; left time: 2009.9044s
	iters: 3700, epoch: 4 | loss: 0.5115462
	speed: 0.0885s/iter; left time: 1996.1985s
Epoch: 4 cost time: 331.7268497943878
Epoch: 4, Steps: 3751 | Train Loss: 0.4742518 Vali Loss: 1.3634113 Test Loss: 6.1683726
Validation loss decreased (1.380149 --> 1.363411).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4907849
	speed: 2.2056s/iter; left time: 49421.5338s
	iters: 200, epoch: 5 | loss: 0.4367384
	speed: 0.0885s/iter; left time: 1973.5917s
	iters: 300, epoch: 5 | loss: 0.4476720
	speed: 0.0886s/iter; left time: 1967.2376s
	iters: 400, epoch: 5 | loss: 0.4855108
	speed: 0.0883s/iter; left time: 1952.2719s
	iters: 500, epoch: 5 | loss: 0.4582908
	speed: 0.0883s/iter; left time: 1943.3588s
	iters: 600, epoch: 5 | loss: 0.3912518
	speed: 0.0883s/iter; left time: 1934.7678s
	iters: 700, epoch: 5 | loss: 0.5155523
	speed: 0.0885s/iter; left time: 1930.6123s
	iters: 800, epoch: 5 | loss: 0.4295879
	speed: 0.0886s/iter; left time: 1922.9888s
	iters: 900, epoch: 5 | loss: 0.5774273
	speed: 0.0884s/iter; left time: 1911.0843s
	iters: 1000, epoch: 5 | loss: 0.4907083
	speed: 0.0884s/iter; left time: 1902.1978s
	iters: 1100, epoch: 5 | loss: 0.4269149
	speed: 0.0887s/iter; left time: 1898.1797s
	iters: 1200, epoch: 5 | loss: 0.4895204
	speed: 0.0885s/iter; left time: 1884.8628s
	iters: 1300, epoch: 5 | loss: 0.4487927
	speed: 0.0886s/iter; left time: 1879.1235s
	iters: 1400, epoch: 5 | loss: 0.4013480
	speed: 0.0883s/iter; left time: 1863.8888s
	iters: 1500, epoch: 5 | loss: 0.3932901
	speed: 0.0883s/iter; left time: 1855.6168s
	iters: 1600, epoch: 5 | loss: 0.5107046
	speed: 0.0884s/iter; left time: 1847.4909s
	iters: 1700, epoch: 5 | loss: 0.4082641
	speed: 0.0889s/iter; left time: 1849.0462s
	iters: 1800, epoch: 5 | loss: 0.4041564
	speed: 0.0885s/iter; left time: 1833.4040s
	iters: 1900, epoch: 5 | loss: 0.4317358
	speed: 0.0887s/iter; left time: 1827.0170s
	iters: 2000, epoch: 5 | loss: 0.3634273
	speed: 0.0888s/iter; left time: 1821.2809s
	iters: 2100, epoch: 5 | loss: 0.6486173
	speed: 0.0884s/iter; left time: 1804.0985s
	iters: 2200, epoch: 5 | loss: 0.5101435
	speed: 0.0883s/iter; left time: 1793.3744s
	iters: 2300, epoch: 5 | loss: 0.4797504
	speed: 0.0884s/iter; left time: 1786.7536s
	iters: 2400, epoch: 5 | loss: 0.3753934
	speed: 0.0888s/iter; left time: 1784.7138s
	iters: 2500, epoch: 5 | loss: 0.3459476
	speed: 0.0886s/iter; left time: 1773.4019s
	iters: 2600, epoch: 5 | loss: 0.4168554
	speed: 0.0888s/iter; left time: 1767.3723s
	iters: 2700, epoch: 5 | loss: 0.3988287
	speed: 0.0887s/iter; left time: 1756.0121s
	iters: 2800, epoch: 5 | loss: 0.4693722
	speed: 0.0884s/iter; left time: 1741.6552s
	iters: 2900, epoch: 5 | loss: 0.4772223
	speed: 0.0884s/iter; left time: 1733.2767s
	iters: 3000, epoch: 5 | loss: 0.4308089
	speed: 0.0884s/iter; left time: 1723.6096s
	iters: 3100, epoch: 5 | loss: 0.5628272
	speed: 0.0888s/iter; left time: 1722.8120s
	iters: 3200, epoch: 5 | loss: 0.4550997
	speed: 0.0887s/iter; left time: 1713.0173s
	iters: 3300, epoch: 5 | loss: 0.4467611
	speed: 0.0889s/iter; left time: 1707.3256s
	iters: 3400, epoch: 5 | loss: 0.4566406
	speed: 0.0887s/iter; left time: 1695.0386s
	iters: 3500, epoch: 5 | loss: 0.5161700
	speed: 0.0884s/iter; left time: 1680.9030s
	iters: 3600, epoch: 5 | loss: 0.4979931
	speed: 0.0885s/iter; left time: 1673.6108s
	iters: 3700, epoch: 5 | loss: 0.3691956
	speed: 0.0884s/iter; left time: 1662.7353s
Epoch: 5 cost time: 333.2299003601074
Epoch: 5, Steps: 3751 | Train Loss: 0.4696463 Vali Loss: 1.3885837 Test Loss: 6.1984634
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4816078
	speed: 2.2026s/iter; left time: 41091.0249s
	iters: 200, epoch: 6 | loss: 0.5665430
	speed: 0.0884s/iter; left time: 1639.7227s
	iters: 300, epoch: 6 | loss: 0.5278216
	speed: 0.0886s/iter; left time: 1635.4417s
	iters: 400, epoch: 6 | loss: 0.4749812
	speed: 0.0883s/iter; left time: 1621.5048s
	iters: 500, epoch: 6 | loss: 0.4475668
	speed: 0.0884s/iter; left time: 1614.6683s
	iters: 600, epoch: 6 | loss: 0.4297244
	speed: 0.0885s/iter; left time: 1606.1054s
	iters: 700, epoch: 6 | loss: 0.5470635
	speed: 0.0883s/iter; left time: 1593.8189s
	iters: 800, epoch: 6 | loss: 0.5237898
	speed: 0.0883s/iter; left time: 1585.5253s
	iters: 900, epoch: 6 | loss: 0.4288153
	speed: 0.0885s/iter; left time: 1580.1648s
	iters: 1000, epoch: 6 | loss: 0.5556691
	speed: 0.0885s/iter; left time: 1571.4511s
	iters: 1100, epoch: 6 | loss: 0.4270946
	speed: 0.0884s/iter; left time: 1560.7911s
	iters: 1200, epoch: 6 | loss: 0.5839157
	speed: 0.0884s/iter; left time: 1552.3215s
	iters: 1300, epoch: 6 | loss: 0.4093392
	speed: 0.0885s/iter; left time: 1544.0839s
	iters: 1400, epoch: 6 | loss: 0.5209112
	speed: 0.0883s/iter; left time: 1533.2313s
	iters: 1500, epoch: 6 | loss: 0.5187678
	speed: 0.0884s/iter; left time: 1526.2617s
	iters: 1600, epoch: 6 | loss: 0.4369196
	speed: 0.0890s/iter; left time: 1527.6375s
	iters: 1700, epoch: 6 | loss: 0.4193009
	speed: 0.0883s/iter; left time: 1506.6195s
	iters: 1800, epoch: 6 | loss: 0.4409583
	speed: 0.0886s/iter; left time: 1503.0228s
	iters: 1900, epoch: 6 | loss: 0.5112833
	speed: 0.0883s/iter; left time: 1487.5819s
	iters: 2000, epoch: 6 | loss: 0.4307358
	speed: 0.0883s/iter; left time: 1479.1885s
	iters: 2100, epoch: 6 | loss: 0.5963659
	speed: 0.0883s/iter; left time: 1471.4637s
	iters: 2200, epoch: 6 | loss: 0.5244011
	speed: 0.0888s/iter; left time: 1470.7624s
	iters: 2300, epoch: 6 | loss: 0.6078826
	speed: 0.0888s/iter; left time: 1461.8251s
	iters: 2400, epoch: 6 | loss: 0.5478019
	speed: 0.0884s/iter; left time: 1446.4898s
	iters: 2500, epoch: 6 | loss: 0.4779203
	speed: 0.0886s/iter; left time: 1440.0254s
	iters: 2600, epoch: 6 | loss: 0.5333058
	speed: 0.0883s/iter; left time: 1426.2946s
	iters: 2700, epoch: 6 | loss: 0.4545917
	speed: 0.0884s/iter; left time: 1419.0613s
	iters: 2800, epoch: 6 | loss: 0.5233549
	speed: 0.0883s/iter; left time: 1408.8400s
	iters: 2900, epoch: 6 | loss: 0.5121584
	speed: 0.0889s/iter; left time: 1410.1087s
	iters: 3000, epoch: 6 | loss: 0.4147522
	speed: 0.0887s/iter; left time: 1397.6032s
	iters: 3100, epoch: 6 | loss: 0.4075623
	speed: 0.0887s/iter; left time: 1388.4142s
	iters: 3200, epoch: 6 | loss: 0.4495691
	speed: 0.0886s/iter; left time: 1378.0421s
	iters: 3300, epoch: 6 | loss: 0.4083729
	speed: 0.0883s/iter; left time: 1365.1637s
	iters: 3400, epoch: 6 | loss: 0.5615820
	speed: 0.0884s/iter; left time: 1358.0138s
	iters: 3500, epoch: 6 | loss: 0.4316067
	speed: 0.0884s/iter; left time: 1348.0251s
	iters: 3600, epoch: 6 | loss: 0.3878290
	speed: 0.0889s/iter; left time: 1346.9309s
	iters: 3700, epoch: 6 | loss: 0.4212685
	speed: 0.0886s/iter; left time: 1334.5150s
Epoch: 6 cost time: 333.11075615882874
Epoch: 6, Steps: 3751 | Train Loss: 0.4673989 Vali Loss: 1.3810184 Test Loss: 6.2008858
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3683971
	speed: 2.1883s/iter; left time: 32616.5834s
	iters: 200, epoch: 7 | loss: 0.5113897
	speed: 0.0879s/iter; left time: 1300.9207s
	iters: 300, epoch: 7 | loss: 0.5125911
	speed: 0.0878s/iter; left time: 1291.6902s
	iters: 400, epoch: 7 | loss: 0.4167304
	speed: 0.0879s/iter; left time: 1283.1475s
	iters: 500, epoch: 7 | loss: 0.4366621
	speed: 0.0879s/iter; left time: 1275.5209s
	iters: 600, epoch: 7 | loss: 0.3910177
	speed: 0.0877s/iter; left time: 1263.7795s
	iters: 700, epoch: 7 | loss: 0.4403167
	speed: 0.0876s/iter; left time: 1253.0013s
	iters: 800, epoch: 7 | loss: 0.5174809
	speed: 0.0877s/iter; left time: 1245.0848s
	iters: 900, epoch: 7 | loss: 0.4096892
	speed: 0.0878s/iter; left time: 1239.0013s
	iters: 1000, epoch: 7 | loss: 0.4731883
	speed: 0.0879s/iter; left time: 1231.7342s
	iters: 1100, epoch: 7 | loss: 0.3949265
	speed: 0.0879s/iter; left time: 1222.4733s
	iters: 1200, epoch: 7 | loss: 0.4090728
	speed: 0.0883s/iter; left time: 1218.8229s
	iters: 1300, epoch: 7 | loss: 0.4264574
	speed: 0.0879s/iter; left time: 1204.6943s
	iters: 1400, epoch: 7 | loss: 0.4677293
	speed: 0.0880s/iter; left time: 1196.8016s
	iters: 1500, epoch: 7 | loss: 0.5397798
	speed: 0.0876s/iter; left time: 1183.5457s
	iters: 1600, epoch: 7 | loss: 0.5676029
	speed: 0.0878s/iter; left time: 1176.6323s
	iters: 1700, epoch: 7 | loss: 0.4699138
	speed: 0.0876s/iter; left time: 1166.0374s
	iters: 1800, epoch: 7 | loss: 0.5653013
	speed: 0.0880s/iter; left time: 1161.3871s
	iters: 1900, epoch: 7 | loss: 0.4373967
	speed: 0.0883s/iter; left time: 1157.0770s
	iters: 2000, epoch: 7 | loss: 0.3936210
	speed: 0.0880s/iter; left time: 1144.4974s
	iters: 2100, epoch: 7 | loss: 0.4751030
	speed: 0.0880s/iter; left time: 1136.0356s
	iters: 2200, epoch: 7 | loss: 0.5026887
	speed: 0.0877s/iter; left time: 1123.3322s
	iters: 2300, epoch: 7 | loss: 0.4971214
	speed: 0.0877s/iter; left time: 1113.9122s
	iters: 2400, epoch: 7 | loss: 0.3527425
	speed: 0.0877s/iter; left time: 1105.2078s
	iters: 2500, epoch: 7 | loss: 0.4042119
	speed: 0.0880s/iter; left time: 1100.1813s
	iters: 2600, epoch: 7 | loss: 0.4524016
	speed: 0.0881s/iter; left time: 1092.5034s
	iters: 2700, epoch: 7 | loss: 0.5035055
	speed: 0.0881s/iter; left time: 1083.9592s
	iters: 2800, epoch: 7 | loss: 0.5571423
	speed: 0.0880s/iter; left time: 1073.7119s
	iters: 2900, epoch: 7 | loss: 0.6448371
	speed: 0.0880s/iter; left time: 1065.3351s
	iters: 3000, epoch: 7 | loss: 0.3881382
	speed: 0.0877s/iter; left time: 1052.4261s
	iters: 3100, epoch: 7 | loss: 0.4800906
	speed: 0.0877s/iter; left time: 1043.8346s
	iters: 3200, epoch: 7 | loss: 0.4557271
	speed: 0.0877s/iter; left time: 1035.2817s
	iters: 3300, epoch: 7 | loss: 0.3890841
	speed: 0.0880s/iter; left time: 1030.0003s
	iters: 3400, epoch: 7 | loss: 0.5111346
	speed: 0.0884s/iter; left time: 1025.3677s
	iters: 3500, epoch: 7 | loss: 0.4954905
	speed: 0.0881s/iter; left time: 1013.7639s
	iters: 3600, epoch: 7 | loss: 0.3465697
	speed: 0.0881s/iter; left time: 1004.5486s
	iters: 3700, epoch: 7 | loss: 0.5641679
	speed: 0.0877s/iter; left time: 991.4458s
Epoch: 7 cost time: 330.9224991798401
Epoch: 7, Steps: 3751 | Train Loss: 0.4662915 Vali Loss: 1.3864831 Test Loss: 6.2186537
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems11_all_96_336_Mamba_custom_ftM_sl336_ll48_pl336_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 294878
test shape: (29487, 1, 336, 521) (29487, 1, 336, 521)
test shape: (29487, 336, 521) (29487, 336, 521)
mse:6.168564796447754, mae:1.0744726657867432
>>>>>>>Overall time: 4361 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
