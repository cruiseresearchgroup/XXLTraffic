Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=822, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems04_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=822, expand=2, factor=1, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems04_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems04_all_96_96_Mamba_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1269344
val 353005
test 353003
	iters: 100, epoch: 1 | loss: 1.5599546
	speed: 0.1142s/iter; left time: 4518.2371s
	iters: 200, epoch: 1 | loss: 1.1857780
	speed: 0.0477s/iter; left time: 1882.6981s
	iters: 300, epoch: 1 | loss: 1.0855503
	speed: 0.0475s/iter; left time: 1871.0398s
	iters: 400, epoch: 1 | loss: 1.0197964
	speed: 0.0475s/iter; left time: 1866.5483s
	iters: 500, epoch: 1 | loss: 0.9757931
	speed: 0.0477s/iter; left time: 1867.7987s
	iters: 600, epoch: 1 | loss: 0.8198978
	speed: 0.0478s/iter; left time: 1865.9333s
	iters: 700, epoch: 1 | loss: 1.0289904
	speed: 0.0477s/iter; left time: 1858.4325s
	iters: 800, epoch: 1 | loss: 0.8453494
	speed: 0.0477s/iter; left time: 1852.8634s
	iters: 900, epoch: 1 | loss: 0.8063264
	speed: 0.0478s/iter; left time: 1852.0722s
	iters: 1000, epoch: 1 | loss: 0.7483888
	speed: 0.0477s/iter; left time: 1842.4784s
	iters: 1100, epoch: 1 | loss: 0.9274598
	speed: 0.0477s/iter; left time: 1839.8879s
	iters: 1200, epoch: 1 | loss: 0.9252157
	speed: 0.0476s/iter; left time: 1832.3036s
	iters: 1300, epoch: 1 | loss: 0.8435601
	speed: 0.0479s/iter; left time: 1839.3452s
	iters: 1400, epoch: 1 | loss: 0.7335284
	speed: 0.0478s/iter; left time: 1829.9922s
	iters: 1500, epoch: 1 | loss: 0.7087486
	speed: 0.0478s/iter; left time: 1823.2578s
	iters: 1600, epoch: 1 | loss: 0.6156087
	speed: 0.0477s/iter; left time: 1816.2912s
	iters: 1700, epoch: 1 | loss: 0.6518200
	speed: 0.0478s/iter; left time: 1814.1248s
	iters: 1800, epoch: 1 | loss: 0.6513366
	speed: 0.0478s/iter; left time: 1810.7170s
	iters: 1900, epoch: 1 | loss: 0.5684292
	speed: 0.0478s/iter; left time: 1803.8788s
	iters: 2000, epoch: 1 | loss: 0.9575034
	speed: 0.0478s/iter; left time: 1801.3204s
	iters: 2100, epoch: 1 | loss: 0.6088851
	speed: 0.0478s/iter; left time: 1794.4420s
	iters: 2200, epoch: 1 | loss: 0.7182111
	speed: 0.0479s/iter; left time: 1794.2427s
	iters: 2300, epoch: 1 | loss: 0.6011861
	speed: 0.0478s/iter; left time: 1785.6470s
	iters: 2400, epoch: 1 | loss: 0.5921869
	speed: 0.0478s/iter; left time: 1780.6587s
	iters: 2500, epoch: 1 | loss: 0.7627540
	speed: 0.0478s/iter; left time: 1775.3959s
	iters: 2600, epoch: 1 | loss: 0.5660449
	speed: 0.0478s/iter; left time: 1772.1361s
	iters: 2700, epoch: 1 | loss: 0.6621602
	speed: 0.0478s/iter; left time: 1765.4322s
	iters: 2800, epoch: 1 | loss: 0.7231516
	speed: 0.0477s/iter; left time: 1760.0378s
	iters: 2900, epoch: 1 | loss: 0.6621593
	speed: 0.0498s/iter; left time: 1828.9269s
	iters: 3000, epoch: 1 | loss: 0.8094804
	speed: 0.0582s/iter; left time: 2133.4654s
	iters: 3100, epoch: 1 | loss: 0.7044475
	speed: 0.0599s/iter; left time: 2191.6288s
	iters: 3200, epoch: 1 | loss: 0.6163450
	speed: 0.0583s/iter; left time: 2127.3925s
	iters: 3300, epoch: 1 | loss: 0.7459618
	speed: 0.0604s/iter; left time: 2195.7414s
	iters: 3400, epoch: 1 | loss: 0.7138558
	speed: 0.0587s/iter; left time: 2129.7528s
	iters: 3500, epoch: 1 | loss: 0.6037826
	speed: 0.0579s/iter; left time: 2092.4855s
	iters: 3600, epoch: 1 | loss: 0.6163489
	speed: 0.0577s/iter; left time: 2080.3616s
	iters: 3700, epoch: 1 | loss: 0.7107991
	speed: 0.0579s/iter; left time: 2080.4287s
	iters: 3800, epoch: 1 | loss: 0.6769993
	speed: 0.0575s/iter; left time: 2060.3429s
	iters: 3900, epoch: 1 | loss: 0.5914972
	speed: 0.0560s/iter; left time: 2002.6416s
Epoch: 1 cost time: 207.72439575195312
Epoch: 1, Steps: 3966 | Train Loss: 0.7863084 Vali Loss: 1.1376791 Test Loss: 1.3163742
Validation loss decreased (inf --> 1.137679).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6492519
	speed: 2.4315s/iter; left time: 86547.8876s
	iters: 200, epoch: 2 | loss: 0.4984998
	speed: 0.0501s/iter; left time: 1778.6968s
	iters: 300, epoch: 2 | loss: 0.7384404
	speed: 0.0501s/iter; left time: 1773.9029s
	iters: 400, epoch: 2 | loss: 0.6399490
	speed: 0.0512s/iter; left time: 1805.7596s
	iters: 500, epoch: 2 | loss: 0.6605325
	speed: 0.0510s/iter; left time: 1794.1384s
	iters: 600, epoch: 2 | loss: 0.6690208
	speed: 0.0532s/iter; left time: 1866.1523s
	iters: 700, epoch: 2 | loss: 0.7827083
	speed: 0.0530s/iter; left time: 1855.7016s
	iters: 800, epoch: 2 | loss: 0.4948485
	speed: 0.0523s/iter; left time: 1825.5579s
	iters: 900, epoch: 2 | loss: 0.5560600
	speed: 0.0528s/iter; left time: 1838.8986s
	iters: 1000, epoch: 2 | loss: 0.5866367
	speed: 0.0529s/iter; left time: 1836.3939s
	iters: 1100, epoch: 2 | loss: 0.5305536
	speed: 0.0531s/iter; left time: 1836.1491s
	iters: 1200, epoch: 2 | loss: 0.6394256
	speed: 0.0541s/iter; left time: 1865.8932s
	iters: 1300, epoch: 2 | loss: 0.5528695
	speed: 0.0524s/iter; left time: 1801.6009s
	iters: 1400, epoch: 2 | loss: 0.6799815
	speed: 0.0527s/iter; left time: 1807.7341s
	iters: 1500, epoch: 2 | loss: 0.5009411
	speed: 0.0539s/iter; left time: 1843.2018s
	iters: 1600, epoch: 2 | loss: 0.8071736
	speed: 0.0546s/iter; left time: 1861.2053s
	iters: 1700, epoch: 2 | loss: 0.5663682
	speed: 0.0532s/iter; left time: 1809.2168s
	iters: 1800, epoch: 2 | loss: 0.6750459
	speed: 0.0531s/iter; left time: 1800.5606s
	iters: 1900, epoch: 2 | loss: 0.6523234
	speed: 0.0544s/iter; left time: 1837.9698s
	iters: 2000, epoch: 2 | loss: 0.6630412
	speed: 0.0521s/iter; left time: 1754.9961s
	iters: 2100, epoch: 2 | loss: 0.5358230
	speed: 0.0543s/iter; left time: 1823.8343s
	iters: 2200, epoch: 2 | loss: 0.6116636
	speed: 0.0536s/iter; left time: 1796.2496s
	iters: 2300, epoch: 2 | loss: 0.5539576
	speed: 0.0541s/iter; left time: 1806.0027s
	iters: 2400, epoch: 2 | loss: 0.6690264
	speed: 0.0531s/iter; left time: 1767.8332s
	iters: 2500, epoch: 2 | loss: 0.9290087
	speed: 0.0540s/iter; left time: 1790.9179s
	iters: 2600, epoch: 2 | loss: 0.5171098
	speed: 0.0563s/iter; left time: 1862.2993s
	iters: 2700, epoch: 2 | loss: 0.5207905
	speed: 0.0580s/iter; left time: 1915.1371s
	iters: 2800, epoch: 2 | loss: 0.6039366
	speed: 0.0585s/iter; left time: 1925.3626s
	iters: 2900, epoch: 2 | loss: 0.7544664
	speed: 0.0563s/iter; left time: 1845.1062s
	iters: 3000, epoch: 2 | loss: 0.5381448
	speed: 0.0546s/iter; left time: 1784.6530s
	iters: 3100, epoch: 2 | loss: 0.5623268
	speed: 0.0542s/iter; left time: 1765.3817s
	iters: 3200, epoch: 2 | loss: 0.4336488
	speed: 0.0559s/iter; left time: 1816.0124s
	iters: 3300, epoch: 2 | loss: 0.5371240
	speed: 0.0552s/iter; left time: 1787.9050s
	iters: 3400, epoch: 2 | loss: 0.5080373
	speed: 0.0572s/iter; left time: 1846.0971s
	iters: 3500, epoch: 2 | loss: 0.5433903
	speed: 0.0596s/iter; left time: 1918.9505s
	iters: 3600, epoch: 2 | loss: 0.6013156
	speed: 0.0597s/iter; left time: 1914.8623s
	iters: 3700, epoch: 2 | loss: 0.7064049
	speed: 0.0585s/iter; left time: 1872.1853s
	iters: 3800, epoch: 2 | loss: 0.5188664
	speed: 0.0556s/iter; left time: 1773.3376s
	iters: 3900, epoch: 2 | loss: 0.5597273
	speed: 0.0527s/iter; left time: 1674.6843s
Epoch: 2 cost time: 215.87978863716125
Epoch: 2, Steps: 3966 | Train Loss: 0.5865199 Vali Loss: 1.1064744 Test Loss: 1.3246258
Validation loss decreased (1.137679 --> 1.106474).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6110604
	speed: 2.4445s/iter; left time: 77316.1131s
	iters: 200, epoch: 3 | loss: 0.4473784
	speed: 0.0583s/iter; left time: 1837.9979s
	iters: 300, epoch: 3 | loss: 0.5364403
	speed: 0.0592s/iter; left time: 1859.1449s
	iters: 400, epoch: 3 | loss: 0.4697127
	speed: 0.0583s/iter; left time: 1826.5631s
	iters: 500, epoch: 3 | loss: 0.5944227
	speed: 0.0585s/iter; left time: 1826.9386s
	iters: 600, epoch: 3 | loss: 0.4335313
	speed: 0.0586s/iter; left time: 1823.7167s
	iters: 700, epoch: 3 | loss: 0.4447085
	speed: 0.0586s/iter; left time: 1817.7380s
	iters: 800, epoch: 3 | loss: 0.6064312
	speed: 0.0586s/iter; left time: 1812.5700s
	iters: 900, epoch: 3 | loss: 0.6889125
	speed: 0.0585s/iter; left time: 1802.2431s
	iters: 1000, epoch: 3 | loss: 0.5345001
	speed: 0.0588s/iter; left time: 1806.2166s
	iters: 1100, epoch: 3 | loss: 0.5717417
	speed: 0.0593s/iter; left time: 1815.8814s
	iters: 1200, epoch: 3 | loss: 0.7617111
	speed: 0.0590s/iter; left time: 1800.0250s
	iters: 1300, epoch: 3 | loss: 0.5435535
	speed: 0.0587s/iter; left time: 1785.9067s
	iters: 1400, epoch: 3 | loss: 0.4897988
	speed: 0.0587s/iter; left time: 1779.1244s
	iters: 1500, epoch: 3 | loss: 0.4346900
	speed: 0.0637s/iter; left time: 1924.2838s
	iters: 1600, epoch: 3 | loss: 0.5125348
	speed: 0.0623s/iter; left time: 1877.0895s
	iters: 1700, epoch: 3 | loss: 0.4610714
	speed: 0.0592s/iter; left time: 1776.4215s
	iters: 1800, epoch: 3 | loss: 0.4999760
	speed: 0.0562s/iter; left time: 1682.8445s
	iters: 1900, epoch: 3 | loss: 0.6832261
	speed: 0.0604s/iter; left time: 1802.7960s
	iters: 2000, epoch: 3 | loss: 0.4732808
	speed: 0.0602s/iter; left time: 1788.3995s
	iters: 2100, epoch: 3 | loss: 0.5756362
	speed: 0.0579s/iter; left time: 1716.4564s
	iters: 2200, epoch: 3 | loss: 0.5634336
	speed: 0.0549s/iter; left time: 1622.5870s
	iters: 2300, epoch: 3 | loss: 0.4573699
	speed: 0.0562s/iter; left time: 1655.1800s
	iters: 2400, epoch: 3 | loss: 0.4581504
	speed: 0.0547s/iter; left time: 1605.2279s
	iters: 2500, epoch: 3 | loss: 0.6224089
	speed: 0.0529s/iter; left time: 1547.1113s
	iters: 2600, epoch: 3 | loss: 0.6043330
	speed: 0.0569s/iter; left time: 1658.7394s
	iters: 2700, epoch: 3 | loss: 0.6272551
	speed: 0.0530s/iter; left time: 1537.4109s
	iters: 2800, epoch: 3 | loss: 0.5132524
	speed: 0.0550s/iter; left time: 1590.4336s
	iters: 2900, epoch: 3 | loss: 0.4756295
	speed: 0.0578s/iter; left time: 1665.9737s
	iters: 3000, epoch: 3 | loss: 0.4008439
	speed: 0.0602s/iter; left time: 1729.5831s
	iters: 3100, epoch: 3 | loss: 0.4656956
	speed: 0.0606s/iter; left time: 1734.6297s
	iters: 3200, epoch: 3 | loss: 0.4610282
	speed: 0.0558s/iter; left time: 1591.2948s
	iters: 3300, epoch: 3 | loss: 0.4768248
	speed: 0.0573s/iter; left time: 1629.7484s
	iters: 3400, epoch: 3 | loss: 0.5139847
	speed: 0.0590s/iter; left time: 1670.9647s
	iters: 3500, epoch: 3 | loss: 0.6930047
	speed: 0.0586s/iter; left time: 1653.5031s
	iters: 3600, epoch: 3 | loss: 0.4410689
	speed: 0.0641s/iter; left time: 1804.1730s
	iters: 3700, epoch: 3 | loss: 0.6018938
	speed: 0.0614s/iter; left time: 1720.3080s
	iters: 3800, epoch: 3 | loss: 0.7126230
	speed: 0.0589s/iter; left time: 1646.0975s
	iters: 3900, epoch: 3 | loss: 0.5104411
	speed: 0.0547s/iter; left time: 1521.4216s
Epoch: 3 cost time: 232.08407020568848
Epoch: 3, Steps: 3966 | Train Loss: 0.5348186 Vali Loss: 1.1141000 Test Loss: 1.3871953
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5011734
	speed: 1.9333s/iter; left time: 53481.8617s
	iters: 200, epoch: 4 | loss: 0.5158738
	speed: 0.0587s/iter; left time: 1616.8014s
	iters: 300, epoch: 4 | loss: 0.5459953
	speed: 0.0592s/iter; left time: 1626.0867s
	iters: 400, epoch: 4 | loss: 0.4718340
	speed: 0.0593s/iter; left time: 1621.6618s
	iters: 500, epoch: 4 | loss: 0.4059611
	speed: 0.0590s/iter; left time: 1609.1501s
	iters: 600, epoch: 4 | loss: 0.3924727
	speed: 0.0590s/iter; left time: 1602.9550s
	iters: 700, epoch: 4 | loss: 0.4493475
	speed: 0.0599s/iter; left time: 1620.5214s
	iters: 800, epoch: 4 | loss: 0.5316101
	speed: 0.0594s/iter; left time: 1601.1159s
	iters: 900, epoch: 4 | loss: 0.4369735
	speed: 0.0592s/iter; left time: 1589.1940s
	iters: 1000, epoch: 4 | loss: 0.5100192
	speed: 0.0591s/iter; left time: 1581.0055s
	iters: 1100, epoch: 4 | loss: 0.4979235
	speed: 0.0589s/iter; left time: 1569.9687s
	iters: 1200, epoch: 4 | loss: 0.5959812
	speed: 0.0592s/iter; left time: 1571.7087s
	iters: 1300, epoch: 4 | loss: 0.4508929
	speed: 0.0587s/iter; left time: 1554.0695s
	iters: 1400, epoch: 4 | loss: 0.3894566
	speed: 0.0622s/iter; left time: 1639.6824s
	iters: 1500, epoch: 4 | loss: 0.6068068
	speed: 0.0613s/iter; left time: 1610.8394s
	iters: 1600, epoch: 4 | loss: 0.6207823
	speed: 0.0575s/iter; left time: 1504.1182s
	iters: 1700, epoch: 4 | loss: 0.4912158
	speed: 0.0555s/iter; left time: 1445.6644s
	iters: 1800, epoch: 4 | loss: 0.5898979
	speed: 0.0547s/iter; left time: 1421.4257s
	iters: 1900, epoch: 4 | loss: 0.5155380
	speed: 0.0542s/iter; left time: 1401.3332s
	iters: 2000, epoch: 4 | loss: 0.4016984
	speed: 0.0543s/iter; left time: 1398.8353s
	iters: 2100, epoch: 4 | loss: 0.4843864
	speed: 0.0541s/iter; left time: 1388.6087s
	iters: 2200, epoch: 4 | loss: 0.5111516
	speed: 0.0539s/iter; left time: 1377.3173s
	iters: 2300, epoch: 4 | loss: 0.4932639
	speed: 0.0538s/iter; left time: 1369.9834s
	iters: 2400, epoch: 4 | loss: 0.4019292
	speed: 0.0545s/iter; left time: 1382.9180s
	iters: 2500, epoch: 4 | loss: 0.5028390
	speed: 0.0562s/iter; left time: 1418.9247s
	iters: 2600, epoch: 4 | loss: 0.4929262
	speed: 0.0557s/iter; left time: 1402.0344s
	iters: 2700, epoch: 4 | loss: 0.4484385
	speed: 0.0558s/iter; left time: 1398.1295s
	iters: 2800, epoch: 4 | loss: 0.3837801
	speed: 0.0571s/iter; left time: 1424.9202s
	iters: 2900, epoch: 4 | loss: 0.5908483
	speed: 0.0563s/iter; left time: 1399.0326s
	iters: 3000, epoch: 4 | loss: 0.4604368
	speed: 0.0563s/iter; left time: 1393.0261s
	iters: 3100, epoch: 4 | loss: 0.5065111
	speed: 0.0556s/iter; left time: 1370.7245s
	iters: 3200, epoch: 4 | loss: 0.5109754
	speed: 0.0559s/iter; left time: 1372.3956s
	iters: 3300, epoch: 4 | loss: 0.6537241
	speed: 0.0563s/iter; left time: 1376.2476s
	iters: 3400, epoch: 4 | loss: 0.4466344
	speed: 0.0557s/iter; left time: 1356.2957s
	iters: 3500, epoch: 4 | loss: 0.6275787
	speed: 0.0554s/iter; left time: 1343.9327s
	iters: 3600, epoch: 4 | loss: 0.7207900
	speed: 0.0552s/iter; left time: 1334.0216s
	iters: 3700, epoch: 4 | loss: 0.5379105
	speed: 0.0546s/iter; left time: 1313.3182s
	iters: 3800, epoch: 4 | loss: 0.4932693
	speed: 0.0547s/iter; left time: 1310.0955s
	iters: 3900, epoch: 4 | loss: 0.4840792
	speed: 0.0544s/iter; left time: 1299.2712s
Epoch: 4 cost time: 226.7497842311859
Epoch: 4, Steps: 3966 | Train Loss: 0.5140572 Vali Loss: 1.1086416 Test Loss: 1.3809249
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5168902
	speed: 2.5608s/iter; left time: 60684.2705s
	iters: 200, epoch: 5 | loss: 0.4757150
	speed: 0.0578s/iter; left time: 1363.2078s
	iters: 300, epoch: 5 | loss: 0.3890783
	speed: 0.0609s/iter; left time: 1431.6743s
	iters: 400, epoch: 5 | loss: 0.4539082
	speed: 0.0585s/iter; left time: 1368.3274s
	iters: 500, epoch: 5 | loss: 0.5590039
	speed: 0.0563s/iter; left time: 1311.5408s
	iters: 600, epoch: 5 | loss: 0.6048810
	speed: 0.0559s/iter; left time: 1297.3049s
	iters: 700, epoch: 5 | loss: 0.4975334
	speed: 0.0550s/iter; left time: 1270.2596s
	iters: 800, epoch: 5 | loss: 0.5821341
	speed: 0.0540s/iter; left time: 1241.1530s
	iters: 900, epoch: 5 | loss: 0.4155214
	speed: 0.0539s/iter; left time: 1233.9774s
	iters: 1000, epoch: 5 | loss: 0.5329095
	speed: 0.0536s/iter; left time: 1222.6620s
	iters: 1100, epoch: 5 | loss: 0.4295043
	speed: 0.0549s/iter; left time: 1245.1874s
	iters: 1200, epoch: 5 | loss: 0.4711865
	speed: 0.0541s/iter; left time: 1222.4338s
	iters: 1300, epoch: 5 | loss: 0.4725442
	speed: 0.0542s/iter; left time: 1219.6182s
	iters: 1400, epoch: 5 | loss: 0.5438240
	speed: 0.0538s/iter; left time: 1204.8428s
	iters: 1500, epoch: 5 | loss: 0.5727562
	speed: 0.0542s/iter; left time: 1207.5531s
	iters: 1600, epoch: 5 | loss: 0.5197410
	speed: 0.0544s/iter; left time: 1206.5618s
	iters: 1700, epoch: 5 | loss: 0.5511475
	speed: 0.0556s/iter; left time: 1227.9780s
	iters: 1800, epoch: 5 | loss: 0.5047533
	speed: 0.0566s/iter; left time: 1245.3439s
	iters: 1900, epoch: 5 | loss: 0.4680923
	speed: 0.0559s/iter; left time: 1224.8110s
	iters: 2000, epoch: 5 | loss: 0.6648661
	speed: 0.0550s/iter; left time: 1199.5917s
	iters: 2100, epoch: 5 | loss: 0.3939780
	speed: 0.0550s/iter; left time: 1193.8067s
	iters: 2200, epoch: 5 | loss: 0.4105974
	speed: 0.0545s/iter; left time: 1176.9337s
	iters: 2300, epoch: 5 | loss: 0.4816042
	speed: 0.0539s/iter; left time: 1158.7361s
	iters: 2400, epoch: 5 | loss: 0.4362825
	speed: 0.0547s/iter; left time: 1171.1673s
	iters: 2500, epoch: 5 | loss: 0.4631067
	speed: 0.0548s/iter; left time: 1167.9011s
	iters: 2600, epoch: 5 | loss: 0.4336921
	speed: 0.0547s/iter; left time: 1159.0525s
	iters: 2700, epoch: 5 | loss: 0.5094144
	speed: 0.0551s/iter; left time: 1162.3142s
	iters: 2800, epoch: 5 | loss: 0.7501597
	speed: 0.0553s/iter; left time: 1161.1639s
	iters: 2900, epoch: 5 | loss: 0.4215590
	speed: 0.0546s/iter; left time: 1141.7390s
	iters: 3000, epoch: 5 | loss: 0.4658459
	speed: 0.0563s/iter; left time: 1171.8994s
	iters: 3100, epoch: 5 | loss: 0.3748226
	speed: 0.0547s/iter; left time: 1131.3669s
	iters: 3200, epoch: 5 | loss: 0.4544441
	speed: 0.0568s/iter; left time: 1170.8262s
	iters: 3300, epoch: 5 | loss: 0.4024047
	speed: 0.0558s/iter; left time: 1143.3502s
	iters: 3400, epoch: 5 | loss: 0.4200709
	speed: 0.0547s/iter; left time: 1116.3972s
	iters: 3500, epoch: 5 | loss: 0.7425913
	speed: 0.0550s/iter; left time: 1116.9474s
	iters: 3600, epoch: 5 | loss: 0.4459498
	speed: 0.0546s/iter; left time: 1102.0863s
	iters: 3700, epoch: 5 | loss: 0.6491569
	speed: 0.0566s/iter; left time: 1138.4578s
	iters: 3800, epoch: 5 | loss: 0.4108843
	speed: 0.0579s/iter; left time: 1157.9632s
	iters: 3900, epoch: 5 | loss: 0.5381987
	speed: 0.0589s/iter; left time: 1172.1256s
Epoch: 5 cost time: 221.82959032058716
Epoch: 5, Steps: 3966 | Train Loss: 0.5045441 Vali Loss: 1.1147745 Test Loss: 1.4268955
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems04_all_96_96_Mamba_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 353003
test shape: (35300, 1, 96, 822) (35300, 1, 96, 822)
test shape: (35300, 96, 822) (35300, 96, 822)
mse:1.3246040344238281, mae:0.9138239622116089
>>>>>>>Overall time: 3219 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
