Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=103, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems05_all_common_flow.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems05_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_96_DLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 600775
val 95012
test 95011
	iters: 100, epoch: 1 | loss: 1.4509969
	speed: 0.0110s/iter; left time: 4117.9911s
	iters: 200, epoch: 1 | loss: 1.4769409
	speed: 0.0079s/iter; left time: 2962.6806s
	iters: 300, epoch: 1 | loss: 1.4196618
	speed: 0.0079s/iter; left time: 2953.8717s
	iters: 400, epoch: 1 | loss: 1.4414551
	speed: 0.0079s/iter; left time: 2956.5130s
	iters: 500, epoch: 1 | loss: 1.4450696
	speed: 0.0079s/iter; left time: 2963.0165s
	iters: 600, epoch: 1 | loss: 1.3870076
	speed: 0.0079s/iter; left time: 2971.4829s
	iters: 700, epoch: 1 | loss: 1.5328780
	speed: 0.0079s/iter; left time: 2958.8763s
	iters: 800, epoch: 1 | loss: 1.5121503
	speed: 0.0079s/iter; left time: 2956.2424s
	iters: 900, epoch: 1 | loss: 1.6701788
	speed: 0.0079s/iter; left time: 2959.3855s
	iters: 1000, epoch: 1 | loss: 1.2768955
	speed: 0.0080s/iter; left time: 2989.9502s
	iters: 1100, epoch: 1 | loss: 1.0847596
	speed: 0.0079s/iter; left time: 2960.1529s
	iters: 1200, epoch: 1 | loss: 1.2218306
	speed: 0.0079s/iter; left time: 2954.2705s
	iters: 1300, epoch: 1 | loss: 1.3083005
	speed: 0.0079s/iter; left time: 2952.9735s
	iters: 1400, epoch: 1 | loss: 1.2380944
	speed: 0.0079s/iter; left time: 2951.8355s
	iters: 1500, epoch: 1 | loss: 1.6374915
	speed: 0.0080s/iter; left time: 2989.9856s
	iters: 1600, epoch: 1 | loss: 1.2366912
	speed: 0.0079s/iter; left time: 2959.4979s
	iters: 1700, epoch: 1 | loss: 1.7364386
	speed: 0.0080s/iter; left time: 2984.8331s
	iters: 1800, epoch: 1 | loss: 1.5180035
	speed: 0.0080s/iter; left time: 2978.3105s
Epoch: 1 cost time: 15.23246169090271
Epoch: 1, Steps: 1877 | Train Loss: 1.4332018 Vali Loss: 1.6356094 Test Loss: 1.6826383
Validation loss decreased (inf --> 1.635609).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1621442
	speed: 0.1561s/iter; left time: 58308.8943s
	iters: 200, epoch: 2 | loss: 1.5105736
	speed: 0.0078s/iter; left time: 2915.4162s
	iters: 300, epoch: 2 | loss: 1.3059744
	speed: 0.0079s/iter; left time: 2933.7587s
	iters: 400, epoch: 2 | loss: 1.3350495
	speed: 0.0078s/iter; left time: 2928.3877s
	iters: 500, epoch: 2 | loss: 1.3572022
	speed: 0.0078s/iter; left time: 2925.9219s
	iters: 600, epoch: 2 | loss: 1.4362271
	speed: 0.0078s/iter; left time: 2891.6595s
	iters: 700, epoch: 2 | loss: 1.3336194
	speed: 0.0078s/iter; left time: 2895.8423s
	iters: 800, epoch: 2 | loss: 1.6345445
	speed: 0.0077s/iter; left time: 2867.8793s
	iters: 900, epoch: 2 | loss: 1.4431716
	speed: 0.0077s/iter; left time: 2878.2442s
	iters: 1000, epoch: 2 | loss: 1.6985488
	speed: 0.0077s/iter; left time: 2870.9482s
	iters: 1100, epoch: 2 | loss: 1.4983432
	speed: 0.0077s/iter; left time: 2882.3963s
	iters: 1200, epoch: 2 | loss: 1.4068303
	speed: 0.0077s/iter; left time: 2881.7129s
	iters: 1300, epoch: 2 | loss: 1.3601300
	speed: 0.0079s/iter; left time: 2926.9151s
	iters: 1400, epoch: 2 | loss: 1.2896094
	speed: 0.0078s/iter; left time: 2896.1880s
	iters: 1500, epoch: 2 | loss: 1.4134705
	speed: 0.0078s/iter; left time: 2893.2305s
	iters: 1600, epoch: 2 | loss: 1.6011981
	speed: 0.0078s/iter; left time: 2899.9962s
	iters: 1700, epoch: 2 | loss: 1.2952077
	speed: 0.0078s/iter; left time: 2885.8357s
	iters: 1800, epoch: 2 | loss: 1.6294432
	speed: 0.0077s/iter; left time: 2869.4862s
Epoch: 2 cost time: 14.73396897315979
Epoch: 2, Steps: 1877 | Train Loss: 1.4186622 Vali Loss: 1.6445758 Test Loss: 1.7010492
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 1.2782892
	speed: 0.1568s/iter; left time: 58258.7284s
	iters: 200, epoch: 3 | loss: 1.2289698
	speed: 0.0078s/iter; left time: 2882.4554s
	iters: 300, epoch: 3 | loss: 1.5546670
	speed: 0.0078s/iter; left time: 2882.7772s
	iters: 400, epoch: 3 | loss: 1.5023010
	speed: 0.0078s/iter; left time: 2878.4091s
	iters: 500, epoch: 3 | loss: 1.4871759
	speed: 0.0078s/iter; left time: 2885.4367s
	iters: 600, epoch: 3 | loss: 1.2782189
	speed: 0.0078s/iter; left time: 2886.7850s
	iters: 700, epoch: 3 | loss: 1.4099408
	speed: 0.0078s/iter; left time: 2903.3644s
	iters: 800, epoch: 3 | loss: 1.4785076
	speed: 0.0079s/iter; left time: 2919.7620s
	iters: 900, epoch: 3 | loss: 1.4448738
	speed: 0.0078s/iter; left time: 2883.5087s
	iters: 1000, epoch: 3 | loss: 1.3314146
	speed: 0.0078s/iter; left time: 2904.3549s
	iters: 1100, epoch: 3 | loss: 1.3465110
	speed: 0.0078s/iter; left time: 2904.0413s
	iters: 1200, epoch: 3 | loss: 1.1347902
	speed: 0.0078s/iter; left time: 2873.7573s
	iters: 1300, epoch: 3 | loss: 1.3736609
	speed: 0.0078s/iter; left time: 2901.7710s
	iters: 1400, epoch: 3 | loss: 1.2368273
	speed: 0.0078s/iter; left time: 2875.3360s
	iters: 1500, epoch: 3 | loss: 1.2586555
	speed: 0.0078s/iter; left time: 2888.0793s
	iters: 1600, epoch: 3 | loss: 1.4725049
	speed: 0.0079s/iter; left time: 2922.7553s
	iters: 1700, epoch: 3 | loss: 1.2912433
	speed: 0.0078s/iter; left time: 2892.0261s
	iters: 1800, epoch: 3 | loss: 1.6125125
	speed: 0.0079s/iter; left time: 2903.6873s
Epoch: 3 cost time: 14.783679962158203
Epoch: 3, Steps: 1877 | Train Loss: 1.4189144 Vali Loss: 1.6486222 Test Loss: 1.7480770
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 4 | loss: 1.5527328
	speed: 0.1570s/iter; left time: 58031.9404s
	iters: 200, epoch: 4 | loss: 1.1378357
	speed: 0.0078s/iter; left time: 2883.0503s
	iters: 300, epoch: 4 | loss: 1.5571290
	speed: 0.0078s/iter; left time: 2877.1796s
	iters: 400, epoch: 4 | loss: 1.6570218
	speed: 0.0078s/iter; left time: 2894.6443s
	iters: 500, epoch: 4 | loss: 1.3933403
	speed: 0.0078s/iter; left time: 2873.6861s
	iters: 600, epoch: 4 | loss: 1.4043257
	speed: 0.0078s/iter; left time: 2872.3472s
	iters: 700, epoch: 4 | loss: 1.4020157
	speed: 0.0078s/iter; left time: 2875.2517s
	iters: 800, epoch: 4 | loss: 1.4272432
	speed: 0.0079s/iter; left time: 2906.1266s
	iters: 900, epoch: 4 | loss: 1.3984116
	speed: 0.0078s/iter; left time: 2869.6701s
	iters: 1000, epoch: 4 | loss: 1.4698895
	speed: 0.0078s/iter; left time: 2891.3323s
	iters: 1100, epoch: 4 | loss: 1.3244438
	speed: 0.0078s/iter; left time: 2892.4284s
	iters: 1200, epoch: 4 | loss: 1.4852992
	speed: 0.0079s/iter; left time: 2907.7020s
	iters: 1300, epoch: 4 | loss: 1.2573686
	speed: 0.0078s/iter; left time: 2875.7561s
	iters: 1400, epoch: 4 | loss: 1.2658364
	speed: 0.0078s/iter; left time: 2863.4248s
	iters: 1500, epoch: 4 | loss: 1.3209600
	speed: 0.0078s/iter; left time: 2867.5319s
	iters: 1600, epoch: 4 | loss: 1.3808093
	speed: 0.0078s/iter; left time: 2877.3543s
	iters: 1700, epoch: 4 | loss: 1.2802463
	speed: 0.0078s/iter; left time: 2870.8230s
	iters: 1800, epoch: 4 | loss: 1.1794349
	speed: 0.0078s/iter; left time: 2869.1263s
Epoch: 4 cost time: 14.791372299194336
Epoch: 4, Steps: 1877 | Train Loss: 1.4188075 Vali Loss: 1.6510564 Test Loss: 1.7552495
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 5 | loss: 1.0842801
	speed: 0.1569s/iter; left time: 57697.1542s
	iters: 200, epoch: 5 | loss: 1.4501138
	speed: 0.0079s/iter; left time: 2914.4177s
	iters: 300, epoch: 5 | loss: 1.3405089
	speed: 0.0080s/iter; left time: 2925.3637s
	iters: 400, epoch: 5 | loss: 1.2506466
	speed: 0.0080s/iter; left time: 2925.9996s
	iters: 500, epoch: 5 | loss: 1.3477813
	speed: 0.0079s/iter; left time: 2907.2318s
	iters: 600, epoch: 5 | loss: 1.4807876
	speed: 0.0079s/iter; left time: 2905.9571s
	iters: 700, epoch: 5 | loss: 1.3878206
	speed: 0.0080s/iter; left time: 2928.1983s
	iters: 800, epoch: 5 | loss: 1.4929901
	speed: 0.0079s/iter; left time: 2902.2392s
	iters: 900, epoch: 5 | loss: 1.5524755
	speed: 0.0079s/iter; left time: 2900.6472s
	iters: 1000, epoch: 5 | loss: 1.4736904
	speed: 0.0079s/iter; left time: 2894.1631s
	iters: 1100, epoch: 5 | loss: 1.0959219
	speed: 0.0078s/iter; left time: 2868.5130s
	iters: 1200, epoch: 5 | loss: 1.5691210
	speed: 0.0079s/iter; left time: 2881.3739s
	iters: 1300, epoch: 5 | loss: 1.5586447
	speed: 0.0079s/iter; left time: 2892.2974s
	iters: 1400, epoch: 5 | loss: 1.3371459
	speed: 0.0080s/iter; left time: 2919.0843s
	iters: 1500, epoch: 5 | loss: 1.2553443
	speed: 0.0079s/iter; left time: 2883.8132s
	iters: 1600, epoch: 5 | loss: 1.1834964
	speed: 0.0079s/iter; left time: 2880.7049s
	iters: 1700, epoch: 5 | loss: 1.5229694
	speed: 0.0079s/iter; left time: 2885.8474s
	iters: 1800, epoch: 5 | loss: 1.4651419
	speed: 0.0079s/iter; left time: 2885.2959s
Epoch: 5 cost time: 14.976483821868896
Epoch: 5, Steps: 1877 | Train Loss: 1.4191027 Vali Loss: 1.6406273 Test Loss: 1.6825479
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 6 | loss: 1.3918035
	speed: 0.1561s/iter; left time: 57113.2870s
	iters: 200, epoch: 6 | loss: 1.3050737
	speed: 0.0079s/iter; left time: 2890.0509s
	iters: 300, epoch: 6 | loss: 1.4814438
	speed: 0.0079s/iter; left time: 2882.1476s
	iters: 400, epoch: 6 | loss: 1.4292806
	speed: 0.0080s/iter; left time: 2939.5078s
	iters: 500, epoch: 6 | loss: 1.4497881
	speed: 0.0079s/iter; left time: 2904.6037s
	iters: 600, epoch: 6 | loss: 1.1375051
	speed: 0.0080s/iter; left time: 2910.2970s
	iters: 700, epoch: 6 | loss: 1.6827446
	speed: 0.0079s/iter; left time: 2894.7435s
	iters: 800, epoch: 6 | loss: 1.4819348
	speed: 0.0079s/iter; left time: 2895.3034s
	iters: 900, epoch: 6 | loss: 1.2528002
	speed: 0.0079s/iter; left time: 2891.9461s
	iters: 1000, epoch: 6 | loss: 1.4224672
	speed: 0.0080s/iter; left time: 2925.4852s
	iters: 1100, epoch: 6 | loss: 1.3968382
	speed: 0.0079s/iter; left time: 2895.5508s
	iters: 1200, epoch: 6 | loss: 1.4237961
	speed: 0.0079s/iter; left time: 2897.6738s
	iters: 1300, epoch: 6 | loss: 1.6240163
	speed: 0.0079s/iter; left time: 2867.3078s
	iters: 1400, epoch: 6 | loss: 1.3251734
	speed: 0.0079s/iter; left time: 2877.5184s
	iters: 1500, epoch: 6 | loss: 1.2166649
	speed: 0.0079s/iter; left time: 2869.1666s
	iters: 1600, epoch: 6 | loss: 1.5456961
	speed: 0.0079s/iter; left time: 2885.9299s
	iters: 1700, epoch: 6 | loss: 1.3618993
	speed: 0.0079s/iter; left time: 2889.9326s
	iters: 1800, epoch: 6 | loss: 1.2638519
	speed: 0.0079s/iter; left time: 2889.9635s
Epoch: 6 cost time: 15.027255058288574
Epoch: 6, Steps: 1877 | Train Loss: 1.4189524 Vali Loss: 1.6509115 Test Loss: 1.7475199
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems05_all_96_96_DLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 95011
test shape: (9501, 1, 96, 103) (9501, 1, 96, 103)
test shape: (9501, 96, 103) (9501, 96, 103)
mse:1.6826399564743042, mae:1.054459571838379
>>>>>>>Overall time: 238 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
