nohup: ignoring input
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=151, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems03_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems03_hour_96_3', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=3, root_path='../../data/pems/', samle_rate=0.01, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_hour_96_3_DLinear_custom_ftM_sl96_ll48_pl3_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.01_sseed7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1499169
val 124077
test 353274
	iters: 100, epoch: 1 | loss: 0.9855495
	speed: 0.0112s/iter; left time: 1046.0876s
	iters: 200, epoch: 1 | loss: 1.1778438
	speed: 0.0073s/iter; left time: 681.3681s
	iters: 300, epoch: 1 | loss: 0.8296543
	speed: 0.0072s/iter; left time: 674.0453s
	iters: 400, epoch: 1 | loss: 0.7455829
	speed: 0.0071s/iter; left time: 659.7688s
Epoch: 1 cost time: 3.834077835083008
Epoch: 1, Steps: 468 | Train Loss: 1.0203854 Vali Loss: 2.4178269 Test Loss: 2.4360058
Validation loss decreased (inf --> 2.417827).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8287841
	speed: 0.0881s/iter; left time: 8198.8399s
	iters: 200, epoch: 2 | loss: 0.9243032
	speed: 0.0095s/iter; left time: 879.8210s
	iters: 300, epoch: 2 | loss: 1.0698593
	speed: 0.0071s/iter; left time: 661.5375s
	iters: 400, epoch: 2 | loss: 0.8178633
	speed: 0.0071s/iter; left time: 662.9334s
Epoch: 2 cost time: 4.036786317825317
Epoch: 2, Steps: 468 | Train Loss: 0.9515471 Vali Loss: 2.4379482 Test Loss: 2.4477999
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 0.7505722
	speed: 0.0836s/iter; left time: 7736.3384s
	iters: 200, epoch: 3 | loss: 1.0735757
	speed: 0.0071s/iter; left time: 652.2157s
	iters: 300, epoch: 3 | loss: 1.1373380
	speed: 0.0069s/iter; left time: 635.9477s
	iters: 400, epoch: 3 | loss: 0.9678661
	speed: 0.0068s/iter; left time: 628.7043s
Epoch: 3 cost time: 3.4126923084259033
Epoch: 3, Steps: 468 | Train Loss: 0.9500535 Vali Loss: 2.4541440 Test Loss: 2.4744396
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 4 | loss: 0.9654427
	speed: 0.0618s/iter; left time: 5689.3484s
	iters: 200, epoch: 4 | loss: 0.7375128
	speed: 0.0081s/iter; left time: 742.1694s
	iters: 300, epoch: 4 | loss: 1.0560886
	speed: 0.0077s/iter; left time: 705.9737s
	iters: 400, epoch: 4 | loss: 1.3206370
	speed: 0.0073s/iter; left time: 673.6146s
Epoch: 4 cost time: 3.9263112545013428
Epoch: 4, Steps: 468 | Train Loss: 0.9501414 Vali Loss: 2.4045050 Test Loss: 2.4084082
Validation loss decreased (2.417827 --> 2.404505).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.9601277
	speed: 0.0698s/iter; left time: 6393.0971s
	iters: 200, epoch: 5 | loss: 1.0777113
	speed: 0.0076s/iter; left time: 693.6981s
	iters: 300, epoch: 5 | loss: 0.7855896
	speed: 0.0077s/iter; left time: 703.2284s
	iters: 400, epoch: 5 | loss: 0.9798304
	speed: 0.0077s/iter; left time: 700.1894s
Epoch: 5 cost time: 3.7076363563537598
Epoch: 5, Steps: 468 | Train Loss: 0.9498322 Vali Loss: 2.4297619 Test Loss: 2.4457052
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 6 | loss: 0.8096894
	speed: 0.0735s/iter; left time: 6703.5143s
	iters: 200, epoch: 6 | loss: 0.8502296
	speed: 0.0072s/iter; left time: 654.6809s
	iters: 300, epoch: 6 | loss: 0.9798818
	speed: 0.0071s/iter; left time: 642.1147s
	iters: 400, epoch: 6 | loss: 0.8327581
	speed: 0.0073s/iter; left time: 664.9815s
Epoch: 6 cost time: 3.534834623336792
Epoch: 6, Steps: 468 | Train Loss: 0.9500398 Vali Loss: 2.4227047 Test Loss: 2.4305313
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 7 | loss: 1.2067498
	speed: 0.0828s/iter; left time: 7505.5892s
	iters: 200, epoch: 7 | loss: 1.2989262
	speed: 0.0071s/iter; left time: 641.9239s
	iters: 300, epoch: 7 | loss: 1.0258663
	speed: 0.0069s/iter; left time: 624.7448s
	iters: 400, epoch: 7 | loss: 1.0966330
	speed: 0.0073s/iter; left time: 657.8765s
Epoch: 7 cost time: 3.5005013942718506
Epoch: 7, Steps: 468 | Train Loss: 0.9498540 Vali Loss: 2.4009871 Test Loss: 2.3986154
Validation loss decreased (2.404505 --> 2.400987).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9467040
	speed: 0.0830s/iter; left time: 7485.3575s
	iters: 200, epoch: 8 | loss: 0.6728871
	speed: 0.0076s/iter; left time: 685.9328s
	iters: 300, epoch: 8 | loss: 0.9048427
	speed: 0.0078s/iter; left time: 705.3214s
	iters: 400, epoch: 8 | loss: 1.0312890
	speed: 0.0079s/iter; left time: 713.7476s
Epoch: 8 cost time: 3.7639570236206055
Epoch: 8, Steps: 468 | Train Loss: 0.9501748 Vali Loss: 2.4092615 Test Loss: 2.3948951
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 9 | loss: 0.8874302
	speed: 0.0695s/iter; left time: 6241.1154s
	iters: 200, epoch: 9 | loss: 0.8841714
	speed: 0.0078s/iter; left time: 699.2592s
	iters: 300, epoch: 9 | loss: 0.9170728
	speed: 0.0074s/iter; left time: 662.3970s
	iters: 400, epoch: 9 | loss: 0.8178837
	speed: 0.0074s/iter; left time: 663.7085s
Epoch: 9 cost time: 3.7017927169799805
Epoch: 9, Steps: 468 | Train Loss: 0.9496397 Vali Loss: 2.4481642 Test Loss: 2.4551082
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 10 | loss: 0.6666141
	speed: 0.0618s/iter; left time: 5519.5038s
	iters: 200, epoch: 10 | loss: 1.1123927
	speed: 0.0075s/iter; left time: 668.2147s
	iters: 300, epoch: 10 | loss: 0.7252830
	speed: 0.0070s/iter; left time: 625.1411s
	iters: 400, epoch: 10 | loss: 0.7997612
	speed: 0.0077s/iter; left time: 682.9453s
Epoch: 10 cost time: 3.5591981410980225
Epoch: 10, Steps: 468 | Train Loss: 0.9498586 Vali Loss: 2.4420176 Test Loss: 2.4568317
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 11 | loss: 1.0257244
	speed: 0.0773s/iter; left time: 6865.6236s
	iters: 200, epoch: 11 | loss: 1.0479976
	speed: 0.0072s/iter; left time: 640.2307s
	iters: 300, epoch: 11 | loss: 1.0435718
	speed: 0.0071s/iter; left time: 627.6505s
	iters: 400, epoch: 11 | loss: 1.0090787
	speed: 0.0070s/iter; left time: 615.7272s
Epoch: 11 cost time: 3.4891388416290283
Epoch: 11, Steps: 468 | Train Loss: 0.9500096 Vali Loss: 2.4453747 Test Loss: 2.4583154
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 12 | loss: 0.9046045
	speed: 0.0642s/iter; left time: 5674.9889s
	iters: 200, epoch: 12 | loss: 0.9420466
	speed: 0.0070s/iter; left time: 621.2380s
	iters: 300, epoch: 12 | loss: 0.9644561
	speed: 0.0070s/iter; left time: 615.0219s
	iters: 400, epoch: 12 | loss: 1.0420445
	speed: 0.0069s/iter; left time: 606.0137s
Epoch: 12 cost time: 3.4172136783599854
Epoch: 12, Steps: 468 | Train Loss: 0.9501602 Vali Loss: 2.4120340 Test Loss: 2.4124434
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems03_hour_96_3_DLinear_custom_ftM_sl96_ll48_pl3_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.01_sseed7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 353274
test shape: (3532, 1, 3, 151) (3532, 1, 3, 151)
test shape: (3532, 3, 151) (3532, 3, 151)
mse:2.398616313934326, mae:1.2833585739135742
>>>>>>>Overall time: 262 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
