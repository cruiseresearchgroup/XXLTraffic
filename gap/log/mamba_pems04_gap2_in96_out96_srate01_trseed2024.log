Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=822, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems04_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=822, expand=2, factor=1, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems04_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems04_all_96_96_Mamba_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1164224
val 247885
test 247883
	iters: 100, epoch: 1 | loss: 1.8329073
	speed: 0.0689s/iter; left time: 2499.8872s
	iters: 200, epoch: 1 | loss: 1.3553495
	speed: 0.0459s/iter; left time: 1660.6213s
	iters: 300, epoch: 1 | loss: 1.0766896
	speed: 0.0459s/iter; left time: 1656.7707s
	iters: 400, epoch: 1 | loss: 0.9385207
	speed: 0.0460s/iter; left time: 1656.2270s
	iters: 500, epoch: 1 | loss: 0.9290453
	speed: 0.0459s/iter; left time: 1647.3370s
	iters: 600, epoch: 1 | loss: 0.9615335
	speed: 0.0459s/iter; left time: 1644.0637s
	iters: 700, epoch: 1 | loss: 0.8294647
	speed: 0.0461s/iter; left time: 1643.4177s
	iters: 800, epoch: 1 | loss: 1.0197595
	speed: 0.0460s/iter; left time: 1636.6813s
	iters: 900, epoch: 1 | loss: 0.8887129
	speed: 0.0460s/iter; left time: 1630.5389s
	iters: 1000, epoch: 1 | loss: 0.7160242
	speed: 0.0461s/iter; left time: 1632.6712s
	iters: 1100, epoch: 1 | loss: 0.6453744
	speed: 0.0460s/iter; left time: 1623.3866s
	iters: 1200, epoch: 1 | loss: 0.8689097
	speed: 0.0461s/iter; left time: 1620.5633s
	iters: 1300, epoch: 1 | loss: 0.7410502
	speed: 0.0460s/iter; left time: 1613.6120s
	iters: 1400, epoch: 1 | loss: 0.7519385
	speed: 0.0461s/iter; left time: 1611.6804s
	iters: 1500, epoch: 1 | loss: 0.7042294
	speed: 0.0460s/iter; left time: 1603.3406s
	iters: 1600, epoch: 1 | loss: 0.9445141
	speed: 0.0460s/iter; left time: 1599.9900s
	iters: 1700, epoch: 1 | loss: 0.6995215
	speed: 0.0460s/iter; left time: 1595.3013s
	iters: 1800, epoch: 1 | loss: 0.8176819
	speed: 0.0461s/iter; left time: 1592.7093s
	iters: 1900, epoch: 1 | loss: 0.7349996
	speed: 0.0460s/iter; left time: 1586.9573s
	iters: 2000, epoch: 1 | loss: 0.7415788
	speed: 0.0460s/iter; left time: 1580.5052s
	iters: 2100, epoch: 1 | loss: 0.7375671
	speed: 0.0461s/iter; left time: 1579.7736s
	iters: 2200, epoch: 1 | loss: 0.7206727
	speed: 0.0460s/iter; left time: 1571.4486s
	iters: 2300, epoch: 1 | loss: 0.6041540
	speed: 0.0460s/iter; left time: 1569.1659s
	iters: 2400, epoch: 1 | loss: 0.6936712
	speed: 0.0460s/iter; left time: 1563.2664s
	iters: 2500, epoch: 1 | loss: 0.6732897
	speed: 0.0461s/iter; left time: 1561.5616s
	iters: 2600, epoch: 1 | loss: 0.7418386
	speed: 0.0460s/iter; left time: 1555.0280s
	iters: 2700, epoch: 1 | loss: 0.8851061
	speed: 0.0467s/iter; left time: 1572.1944s
	iters: 2800, epoch: 1 | loss: 0.6137673
	speed: 0.0462s/iter; left time: 1552.7256s
	iters: 2900, epoch: 1 | loss: 0.6422374
	speed: 0.0459s/iter; left time: 1536.6796s
	iters: 3000, epoch: 1 | loss: 0.7532252
	speed: 0.0463s/iter; left time: 1545.4119s
	iters: 3100, epoch: 1 | loss: 0.7875317
	speed: 0.0458s/iter; left time: 1525.6953s
	iters: 3200, epoch: 1 | loss: 0.7216586
	speed: 0.0467s/iter; left time: 1548.9620s
	iters: 3300, epoch: 1 | loss: 0.7863178
	speed: 0.0462s/iter; left time: 1527.4057s
	iters: 3400, epoch: 1 | loss: 0.6291832
	speed: 0.0465s/iter; left time: 1532.3471s
	iters: 3500, epoch: 1 | loss: 0.6335655
	speed: 0.0461s/iter; left time: 1516.0255s
	iters: 3600, epoch: 1 | loss: 0.7152920
	speed: 0.0462s/iter; left time: 1514.4786s
Epoch: 1 cost time: 170.171382188797
Epoch: 1, Steps: 3638 | Train Loss: 0.8332399 Vali Loss: 1.4059752 Test Loss: 1.2967967
Validation loss decreased (inf --> 1.405975).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6849254
	speed: 1.2224s/iter; left time: 39902.0914s
	iters: 200, epoch: 2 | loss: 0.6055635
	speed: 0.0475s/iter; left time: 1546.8150s
	iters: 300, epoch: 2 | loss: 0.6272982
	speed: 0.0476s/iter; left time: 1545.5846s
	iters: 400, epoch: 2 | loss: 0.6618599
	speed: 0.0475s/iter; left time: 1534.7383s
	iters: 500, epoch: 2 | loss: 0.7134980
	speed: 0.0476s/iter; left time: 1534.9917s
	iters: 600, epoch: 2 | loss: 0.8263806
	speed: 0.0475s/iter; left time: 1526.1455s
	iters: 700, epoch: 2 | loss: 0.7698163
	speed: 0.0475s/iter; left time: 1521.4567s
	iters: 800, epoch: 2 | loss: 0.6352232
	speed: 0.0475s/iter; left time: 1516.0257s
	iters: 900, epoch: 2 | loss: 0.5939702
	speed: 0.0476s/iter; left time: 1515.7278s
	iters: 1000, epoch: 2 | loss: 0.6088135
	speed: 0.0476s/iter; left time: 1509.5215s
	iters: 1100, epoch: 2 | loss: 0.5452706
	speed: 0.0476s/iter; left time: 1505.2411s
	iters: 1200, epoch: 2 | loss: 0.6059046
	speed: 0.0476s/iter; left time: 1500.1217s
	iters: 1300, epoch: 2 | loss: 0.4880342
	speed: 0.0475s/iter; left time: 1493.6038s
	iters: 1400, epoch: 2 | loss: 0.5398083
	speed: 0.0476s/iter; left time: 1490.8517s
	iters: 1500, epoch: 2 | loss: 0.7584566
	speed: 0.0476s/iter; left time: 1486.0980s
	iters: 1600, epoch: 2 | loss: 0.7757481
	speed: 0.0476s/iter; left time: 1481.4298s
	iters: 1700, epoch: 2 | loss: 0.6153961
	speed: 0.0476s/iter; left time: 1477.5462s
	iters: 1800, epoch: 2 | loss: 0.6753118
	speed: 0.0478s/iter; left time: 1478.5122s
	iters: 1900, epoch: 2 | loss: 0.6597879
	speed: 0.0479s/iter; left time: 1478.8007s
	iters: 2000, epoch: 2 | loss: 0.5961645
	speed: 0.0477s/iter; left time: 1465.4035s
	iters: 2100, epoch: 2 | loss: 0.5878993
	speed: 0.0478s/iter; left time: 1464.1407s
	iters: 2200, epoch: 2 | loss: 0.6437632
	speed: 0.0468s/iter; left time: 1428.5866s
	iters: 2300, epoch: 2 | loss: 0.5358595
	speed: 0.0469s/iter; left time: 1426.6504s
	iters: 2400, epoch: 2 | loss: 0.6936190
	speed: 0.0469s/iter; left time: 1422.0318s
	iters: 2500, epoch: 2 | loss: 0.6659622
	speed: 0.0469s/iter; left time: 1418.2148s
	iters: 2600, epoch: 2 | loss: 0.8477629
	speed: 0.0468s/iter; left time: 1410.9751s
	iters: 2700, epoch: 2 | loss: 0.5287949
	speed: 0.0468s/iter; left time: 1404.5762s
	iters: 2800, epoch: 2 | loss: 0.5203000
	speed: 0.0467s/iter; left time: 1398.7066s
	iters: 2900, epoch: 2 | loss: 0.6661465
	speed: 0.0468s/iter; left time: 1397.1474s
	iters: 3000, epoch: 2 | loss: 0.6847616
	speed: 0.0467s/iter; left time: 1388.6695s
	iters: 3100, epoch: 2 | loss: 0.5488392
	speed: 0.0467s/iter; left time: 1384.5808s
	iters: 3200, epoch: 2 | loss: 0.6765447
	speed: 0.0468s/iter; left time: 1383.3428s
	iters: 3300, epoch: 2 | loss: 0.5306289
	speed: 0.0468s/iter; left time: 1377.5725s
	iters: 3400, epoch: 2 | loss: 0.5622628
	speed: 0.0469s/iter; left time: 1376.6778s
	iters: 3500, epoch: 2 | loss: 0.4896925
	speed: 0.0469s/iter; left time: 1372.7320s
	iters: 3600, epoch: 2 | loss: 0.6681813
	speed: 0.0468s/iter; left time: 1364.1322s
Epoch: 2 cost time: 172.7977602481842
Epoch: 2, Steps: 3638 | Train Loss: 0.6193868 Vali Loss: 1.3887197 Test Loss: 1.2503548
Validation loss decreased (1.405975 --> 1.388720).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7141864
	speed: 1.2250s/iter; left time: 35530.6281s
	iters: 200, epoch: 3 | loss: 0.5250831
	speed: 0.0472s/iter; left time: 1363.4681s
	iters: 300, epoch: 3 | loss: 0.5236172
	speed: 0.0472s/iter; left time: 1360.4611s
	iters: 400, epoch: 3 | loss: 0.4670479
	speed: 0.0470s/iter; left time: 1349.7839s
	iters: 500, epoch: 3 | loss: 0.4945185
	speed: 0.0470s/iter; left time: 1344.6981s
	iters: 600, epoch: 3 | loss: 0.6060698
	speed: 0.0471s/iter; left time: 1341.9213s
	iters: 700, epoch: 3 | loss: 0.7156824
	speed: 0.0470s/iter; left time: 1335.1340s
	iters: 800, epoch: 3 | loss: 0.6331463
	speed: 0.0469s/iter; left time: 1328.6273s
	iters: 900, epoch: 3 | loss: 0.5319573
	speed: 0.0469s/iter; left time: 1322.9362s
	iters: 1000, epoch: 3 | loss: 0.5702751
	speed: 0.0470s/iter; left time: 1319.8209s
	iters: 1100, epoch: 3 | loss: 0.5391575
	speed: 0.0469s/iter; left time: 1313.3937s
	iters: 1200, epoch: 3 | loss: 0.5201265
	speed: 0.0468s/iter; left time: 1307.1520s
	iters: 1300, epoch: 3 | loss: 0.5654647
	speed: 0.0469s/iter; left time: 1302.9500s
	iters: 1400, epoch: 3 | loss: 0.6224238
	speed: 0.0468s/iter; left time: 1297.3499s
	iters: 1500, epoch: 3 | loss: 0.5994388
	speed: 0.0469s/iter; left time: 1295.1873s
	iters: 1600, epoch: 3 | loss: 0.6175307
	speed: 0.0468s/iter; left time: 1288.0925s
	iters: 1700, epoch: 3 | loss: 0.4822653
	speed: 0.0467s/iter; left time: 1280.5904s
	iters: 1800, epoch: 3 | loss: 0.5282849
	speed: 0.0470s/iter; left time: 1284.4051s
	iters: 1900, epoch: 3 | loss: 0.5466140
	speed: 0.0471s/iter; left time: 1282.5233s
	iters: 2000, epoch: 3 | loss: 0.4930052
	speed: 0.0470s/iter; left time: 1272.7757s
	iters: 2100, epoch: 3 | loss: 0.6972917
	speed: 0.0469s/iter; left time: 1265.5273s
	iters: 2200, epoch: 3 | loss: 0.4474758
	speed: 0.0469s/iter; left time: 1261.9199s
	iters: 2300, epoch: 3 | loss: 0.6007984
	speed: 0.0467s/iter; left time: 1252.4921s
	iters: 2400, epoch: 3 | loss: 0.5470256
	speed: 0.0467s/iter; left time: 1247.0257s
	iters: 2500, epoch: 3 | loss: 0.6637766
	speed: 0.0467s/iter; left time: 1242.6889s
	iters: 2600, epoch: 3 | loss: 0.5666344
	speed: 0.0467s/iter; left time: 1237.6006s
	iters: 2700, epoch: 3 | loss: 0.5374672
	speed: 0.0467s/iter; left time: 1232.7809s
	iters: 2800, epoch: 3 | loss: 0.5226852
	speed: 0.0466s/iter; left time: 1226.9755s
	iters: 2900, epoch: 3 | loss: 0.4610634
	speed: 0.0467s/iter; left time: 1222.6575s
	iters: 3000, epoch: 3 | loss: 0.5593175
	speed: 0.0467s/iter; left time: 1218.2558s
	iters: 3100, epoch: 3 | loss: 0.5136254
	speed: 0.0466s/iter; left time: 1212.5228s
	iters: 3200, epoch: 3 | loss: 0.5753387
	speed: 0.0467s/iter; left time: 1208.6443s
	iters: 3300, epoch: 3 | loss: 0.5671135
	speed: 0.0467s/iter; left time: 1204.0986s
	iters: 3400, epoch: 3 | loss: 0.6422102
	speed: 0.0467s/iter; left time: 1199.4794s
	iters: 3500, epoch: 3 | loss: 0.5093127
	speed: 0.0467s/iter; left time: 1194.6463s
	iters: 3600, epoch: 3 | loss: 0.5393078
	speed: 0.0466s/iter; left time: 1188.9224s
Epoch: 3 cost time: 171.50219249725342
Epoch: 3, Steps: 3638 | Train Loss: 0.5662815 Vali Loss: 1.3448019 Test Loss: 1.2200963
Validation loss decreased (1.388720 --> 1.344802).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5482953
	speed: 1.2100s/iter; left time: 30692.9078s
	iters: 200, epoch: 4 | loss: 0.5363556
	speed: 0.0475s/iter; left time: 1200.7389s
	iters: 300, epoch: 4 | loss: 0.4932387
	speed: 0.0471s/iter; left time: 1184.8593s
	iters: 400, epoch: 4 | loss: 0.4721713
	speed: 0.0471s/iter; left time: 1181.7680s
	iters: 500, epoch: 4 | loss: 0.6600600
	speed: 0.0470s/iter; left time: 1174.3685s
	iters: 600, epoch: 4 | loss: 0.5102162
	speed: 0.0471s/iter; left time: 1170.1534s
	iters: 700, epoch: 4 | loss: 0.5263343
	speed: 0.0471s/iter; left time: 1165.6188s
	iters: 800, epoch: 4 | loss: 0.5702004
	speed: 0.0470s/iter; left time: 1158.5926s
	iters: 900, epoch: 4 | loss: 0.4552439
	speed: 0.0470s/iter; left time: 1154.9695s
	iters: 1000, epoch: 4 | loss: 0.5600058
	speed: 0.0470s/iter; left time: 1149.0989s
	iters: 1100, epoch: 4 | loss: 0.4337278
	speed: 0.0469s/iter; left time: 1143.6213s
	iters: 1200, epoch: 4 | loss: 0.5896134
	speed: 0.0469s/iter; left time: 1139.0042s
	iters: 1300, epoch: 4 | loss: 0.4763049
	speed: 0.0470s/iter; left time: 1135.3197s
	iters: 1400, epoch: 4 | loss: 0.7337431
	speed: 0.0470s/iter; left time: 1130.2625s
	iters: 1500, epoch: 4 | loss: 0.5040392
	speed: 0.0470s/iter; left time: 1127.0914s
	iters: 1600, epoch: 4 | loss: 0.5162967
	speed: 0.0472s/iter; left time: 1125.5169s
	iters: 1700, epoch: 4 | loss: 0.6405616
	speed: 0.0474s/iter; left time: 1126.4093s
	iters: 1800, epoch: 4 | loss: 0.6005412
	speed: 0.0473s/iter; left time: 1119.5313s
	iters: 1900, epoch: 4 | loss: 0.5210511
	speed: 0.0471s/iter; left time: 1110.8222s
	iters: 2000, epoch: 4 | loss: 0.5703824
	speed: 0.0470s/iter; left time: 1103.8845s
	iters: 2100, epoch: 4 | loss: 0.6183983
	speed: 0.0470s/iter; left time: 1097.8472s
	iters: 2200, epoch: 4 | loss: 0.7351353
	speed: 0.0470s/iter; left time: 1094.0803s
	iters: 2300, epoch: 4 | loss: 0.4652773
	speed: 0.0472s/iter; left time: 1094.6184s
	iters: 2400, epoch: 4 | loss: 0.5150313
	speed: 0.0469s/iter; left time: 1081.8799s
	iters: 2500, epoch: 4 | loss: 0.5163028
	speed: 0.0471s/iter; left time: 1080.9977s
	iters: 2600, epoch: 4 | loss: 0.6904774
	speed: 0.0470s/iter; left time: 1074.3751s
	iters: 2700, epoch: 4 | loss: 0.6387946
	speed: 0.0469s/iter; left time: 1068.7088s
	iters: 2800, epoch: 4 | loss: 0.4821668
	speed: 0.0469s/iter; left time: 1063.0739s
	iters: 2900, epoch: 4 | loss: 0.5293676
	speed: 0.0469s/iter; left time: 1058.9172s
	iters: 3000, epoch: 4 | loss: 0.4673473
	speed: 0.0469s/iter; left time: 1054.2154s
	iters: 3100, epoch: 4 | loss: 0.7219463
	speed: 0.0470s/iter; left time: 1050.5895s
	iters: 3200, epoch: 4 | loss: 0.5959041
	speed: 0.0471s/iter; left time: 1048.7819s
	iters: 3300, epoch: 4 | loss: 0.6157479
	speed: 0.0470s/iter; left time: 1041.2770s
	iters: 3400, epoch: 4 | loss: 0.5789294
	speed: 0.0472s/iter; left time: 1041.4008s
	iters: 3500, epoch: 4 | loss: 0.5815547
	speed: 0.0476s/iter; left time: 1045.2719s
	iters: 3600, epoch: 4 | loss: 0.4470253
	speed: 0.0472s/iter; left time: 1032.8220s
Epoch: 4 cost time: 172.29285430908203
Epoch: 4, Steps: 3638 | Train Loss: 0.5434949 Vali Loss: 1.3871036 Test Loss: 1.2150598
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5585430
	speed: 1.1938s/iter; left time: 25939.8361s
	iters: 200, epoch: 5 | loss: 0.6887818
	speed: 0.0476s/iter; left time: 1029.7630s
	iters: 300, epoch: 5 | loss: 0.5722382
	speed: 0.0476s/iter; left time: 1024.2596s
	iters: 400, epoch: 5 | loss: 0.5031641
	speed: 0.0477s/iter; left time: 1022.9608s
	iters: 500, epoch: 5 | loss: 0.7074103
	speed: 0.0476s/iter; left time: 1015.2051s
	iters: 600, epoch: 5 | loss: 0.4577399
	speed: 0.0469s/iter; left time: 994.9826s
	iters: 700, epoch: 5 | loss: 0.5831617
	speed: 0.0470s/iter; left time: 992.2541s
	iters: 800, epoch: 5 | loss: 0.4454925
	speed: 0.0467s/iter; left time: 982.0697s
	iters: 900, epoch: 5 | loss: 0.5320590
	speed: 0.0468s/iter; left time: 978.7560s
	iters: 1000, epoch: 5 | loss: 0.4691353
	speed: 0.0468s/iter; left time: 974.6115s
	iters: 1100, epoch: 5 | loss: 0.5041288
	speed: 0.0468s/iter; left time: 969.5931s
	iters: 1200, epoch: 5 | loss: 0.5356947
	speed: 0.0468s/iter; left time: 965.5589s
	iters: 1300, epoch: 5 | loss: 0.5003730
	speed: 0.0467s/iter; left time: 959.0314s
	iters: 1400, epoch: 5 | loss: 0.4826729
	speed: 0.0468s/iter; left time: 955.1521s
	iters: 1500, epoch: 5 | loss: 0.4082595
	speed: 0.0467s/iter; left time: 950.2991s
	iters: 1600, epoch: 5 | loss: 0.6514886
	speed: 0.0468s/iter; left time: 947.0264s
	iters: 1700, epoch: 5 | loss: 0.5977879
	speed: 0.0468s/iter; left time: 941.0517s
	iters: 1800, epoch: 5 | loss: 0.5250036
	speed: 0.0470s/iter; left time: 941.0131s
	iters: 1900, epoch: 5 | loss: 0.5783235
	speed: 0.0469s/iter; left time: 933.8524s
	iters: 2000, epoch: 5 | loss: 0.5042351
	speed: 0.0468s/iter; left time: 927.0154s
	iters: 2100, epoch: 5 | loss: 0.5251206
	speed: 0.0468s/iter; left time: 924.2259s
	iters: 2200, epoch: 5 | loss: 0.5319685
	speed: 0.0469s/iter; left time: 921.0296s
	iters: 2300, epoch: 5 | loss: 0.4749386
	speed: 0.0473s/iter; left time: 923.1969s
	iters: 2400, epoch: 5 | loss: 0.4614544
	speed: 0.0471s/iter; left time: 915.8514s
	iters: 2500, epoch: 5 | loss: 0.4797703
	speed: 0.0473s/iter; left time: 914.2081s
	iters: 2600, epoch: 5 | loss: 0.4562527
	speed: 0.0469s/iter; left time: 902.7351s
	iters: 2700, epoch: 5 | loss: 0.5008065
	speed: 0.0469s/iter; left time: 897.9432s
	iters: 2800, epoch: 5 | loss: 0.5483823
	speed: 0.0469s/iter; left time: 891.6959s
	iters: 2900, epoch: 5 | loss: 0.4394314
	speed: 0.0468s/iter; left time: 886.2909s
	iters: 3000, epoch: 5 | loss: 0.4736671
	speed: 0.0468s/iter; left time: 881.3228s
	iters: 3100, epoch: 5 | loss: 0.7024131
	speed: 0.0468s/iter; left time: 876.3686s
	iters: 3200, epoch: 5 | loss: 0.4912775
	speed: 0.0470s/iter; left time: 874.9487s
	iters: 3300, epoch: 5 | loss: 0.6201952
	speed: 0.0470s/iter; left time: 871.0882s
	iters: 3400, epoch: 5 | loss: 0.5019773
	speed: 0.0474s/iter; left time: 873.2243s
	iters: 3500, epoch: 5 | loss: 0.6537949
	speed: 0.0474s/iter; left time: 868.4587s
	iters: 3600, epoch: 5 | loss: 0.4840651
	speed: 0.0473s/iter; left time: 861.3643s
Epoch: 5 cost time: 172.12035202980042
Epoch: 5, Steps: 3638 | Train Loss: 0.5325506 Vali Loss: 1.4037350 Test Loss: 1.2372493
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6951440
	speed: 1.2048s/iter; left time: 21796.5802s
	iters: 200, epoch: 6 | loss: 0.5198241
	speed: 0.0476s/iter; left time: 856.1944s
	iters: 300, epoch: 6 | loss: 0.4506704
	speed: 0.0475s/iter; left time: 850.1424s
	iters: 400, epoch: 6 | loss: 0.4288011
	speed: 0.0475s/iter; left time: 845.4516s
	iters: 500, epoch: 6 | loss: 0.5056052
	speed: 0.0469s/iter; left time: 829.7382s
	iters: 600, epoch: 6 | loss: 0.7137842
	speed: 0.0467s/iter; left time: 822.3040s
	iters: 700, epoch: 6 | loss: 0.4281572
	speed: 0.0468s/iter; left time: 818.4289s
	iters: 800, epoch: 6 | loss: 0.4983217
	speed: 0.0467s/iter; left time: 812.8221s
	iters: 900, epoch: 6 | loss: 0.4972978
	speed: 0.0467s/iter; left time: 807.4103s
	iters: 1000, epoch: 6 | loss: 0.4784398
	speed: 0.0467s/iter; left time: 802.1725s
	iters: 1100, epoch: 6 | loss: 0.4716787
	speed: 0.0467s/iter; left time: 797.7641s
	iters: 1200, epoch: 6 | loss: 0.5079799
	speed: 0.0467s/iter; left time: 793.0828s
	iters: 1300, epoch: 6 | loss: 0.7118884
	speed: 0.0468s/iter; left time: 790.1578s
	iters: 1400, epoch: 6 | loss: 0.4037661
	speed: 0.0467s/iter; left time: 783.5762s
	iters: 1500, epoch: 6 | loss: 0.5518885
	speed: 0.0466s/iter; left time: 778.3747s
	iters: 1600, epoch: 6 | loss: 0.4814889
	speed: 0.0466s/iter; left time: 772.6185s
	iters: 1700, epoch: 6 | loss: 0.5048828
	speed: 0.0466s/iter; left time: 769.1194s
	iters: 1800, epoch: 6 | loss: 0.6393129
	speed: 0.0466s/iter; left time: 764.5181s
	iters: 1900, epoch: 6 | loss: 0.5729902
	speed: 0.0468s/iter; left time: 761.8011s
	iters: 2000, epoch: 6 | loss: 0.5275184
	speed: 0.0471s/iter; left time: 762.4074s
	iters: 2100, epoch: 6 | loss: 0.5557019
	speed: 0.0467s/iter; left time: 751.4509s
	iters: 2200, epoch: 6 | loss: 0.5124190
	speed: 0.0466s/iter; left time: 745.0831s
	iters: 2300, epoch: 6 | loss: 0.5503421
	speed: 0.0467s/iter; left time: 742.2175s
	iters: 2400, epoch: 6 | loss: 0.5601671
	speed: 0.0467s/iter; left time: 737.8340s
	iters: 2500, epoch: 6 | loss: 0.4734149
	speed: 0.0467s/iter; left time: 732.6444s
	iters: 2600, epoch: 6 | loss: 0.4813617
	speed: 0.0467s/iter; left time: 727.4213s
	iters: 2700, epoch: 6 | loss: 0.4773763
	speed: 0.0466s/iter; left time: 722.5757s
	iters: 2800, epoch: 6 | loss: 0.5987989
	speed: 0.0466s/iter; left time: 717.2064s
	iters: 2900, epoch: 6 | loss: 0.4622441
	speed: 0.0466s/iter; left time: 712.2362s
	iters: 3000, epoch: 6 | loss: 0.4691901
	speed: 0.0466s/iter; left time: 708.3432s
	iters: 3100, epoch: 6 | loss: 0.5733820
	speed: 0.0466s/iter; left time: 703.3132s
	iters: 3200, epoch: 6 | loss: 0.4625239
	speed: 0.0466s/iter; left time: 698.2198s
	iters: 3300, epoch: 6 | loss: 0.4435083
	speed: 0.0467s/iter; left time: 695.3277s
	iters: 3400, epoch: 6 | loss: 0.4439566
	speed: 0.0466s/iter; left time: 688.7023s
	iters: 3500, epoch: 6 | loss: 0.5873089
	speed: 0.0466s/iter; left time: 685.0305s
	iters: 3600, epoch: 6 | loss: 0.4793601
	speed: 0.0466s/iter; left time: 679.2763s
Epoch: 6 cost time: 171.20913910865784
Epoch: 6, Steps: 3638 | Train Loss: 0.5272061 Vali Loss: 1.4176054 Test Loss: 1.2357943
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems04_all_96_96_Mamba_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 247883
test shape: (24788, 1, 96, 822) (24788, 1, 96, 822)
test shape: (24788, 96, 822) (24788, 96, 822)
mse:1.220097303390503, mae:0.8934009671211243
>>>>>>>Overall time: 2548 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
