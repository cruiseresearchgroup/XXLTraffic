Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=130, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems06_all_common_flow.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems06_all_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_all_96_720_DLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 742470
val 141828
test 141826
	iters: 100, epoch: 1 | loss: 1.6182725
	speed: 0.0310s/iter; left time: 14369.2376s
	iters: 200, epoch: 1 | loss: 1.6595291
	speed: 0.0283s/iter; left time: 13145.0376s
	iters: 300, epoch: 1 | loss: 1.7764356
	speed: 0.0284s/iter; left time: 13162.5123s
	iters: 400, epoch: 1 | loss: 1.3459914
	speed: 0.0283s/iter; left time: 13135.7515s
	iters: 500, epoch: 1 | loss: 1.5407485
	speed: 0.0283s/iter; left time: 13138.4589s
	iters: 600, epoch: 1 | loss: 1.6616273
	speed: 0.0283s/iter; left time: 13126.5889s
	iters: 700, epoch: 1 | loss: 1.5264623
	speed: 0.0284s/iter; left time: 13147.7116s
	iters: 800, epoch: 1 | loss: 1.3681849
	speed: 0.0284s/iter; left time: 13151.4580s
	iters: 900, epoch: 1 | loss: 1.4226389
	speed: 0.0284s/iter; left time: 13149.1310s
	iters: 1000, epoch: 1 | loss: 1.3275180
	speed: 0.0284s/iter; left time: 13150.8364s
	iters: 1100, epoch: 1 | loss: 1.8244818
	speed: 0.0284s/iter; left time: 13140.2760s
	iters: 1200, epoch: 1 | loss: 1.4555326
	speed: 0.0284s/iter; left time: 13145.2594s
	iters: 1300, epoch: 1 | loss: 1.3533081
	speed: 0.0285s/iter; left time: 13165.2060s
	iters: 1400, epoch: 1 | loss: 1.3880401
	speed: 0.0285s/iter; left time: 13169.0676s
	iters: 1500, epoch: 1 | loss: 1.3105798
	speed: 0.0284s/iter; left time: 13150.3035s
	iters: 1600, epoch: 1 | loss: 1.3034438
	speed: 0.0285s/iter; left time: 13185.3448s
	iters: 1700, epoch: 1 | loss: 1.5200140
	speed: 0.0285s/iter; left time: 13165.7353s
	iters: 1800, epoch: 1 | loss: 1.3562247
	speed: 0.0285s/iter; left time: 13155.2034s
	iters: 1900, epoch: 1 | loss: 1.3830231
	speed: 0.0285s/iter; left time: 13147.0964s
	iters: 2000, epoch: 1 | loss: 1.5230511
	speed: 0.0285s/iter; left time: 13155.1066s
	iters: 2100, epoch: 1 | loss: 1.3451520
	speed: 0.0285s/iter; left time: 13173.3912s
	iters: 2200, epoch: 1 | loss: 1.4325814
	speed: 0.0285s/iter; left time: 13141.4844s
	iters: 2300, epoch: 1 | loss: 1.2577652
	speed: 0.0286s/iter; left time: 13187.0081s
Epoch: 1 cost time: 66.25578808784485
Epoch: 1, Steps: 2320 | Train Loss: 1.4131136 Vali Loss: 1.3955467 Test Loss: 1.5400707
Validation loss decreased (inf --> 1.395547).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2520490
	speed: 0.5377s/iter; left time: 248170.0365s
	iters: 200, epoch: 2 | loss: 1.5467449
	speed: 0.0285s/iter; left time: 13133.9537s
	iters: 300, epoch: 2 | loss: 1.3696706
	speed: 0.0284s/iter; left time: 13098.2050s
	iters: 400, epoch: 2 | loss: 1.2023352
	speed: 0.0284s/iter; left time: 13101.9714s
	iters: 500, epoch: 2 | loss: 1.6197702
	speed: 0.0284s/iter; left time: 13084.3103s
	iters: 600, epoch: 2 | loss: 1.2660474
	speed: 0.0284s/iter; left time: 13096.0576s
	iters: 700, epoch: 2 | loss: 1.3700852
	speed: 0.0284s/iter; left time: 13111.7564s
	iters: 800, epoch: 2 | loss: 1.4893513
	speed: 0.0284s/iter; left time: 13087.9047s
	iters: 900, epoch: 2 | loss: 1.4160686
	speed: 0.0284s/iter; left time: 13105.1405s
	iters: 1000, epoch: 2 | loss: 1.5340208
	speed: 0.0284s/iter; left time: 13093.6403s
	iters: 1100, epoch: 2 | loss: 1.6156286
	speed: 0.0285s/iter; left time: 13113.4763s
	iters: 1200, epoch: 2 | loss: 1.2976289
	speed: 0.0284s/iter; left time: 13077.7160s
	iters: 1300, epoch: 2 | loss: 1.2385099
	speed: 0.0285s/iter; left time: 13103.3837s
	iters: 1400, epoch: 2 | loss: 1.4690151
	speed: 0.0284s/iter; left time: 13091.6783s
	iters: 1500, epoch: 2 | loss: 1.4471873
	speed: 0.0284s/iter; left time: 13089.6064s
	iters: 1600, epoch: 2 | loss: 1.5193295
	speed: 0.0285s/iter; left time: 13112.9322s
	iters: 1700, epoch: 2 | loss: 1.5578502
	speed: 0.0284s/iter; left time: 13083.1882s
	iters: 1800, epoch: 2 | loss: 1.5162939
	speed: 0.0285s/iter; left time: 13085.5169s
	iters: 1900, epoch: 2 | loss: 1.5663871
	speed: 0.0285s/iter; left time: 13084.2555s
	iters: 2000, epoch: 2 | loss: 1.4494444
	speed: 0.0285s/iter; left time: 13096.8968s
	iters: 2100, epoch: 2 | loss: 1.3541054
	speed: 0.0285s/iter; left time: 13090.4658s
	iters: 2200, epoch: 2 | loss: 1.1118858
	speed: 0.0285s/iter; left time: 13084.6508s
	iters: 2300, epoch: 2 | loss: 1.3201844
	speed: 0.0284s/iter; left time: 13061.9211s
Epoch: 2 cost time: 66.11477518081665
Epoch: 2, Steps: 2320 | Train Loss: 1.4069715 Vali Loss: 1.3813392 Test Loss: 1.5115384
Validation loss decreased (1.395547 --> 1.381339).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2776669
	speed: 0.4404s/iter; left time: 202263.1245s
	iters: 200, epoch: 3 | loss: 1.3970145
	speed: 0.0284s/iter; left time: 13020.1517s
	iters: 300, epoch: 3 | loss: 1.2134230
	speed: 0.0283s/iter; left time: 12994.9425s
	iters: 400, epoch: 3 | loss: 1.3182108
	speed: 0.0283s/iter; left time: 12994.1427s
	iters: 500, epoch: 3 | loss: 1.3324888
	speed: 0.0283s/iter; left time: 13000.0625s
	iters: 600, epoch: 3 | loss: 1.4394504
	speed: 0.0283s/iter; left time: 12995.0757s
	iters: 700, epoch: 3 | loss: 1.2776273
	speed: 0.0284s/iter; left time: 13048.5917s
	iters: 800, epoch: 3 | loss: 1.3237067
	speed: 0.0284s/iter; left time: 13004.0048s
	iters: 900, epoch: 3 | loss: 1.5546663
	speed: 0.0283s/iter; left time: 12992.1513s
	iters: 1000, epoch: 3 | loss: 1.4634315
	speed: 0.0284s/iter; left time: 13032.0499s
	iters: 1100, epoch: 3 | loss: 1.0648719
	speed: 0.0284s/iter; left time: 13034.0501s
	iters: 1200, epoch: 3 | loss: 1.2951266
	speed: 0.0285s/iter; left time: 13042.1533s
	iters: 1300, epoch: 3 | loss: 1.2889566
	speed: 0.0283s/iter; left time: 12982.8799s
	iters: 1400, epoch: 3 | loss: 1.7127494
	speed: 0.0284s/iter; left time: 13001.8414s
	iters: 1500, epoch: 3 | loss: 1.4019084
	speed: 0.0284s/iter; left time: 12996.7132s
	iters: 1600, epoch: 3 | loss: 1.3254296
	speed: 0.0284s/iter; left time: 12982.1007s
	iters: 1700, epoch: 3 | loss: 1.2169863
	speed: 0.0284s/iter; left time: 12985.1384s
	iters: 1800, epoch: 3 | loss: 1.4243739
	speed: 0.0284s/iter; left time: 12972.9782s
	iters: 1900, epoch: 3 | loss: 1.3062289
	speed: 0.0284s/iter; left time: 12980.4607s
	iters: 2000, epoch: 3 | loss: 1.1175508
	speed: 0.0284s/iter; left time: 12966.7472s
	iters: 2100, epoch: 3 | loss: 1.3602248
	speed: 0.0284s/iter; left time: 12973.7925s
	iters: 2200, epoch: 3 | loss: 1.4454980
	speed: 0.0284s/iter; left time: 12980.9131s
	iters: 2300, epoch: 3 | loss: 1.2770268
	speed: 0.0284s/iter; left time: 12966.8800s
Epoch: 3 cost time: 65.9514229297638
Epoch: 3, Steps: 2320 | Train Loss: 1.4071192 Vali Loss: 1.3836734 Test Loss: 1.5152711
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 4 | loss: 1.2367027
	speed: 0.4418s/iter; left time: 201894.5838s
	iters: 200, epoch: 4 | loss: 1.1979529
	speed: 0.0288s/iter; left time: 13156.7915s
	iters: 300, epoch: 4 | loss: 1.4943976
	speed: 0.0287s/iter; left time: 13129.2086s
	iters: 400, epoch: 4 | loss: 1.5118059
	speed: 0.0288s/iter; left time: 13146.5788s
	iters: 500, epoch: 4 | loss: 1.4578562
	speed: 0.0287s/iter; left time: 13109.8339s
	iters: 600, epoch: 4 | loss: 1.3857456
	speed: 0.0288s/iter; left time: 13126.8532s
	iters: 700, epoch: 4 | loss: 1.2820741
	speed: 0.0287s/iter; left time: 13110.8016s
	iters: 800, epoch: 4 | loss: 1.3812190
	speed: 0.0288s/iter; left time: 13147.1403s
	iters: 900, epoch: 4 | loss: 1.4600009
	speed: 0.0288s/iter; left time: 13155.7712s
	iters: 1000, epoch: 4 | loss: 1.5300459
	speed: 0.0288s/iter; left time: 13122.1625s
	iters: 1100, epoch: 4 | loss: 1.4771484
	speed: 0.0287s/iter; left time: 13087.3683s
	iters: 1200, epoch: 4 | loss: 1.1979166
	speed: 0.0288s/iter; left time: 13124.5751s
	iters: 1300, epoch: 4 | loss: 1.2836899
	speed: 0.0288s/iter; left time: 13109.0612s
	iters: 1400, epoch: 4 | loss: 1.1831471
	speed: 0.0287s/iter; left time: 13075.1472s
	iters: 1500, epoch: 4 | loss: 1.4270012
	speed: 0.0286s/iter; left time: 13041.9897s
	iters: 1600, epoch: 4 | loss: 1.4622515
	speed: 0.0287s/iter; left time: 13072.8469s
	iters: 1700, epoch: 4 | loss: 1.1455675
	speed: 0.0287s/iter; left time: 13087.5971s
	iters: 1800, epoch: 4 | loss: 1.5138161
	speed: 0.0287s/iter; left time: 13061.8920s
	iters: 1900, epoch: 4 | loss: 1.4410473
	speed: 0.0287s/iter; left time: 13052.0323s
	iters: 2000, epoch: 4 | loss: 1.4724085
	speed: 0.0287s/iter; left time: 13060.8761s
	iters: 2100, epoch: 4 | loss: 1.4984576
	speed: 0.0287s/iter; left time: 13071.1639s
	iters: 2200, epoch: 4 | loss: 1.5577028
	speed: 0.0286s/iter; left time: 13010.1980s
	iters: 2300, epoch: 4 | loss: 1.2255018
	speed: 0.0287s/iter; left time: 13033.5847s
Epoch: 4 cost time: 66.78063154220581
Epoch: 4, Steps: 2320 | Train Loss: 1.4071197 Vali Loss: 1.3881863 Test Loss: 1.5403812
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 5 | loss: 1.4107618
	speed: 0.4419s/iter; left time: 200893.2644s
	iters: 200, epoch: 5 | loss: 1.3493034
	speed: 0.0287s/iter; left time: 13023.3455s
	iters: 300, epoch: 5 | loss: 1.6343600
	speed: 0.0286s/iter; left time: 12993.9461s
	iters: 400, epoch: 5 | loss: 1.3172733
	speed: 0.0287s/iter; left time: 13030.2579s
	iters: 500, epoch: 5 | loss: 1.4346666
	speed: 0.0287s/iter; left time: 13015.7221s
	iters: 600, epoch: 5 | loss: 1.3301119
	speed: 0.0286s/iter; left time: 13004.2123s
	iters: 700, epoch: 5 | loss: 1.4157604
	speed: 0.0286s/iter; left time: 12984.5639s
	iters: 800, epoch: 5 | loss: 1.3324131
	speed: 0.0288s/iter; left time: 13052.4895s
	iters: 900, epoch: 5 | loss: 1.3545703
	speed: 0.0286s/iter; left time: 12993.2097s
	iters: 1000, epoch: 5 | loss: 1.3524290
	speed: 0.0287s/iter; left time: 13001.9939s
	iters: 1100, epoch: 5 | loss: 1.4695319
	speed: 0.0287s/iter; left time: 13032.9397s
	iters: 1200, epoch: 5 | loss: 1.2886242
	speed: 0.0286s/iter; left time: 12973.8348s
	iters: 1300, epoch: 5 | loss: 1.4902031
	speed: 0.0286s/iter; left time: 12975.7674s
	iters: 1400, epoch: 5 | loss: 1.4147733
	speed: 0.0286s/iter; left time: 12970.0404s
	iters: 1500, epoch: 5 | loss: 1.4259576
	speed: 0.0286s/iter; left time: 12974.9475s
	iters: 1600, epoch: 5 | loss: 1.3059037
	speed: 0.0286s/iter; left time: 12980.7370s
	iters: 1700, epoch: 5 | loss: 1.4503518
	speed: 0.0286s/iter; left time: 12959.0312s
	iters: 1800, epoch: 5 | loss: 1.2277914
	speed: 0.0287s/iter; left time: 12976.3012s
	iters: 1900, epoch: 5 | loss: 1.5787362
	speed: 0.0286s/iter; left time: 12935.4814s
	iters: 2000, epoch: 5 | loss: 1.1546381
	speed: 0.0286s/iter; left time: 12937.2239s
	iters: 2100, epoch: 5 | loss: 1.4023992
	speed: 0.0286s/iter; left time: 12949.1515s
	iters: 2200, epoch: 5 | loss: 1.6040001
	speed: 0.0286s/iter; left time: 12959.9601s
	iters: 2300, epoch: 5 | loss: 1.4230300
	speed: 0.0286s/iter; left time: 12925.2715s
Epoch: 5 cost time: 66.5534873008728
Epoch: 5, Steps: 2320 | Train Loss: 1.4068526 Vali Loss: 1.4062434 Test Loss: 1.5502170
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 6 | loss: 1.3735293
	speed: 0.4416s/iter; left time: 199742.3992s
	iters: 200, epoch: 6 | loss: 1.3792815
	speed: 0.0286s/iter; left time: 12952.0375s
	iters: 300, epoch: 6 | loss: 1.6194834
	speed: 0.0285s/iter; left time: 12892.1765s
	iters: 400, epoch: 6 | loss: 1.3215661
	speed: 0.0286s/iter; left time: 12936.7244s
	iters: 500, epoch: 6 | loss: 1.3644043
	speed: 0.0286s/iter; left time: 12905.6653s
	iters: 600, epoch: 6 | loss: 1.3646518
	speed: 0.0286s/iter; left time: 12909.0656s
	iters: 700, epoch: 6 | loss: 1.3058031
	speed: 0.0287s/iter; left time: 12978.0058s
	iters: 800, epoch: 6 | loss: 1.5303030
	speed: 0.0286s/iter; left time: 12899.2941s
	iters: 900, epoch: 6 | loss: 1.2749666
	speed: 0.0286s/iter; left time: 12915.6333s
	iters: 1000, epoch: 6 | loss: 1.4570380
	speed: 0.0286s/iter; left time: 12888.6168s
	iters: 1100, epoch: 6 | loss: 1.5614690
	speed: 0.0286s/iter; left time: 12907.0984s
	iters: 1200, epoch: 6 | loss: 1.5810505
	speed: 0.0286s/iter; left time: 12910.6402s
	iters: 1300, epoch: 6 | loss: 1.3024447
	speed: 0.0287s/iter; left time: 12937.5693s
	iters: 1400, epoch: 6 | loss: 1.4880369
	speed: 0.0286s/iter; left time: 12887.7507s
	iters: 1500, epoch: 6 | loss: 1.2430214
	speed: 0.0286s/iter; left time: 12884.4341s
	iters: 1600, epoch: 6 | loss: 1.4551525
	speed: 0.0286s/iter; left time: 12901.2861s
	iters: 1700, epoch: 6 | loss: 1.2751909
	speed: 0.0286s/iter; left time: 12907.7686s
	iters: 1800, epoch: 6 | loss: 1.3348894
	speed: 0.0286s/iter; left time: 12876.5234s
	iters: 1900, epoch: 6 | loss: 1.4553896
	speed: 0.0286s/iter; left time: 12873.6797s
	iters: 2000, epoch: 6 | loss: 1.4685620
	speed: 0.0286s/iter; left time: 12865.9673s
	iters: 2100, epoch: 6 | loss: 1.4895667
	speed: 0.0286s/iter; left time: 12880.6447s
	iters: 2200, epoch: 6 | loss: 1.1234142
	speed: 0.0287s/iter; left time: 12907.0796s
	iters: 2300, epoch: 6 | loss: 1.3812351
	speed: 0.0286s/iter; left time: 12852.8980s
Epoch: 6 cost time: 66.47113943099976
Epoch: 6, Steps: 2320 | Train Loss: 1.4069791 Vali Loss: 1.3830469 Test Loss: 1.5326878
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 7 | loss: 1.4922421
	speed: 0.4415s/iter; left time: 198649.2266s
	iters: 200, epoch: 7 | loss: 1.4848875
	speed: 0.0288s/iter; left time: 12949.6808s
	iters: 300, epoch: 7 | loss: 1.6240642
	speed: 0.0287s/iter; left time: 12904.3700s
	iters: 400, epoch: 7 | loss: 1.1759627
	speed: 0.0287s/iter; left time: 12892.8929s
	iters: 500, epoch: 7 | loss: 1.5218409
	speed: 0.0286s/iter; left time: 12877.5351s
	iters: 600, epoch: 7 | loss: 1.4181033
	speed: 0.0287s/iter; left time: 12900.3796s
	iters: 700, epoch: 7 | loss: 1.2986133
	speed: 0.0287s/iter; left time: 12903.4880s
	iters: 800, epoch: 7 | loss: 1.3573439
	speed: 0.0286s/iter; left time: 12858.5550s
	iters: 900, epoch: 7 | loss: 1.3009863
	speed: 0.0287s/iter; left time: 12881.4317s
	iters: 1000, epoch: 7 | loss: 1.4355979
	speed: 0.0286s/iter; left time: 12863.6096s
	iters: 1100, epoch: 7 | loss: 1.4776721
	speed: 0.0288s/iter; left time: 12938.3563s
	iters: 1200, epoch: 7 | loss: 1.3676748
	speed: 0.0287s/iter; left time: 12876.8086s
	iters: 1300, epoch: 7 | loss: 1.2621504
	speed: 0.0286s/iter; left time: 12847.3071s
	iters: 1400, epoch: 7 | loss: 1.4983355
	speed: 0.0286s/iter; left time: 12852.4236s
	iters: 1500, epoch: 7 | loss: 1.3750229
	speed: 0.0287s/iter; left time: 12873.4250s
	iters: 1600, epoch: 7 | loss: 1.2422227
	speed: 0.0286s/iter; left time: 12838.1149s
	iters: 1700, epoch: 7 | loss: 1.6301756
	speed: 0.0287s/iter; left time: 12847.8368s
	iters: 1800, epoch: 7 | loss: 1.3556075
	speed: 0.0286s/iter; left time: 12830.2340s
	iters: 1900, epoch: 7 | loss: 1.1925087
	speed: 0.0286s/iter; left time: 12838.1054s
	iters: 2000, epoch: 7 | loss: 1.2982587
	speed: 0.0286s/iter; left time: 12830.3534s
	iters: 2100, epoch: 7 | loss: 1.1763681
	speed: 0.0286s/iter; left time: 12821.2194s
	iters: 2200, epoch: 7 | loss: 1.5270512
	speed: 0.0286s/iter; left time: 12815.8320s
	iters: 2300, epoch: 7 | loss: 1.3867488
	speed: 0.0286s/iter; left time: 12798.5174s
Epoch: 7 cost time: 66.61759042739868
Epoch: 7, Steps: 2320 | Train Loss: 1.4069967 Vali Loss: 1.4092450 Test Loss: 1.5462905
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems06_all_96_720_DLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 141826
test shape: (14182, 1, 720, 130) (14182, 1, 720, 130)
test shape: (14182, 720, 130) (14182, 720, 130)
mse:1.511534571647644, mae:0.9825423955917358
>>>>>>>Overall time: 873 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
