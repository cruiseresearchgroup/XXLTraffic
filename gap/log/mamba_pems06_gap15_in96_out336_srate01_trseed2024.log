Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=130, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems06_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=130, expand=2, factor=1, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems06_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=336, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_all_96_336_Mamba_custom_ftM_sl336_ll48_pl336_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 742614
val 142212
test 142210
	iters: 100, epoch: 1 | loss: 1.0988200
	speed: 0.0410s/iter; left time: 946.7857s
	iters: 200, epoch: 1 | loss: 0.9296405
	speed: 0.0229s/iter; left time: 527.4438s
	iters: 300, epoch: 1 | loss: 0.8122902
	speed: 0.0229s/iter; left time: 525.4671s
	iters: 400, epoch: 1 | loss: 0.8814168
	speed: 0.0230s/iter; left time: 523.3987s
	iters: 500, epoch: 1 | loss: 0.9595226
	speed: 0.0230s/iter; left time: 522.3413s
	iters: 600, epoch: 1 | loss: 0.8239175
	speed: 0.0229s/iter; left time: 518.5763s
	iters: 700, epoch: 1 | loss: 0.8450140
	speed: 0.0230s/iter; left time: 517.8503s
	iters: 800, epoch: 1 | loss: 0.8518679
	speed: 0.0230s/iter; left time: 514.5590s
	iters: 900, epoch: 1 | loss: 0.8732886
	speed: 0.0230s/iter; left time: 512.9029s
	iters: 1000, epoch: 1 | loss: 0.7822103
	speed: 0.0230s/iter; left time: 510.0891s
	iters: 1100, epoch: 1 | loss: 0.6770708
	speed: 0.0231s/iter; left time: 510.6558s
	iters: 1200, epoch: 1 | loss: 0.9180214
	speed: 0.0231s/iter; left time: 507.3717s
	iters: 1300, epoch: 1 | loss: 0.6542142
	speed: 0.0230s/iter; left time: 503.8056s
	iters: 1400, epoch: 1 | loss: 0.7492613
	speed: 0.0230s/iter; left time: 502.1847s
	iters: 1500, epoch: 1 | loss: 0.7179243
	speed: 0.0230s/iter; left time: 499.7920s
	iters: 1600, epoch: 1 | loss: 0.6619880
	speed: 0.0232s/iter; left time: 500.8455s
	iters: 1700, epoch: 1 | loss: 0.7436101
	speed: 0.0230s/iter; left time: 495.4044s
	iters: 1800, epoch: 1 | loss: 0.6836890
	speed: 0.0231s/iter; left time: 494.0106s
	iters: 1900, epoch: 1 | loss: 0.7321125
	speed: 0.0231s/iter; left time: 491.1083s
	iters: 2000, epoch: 1 | loss: 0.6761923
	speed: 0.0231s/iter; left time: 489.2631s
	iters: 2100, epoch: 1 | loss: 0.6380422
	speed: 0.0231s/iter; left time: 487.4996s
	iters: 2200, epoch: 1 | loss: 0.6687300
	speed: 0.0231s/iter; left time: 484.2144s
	iters: 2300, epoch: 1 | loss: 0.7380508
	speed: 0.0232s/iter; left time: 483.8651s
Epoch: 1 cost time: 55.294676065444946
Epoch: 1, Steps: 2320 | Train Loss: 0.8095392 Vali Loss: 1.7688931 Test Loss: 1.6050152
Validation loss decreased (inf --> 1.768893).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7326415
	speed: 0.4398s/iter; left time: 9138.7905s
	iters: 200, epoch: 2 | loss: 0.7250972
	speed: 0.0240s/iter; left time: 496.7147s
	iters: 300, epoch: 2 | loss: 0.7179549
	speed: 0.0239s/iter; left time: 492.6195s
	iters: 400, epoch: 2 | loss: 0.6799139
	speed: 0.0239s/iter; left time: 490.2549s
	iters: 500, epoch: 2 | loss: 0.5523852
	speed: 0.0239s/iter; left time: 487.4259s
	iters: 600, epoch: 2 | loss: 0.8436695
	speed: 0.0240s/iter; left time: 486.7926s
	iters: 700, epoch: 2 | loss: 0.7602439
	speed: 0.0238s/iter; left time: 481.1612s
	iters: 800, epoch: 2 | loss: 0.6609609
	speed: 0.0240s/iter; left time: 481.2029s
	iters: 900, epoch: 2 | loss: 0.6831912
	speed: 0.0238s/iter; left time: 475.6038s
	iters: 1000, epoch: 2 | loss: 0.7289268
	speed: 0.0239s/iter; left time: 475.0558s
	iters: 1100, epoch: 2 | loss: 0.6044317
	speed: 0.0239s/iter; left time: 472.6530s
	iters: 1200, epoch: 2 | loss: 0.7084303
	speed: 0.0238s/iter; left time: 469.3786s
	iters: 1300, epoch: 2 | loss: 0.5854181
	speed: 0.0241s/iter; left time: 471.3087s
	iters: 1400, epoch: 2 | loss: 0.6376846
	speed: 0.0240s/iter; left time: 466.6365s
	iters: 1500, epoch: 2 | loss: 0.6425334
	speed: 0.0238s/iter; left time: 462.0441s
	iters: 1600, epoch: 2 | loss: 0.4991472
	speed: 0.0239s/iter; left time: 460.1611s
	iters: 1700, epoch: 2 | loss: 0.6122829
	speed: 0.0239s/iter; left time: 457.4955s
	iters: 1800, epoch: 2 | loss: 0.7172177
	speed: 0.0239s/iter; left time: 456.8219s
	iters: 1900, epoch: 2 | loss: 0.4808352
	speed: 0.0239s/iter; left time: 454.2136s
	iters: 2000, epoch: 2 | loss: 0.5817987
	speed: 0.0239s/iter; left time: 450.5424s
	iters: 2100, epoch: 2 | loss: 0.5716496
	speed: 0.0238s/iter; left time: 447.3726s
	iters: 2200, epoch: 2 | loss: 0.6525050
	speed: 0.0239s/iter; left time: 445.8525s
	iters: 2300, epoch: 2 | loss: 0.6197641
	speed: 0.0239s/iter; left time: 444.9243s
Epoch: 2 cost time: 55.829479932785034
Epoch: 2, Steps: 2320 | Train Loss: 0.6670480 Vali Loss: 1.8420242 Test Loss: 1.7414739
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6250051
	speed: 0.4444s/iter; left time: 8203.4925s
	iters: 200, epoch: 3 | loss: 0.6792596
	speed: 0.0241s/iter; left time: 442.8311s
	iters: 300, epoch: 3 | loss: 0.5008017
	speed: 0.0239s/iter; left time: 437.2812s
	iters: 400, epoch: 3 | loss: 0.6998389
	speed: 0.0239s/iter; left time: 434.6777s
	iters: 500, epoch: 3 | loss: 0.6630162
	speed: 0.0239s/iter; left time: 432.2386s
	iters: 600, epoch: 3 | loss: 0.6191138
	speed: 0.0240s/iter; left time: 430.5910s
	iters: 700, epoch: 3 | loss: 0.5478256
	speed: 0.0239s/iter; left time: 427.7322s
	iters: 800, epoch: 3 | loss: 0.5973828
	speed: 0.0239s/iter; left time: 425.0697s
	iters: 900, epoch: 3 | loss: 0.6399192
	speed: 0.0239s/iter; left time: 422.8848s
	iters: 1000, epoch: 3 | loss: 0.7387985
	speed: 0.0239s/iter; left time: 419.8272s
	iters: 1100, epoch: 3 | loss: 0.6457316
	speed: 0.0239s/iter; left time: 417.8709s
	iters: 1200, epoch: 3 | loss: 0.7025948
	speed: 0.0238s/iter; left time: 413.8783s
	iters: 1300, epoch: 3 | loss: 0.7532126
	speed: 0.0240s/iter; left time: 414.3896s
	iters: 1400, epoch: 3 | loss: 0.8073997
	speed: 0.0239s/iter; left time: 410.1460s
	iters: 1500, epoch: 3 | loss: 0.7211012
	speed: 0.0238s/iter; left time: 406.8455s
	iters: 1600, epoch: 3 | loss: 0.6502190
	speed: 0.0238s/iter; left time: 404.2855s
	iters: 1700, epoch: 3 | loss: 0.6551869
	speed: 0.0240s/iter; left time: 404.3205s
	iters: 1800, epoch: 3 | loss: 0.5688376
	speed: 0.0239s/iter; left time: 400.9053s
	iters: 1900, epoch: 3 | loss: 0.7749729
	speed: 0.0238s/iter; left time: 397.0066s
	iters: 2000, epoch: 3 | loss: 0.7090315
	speed: 0.0239s/iter; left time: 395.2889s
	iters: 2100, epoch: 3 | loss: 0.6802278
	speed: 0.0239s/iter; left time: 393.7275s
	iters: 2200, epoch: 3 | loss: 0.5797589
	speed: 0.0239s/iter; left time: 390.7513s
	iters: 2300, epoch: 3 | loss: 0.6086180
	speed: 0.0239s/iter; left time: 388.8851s
Epoch: 3 cost time: 55.77244734764099
Epoch: 3, Steps: 2320 | Train Loss: 0.6305667 Vali Loss: 1.8356895 Test Loss: 1.7403575
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6034259
	speed: 0.4418s/iter; left time: 7131.8562s
	iters: 200, epoch: 4 | loss: 0.6653811
	speed: 0.0240s/iter; left time: 384.4162s
	iters: 300, epoch: 4 | loss: 0.6089019
	speed: 0.0239s/iter; left time: 381.2022s
	iters: 400, epoch: 4 | loss: 0.6155700
	speed: 0.0240s/iter; left time: 379.6500s
	iters: 500, epoch: 4 | loss: 0.6674651
	speed: 0.0240s/iter; left time: 377.8855s
	iters: 600, epoch: 4 | loss: 0.6403872
	speed: 0.0240s/iter; left time: 375.4626s
	iters: 700, epoch: 4 | loss: 0.6746625
	speed: 0.0239s/iter; left time: 371.6190s
	iters: 800, epoch: 4 | loss: 0.7483414
	speed: 0.0240s/iter; left time: 371.3013s
	iters: 900, epoch: 4 | loss: 0.5874761
	speed: 0.0239s/iter; left time: 366.9240s
	iters: 1000, epoch: 4 | loss: 0.6100513
	speed: 0.0239s/iter; left time: 364.8548s
	iters: 1100, epoch: 4 | loss: 0.5656874
	speed: 0.0241s/iter; left time: 364.9832s
	iters: 1200, epoch: 4 | loss: 0.5758346
	speed: 0.0240s/iter; left time: 360.5271s
	iters: 1300, epoch: 4 | loss: 0.6818184
	speed: 0.0239s/iter; left time: 357.2594s
	iters: 1400, epoch: 4 | loss: 0.6219671
	speed: 0.0239s/iter; left time: 354.1573s
	iters: 1500, epoch: 4 | loss: 0.5100242
	speed: 0.0239s/iter; left time: 352.8203s
	iters: 1600, epoch: 4 | loss: 0.5649225
	speed: 0.0239s/iter; left time: 350.2023s
	iters: 1700, epoch: 4 | loss: 0.6667473
	speed: 0.0239s/iter; left time: 347.2847s
	iters: 1800, epoch: 4 | loss: 0.6284108
	speed: 0.0239s/iter; left time: 345.1427s
	iters: 1900, epoch: 4 | loss: 0.5367067
	speed: 0.0238s/iter; left time: 341.9752s
	iters: 2000, epoch: 4 | loss: 0.5984850
	speed: 0.0238s/iter; left time: 339.2558s
	iters: 2100, epoch: 4 | loss: 0.5557568
	speed: 0.0239s/iter; left time: 337.4187s
	iters: 2200, epoch: 4 | loss: 0.6749979
	speed: 0.0239s/iter; left time: 335.3107s
	iters: 2300, epoch: 4 | loss: 0.5781609
	speed: 0.0238s/iter; left time: 332.0472s
Epoch: 4 cost time: 55.80978059768677
Epoch: 4, Steps: 2320 | Train Loss: 0.6162321 Vali Loss: 1.8580352 Test Loss: 1.7598498
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems06_all_96_336_Mamba_custom_ftM_sl336_ll48_pl336_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 142210
test shape: (14221, 1, 336, 130) (14221, 1, 336, 130)
test shape: (14221, 336, 130) (14221, 336, 130)
mse:1.6050235033035278, mae:1.0181487798690796
>>>>>>>Overall time: 494 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
