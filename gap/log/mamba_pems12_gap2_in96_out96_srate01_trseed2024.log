Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=867, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems12_all_filter10.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=867, expand=2, factor=1, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems12_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems12_all_96_96_Mamba_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1190666
val 256698
test 256697
	iters: 100, epoch: 1 | loss: 1.6037009
	speed: 0.0774s/iter; left time: 2871.6553s
	iters: 200, epoch: 1 | loss: 1.2064294
	speed: 0.0433s/iter; left time: 1603.6165s
	iters: 300, epoch: 1 | loss: 1.0296973
	speed: 0.0434s/iter; left time: 1601.5586s
	iters: 400, epoch: 1 | loss: 1.0190984
	speed: 0.0434s/iter; left time: 1597.8061s
	iters: 500, epoch: 1 | loss: 0.8838456
	speed: 0.0435s/iter; left time: 1596.2795s
	iters: 600, epoch: 1 | loss: 0.8800738
	speed: 0.0436s/iter; left time: 1594.2011s
	iters: 700, epoch: 1 | loss: 0.9105031
	speed: 0.0436s/iter; left time: 1590.1720s
	iters: 800, epoch: 1 | loss: 0.9143595
	speed: 0.0436s/iter; left time: 1586.4250s
	iters: 900, epoch: 1 | loss: 0.8132447
	speed: 0.0437s/iter; left time: 1586.5435s
	iters: 1000, epoch: 1 | loss: 0.9098311
	speed: 0.0436s/iter; left time: 1578.3459s
	iters: 1100, epoch: 1 | loss: 0.7613146
	speed: 0.0437s/iter; left time: 1575.9715s
	iters: 1200, epoch: 1 | loss: 0.7471232
	speed: 0.0437s/iter; left time: 1571.9896s
	iters: 1300, epoch: 1 | loss: 0.7514095
	speed: 0.0449s/iter; left time: 1612.9321s
	iters: 1400, epoch: 1 | loss: 0.8305264
	speed: 0.0450s/iter; left time: 1609.6419s
	iters: 1500, epoch: 1 | loss: 0.7999672
	speed: 0.0451s/iter; left time: 1610.1083s
	iters: 1600, epoch: 1 | loss: 0.7773939
	speed: 0.0444s/iter; left time: 1581.3981s
	iters: 1700, epoch: 1 | loss: 0.8001156
	speed: 0.0440s/iter; left time: 1562.6812s
	iters: 1800, epoch: 1 | loss: 0.8669612
	speed: 0.0445s/iter; left time: 1573.5961s
	iters: 1900, epoch: 1 | loss: 0.7837635
	speed: 0.0448s/iter; left time: 1581.6074s
	iters: 2000, epoch: 1 | loss: 0.8303970
	speed: 0.0441s/iter; left time: 1553.7132s
	iters: 2100, epoch: 1 | loss: 0.6880249
	speed: 0.0440s/iter; left time: 1545.6176s
	iters: 2200, epoch: 1 | loss: 0.6991910
	speed: 0.0438s/iter; left time: 1534.6516s
	iters: 2300, epoch: 1 | loss: 0.6933484
	speed: 0.0434s/iter; left time: 1515.9323s
	iters: 2400, epoch: 1 | loss: 0.8019491
	speed: 0.0434s/iter; left time: 1509.4095s
	iters: 2500, epoch: 1 | loss: 0.6608099
	speed: 0.0432s/iter; left time: 1500.3493s
	iters: 2600, epoch: 1 | loss: 0.6760151
	speed: 0.0438s/iter; left time: 1515.7085s
	iters: 2700, epoch: 1 | loss: 0.7016077
	speed: 0.0437s/iter; left time: 1506.3280s
	iters: 2800, epoch: 1 | loss: 0.7188562
	speed: 0.0437s/iter; left time: 1502.6569s
	iters: 2900, epoch: 1 | loss: 0.6814451
	speed: 0.0434s/iter; left time: 1487.2676s
	iters: 3000, epoch: 1 | loss: 0.7808841
	speed: 0.0440s/iter; left time: 1504.0457s
	iters: 3100, epoch: 1 | loss: 0.6673471
	speed: 0.0438s/iter; left time: 1493.3272s
	iters: 3200, epoch: 1 | loss: 0.7014311
	speed: 0.0437s/iter; left time: 1485.5925s
	iters: 3300, epoch: 1 | loss: 0.5835796
	speed: 0.0436s/iter; left time: 1476.7174s
	iters: 3400, epoch: 1 | loss: 0.6937578
	speed: 0.0431s/iter; left time: 1456.0532s
	iters: 3500, epoch: 1 | loss: 0.6164429
	speed: 0.0436s/iter; left time: 1467.9861s
	iters: 3600, epoch: 1 | loss: 0.6594942
	speed: 0.0442s/iter; left time: 1486.7350s
	iters: 3700, epoch: 1 | loss: 0.6155141
	speed: 0.0441s/iter; left time: 1479.0025s
Epoch: 1 cost time: 166.6853792667389
Epoch: 1, Steps: 3720 | Train Loss: 0.8301622 Vali Loss: 1.9970421 Test Loss: 0.9852607
Validation loss decreased (inf --> 1.997042).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6297126
	speed: 1.2172s/iter; left time: 40631.9137s
	iters: 200, epoch: 2 | loss: 0.7027287
	speed: 0.0447s/iter; left time: 1487.1334s
	iters: 300, epoch: 2 | loss: 0.6518988
	speed: 0.0446s/iter; left time: 1480.8848s
	iters: 400, epoch: 2 | loss: 0.6788236
	speed: 0.0447s/iter; left time: 1479.8692s
	iters: 500, epoch: 2 | loss: 0.6792355
	speed: 0.0446s/iter; left time: 1471.8807s
	iters: 600, epoch: 2 | loss: 0.6022688
	speed: 0.0447s/iter; left time: 1469.2151s
	iters: 700, epoch: 2 | loss: 0.5741314
	speed: 0.0448s/iter; left time: 1467.0046s
	iters: 800, epoch: 2 | loss: 0.5733207
	speed: 0.0447s/iter; left time: 1459.2682s
	iters: 900, epoch: 2 | loss: 0.6001439
	speed: 0.0447s/iter; left time: 1455.8072s
	iters: 1000, epoch: 2 | loss: 0.6512063
	speed: 0.0447s/iter; left time: 1450.3774s
	iters: 1100, epoch: 2 | loss: 0.6514447
	speed: 0.0446s/iter; left time: 1444.8892s
	iters: 1200, epoch: 2 | loss: 0.5924646
	speed: 0.0446s/iter; left time: 1440.8711s
	iters: 1300, epoch: 2 | loss: 0.6957222
	speed: 0.0446s/iter; left time: 1435.5934s
	iters: 1400, epoch: 2 | loss: 0.6663881
	speed: 0.0447s/iter; left time: 1433.1105s
	iters: 1500, epoch: 2 | loss: 0.7009810
	speed: 0.0447s/iter; left time: 1430.0141s
	iters: 1600, epoch: 2 | loss: 0.5821702
	speed: 0.0447s/iter; left time: 1425.9791s
	iters: 1700, epoch: 2 | loss: 0.5635374
	speed: 0.0447s/iter; left time: 1419.9942s
	iters: 1800, epoch: 2 | loss: 0.6020835
	speed: 0.0451s/iter; left time: 1430.3207s
	iters: 1900, epoch: 2 | loss: 0.6546587
	speed: 0.0448s/iter; left time: 1414.8969s
	iters: 2000, epoch: 2 | loss: 0.5372477
	speed: 0.0447s/iter; left time: 1408.0174s
	iters: 2100, epoch: 2 | loss: 0.5367675
	speed: 0.0448s/iter; left time: 1406.4350s
	iters: 2200, epoch: 2 | loss: 0.6192563
	speed: 0.0448s/iter; left time: 1400.8349s
	iters: 2300, epoch: 2 | loss: 0.5739990
	speed: 0.0448s/iter; left time: 1397.2170s
	iters: 2400, epoch: 2 | loss: 0.6389440
	speed: 0.0455s/iter; left time: 1415.3611s
	iters: 2500, epoch: 2 | loss: 0.6520215
	speed: 0.0442s/iter; left time: 1368.2609s
	iters: 2600, epoch: 2 | loss: 0.5299684
	speed: 0.0440s/iter; left time: 1358.1593s
	iters: 2700, epoch: 2 | loss: 0.6300555
	speed: 0.0446s/iter; left time: 1373.8912s
	iters: 2800, epoch: 2 | loss: 0.5686800
	speed: 0.0447s/iter; left time: 1370.2163s
	iters: 2900, epoch: 2 | loss: 0.5233614
	speed: 0.0447s/iter; left time: 1366.2813s
	iters: 3000, epoch: 2 | loss: 0.6447892
	speed: 0.0448s/iter; left time: 1364.2499s
	iters: 3100, epoch: 2 | loss: 0.5538739
	speed: 0.0447s/iter; left time: 1357.4057s
	iters: 3200, epoch: 2 | loss: 0.5141536
	speed: 0.0447s/iter; left time: 1354.3662s
	iters: 3300, epoch: 2 | loss: 0.6134369
	speed: 0.0448s/iter; left time: 1352.8376s
	iters: 3400, epoch: 2 | loss: 0.5512033
	speed: 0.0449s/iter; left time: 1350.1806s
	iters: 3500, epoch: 2 | loss: 0.6069716
	speed: 0.0447s/iter; left time: 1341.1639s
	iters: 3600, epoch: 2 | loss: 0.5499927
	speed: 0.0447s/iter; left time: 1335.1880s
	iters: 3700, epoch: 2 | loss: 0.5645038
	speed: 0.0448s/iter; left time: 1335.2955s
Epoch: 2 cost time: 167.15029668807983
Epoch: 2, Steps: 3720 | Train Loss: 0.6108408 Vali Loss: 1.9096893 Test Loss: 0.9555255
Validation loss decreased (1.997042 --> 1.909689).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6213824
	speed: 1.1566s/iter; left time: 34304.5037s
	iters: 200, epoch: 3 | loss: 0.5341086
	speed: 0.0450s/iter; left time: 1329.2223s
	iters: 300, epoch: 3 | loss: 0.5689226
	speed: 0.0448s/iter; left time: 1319.7063s
	iters: 400, epoch: 3 | loss: 0.4918857
	speed: 0.0447s/iter; left time: 1313.8307s
	iters: 500, epoch: 3 | loss: 0.5695519
	speed: 0.0448s/iter; left time: 1311.2180s
	iters: 600, epoch: 3 | loss: 0.5142195
	speed: 0.0448s/iter; left time: 1306.4207s
	iters: 700, epoch: 3 | loss: 0.5679502
	speed: 0.0448s/iter; left time: 1301.7604s
	iters: 800, epoch: 3 | loss: 0.5430951
	speed: 0.0448s/iter; left time: 1297.0256s
	iters: 900, epoch: 3 | loss: 0.5613089
	speed: 0.0448s/iter; left time: 1292.2575s
	iters: 1000, epoch: 3 | loss: 0.5391046
	speed: 0.0449s/iter; left time: 1290.8630s
	iters: 1100, epoch: 3 | loss: 0.5136776
	speed: 0.0448s/iter; left time: 1284.1664s
	iters: 1200, epoch: 3 | loss: 0.5872872
	speed: 0.0448s/iter; left time: 1278.4643s
	iters: 1300, epoch: 3 | loss: 0.5419698
	speed: 0.0449s/iter; left time: 1277.8274s
	iters: 1400, epoch: 3 | loss: 0.5184022
	speed: 0.0448s/iter; left time: 1270.5027s
	iters: 1500, epoch: 3 | loss: 0.4938233
	speed: 0.0449s/iter; left time: 1267.9937s
	iters: 1600, epoch: 3 | loss: 0.4625257
	speed: 0.0448s/iter; left time: 1262.5869s
	iters: 1700, epoch: 3 | loss: 0.5474088
	speed: 0.0451s/iter; left time: 1266.7097s
	iters: 1800, epoch: 3 | loss: 0.6159195
	speed: 0.0451s/iter; left time: 1260.5327s
	iters: 1900, epoch: 3 | loss: 0.5886699
	speed: 0.0450s/iter; left time: 1252.4941s
	iters: 2000, epoch: 3 | loss: 0.5810908
	speed: 0.0450s/iter; left time: 1247.9811s
	iters: 2100, epoch: 3 | loss: 0.5151237
	speed: 0.0447s/iter; left time: 1237.1519s
	iters: 2200, epoch: 3 | loss: 0.5751427
	speed: 0.0448s/iter; left time: 1233.3710s
	iters: 2300, epoch: 3 | loss: 0.5321001
	speed: 0.0444s/iter; left time: 1218.0964s
	iters: 2400, epoch: 3 | loss: 0.5001950
	speed: 0.0444s/iter; left time: 1214.8248s
	iters: 2500, epoch: 3 | loss: 0.5238425
	speed: 0.0443s/iter; left time: 1208.6327s
	iters: 2600, epoch: 3 | loss: 0.5679028
	speed: 0.0444s/iter; left time: 1205.1088s
	iters: 2700, epoch: 3 | loss: 0.5329719
	speed: 0.0444s/iter; left time: 1202.5684s
	iters: 2800, epoch: 3 | loss: 0.5500266
	speed: 0.0444s/iter; left time: 1196.1317s
	iters: 2900, epoch: 3 | loss: 0.4874487
	speed: 0.0445s/iter; left time: 1195.7059s
	iters: 3000, epoch: 3 | loss: 0.4877734
	speed: 0.0443s/iter; left time: 1186.2515s
	iters: 3100, epoch: 3 | loss: 0.5277537
	speed: 0.0444s/iter; left time: 1183.1417s
	iters: 3200, epoch: 3 | loss: 0.5179579
	speed: 0.0444s/iter; left time: 1179.2303s
	iters: 3300, epoch: 3 | loss: 0.6564778
	speed: 0.0443s/iter; left time: 1172.7028s
	iters: 3400, epoch: 3 | loss: 0.5701699
	speed: 0.0443s/iter; left time: 1167.7625s
	iters: 3500, epoch: 3 | loss: 0.5109636
	speed: 0.0444s/iter; left time: 1166.9913s
	iters: 3600, epoch: 3 | loss: 0.5537459
	speed: 0.0443s/iter; left time: 1160.1230s
	iters: 3700, epoch: 3 | loss: 0.5050604
	speed: 0.0444s/iter; left time: 1156.7656s
Epoch: 3 cost time: 167.0434284210205
Epoch: 3, Steps: 3720 | Train Loss: 0.5465848 Vali Loss: 1.9662480 Test Loss: 0.9614044
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5254229
	speed: 1.1683s/iter; left time: 30307.0978s
	iters: 200, epoch: 4 | loss: 0.5236267
	speed: 0.0444s/iter; left time: 1148.4591s
	iters: 300, epoch: 4 | loss: 0.4997367
	speed: 0.0445s/iter; left time: 1146.1573s
	iters: 400, epoch: 4 | loss: 0.4815140
	speed: 0.0446s/iter; left time: 1143.2531s
	iters: 500, epoch: 4 | loss: 0.4907137
	speed: 0.0444s/iter; left time: 1135.0269s
	iters: 600, epoch: 4 | loss: 0.5116265
	speed: 0.0444s/iter; left time: 1129.9023s
	iters: 700, epoch: 4 | loss: 0.4918792
	speed: 0.0444s/iter; left time: 1124.1733s
	iters: 800, epoch: 4 | loss: 0.5553482
	speed: 0.0445s/iter; left time: 1122.3980s
	iters: 900, epoch: 4 | loss: 0.5474496
	speed: 0.0444s/iter; left time: 1115.3018s
	iters: 1000, epoch: 4 | loss: 0.5445752
	speed: 0.0445s/iter; left time: 1113.7212s
	iters: 1100, epoch: 4 | loss: 0.5444490
	speed: 0.0444s/iter; left time: 1106.9261s
	iters: 1200, epoch: 4 | loss: 0.4975491
	speed: 0.0445s/iter; left time: 1104.1993s
	iters: 1300, epoch: 4 | loss: 0.4706952
	speed: 0.0444s/iter; left time: 1098.2140s
	iters: 1400, epoch: 4 | loss: 0.5551364
	speed: 0.0446s/iter; left time: 1097.8653s
	iters: 1500, epoch: 4 | loss: 0.4483340
	speed: 0.0445s/iter; left time: 1091.2066s
	iters: 1600, epoch: 4 | loss: 0.5642670
	speed: 0.0444s/iter; left time: 1085.4574s
	iters: 1700, epoch: 4 | loss: 0.5570471
	speed: 0.0447s/iter; left time: 1087.2084s
	iters: 1800, epoch: 4 | loss: 0.4807386
	speed: 0.0448s/iter; left time: 1085.9250s
	iters: 1900, epoch: 4 | loss: 0.4715708
	speed: 0.0446s/iter; left time: 1075.6442s
	iters: 2000, epoch: 4 | loss: 0.5398903
	speed: 0.0445s/iter; left time: 1068.7002s
	iters: 2100, epoch: 4 | loss: 0.5108299
	speed: 0.0445s/iter; left time: 1064.9333s
	iters: 2200, epoch: 4 | loss: 0.5222780
	speed: 0.0444s/iter; left time: 1059.6273s
	iters: 2300, epoch: 4 | loss: 0.4991583
	speed: 0.0445s/iter; left time: 1055.3847s
	iters: 2400, epoch: 4 | loss: 0.5283176
	speed: 0.0445s/iter; left time: 1052.9902s
	iters: 2500, epoch: 4 | loss: 0.4695997
	speed: 0.0445s/iter; left time: 1047.1017s
	iters: 2600, epoch: 4 | loss: 0.5400389
	speed: 0.0444s/iter; left time: 1041.1249s
	iters: 2700, epoch: 4 | loss: 0.5327012
	speed: 0.0446s/iter; left time: 1040.7535s
	iters: 2800, epoch: 4 | loss: 0.4741039
	speed: 0.0444s/iter; left time: 1032.8682s
	iters: 2900, epoch: 4 | loss: 0.5503993
	speed: 0.0445s/iter; left time: 1030.5772s
	iters: 3000, epoch: 4 | loss: 0.4911483
	speed: 0.0445s/iter; left time: 1024.9337s
	iters: 3100, epoch: 4 | loss: 0.5606076
	speed: 0.0445s/iter; left time: 1021.4795s
	iters: 3200, epoch: 4 | loss: 0.5191740
	speed: 0.0444s/iter; left time: 1013.9950s
	iters: 3300, epoch: 4 | loss: 0.4727391
	speed: 0.0444s/iter; left time: 1010.5197s
	iters: 3400, epoch: 4 | loss: 0.5052071
	speed: 0.0445s/iter; left time: 1006.4538s
	iters: 3500, epoch: 4 | loss: 0.5562602
	speed: 0.0445s/iter; left time: 1003.8083s
	iters: 3600, epoch: 4 | loss: 0.5006653
	speed: 0.0444s/iter; left time: 997.0975s
	iters: 3700, epoch: 4 | loss: 0.4754488
	speed: 0.0445s/iter; left time: 993.6014s
Epoch: 4 cost time: 166.4439558982849
Epoch: 4, Steps: 3720 | Train Loss: 0.5211130 Vali Loss: 1.9432267 Test Loss: 0.9780910
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4790805
	speed: 1.2705s/iter; left time: 28232.6634s
	iters: 200, epoch: 5 | loss: 0.4687696
	speed: 0.0445s/iter; left time: 984.7660s
	iters: 300, epoch: 5 | loss: 0.5090412
	speed: 0.0445s/iter; left time: 979.1323s
	iters: 400, epoch: 5 | loss: 0.5420223
	speed: 0.0446s/iter; left time: 977.0117s
	iters: 500, epoch: 5 | loss: 0.4504436
	speed: 0.0445s/iter; left time: 970.3308s
	iters: 600, epoch: 5 | loss: 0.5198534
	speed: 0.0445s/iter; left time: 965.9260s
	iters: 700, epoch: 5 | loss: 0.5199269
	speed: 0.0444s/iter; left time: 960.8372s
	iters: 800, epoch: 5 | loss: 0.5468994
	speed: 0.0445s/iter; left time: 957.3515s
	iters: 900, epoch: 5 | loss: 0.4896015
	speed: 0.0445s/iter; left time: 954.1251s
	iters: 1000, epoch: 5 | loss: 0.4773467
	speed: 0.0445s/iter; left time: 948.7069s
	iters: 1100, epoch: 5 | loss: 0.5304196
	speed: 0.0445s/iter; left time: 945.0298s
	iters: 1200, epoch: 5 | loss: 0.5136091
	speed: 0.0446s/iter; left time: 941.4306s
	iters: 1300, epoch: 5 | loss: 0.4608015
	speed: 0.0445s/iter; left time: 934.6961s
	iters: 1400, epoch: 5 | loss: 0.4828140
	speed: 0.0446s/iter; left time: 933.7128s
	iters: 1500, epoch: 5 | loss: 0.4809980
	speed: 0.0445s/iter; left time: 927.4140s
	iters: 1600, epoch: 5 | loss: 0.5216722
	speed: 0.0445s/iter; left time: 921.3390s
	iters: 1700, epoch: 5 | loss: 0.5055287
	speed: 0.0445s/iter; left time: 916.8946s
	iters: 1800, epoch: 5 | loss: 0.5738367
	speed: 0.0445s/iter; left time: 912.9346s
	iters: 1900, epoch: 5 | loss: 0.4574156
	speed: 0.0446s/iter; left time: 910.1369s
	iters: 2000, epoch: 5 | loss: 0.5107299
	speed: 0.0445s/iter; left time: 904.4351s
	iters: 2100, epoch: 5 | loss: 0.5295005
	speed: 0.0445s/iter; left time: 899.3184s
	iters: 2200, epoch: 5 | loss: 0.4702933
	speed: 0.0446s/iter; left time: 896.7066s
	iters: 2300, epoch: 5 | loss: 0.4503208
	speed: 0.0444s/iter; left time: 889.6115s
	iters: 2400, epoch: 5 | loss: 0.5020291
	speed: 0.0445s/iter; left time: 885.9058s
	iters: 2500, epoch: 5 | loss: 0.4263590
	speed: 0.0444s/iter; left time: 879.2458s
	iters: 2600, epoch: 5 | loss: 0.4813441
	speed: 0.0445s/iter; left time: 876.7056s
	iters: 2700, epoch: 5 | loss: 0.5448778
	speed: 0.0445s/iter; left time: 873.3569s
	iters: 2800, epoch: 5 | loss: 0.4543864
	speed: 0.0446s/iter; left time: 871.3848s
	iters: 2900, epoch: 5 | loss: 0.4804323
	speed: 0.0445s/iter; left time: 864.1060s
	iters: 3000, epoch: 5 | loss: 0.5365272
	speed: 0.0451s/iter; left time: 871.6996s
	iters: 3100, epoch: 5 | loss: 0.4624972
	speed: 0.0448s/iter; left time: 861.6230s
	iters: 3200, epoch: 5 | loss: 0.5016571
	speed: 0.0445s/iter; left time: 851.7725s
	iters: 3300, epoch: 5 | loss: 0.6159040
	speed: 0.0448s/iter; left time: 852.0857s
	iters: 3400, epoch: 5 | loss: 0.5571531
	speed: 0.0445s/iter; left time: 841.5994s
	iters: 3500, epoch: 5 | loss: 0.4868568
	speed: 0.0446s/iter; left time: 838.8197s
	iters: 3600, epoch: 5 | loss: 0.4696728
	speed: 0.0445s/iter; left time: 832.2187s
	iters: 3700, epoch: 5 | loss: 0.4563746
	speed: 0.0445s/iter; left time: 829.0924s
Epoch: 5 cost time: 166.7541823387146
Epoch: 5, Steps: 3720 | Train Loss: 0.5092672 Vali Loss: 1.9743315 Test Loss: 0.9863124
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems12_all_96_96_Mamba_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 256697
test shape: (25669, 1, 96, 867) (25669, 1, 96, 867)
test shape: (25669, 96, 867) (25669, 96, 867)
mse:0.9555228352546692, mae:0.7044712901115417
>>>>>>>Overall time: 2297 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
