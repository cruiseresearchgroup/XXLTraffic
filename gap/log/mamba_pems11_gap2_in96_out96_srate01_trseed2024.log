Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=521, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems11_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=521, expand=2, factor=1, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems11_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems11_all_96_96_Mamba_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1148680
val 242702
test 242702
	iters: 100, epoch: 1 | loss: 2.1547959
	speed: 0.0542s/iter; left time: 1938.2499s
	iters: 200, epoch: 1 | loss: 1.3530574
	speed: 0.0306s/iter; left time: 1092.3284s
	iters: 300, epoch: 1 | loss: 1.1669986
	speed: 0.0307s/iter; left time: 1094.0614s
	iters: 400, epoch: 1 | loss: 1.1932003
	speed: 0.0306s/iter; left time: 1086.2449s
	iters: 500, epoch: 1 | loss: 1.0365318
	speed: 0.0307s/iter; left time: 1085.6725s
	iters: 600, epoch: 1 | loss: 1.0055859
	speed: 0.0306s/iter; left time: 1079.8795s
	iters: 700, epoch: 1 | loss: 1.0296628
	speed: 0.0307s/iter; left time: 1080.1780s
	iters: 800, epoch: 1 | loss: 1.0703166
	speed: 0.0306s/iter; left time: 1072.2366s
	iters: 900, epoch: 1 | loss: 1.0540379
	speed: 0.0306s/iter; left time: 1069.2831s
	iters: 1000, epoch: 1 | loss: 0.9272581
	speed: 0.0306s/iter; left time: 1066.5829s
	iters: 1100, epoch: 1 | loss: 0.9176949
	speed: 0.0305s/iter; left time: 1061.1653s
	iters: 1200, epoch: 1 | loss: 0.7781460
	speed: 0.0304s/iter; left time: 1055.2232s
	iters: 1300, epoch: 1 | loss: 0.7170835
	speed: 0.0308s/iter; left time: 1064.7018s
	iters: 1400, epoch: 1 | loss: 0.9938768
	speed: 0.0309s/iter; left time: 1065.4402s
	iters: 1500, epoch: 1 | loss: 0.7881516
	speed: 0.0307s/iter; left time: 1055.1783s
	iters: 1600, epoch: 1 | loss: 0.9384428
	speed: 0.0305s/iter; left time: 1046.5475s
	iters: 1700, epoch: 1 | loss: 0.9059209
	speed: 0.0305s/iter; left time: 1043.6273s
	iters: 1800, epoch: 1 | loss: 0.7698883
	speed: 0.0309s/iter; left time: 1052.5815s
	iters: 1900, epoch: 1 | loss: 1.0585612
	speed: 0.0307s/iter; left time: 1042.7467s
	iters: 2000, epoch: 1 | loss: 0.8396509
	speed: 0.0305s/iter; left time: 1032.9055s
	iters: 2100, epoch: 1 | loss: 1.0949965
	speed: 0.0307s/iter; left time: 1038.0223s
	iters: 2200, epoch: 1 | loss: 0.8545713
	speed: 0.0304s/iter; left time: 1024.5069s
	iters: 2300, epoch: 1 | loss: 0.7891865
	speed: 0.0305s/iter; left time: 1025.0698s
	iters: 2400, epoch: 1 | loss: 0.8189821
	speed: 0.0308s/iter; left time: 1030.2105s
	iters: 2500, epoch: 1 | loss: 0.9455788
	speed: 0.0306s/iter; left time: 1023.0953s
	iters: 2600, epoch: 1 | loss: 0.8557658
	speed: 0.0306s/iter; left time: 1017.1758s
	iters: 2700, epoch: 1 | loss: 0.6588590
	speed: 0.0307s/iter; left time: 1020.0416s
	iters: 2800, epoch: 1 | loss: 0.9229399
	speed: 0.0306s/iter; left time: 1011.6972s
	iters: 2900, epoch: 1 | loss: 0.9094286
	speed: 0.0304s/iter; left time: 1001.7432s
	iters: 3000, epoch: 1 | loss: 0.9834005
	speed: 0.0306s/iter; left time: 1004.9589s
	iters: 3100, epoch: 1 | loss: 0.6728899
	speed: 0.0307s/iter; left time: 1008.1191s
	iters: 3200, epoch: 1 | loss: 0.7662725
	speed: 0.0306s/iter; left time: 1001.7874s
	iters: 3300, epoch: 1 | loss: 0.7050133
	speed: 0.0304s/iter; left time: 991.4133s
	iters: 3400, epoch: 1 | loss: 0.7791457
	speed: 0.0307s/iter; left time: 999.0321s
	iters: 3500, epoch: 1 | loss: 0.6677305
	speed: 0.0307s/iter; left time: 992.8464s
Epoch: 1 cost time: 112.4105954170227
Epoch: 1, Steps: 3589 | Train Loss: 0.9395589 Vali Loss: 2.4409466 Test Loss: 5.9139137
Validation loss decreased (inf --> 2.440947).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5753549
	speed: 1.1018s/iter; left time: 35479.3477s
	iters: 200, epoch: 2 | loss: 1.0742850
	speed: 0.0310s/iter; left time: 996.3003s
	iters: 300, epoch: 2 | loss: 0.7444004
	speed: 0.0310s/iter; left time: 991.5363s
	iters: 400, epoch: 2 | loss: 0.7055863
	speed: 0.0310s/iter; left time: 989.3309s
	iters: 500, epoch: 2 | loss: 0.8343007
	speed: 0.0310s/iter; left time: 986.4281s
	iters: 600, epoch: 2 | loss: 0.7394081
	speed: 0.0310s/iter; left time: 984.0941s
	iters: 700, epoch: 2 | loss: 0.7339044
	speed: 0.0311s/iter; left time: 982.7434s
	iters: 800, epoch: 2 | loss: 0.7226442
	speed: 0.0311s/iter; left time: 978.2157s
	iters: 900, epoch: 2 | loss: 0.7361673
	speed: 0.0310s/iter; left time: 974.5019s
	iters: 1000, epoch: 2 | loss: 0.7396132
	speed: 0.0313s/iter; left time: 978.4991s
	iters: 1100, epoch: 2 | loss: 0.7143371
	speed: 0.0312s/iter; left time: 973.2571s
	iters: 1200, epoch: 2 | loss: 0.7659293
	speed: 0.0312s/iter; left time: 970.7698s
	iters: 1300, epoch: 2 | loss: 0.7434320
	speed: 0.0313s/iter; left time: 969.0388s
	iters: 1400, epoch: 2 | loss: 0.6209375
	speed: 0.0314s/iter; left time: 970.7630s
	iters: 1500, epoch: 2 | loss: 0.7291415
	speed: 0.0312s/iter; left time: 960.9555s
	iters: 1600, epoch: 2 | loss: 0.7450010
	speed: 0.0313s/iter; left time: 959.4639s
	iters: 1700, epoch: 2 | loss: 0.7339690
	speed: 0.0312s/iter; left time: 956.1661s
	iters: 1800, epoch: 2 | loss: 0.7949320
	speed: 0.0313s/iter; left time: 954.7785s
	iters: 1900, epoch: 2 | loss: 0.6684664
	speed: 0.0312s/iter; left time: 949.5184s
	iters: 2000, epoch: 2 | loss: 0.7187437
	speed: 0.0311s/iter; left time: 942.8493s
	iters: 2100, epoch: 2 | loss: 0.7307383
	speed: 0.0311s/iter; left time: 939.5202s
	iters: 2200, epoch: 2 | loss: 0.6211028
	speed: 0.0311s/iter; left time: 935.4765s
	iters: 2300, epoch: 2 | loss: 0.7367001
	speed: 0.0311s/iter; left time: 932.7147s
	iters: 2400, epoch: 2 | loss: 0.7214268
	speed: 0.0311s/iter; left time: 930.2046s
	iters: 2500, epoch: 2 | loss: 0.5990762
	speed: 0.0311s/iter; left time: 926.9720s
	iters: 2600, epoch: 2 | loss: 0.7229226
	speed: 0.0311s/iter; left time: 923.2747s
	iters: 2700, epoch: 2 | loss: 0.6335796
	speed: 0.0311s/iter; left time: 919.6063s
	iters: 2800, epoch: 2 | loss: 0.6403268
	speed: 0.0311s/iter; left time: 916.7395s
	iters: 2900, epoch: 2 | loss: 0.7459463
	speed: 0.0311s/iter; left time: 915.2957s
	iters: 3000, epoch: 2 | loss: 0.7977361
	speed: 0.0311s/iter; left time: 910.8002s
	iters: 3100, epoch: 2 | loss: 0.6897265
	speed: 0.0311s/iter; left time: 908.1698s
	iters: 3200, epoch: 2 | loss: 0.5367551
	speed: 0.0311s/iter; left time: 903.6425s
	iters: 3300, epoch: 2 | loss: 0.9196161
	speed: 0.0314s/iter; left time: 909.4315s
	iters: 3400, epoch: 2 | loss: 0.6527688
	speed: 0.0310s/iter; left time: 896.5073s
	iters: 3500, epoch: 2 | loss: 0.6774051
	speed: 0.0309s/iter; left time: 888.7588s
Epoch: 2 cost time: 112.29616403579712
Epoch: 2, Steps: 3589 | Train Loss: 0.7423766 Vali Loss: 4.4073176 Test Loss: 7.3177056
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7283735
	speed: 0.9578s/iter; left time: 27406.2380s
	iters: 200, epoch: 3 | loss: 0.8567371
	speed: 0.0311s/iter; left time: 885.5545s
	iters: 300, epoch: 3 | loss: 0.6324415
	speed: 0.0311s/iter; left time: 883.8773s
	iters: 400, epoch: 3 | loss: 0.6713503
	speed: 0.0310s/iter; left time: 878.1473s
	iters: 500, epoch: 3 | loss: 0.8685196
	speed: 0.0310s/iter; left time: 875.1905s
	iters: 600, epoch: 3 | loss: 0.8287700
	speed: 0.0311s/iter; left time: 874.0485s
	iters: 700, epoch: 3 | loss: 0.5147318
	speed: 0.0310s/iter; left time: 868.0215s
	iters: 800, epoch: 3 | loss: 0.5190483
	speed: 0.0311s/iter; left time: 868.2073s
	iters: 900, epoch: 3 | loss: 0.6658018
	speed: 0.0310s/iter; left time: 862.6348s
	iters: 1000, epoch: 3 | loss: 0.5949918
	speed: 0.0311s/iter; left time: 863.1729s
	iters: 1100, epoch: 3 | loss: 0.5853552
	speed: 0.0310s/iter; left time: 857.0707s
	iters: 1200, epoch: 3 | loss: 0.5454894
	speed: 0.0310s/iter; left time: 854.2480s
	iters: 1300, epoch: 3 | loss: 0.8116715
	speed: 0.0311s/iter; left time: 852.6954s
	iters: 1400, epoch: 3 | loss: 0.5577059
	speed: 0.0311s/iter; left time: 848.8894s
	iters: 1500, epoch: 3 | loss: 0.5761545
	speed: 0.0314s/iter; left time: 853.8221s
	iters: 1600, epoch: 3 | loss: 0.6866795
	speed: 0.0311s/iter; left time: 843.0899s
	iters: 1700, epoch: 3 | loss: 0.4915477
	speed: 0.0311s/iter; left time: 839.5988s
	iters: 1800, epoch: 3 | loss: 0.7273802
	speed: 0.0313s/iter; left time: 842.1008s
	iters: 1900, epoch: 3 | loss: 0.6612662
	speed: 0.0310s/iter; left time: 832.1692s
	iters: 2000, epoch: 3 | loss: 0.5784523
	speed: 0.0311s/iter; left time: 830.3228s
	iters: 2100, epoch: 3 | loss: 0.8772796
	speed: 0.0311s/iter; left time: 828.8093s
	iters: 2200, epoch: 3 | loss: 0.7313720
	speed: 0.0311s/iter; left time: 825.3372s
	iters: 2300, epoch: 3 | loss: 0.8361407
	speed: 0.0312s/iter; left time: 823.8728s
	iters: 2400, epoch: 3 | loss: 0.6907895
	speed: 0.0311s/iter; left time: 817.1537s
	iters: 2500, epoch: 3 | loss: 0.8767379
	speed: 0.0311s/iter; left time: 815.6178s
	iters: 2600, epoch: 3 | loss: 0.7023237
	speed: 0.0311s/iter; left time: 811.0167s
	iters: 2700, epoch: 3 | loss: 0.5345432
	speed: 0.0312s/iter; left time: 810.3519s
	iters: 2800, epoch: 3 | loss: 0.6961579
	speed: 0.0311s/iter; left time: 805.1313s
	iters: 2900, epoch: 3 | loss: 0.6707665
	speed: 0.0311s/iter; left time: 803.6718s
	iters: 3000, epoch: 3 | loss: 0.7032261
	speed: 0.0311s/iter; left time: 798.7982s
	iters: 3100, epoch: 3 | loss: 0.6998824
	speed: 0.0312s/iter; left time: 798.7709s
	iters: 3200, epoch: 3 | loss: 0.5471761
	speed: 0.0311s/iter; left time: 794.7133s
	iters: 3300, epoch: 3 | loss: 0.6192730
	speed: 0.0311s/iter; left time: 789.6359s
	iters: 3400, epoch: 3 | loss: 0.9198831
	speed: 0.0311s/iter; left time: 787.4538s
	iters: 3500, epoch: 3 | loss: 0.5619597
	speed: 0.0311s/iter; left time: 784.4450s
Epoch: 3 cost time: 112.41250133514404
Epoch: 3, Steps: 3589 | Train Loss: 0.6991506 Vali Loss: 5.0765347 Test Loss: 7.6607332
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7728683
	speed: 1.0112s/iter; left time: 25303.5024s
	iters: 200, epoch: 4 | loss: 0.7543261
	speed: 0.0314s/iter; left time: 782.6177s
	iters: 300, epoch: 4 | loss: 0.5342606
	speed: 0.0313s/iter; left time: 777.5744s
	iters: 400, epoch: 4 | loss: 0.5912312
	speed: 0.0313s/iter; left time: 772.7398s
	iters: 500, epoch: 4 | loss: 0.5747204
	speed: 0.0312s/iter; left time: 769.3093s
	iters: 600, epoch: 4 | loss: 0.7070431
	speed: 0.0314s/iter; left time: 769.3625s
	iters: 700, epoch: 4 | loss: 0.6245523
	speed: 0.0313s/iter; left time: 765.0414s
	iters: 800, epoch: 4 | loss: 0.6830254
	speed: 0.0313s/iter; left time: 761.8085s
	iters: 900, epoch: 4 | loss: 0.6954376
	speed: 0.0313s/iter; left time: 757.9536s
	iters: 1000, epoch: 4 | loss: 0.5794821
	speed: 0.0312s/iter; left time: 753.2600s
	iters: 1100, epoch: 4 | loss: 0.5437537
	speed: 0.0313s/iter; left time: 752.0053s
	iters: 1200, epoch: 4 | loss: 0.7829116
	speed: 0.0313s/iter; left time: 747.6901s
	iters: 1300, epoch: 4 | loss: 0.6509559
	speed: 0.0312s/iter; left time: 743.8454s
	iters: 1400, epoch: 4 | loss: 0.6529094
	speed: 0.0313s/iter; left time: 741.7274s
	iters: 1500, epoch: 4 | loss: 0.6449347
	speed: 0.0313s/iter; left time: 738.3904s
	iters: 1600, epoch: 4 | loss: 0.7283233
	speed: 0.0313s/iter; left time: 735.1296s
	iters: 1700, epoch: 4 | loss: 0.6964604
	speed: 0.0312s/iter; left time: 731.7469s
	iters: 1800, epoch: 4 | loss: 0.6136773
	speed: 0.0312s/iter; left time: 728.4628s
	iters: 1900, epoch: 4 | loss: 0.7280737
	speed: 0.0312s/iter; left time: 725.3696s
	iters: 2000, epoch: 4 | loss: 0.4891237
	speed: 0.0313s/iter; left time: 723.8236s
	iters: 2100, epoch: 4 | loss: 0.6939099
	speed: 0.0314s/iter; left time: 723.0034s
	iters: 2200, epoch: 4 | loss: 0.6817431
	speed: 0.0316s/iter; left time: 723.3343s
	iters: 2300, epoch: 4 | loss: 0.6768156
	speed: 0.0313s/iter; left time: 714.5469s
	iters: 2400, epoch: 4 | loss: 0.7352855
	speed: 0.0313s/iter; left time: 712.3007s
	iters: 2500, epoch: 4 | loss: 0.7152090
	speed: 0.0314s/iter; left time: 710.7237s
	iters: 2600, epoch: 4 | loss: 0.8143530
	speed: 0.0313s/iter; left time: 704.2891s
	iters: 2700, epoch: 4 | loss: 0.8625103
	speed: 0.0312s/iter; left time: 699.9413s
	iters: 2800, epoch: 4 | loss: 0.6914918
	speed: 0.0313s/iter; left time: 698.0657s
	iters: 2900, epoch: 4 | loss: 0.7382264
	speed: 0.0312s/iter; left time: 693.7783s
	iters: 3000, epoch: 4 | loss: 0.8383459
	speed: 0.0313s/iter; left time: 692.1318s
	iters: 3100, epoch: 4 | loss: 0.5663207
	speed: 0.0312s/iter; left time: 688.0387s
	iters: 3200, epoch: 4 | loss: 0.7513843
	speed: 0.0312s/iter; left time: 684.8397s
	iters: 3300, epoch: 4 | loss: 0.5482273
	speed: 0.0313s/iter; left time: 683.7571s
	iters: 3400, epoch: 4 | loss: 0.6258893
	speed: 0.0313s/iter; left time: 678.9183s
	iters: 3500, epoch: 4 | loss: 0.6022919
	speed: 0.0313s/iter; left time: 675.7528s
Epoch: 4 cost time: 112.98828768730164
Epoch: 4, Steps: 3589 | Train Loss: 0.6817225 Vali Loss: 5.4922352 Test Loss: 7.9600635
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems11_all_96_96_Mamba_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 242702
test shape: (24270, 1, 96, 521) (24270, 1, 96, 521)
test shape: (24270, 96, 521) (24270, 96, 521)
mse:5.913945198059082, mae:0.9962128400802612
>>>>>>>Overall time: 1312 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
