Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=130, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems06_all_common_flow.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems06_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_all_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 690438
val 89796
test 89794
	iters: 100, epoch: 1 | loss: 1.4740219
	speed: 0.0198s/iter; left time: 8555.4456s
	iters: 200, epoch: 1 | loss: 1.3038595
	speed: 0.0169s/iter; left time: 7305.4168s
	iters: 300, epoch: 1 | loss: 1.3569500
	speed: 0.0169s/iter; left time: 7286.5209s
	iters: 400, epoch: 1 | loss: 1.7192934
	speed: 0.0169s/iter; left time: 7269.7344s
	iters: 500, epoch: 1 | loss: 1.6916497
	speed: 0.0169s/iter; left time: 7285.7376s
	iters: 600, epoch: 1 | loss: 1.6666908
	speed: 0.0169s/iter; left time: 7273.8065s
	iters: 700, epoch: 1 | loss: 1.4107293
	speed: 0.0169s/iter; left time: 7273.8124s
	iters: 800, epoch: 1 | loss: 1.3055786
	speed: 0.0169s/iter; left time: 7278.2608s
	iters: 900, epoch: 1 | loss: 1.5411160
	speed: 0.0169s/iter; left time: 7271.4724s
	iters: 1000, epoch: 1 | loss: 1.3926940
	speed: 0.0170s/iter; left time: 7320.5976s
	iters: 1100, epoch: 1 | loss: 1.5558023
	speed: 0.0169s/iter; left time: 7288.1869s
	iters: 1200, epoch: 1 | loss: 1.4958500
	speed: 0.0170s/iter; left time: 7318.1958s
	iters: 1300, epoch: 1 | loss: 1.3267517
	speed: 0.0169s/iter; left time: 7283.1566s
	iters: 1400, epoch: 1 | loss: 1.5083312
	speed: 0.0170s/iter; left time: 7293.8477s
	iters: 1500, epoch: 1 | loss: 1.3594147
	speed: 0.0170s/iter; left time: 7286.9846s
	iters: 1600, epoch: 1 | loss: 1.7046471
	speed: 0.0170s/iter; left time: 7287.0111s
	iters: 1700, epoch: 1 | loss: 1.3901473
	speed: 0.0170s/iter; left time: 7310.6410s
	iters: 1800, epoch: 1 | loss: 1.4429433
	speed: 0.0169s/iter; left time: 7278.3730s
	iters: 1900, epoch: 1 | loss: 1.6641244
	speed: 0.0170s/iter; left time: 7311.2545s
	iters: 2000, epoch: 1 | loss: 1.3447723
	speed: 0.0170s/iter; left time: 7280.3799s
	iters: 2100, epoch: 1 | loss: 1.2649418
	speed: 0.0169s/iter; left time: 7274.1798s
Epoch: 1 cost time: 36.8923180103302
Epoch: 1, Steps: 2157 | Train Loss: 1.4579379 Vali Loss: 1.4270920 Test Loss: 1.4200218
Validation loss decreased (inf --> 1.427092).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5278405
	speed: 0.2254s/iter; left time: 96722.8162s
	iters: 200, epoch: 2 | loss: 1.4598264
	speed: 0.0167s/iter; left time: 7183.7781s
	iters: 300, epoch: 2 | loss: 1.3585290
	speed: 0.0168s/iter; left time: 7198.4165s
	iters: 400, epoch: 2 | loss: 1.4411459
	speed: 0.0168s/iter; left time: 7183.9118s
	iters: 500, epoch: 2 | loss: 1.5480409
	speed: 0.0168s/iter; left time: 7198.1483s
	iters: 600, epoch: 2 | loss: 1.2564292
	speed: 0.0168s/iter; left time: 7210.4724s
	iters: 700, epoch: 2 | loss: 1.2842791
	speed: 0.0168s/iter; left time: 7213.9704s
	iters: 800, epoch: 2 | loss: 1.1716067
	speed: 0.0168s/iter; left time: 7194.2935s
	iters: 900, epoch: 2 | loss: 1.4076247
	speed: 0.0168s/iter; left time: 7198.6611s
	iters: 1000, epoch: 2 | loss: 1.3163006
	speed: 0.0169s/iter; left time: 7218.7598s
	iters: 1100, epoch: 2 | loss: 1.4149449
	speed: 0.0168s/iter; left time: 7192.4479s
	iters: 1200, epoch: 2 | loss: 1.4079758
	speed: 0.0168s/iter; left time: 7180.2075s
	iters: 1300, epoch: 2 | loss: 1.3670527
	speed: 0.0170s/iter; left time: 7277.7857s
	iters: 1400, epoch: 2 | loss: 1.4536217
	speed: 0.0169s/iter; left time: 7212.3007s
	iters: 1500, epoch: 2 | loss: 1.3094422
	speed: 0.0168s/iter; left time: 7178.5090s
	iters: 1600, epoch: 2 | loss: 1.8823811
	speed: 0.0168s/iter; left time: 7178.8077s
	iters: 1700, epoch: 2 | loss: 1.6465280
	speed: 0.0169s/iter; left time: 7210.0059s
	iters: 1800, epoch: 2 | loss: 1.8392435
	speed: 0.0168s/iter; left time: 7171.1752s
	iters: 1900, epoch: 2 | loss: 1.2904693
	speed: 0.0169s/iter; left time: 7206.1502s
	iters: 2000, epoch: 2 | loss: 1.1908453
	speed: 0.0168s/iter; left time: 7178.1548s
	iters: 2100, epoch: 2 | loss: 1.4363362
	speed: 0.0168s/iter; left time: 7176.5236s
Epoch: 2 cost time: 36.411818504333496
Epoch: 2, Steps: 2157 | Train Loss: 1.4514418 Vali Loss: 1.4590306 Test Loss: 1.4218210
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 1.4339262
	speed: 0.2226s/iter; left time: 95067.3601s
	iters: 200, epoch: 3 | loss: 1.5153344
	speed: 0.0167s/iter; left time: 7143.5878s
	iters: 300, epoch: 3 | loss: 1.5336466
	speed: 0.0167s/iter; left time: 7136.6771s
	iters: 400, epoch: 3 | loss: 1.3764729
	speed: 0.0167s/iter; left time: 7131.8106s
	iters: 500, epoch: 3 | loss: 1.4356793
	speed: 0.0167s/iter; left time: 7144.6821s
	iters: 600, epoch: 3 | loss: 1.4700397
	speed: 0.0167s/iter; left time: 7140.3036s
	iters: 700, epoch: 3 | loss: 1.2781596
	speed: 0.0168s/iter; left time: 7152.4966s
	iters: 800, epoch: 3 | loss: 1.6770601
	speed: 0.0168s/iter; left time: 7160.2529s
	iters: 900, epoch: 3 | loss: 1.0948819
	speed: 0.0168s/iter; left time: 7179.9846s
	iters: 1000, epoch: 3 | loss: 1.4398798
	speed: 0.0168s/iter; left time: 7153.4883s
	iters: 1100, epoch: 3 | loss: 1.4183940
	speed: 0.0169s/iter; left time: 7202.1523s
	iters: 1200, epoch: 3 | loss: 1.5209085
	speed: 0.0168s/iter; left time: 7142.3821s
	iters: 1300, epoch: 3 | loss: 1.5995686
	speed: 0.0168s/iter; left time: 7170.0633s
	iters: 1400, epoch: 3 | loss: 1.4380965
	speed: 0.0168s/iter; left time: 7132.5873s
	iters: 1500, epoch: 3 | loss: 1.4352115
	speed: 0.0168s/iter; left time: 7147.9949s
	iters: 1600, epoch: 3 | loss: 1.5899687
	speed: 0.0168s/iter; left time: 7134.9252s
	iters: 1700, epoch: 3 | loss: 1.6326295
	speed: 0.0168s/iter; left time: 7144.3193s
	iters: 1800, epoch: 3 | loss: 1.7510900
	speed: 0.0168s/iter; left time: 7157.8706s
	iters: 1900, epoch: 3 | loss: 1.2652454
	speed: 0.0168s/iter; left time: 7158.4532s
	iters: 2000, epoch: 3 | loss: 1.2696266
	speed: 0.0169s/iter; left time: 7172.8151s
	iters: 2100, epoch: 3 | loss: 1.2927071
	speed: 0.0167s/iter; left time: 7106.6781s
Epoch: 3 cost time: 36.3397855758667
Epoch: 3, Steps: 2157 | Train Loss: 1.4515401 Vali Loss: 1.4224446 Test Loss: 1.4316739
Validation loss decreased (1.427092 --> 1.422445).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4536194
	speed: 0.2227s/iter; left time: 94609.1244s
	iters: 200, epoch: 4 | loss: 1.5697402
	speed: 0.0168s/iter; left time: 7122.4377s
	iters: 300, epoch: 4 | loss: 1.7323053
	speed: 0.0167s/iter; left time: 7085.9850s
	iters: 400, epoch: 4 | loss: 1.3470035
	speed: 0.0167s/iter; left time: 7109.2831s
	iters: 500, epoch: 4 | loss: 1.5126842
	speed: 0.0168s/iter; left time: 7113.6294s
	iters: 600, epoch: 4 | loss: 1.3559613
	speed: 0.0167s/iter; left time: 7092.0941s
	iters: 700, epoch: 4 | loss: 1.4150053
	speed: 0.0167s/iter; left time: 7100.5827s
	iters: 800, epoch: 4 | loss: 1.3829356
	speed: 0.0167s/iter; left time: 7092.9347s
	iters: 900, epoch: 4 | loss: 1.1046170
	speed: 0.0167s/iter; left time: 7091.3392s
	iters: 1000, epoch: 4 | loss: 1.2729144
	speed: 0.0167s/iter; left time: 7088.4519s
	iters: 1100, epoch: 4 | loss: 1.4501835
	speed: 0.0168s/iter; left time: 7141.0795s
	iters: 1200, epoch: 4 | loss: 1.4540571
	speed: 0.0167s/iter; left time: 7093.5444s
	iters: 1300, epoch: 4 | loss: 1.5321887
	speed: 0.0169s/iter; left time: 7174.4490s
	iters: 1400, epoch: 4 | loss: 1.4939040
	speed: 0.0170s/iter; left time: 7179.3997s
	iters: 1500, epoch: 4 | loss: 1.6875354
	speed: 0.0169s/iter; left time: 7171.7746s
	iters: 1600, epoch: 4 | loss: 1.7631496
	speed: 0.0167s/iter; left time: 7081.4645s
	iters: 1700, epoch: 4 | loss: 1.3595970
	speed: 0.0169s/iter; left time: 7142.7277s
	iters: 1800, epoch: 4 | loss: 1.6257352
	speed: 0.0168s/iter; left time: 7118.7794s
	iters: 1900, epoch: 4 | loss: 1.5868320
	speed: 0.0167s/iter; left time: 7080.9474s
	iters: 2000, epoch: 4 | loss: 1.4843348
	speed: 0.0167s/iter; left time: 7081.9336s
	iters: 2100, epoch: 4 | loss: 1.4241041
	speed: 0.0168s/iter; left time: 7095.0137s
Epoch: 4 cost time: 36.33704328536987
Epoch: 4, Steps: 2157 | Train Loss: 1.4515384 Vali Loss: 1.4673036 Test Loss: 1.4196199
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 5 | loss: 1.3114532
	speed: 0.2224s/iter; left time: 93996.1255s
	iters: 200, epoch: 5 | loss: 1.5147045
	speed: 0.0169s/iter; left time: 7140.4079s
	iters: 300, epoch: 5 | loss: 1.3805076
	speed: 0.0169s/iter; left time: 7132.8540s
	iters: 400, epoch: 5 | loss: 1.4629765
	speed: 0.0168s/iter; left time: 7111.4784s
	iters: 500, epoch: 5 | loss: 1.5013497
	speed: 0.0169s/iter; left time: 7124.7303s
	iters: 600, epoch: 5 | loss: 1.7759104
	speed: 0.0168s/iter; left time: 7105.8262s
	iters: 700, epoch: 5 | loss: 1.4096475
	speed: 0.0169s/iter; left time: 7135.3887s
	iters: 800, epoch: 5 | loss: 1.5153131
	speed: 0.0168s/iter; left time: 7108.9832s
	iters: 900, epoch: 5 | loss: 1.3834226
	speed: 0.0169s/iter; left time: 7143.4669s
	iters: 1000, epoch: 5 | loss: 1.3452585
	speed: 0.0169s/iter; left time: 7141.9677s
	iters: 1100, epoch: 5 | loss: 1.2044368
	speed: 0.0169s/iter; left time: 7113.4749s
	iters: 1200, epoch: 5 | loss: 1.2081152
	speed: 0.0169s/iter; left time: 7106.1291s
	iters: 1300, epoch: 5 | loss: 1.6030431
	speed: 0.0169s/iter; left time: 7135.5272s
	iters: 1400, epoch: 5 | loss: 1.6267439
	speed: 0.0169s/iter; left time: 7113.2021s
	iters: 1500, epoch: 5 | loss: 1.4203651
	speed: 0.0169s/iter; left time: 7136.3134s
	iters: 1600, epoch: 5 | loss: 1.3919326
	speed: 0.0169s/iter; left time: 7118.2015s
	iters: 1700, epoch: 5 | loss: 1.3692120
	speed: 0.0169s/iter; left time: 7103.6462s
	iters: 1800, epoch: 5 | loss: 1.3063295
	speed: 0.0170s/iter; left time: 7153.3626s
	iters: 1900, epoch: 5 | loss: 1.5184882
	speed: 0.0169s/iter; left time: 7099.0981s
	iters: 2000, epoch: 5 | loss: 1.5561404
	speed: 0.0169s/iter; left time: 7111.4411s
	iters: 2100, epoch: 5 | loss: 1.5344005
	speed: 0.0169s/iter; left time: 7091.5282s
Epoch: 5 cost time: 36.570099115371704
Epoch: 5, Steps: 2157 | Train Loss: 1.4517171 Vali Loss: 1.4637916 Test Loss: 1.4369723
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 6 | loss: 1.4501898
	speed: 0.2237s/iter; left time: 94053.9818s
	iters: 200, epoch: 6 | loss: 1.5995268
	speed: 0.0173s/iter; left time: 7255.6738s
	iters: 300, epoch: 6 | loss: 1.3361200
	speed: 0.0172s/iter; left time: 7209.2879s
	iters: 400, epoch: 6 | loss: 1.4133310
	speed: 0.0173s/iter; left time: 7249.1674s
	iters: 500, epoch: 6 | loss: 1.4100065
	speed: 0.0171s/iter; left time: 7194.6882s
	iters: 600, epoch: 6 | loss: 1.4790282
	speed: 0.0171s/iter; left time: 7190.3861s
	iters: 700, epoch: 6 | loss: 1.5207988
	speed: 0.0171s/iter; left time: 7185.2141s
	iters: 800, epoch: 6 | loss: 1.5848722
	speed: 0.0171s/iter; left time: 7172.5009s
	iters: 900, epoch: 6 | loss: 1.3753617
	speed: 0.0171s/iter; left time: 7171.6520s
	iters: 1000, epoch: 6 | loss: 1.3772748
	speed: 0.0171s/iter; left time: 7154.5125s
	iters: 1100, epoch: 6 | loss: 1.1736906
	speed: 0.0170s/iter; left time: 7141.2791s
	iters: 1200, epoch: 6 | loss: 1.5274920
	speed: 0.0171s/iter; left time: 7153.1174s
	iters: 1300, epoch: 6 | loss: 1.1185904
	speed: 0.0170s/iter; left time: 7140.7378s
	iters: 1400, epoch: 6 | loss: 1.3151975
	speed: 0.0171s/iter; left time: 7169.2664s
	iters: 1500, epoch: 6 | loss: 1.4844922
	speed: 0.0171s/iter; left time: 7156.0339s
	iters: 1600, epoch: 6 | loss: 1.3479549
	speed: 0.0170s/iter; left time: 7114.4649s
	iters: 1700, epoch: 6 | loss: 1.4636508
	speed: 0.0170s/iter; left time: 7125.7621s
	iters: 1800, epoch: 6 | loss: 1.6070234
	speed: 0.0170s/iter; left time: 7107.8898s
	iters: 1900, epoch: 6 | loss: 1.6106921
	speed: 0.0171s/iter; left time: 7175.8358s
	iters: 2000, epoch: 6 | loss: 1.4932706
	speed: 0.0169s/iter; left time: 7094.7794s
	iters: 2100, epoch: 6 | loss: 1.3397708
	speed: 0.0170s/iter; left time: 7123.5380s
Epoch: 6 cost time: 36.969115257263184
Epoch: 6, Steps: 2157 | Train Loss: 1.4514980 Vali Loss: 1.4138259 Test Loss: 1.4322447
Validation loss decreased (1.422445 --> 1.413826).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5342108
	speed: 0.2237s/iter; left time: 93567.6272s
	iters: 200, epoch: 7 | loss: 1.3417205
	speed: 0.0170s/iter; left time: 7112.0795s
	iters: 300, epoch: 7 | loss: 1.4161205
	speed: 0.0171s/iter; left time: 7170.1115s
	iters: 400, epoch: 7 | loss: 1.3879617
	speed: 0.0170s/iter; left time: 7124.3533s
	iters: 500, epoch: 7 | loss: 1.4623666
	speed: 0.0171s/iter; left time: 7129.4053s
	iters: 600, epoch: 7 | loss: 1.7200789
	speed: 0.0171s/iter; left time: 7134.8069s
	iters: 700, epoch: 7 | loss: 1.4466465
	speed: 0.0170s/iter; left time: 7089.0895s
	iters: 800, epoch: 7 | loss: 1.2584338
	speed: 0.0170s/iter; left time: 7098.8748s
	iters: 900, epoch: 7 | loss: 1.3123263
	speed: 0.0169s/iter; left time: 7076.5257s
	iters: 1000, epoch: 7 | loss: 1.4681042
	speed: 0.0170s/iter; left time: 7111.4510s
	iters: 1100, epoch: 7 | loss: 1.7065079
	speed: 0.0170s/iter; left time: 7095.2365s
	iters: 1200, epoch: 7 | loss: 1.4382656
	speed: 0.0170s/iter; left time: 7101.4633s
	iters: 1300, epoch: 7 | loss: 1.2158582
	speed: 0.0169s/iter; left time: 7055.4387s
	iters: 1400, epoch: 7 | loss: 1.5028578
	speed: 0.0169s/iter; left time: 7062.7939s
	iters: 1500, epoch: 7 | loss: 1.4344258
	speed: 0.0169s/iter; left time: 7063.6623s
	iters: 1600, epoch: 7 | loss: 1.2488056
	speed: 0.0170s/iter; left time: 7089.0590s
	iters: 1700, epoch: 7 | loss: 1.4262444
	speed: 0.0169s/iter; left time: 7059.2476s
	iters: 1800, epoch: 7 | loss: 1.3219055
	speed: 0.0169s/iter; left time: 7039.6876s
	iters: 1900, epoch: 7 | loss: 1.4142051
	speed: 0.0169s/iter; left time: 7050.0242s
	iters: 2000, epoch: 7 | loss: 1.4705381
	speed: 0.0169s/iter; left time: 7031.0947s
	iters: 2100, epoch: 7 | loss: 1.3870277
	speed: 0.0169s/iter; left time: 7026.5475s
Epoch: 7 cost time: 36.75407576560974
Epoch: 7, Steps: 2157 | Train Loss: 1.4515335 Vali Loss: 1.4191667 Test Loss: 1.4364691
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 8 | loss: 1.7278217
	speed: 0.2232s/iter; left time: 92899.4635s
	iters: 200, epoch: 8 | loss: 1.2709020
	speed: 0.0170s/iter; left time: 7092.5140s
	iters: 300, epoch: 8 | loss: 1.5397781
	speed: 0.0170s/iter; left time: 7080.7722s
	iters: 400, epoch: 8 | loss: 1.2411913
	speed: 0.0171s/iter; left time: 7106.8494s
	iters: 500, epoch: 8 | loss: 1.6076337
	speed: 0.0171s/iter; left time: 7093.0670s
	iters: 600, epoch: 8 | loss: 1.4368976
	speed: 0.0170s/iter; left time: 7062.6585s
	iters: 700, epoch: 8 | loss: 1.2972813
	speed: 0.0172s/iter; left time: 7127.6076s
	iters: 800, epoch: 8 | loss: 1.3612218
	speed: 0.0170s/iter; left time: 7055.9568s
	iters: 900, epoch: 8 | loss: 1.4474862
	speed: 0.0170s/iter; left time: 7057.6448s
	iters: 1000, epoch: 8 | loss: 1.4546639
	speed: 0.0170s/iter; left time: 7044.6650s
	iters: 1100, epoch: 8 | loss: 1.3632325
	speed: 0.0170s/iter; left time: 7041.8590s
	iters: 1200, epoch: 8 | loss: 1.3120739
	speed: 0.0170s/iter; left time: 7044.5463s
	iters: 1300, epoch: 8 | loss: 1.4145955
	speed: 0.0169s/iter; left time: 7029.1286s
	iters: 1400, epoch: 8 | loss: 1.4516631
	speed: 0.0169s/iter; left time: 7012.2902s
	iters: 1500, epoch: 8 | loss: 1.3941531
	speed: 0.0169s/iter; left time: 7021.1533s
	iters: 1600, epoch: 8 | loss: 1.4343686
	speed: 0.0169s/iter; left time: 7017.5781s
	iters: 1700, epoch: 8 | loss: 1.6845070
	speed: 0.0169s/iter; left time: 6995.9590s
	iters: 1800, epoch: 8 | loss: 1.6040243
	speed: 0.0169s/iter; left time: 7021.3407s
	iters: 1900, epoch: 8 | loss: 1.3484133
	speed: 0.0170s/iter; left time: 7055.8802s
	iters: 2000, epoch: 8 | loss: 1.4647741
	speed: 0.0168s/iter; left time: 6978.7324s
	iters: 2100, epoch: 8 | loss: 1.4629983
	speed: 0.0169s/iter; left time: 6984.4693s
Epoch: 8 cost time: 36.744739294052124
Epoch: 8, Steps: 2157 | Train Loss: 1.4515442 Vali Loss: 1.4325339 Test Loss: 1.4386514
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 9 | loss: 1.4933981
	speed: 0.2235s/iter; left time: 92557.1606s
	iters: 200, epoch: 9 | loss: 1.3696296
	speed: 0.0170s/iter; left time: 7040.9023s
	iters: 300, epoch: 9 | loss: 1.3125268
	speed: 0.0170s/iter; left time: 7045.5922s
	iters: 400, epoch: 9 | loss: 1.4510895
	speed: 0.0170s/iter; left time: 7026.6723s
	iters: 500, epoch: 9 | loss: 1.5252987
	speed: 0.0170s/iter; left time: 7046.3204s
	iters: 600, epoch: 9 | loss: 1.3548975
	speed: 0.0170s/iter; left time: 7043.4101s
	iters: 700, epoch: 9 | loss: 1.5144278
	speed: 0.0170s/iter; left time: 7011.6747s
	iters: 800, epoch: 9 | loss: 1.5623288
	speed: 0.0169s/iter; left time: 7006.0920s
	iters: 900, epoch: 9 | loss: 1.4360175
	speed: 0.0171s/iter; left time: 7052.3000s
	iters: 1000, epoch: 9 | loss: 1.3903414
	speed: 0.0170s/iter; left time: 7029.1271s
	iters: 1100, epoch: 9 | loss: 1.7073028
	speed: 0.0171s/iter; left time: 7052.9294s
	iters: 1200, epoch: 9 | loss: 1.3198441
	speed: 0.0169s/iter; left time: 6994.7360s
	iters: 1300, epoch: 9 | loss: 1.4475945
	speed: 0.0171s/iter; left time: 7041.1616s
	iters: 1400, epoch: 9 | loss: 1.3124473
	speed: 0.0170s/iter; left time: 7007.2605s
	iters: 1500, epoch: 9 | loss: 1.2437210
	speed: 0.0169s/iter; left time: 6968.7728s
	iters: 1600, epoch: 9 | loss: 1.5044020
	speed: 0.0169s/iter; left time: 6967.9751s
	iters: 1700, epoch: 9 | loss: 1.4795609
	speed: 0.0170s/iter; left time: 6998.5664s
	iters: 1800, epoch: 9 | loss: 1.4184369
	speed: 0.0169s/iter; left time: 6956.3154s
	iters: 1900, epoch: 9 | loss: 1.2730726
	speed: 0.0170s/iter; left time: 6994.9289s
	iters: 2000, epoch: 9 | loss: 1.3017521
	speed: 0.0169s/iter; left time: 6959.8620s
	iters: 2100, epoch: 9 | loss: 1.2709194
	speed: 0.0169s/iter; left time: 6945.3020s
Epoch: 9 cost time: 36.73894262313843
Epoch: 9, Steps: 2157 | Train Loss: 1.4515287 Vali Loss: 1.4733894 Test Loss: 1.4628611
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 10 | loss: 1.4875727
	speed: 0.2244s/iter; left time: 92414.1038s
	iters: 200, epoch: 10 | loss: 1.3803650
	speed: 0.0169s/iter; left time: 6966.1606s
	iters: 300, epoch: 10 | loss: 1.1045527
	speed: 0.0169s/iter; left time: 6951.6676s
	iters: 400, epoch: 10 | loss: 1.4086730
	speed: 0.0169s/iter; left time: 6966.4728s
	iters: 500, epoch: 10 | loss: 1.3848196
	speed: 0.0171s/iter; left time: 7045.4217s
	iters: 600, epoch: 10 | loss: 1.2843214
	speed: 0.0169s/iter; left time: 6959.5194s
	iters: 700, epoch: 10 | loss: 1.5892797
	speed: 0.0169s/iter; left time: 6938.3679s
	iters: 800, epoch: 10 | loss: 1.2893015
	speed: 0.0169s/iter; left time: 6934.4810s
	iters: 900, epoch: 10 | loss: 1.3740047
	speed: 0.0168s/iter; left time: 6919.4131s
	iters: 1000, epoch: 10 | loss: 1.5307242
	speed: 0.0170s/iter; left time: 6976.9259s
	iters: 1100, epoch: 10 | loss: 1.7067891
	speed: 0.0169s/iter; left time: 6939.9811s
	iters: 1200, epoch: 10 | loss: 1.6090842
	speed: 0.0169s/iter; left time: 6950.5551s
	iters: 1300, epoch: 10 | loss: 1.5629200
	speed: 0.0168s/iter; left time: 6909.1495s
	iters: 1400, epoch: 10 | loss: 1.6486051
	speed: 0.0168s/iter; left time: 6907.1265s
	iters: 1500, epoch: 10 | loss: 1.3614810
	speed: 0.0168s/iter; left time: 6906.9133s
	iters: 1600, epoch: 10 | loss: 1.5580403
	speed: 0.0168s/iter; left time: 6890.6656s
	iters: 1700, epoch: 10 | loss: 1.3511765
	speed: 0.0168s/iter; left time: 6885.1862s
	iters: 1800, epoch: 10 | loss: 1.5027083
	speed: 0.0168s/iter; left time: 6896.3996s
	iters: 1900, epoch: 10 | loss: 1.3680792
	speed: 0.0169s/iter; left time: 6938.1264s
	iters: 2000, epoch: 10 | loss: 1.5030104
	speed: 0.0168s/iter; left time: 6868.9859s
	iters: 2100, epoch: 10 | loss: 1.2682034
	speed: 0.0168s/iter; left time: 6904.7763s
Epoch: 10 cost time: 36.54220771789551
Epoch: 10, Steps: 2157 | Train Loss: 1.4516695 Vali Loss: 1.4425503 Test Loss: 1.4171859
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 11 | loss: 1.4985416
	speed: 0.2253s/iter; left time: 92329.8207s
	iters: 200, epoch: 11 | loss: 1.2245667
	speed: 0.0172s/iter; left time: 7048.8342s
	iters: 300, epoch: 11 | loss: 1.4382133
	speed: 0.0172s/iter; left time: 7028.7396s
	iters: 400, epoch: 11 | loss: 1.4860640
	speed: 0.0173s/iter; left time: 7067.0732s
	iters: 500, epoch: 11 | loss: 1.4279095
	speed: 0.0172s/iter; left time: 7056.4555s
	iters: 600, epoch: 11 | loss: 1.5059373
	speed: 0.0172s/iter; left time: 7025.4435s
	iters: 700, epoch: 11 | loss: 1.5576354
	speed: 0.0173s/iter; left time: 7060.4962s
	iters: 800, epoch: 11 | loss: 1.6297641
	speed: 0.0172s/iter; left time: 7015.5903s
	iters: 900, epoch: 11 | loss: 1.6479774
	speed: 0.0171s/iter; left time: 6998.4784s
	iters: 1000, epoch: 11 | loss: 1.3879895
	speed: 0.0172s/iter; left time: 7041.5802s
	iters: 1100, epoch: 11 | loss: 1.3855850
	speed: 0.0171s/iter; left time: 7001.3225s
	iters: 1200, epoch: 11 | loss: 1.3823189
	speed: 0.0172s/iter; left time: 7013.0358s
	iters: 1300, epoch: 11 | loss: 1.1760808
	speed: 0.0172s/iter; left time: 7012.5887s
	iters: 1400, epoch: 11 | loss: 1.3074419
	speed: 0.0171s/iter; left time: 6976.1590s
	iters: 1500, epoch: 11 | loss: 1.4751667
	speed: 0.0171s/iter; left time: 6976.5363s
	iters: 1600, epoch: 11 | loss: 1.4705018
	speed: 0.0172s/iter; left time: 7009.5842s
	iters: 1700, epoch: 11 | loss: 1.4226416
	speed: 0.0172s/iter; left time: 7000.2150s
	iters: 1800, epoch: 11 | loss: 1.4534906
	speed: 0.0171s/iter; left time: 6990.2746s
	iters: 1900, epoch: 11 | loss: 1.3258321
	speed: 0.0171s/iter; left time: 6994.6751s
	iters: 2000, epoch: 11 | loss: 1.4378724
	speed: 0.0170s/iter; left time: 6949.4470s
	iters: 2100, epoch: 11 | loss: 1.3587003
	speed: 0.0171s/iter; left time: 6988.6502s
Epoch: 11 cost time: 37.1469042301178
Epoch: 11, Steps: 2157 | Train Loss: 1.4515562 Vali Loss: 1.3639607 Test Loss: 1.4153517
Validation loss decreased (1.413826 --> 1.363961).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.3419402
	speed: 0.2248s/iter; left time: 91611.2680s
	iters: 200, epoch: 12 | loss: 1.4490247
	speed: 0.0170s/iter; left time: 6913.4213s
	iters: 300, epoch: 12 | loss: 1.7189293
	speed: 0.0170s/iter; left time: 6907.5687s
	iters: 400, epoch: 12 | loss: 1.3867904
	speed: 0.0170s/iter; left time: 6911.1175s
	iters: 500, epoch: 12 | loss: 1.5401583
	speed: 0.0170s/iter; left time: 6929.6070s
	iters: 600, epoch: 12 | loss: 1.5315920
	speed: 0.0171s/iter; left time: 6956.9708s
	iters: 700, epoch: 12 | loss: 1.4542774
	speed: 0.0169s/iter; left time: 6886.2404s
	iters: 800, epoch: 12 | loss: 1.5970231
	speed: 0.0170s/iter; left time: 6921.9636s
	iters: 900, epoch: 12 | loss: 1.3196902
	speed: 0.0169s/iter; left time: 6890.9281s
	iters: 1000, epoch: 12 | loss: 1.3111732
	speed: 0.0170s/iter; left time: 6923.4672s
	iters: 1100, epoch: 12 | loss: 1.4433528
	speed: 0.0170s/iter; left time: 6905.7870s
	iters: 1200, epoch: 12 | loss: 1.7051578
	speed: 0.0170s/iter; left time: 6898.0790s
	iters: 1300, epoch: 12 | loss: 1.5518111
	speed: 0.0169s/iter; left time: 6882.2500s
	iters: 1400, epoch: 12 | loss: 1.2971702
	speed: 0.0170s/iter; left time: 6913.7999s
	iters: 1500, epoch: 12 | loss: 1.4286447
	speed: 0.0168s/iter; left time: 6839.9702s
	iters: 1600, epoch: 12 | loss: 1.2210588
	speed: 0.0169s/iter; left time: 6876.2302s
	iters: 1700, epoch: 12 | loss: 1.2610968
	speed: 0.0168s/iter; left time: 6839.4353s
	iters: 1800, epoch: 12 | loss: 1.4051729
	speed: 0.0169s/iter; left time: 6842.1719s
	iters: 1900, epoch: 12 | loss: 1.3467169
	speed: 0.0169s/iter; left time: 6839.1879s
	iters: 2000, epoch: 12 | loss: 1.4119133
	speed: 0.0170s/iter; left time: 6881.3437s
	iters: 2100, epoch: 12 | loss: 1.4060054
	speed: 0.0169s/iter; left time: 6836.9086s
Epoch: 12 cost time: 36.69971704483032
Epoch: 12, Steps: 2157 | Train Loss: 1.4516627 Vali Loss: 1.4065636 Test Loss: 1.4295689
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 13 | loss: 1.4628167
	speed: 0.2249s/iter; left time: 91168.2289s
	iters: 200, epoch: 13 | loss: 1.3545283
	speed: 0.0170s/iter; left time: 6880.2947s
	iters: 300, epoch: 13 | loss: 1.4357970
	speed: 0.0171s/iter; left time: 6934.1168s
	iters: 400, epoch: 13 | loss: 1.5835122
	speed: 0.0171s/iter; left time: 6937.8937s
	iters: 500, epoch: 13 | loss: 1.5446209
	speed: 0.0169s/iter; left time: 6858.0158s
	iters: 600, epoch: 13 | loss: 1.6056056
	speed: 0.0170s/iter; left time: 6886.2247s
	iters: 700, epoch: 13 | loss: 1.5490464
	speed: 0.0170s/iter; left time: 6886.0847s
	iters: 800, epoch: 13 | loss: 1.4335568
	speed: 0.0169s/iter; left time: 6849.2847s
	iters: 900, epoch: 13 | loss: 1.5517410
	speed: 0.0171s/iter; left time: 6915.3892s
	iters: 1000, epoch: 13 | loss: 1.2947736
	speed: 0.0171s/iter; left time: 6911.0385s
	iters: 1100, epoch: 13 | loss: 1.5668681
	speed: 0.0170s/iter; left time: 6872.8686s
	iters: 1200, epoch: 13 | loss: 1.4203960
	speed: 0.0169s/iter; left time: 6842.9828s
	iters: 1300, epoch: 13 | loss: 1.8489873
	speed: 0.0171s/iter; left time: 6906.4143s
	iters: 1400, epoch: 13 | loss: 1.2405354
	speed: 0.0169s/iter; left time: 6844.6436s
	iters: 1500, epoch: 13 | loss: 1.5201735
	speed: 0.0169s/iter; left time: 6834.4502s
	iters: 1600, epoch: 13 | loss: 1.3708485
	speed: 0.0170s/iter; left time: 6851.7010s
	iters: 1700, epoch: 13 | loss: 1.3146862
	speed: 0.0168s/iter; left time: 6803.1397s
	iters: 1800, epoch: 13 | loss: 1.3313159
	speed: 0.0170s/iter; left time: 6854.2790s
	iters: 1900, epoch: 13 | loss: 1.4251882
	speed: 0.0168s/iter; left time: 6798.7916s
	iters: 2000, epoch: 13 | loss: 1.5381312
	speed: 0.0169s/iter; left time: 6809.1387s
	iters: 2100, epoch: 13 | loss: 1.6761808
	speed: 0.0168s/iter; left time: 6792.1602s
Epoch: 13 cost time: 36.74667191505432
Epoch: 13, Steps: 2157 | Train Loss: 1.4514548 Vali Loss: 1.4335469 Test Loss: 1.4326087
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 14 | loss: 1.4173971
	speed: 0.2250s/iter; left time: 90716.2093s
	iters: 200, epoch: 14 | loss: 1.6247997
	speed: 0.0169s/iter; left time: 6826.4699s
	iters: 300, epoch: 14 | loss: 1.3326243
	speed: 0.0169s/iter; left time: 6825.6502s
	iters: 400, epoch: 14 | loss: 1.3120193
	speed: 0.0169s/iter; left time: 6829.2619s
	iters: 500, epoch: 14 | loss: 1.3045020
	speed: 0.0169s/iter; left time: 6816.9124s
	iters: 600, epoch: 14 | loss: 1.3720187
	speed: 0.0170s/iter; left time: 6858.1734s
	iters: 700, epoch: 14 | loss: 1.5444449
	speed: 0.0169s/iter; left time: 6801.4387s
	iters: 800, epoch: 14 | loss: 1.6700784
	speed: 0.0169s/iter; left time: 6819.4576s
	iters: 900, epoch: 14 | loss: 1.5242467
	speed: 0.0171s/iter; left time: 6875.3676s
	iters: 1000, epoch: 14 | loss: 1.5035708
	speed: 0.0169s/iter; left time: 6786.5854s
	iters: 1100, epoch: 14 | loss: 1.6661011
	speed: 0.0169s/iter; left time: 6781.5708s
	iters: 1200, epoch: 14 | loss: 1.5037464
	speed: 0.0169s/iter; left time: 6810.5174s
	iters: 1300, epoch: 14 | loss: 1.3307240
	speed: 0.0169s/iter; left time: 6789.2391s
	iters: 1400, epoch: 14 | loss: 1.4811701
	speed: 0.0169s/iter; left time: 6776.2324s
	iters: 1500, epoch: 14 | loss: 1.4722061
	speed: 0.0169s/iter; left time: 6784.7658s
	iters: 1600, epoch: 14 | loss: 1.8320452
	speed: 0.0169s/iter; left time: 6779.0199s
	iters: 1700, epoch: 14 | loss: 1.5359569
	speed: 0.0168s/iter; left time: 6755.8586s
	iters: 1800, epoch: 14 | loss: 1.4335815
	speed: 0.0168s/iter; left time: 6759.8913s
	iters: 1900, epoch: 14 | loss: 1.4721534
	speed: 0.0169s/iter; left time: 6777.3730s
	iters: 2000, epoch: 14 | loss: 1.2787026
	speed: 0.0169s/iter; left time: 6779.5967s
	iters: 2100, epoch: 14 | loss: 1.5644885
	speed: 0.0168s/iter; left time: 6756.5507s
Epoch: 14 cost time: 36.60432720184326
Epoch: 14, Steps: 2157 | Train Loss: 1.4516060 Vali Loss: 1.4424317 Test Loss: 1.4547412
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 15 | loss: 1.5579031
	speed: 0.2241s/iter; left time: 89900.7717s
	iters: 200, epoch: 15 | loss: 1.6549097
	speed: 0.0170s/iter; left time: 6834.1686s
	iters: 300, epoch: 15 | loss: 1.4735359
	speed: 0.0170s/iter; left time: 6833.7939s
	iters: 400, epoch: 15 | loss: 1.1593980
	speed: 0.0171s/iter; left time: 6841.1177s
	iters: 500, epoch: 15 | loss: 1.5381600
	speed: 0.0171s/iter; left time: 6844.1971s
	iters: 600, epoch: 15 | loss: 1.7311463
	speed: 0.0171s/iter; left time: 6844.9982s
	iters: 700, epoch: 15 | loss: 1.3490902
	speed: 0.0171s/iter; left time: 6862.4538s
	iters: 800, epoch: 15 | loss: 1.2810472
	speed: 0.0170s/iter; left time: 6824.7716s
	iters: 900, epoch: 15 | loss: 1.6909366
	speed: 0.0170s/iter; left time: 6807.8483s
	iters: 1000, epoch: 15 | loss: 1.6191875
	speed: 0.0169s/iter; left time: 6783.1019s
	iters: 1100, epoch: 15 | loss: 1.4149615
	speed: 0.0170s/iter; left time: 6793.1115s
	iters: 1200, epoch: 15 | loss: 1.2551849
	speed: 0.0170s/iter; left time: 6801.9471s
	iters: 1300, epoch: 15 | loss: 1.3904910
	speed: 0.0170s/iter; left time: 6807.6396s
	iters: 1400, epoch: 15 | loss: 1.2350258
	speed: 0.0170s/iter; left time: 6778.1104s
	iters: 1500, epoch: 15 | loss: 1.5824033
	speed: 0.0170s/iter; left time: 6777.6244s
	iters: 1600, epoch: 15 | loss: 1.3612688
	speed: 0.0170s/iter; left time: 6803.0348s
	iters: 1700, epoch: 15 | loss: 1.2848785
	speed: 0.0170s/iter; left time: 6798.2634s
	iters: 1800, epoch: 15 | loss: 1.5028421
	speed: 0.0169s/iter; left time: 6756.3662s
	iters: 1900, epoch: 15 | loss: 1.4014305
	speed: 0.0169s/iter; left time: 6764.6470s
	iters: 2000, epoch: 15 | loss: 1.3446931
	speed: 0.0171s/iter; left time: 6811.8521s
	iters: 2100, epoch: 15 | loss: 1.4972929
	speed: 0.0169s/iter; left time: 6758.1110s
Epoch: 15 cost time: 36.842071533203125
Epoch: 15, Steps: 2157 | Train Loss: 1.4515206 Vali Loss: 1.4290353 Test Loss: 1.4137217
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 16 | loss: 1.5516913
	speed: 0.2239s/iter; left time: 89325.8132s
	iters: 200, epoch: 16 | loss: 1.3913255
	speed: 0.0170s/iter; left time: 6794.1715s
	iters: 300, epoch: 16 | loss: 1.5526818
	speed: 0.0170s/iter; left time: 6768.4129s
	iters: 400, epoch: 16 | loss: 1.6811041
	speed: 0.0171s/iter; left time: 6818.1451s
	iters: 500, epoch: 16 | loss: 1.2864461
	speed: 0.0170s/iter; left time: 6780.9540s
	iters: 600, epoch: 16 | loss: 1.3774378
	speed: 0.0171s/iter; left time: 6795.1759s
	iters: 700, epoch: 16 | loss: 1.5109129
	speed: 0.0169s/iter; left time: 6744.1624s
	iters: 800, epoch: 16 | loss: 1.4353743
	speed: 0.0170s/iter; left time: 6757.2833s
	iters: 900, epoch: 16 | loss: 1.3254218
	speed: 0.0169s/iter; left time: 6739.1474s
	iters: 1000, epoch: 16 | loss: 1.2257093
	speed: 0.0170s/iter; left time: 6765.6510s
	iters: 1100, epoch: 16 | loss: 1.4160802
	speed: 0.0170s/iter; left time: 6783.1592s
	iters: 1200, epoch: 16 | loss: 1.3609679
	speed: 0.0171s/iter; left time: 6786.0466s
	iters: 1300, epoch: 16 | loss: 1.4878252
	speed: 0.0170s/iter; left time: 6770.9499s
	iters: 1400, epoch: 16 | loss: 1.5179572
	speed: 0.0170s/iter; left time: 6775.3844s
	iters: 1500, epoch: 16 | loss: 1.4616947
	speed: 0.0171s/iter; left time: 6783.3550s
	iters: 1600, epoch: 16 | loss: 1.4253720
	speed: 0.0170s/iter; left time: 6766.4854s
	iters: 1700, epoch: 16 | loss: 1.2684042
	speed: 0.0170s/iter; left time: 6773.1281s
	iters: 1800, epoch: 16 | loss: 1.5497861
	speed: 0.0171s/iter; left time: 6803.7436s
	iters: 1900, epoch: 16 | loss: 1.6645393
	speed: 0.0171s/iter; left time: 6787.9916s
	iters: 2000, epoch: 16 | loss: 1.3037115
	speed: 0.0171s/iter; left time: 6785.5677s
	iters: 2100, epoch: 16 | loss: 1.3337982
	speed: 0.0170s/iter; left time: 6764.6232s
Epoch: 16 cost time: 36.87851166725159
Epoch: 16, Steps: 2157 | Train Loss: 1.4515936 Vali Loss: 1.4424278 Test Loss: 1.4567920
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems06_all_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 89794
test shape: (8979, 1, 336, 130) (8979, 1, 336, 130)
test shape: (8979, 336, 130) (8979, 336, 130)
mse:1.4153493642807007, mae:0.9338586330413818
>>>>>>>Overall time: 988 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
