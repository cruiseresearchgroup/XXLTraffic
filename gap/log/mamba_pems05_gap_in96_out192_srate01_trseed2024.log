Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=103, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems05_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=103, expand=2, factor=1, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems05_all_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=192, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_192_Mamba_custom_ftM_sl192_ll48_pl192_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 653287
val 147620
test 147619
	iters: 100, epoch: 1 | loss: 1.1814201
	speed: 0.0350s/iter; left time: 710.2149s
	iters: 200, epoch: 1 | loss: 1.0674897
	speed: 0.0149s/iter; left time: 301.0428s
	iters: 300, epoch: 1 | loss: 0.9340582
	speed: 0.0151s/iter; left time: 302.8568s
	iters: 400, epoch: 1 | loss: 0.9856194
	speed: 0.0148s/iter; left time: 296.3427s
	iters: 500, epoch: 1 | loss: 1.0064799
	speed: 0.0149s/iter; left time: 296.1159s
	iters: 600, epoch: 1 | loss: 0.8881592
	speed: 0.0147s/iter; left time: 290.2972s
	iters: 700, epoch: 1 | loss: 0.9829442
	speed: 0.0147s/iter; left time: 289.1971s
	iters: 800, epoch: 1 | loss: 0.9429659
	speed: 0.0168s/iter; left time: 330.0305s
	iters: 900, epoch: 1 | loss: 0.8214087
	speed: 0.0158s/iter; left time: 307.6211s
	iters: 1000, epoch: 1 | loss: 0.9691698
	speed: 0.0156s/iter; left time: 302.1739s
	iters: 1100, epoch: 1 | loss: 0.8709483
	speed: 0.0156s/iter; left time: 301.7061s
	iters: 1200, epoch: 1 | loss: 0.9222686
	speed: 0.0147s/iter; left time: 283.1853s
	iters: 1300, epoch: 1 | loss: 0.8498371
	speed: 0.0135s/iter; left time: 257.9955s
	iters: 1400, epoch: 1 | loss: 0.8147258
	speed: 0.0137s/iter; left time: 261.0390s
	iters: 1500, epoch: 1 | loss: 0.8217782
	speed: 0.0128s/iter; left time: 242.8658s
	iters: 1600, epoch: 1 | loss: 0.8428595
	speed: 0.0146s/iter; left time: 273.8569s
	iters: 1700, epoch: 1 | loss: 0.7371762
	speed: 0.0149s/iter; left time: 279.5677s
	iters: 1800, epoch: 1 | loss: 0.8494660
	speed: 0.0147s/iter; left time: 273.7666s
	iters: 1900, epoch: 1 | loss: 0.8320075
	speed: 0.0156s/iter; left time: 289.2290s
	iters: 2000, epoch: 1 | loss: 0.9500480
	speed: 0.0149s/iter; left time: 274.7515s
Epoch: 1 cost time: 32.464041233062744
Epoch: 1, Steps: 2041 | Train Loss: 0.9158963 Vali Loss: 1.3879601 Test Loss: 2.2017775
Validation loss decreased (inf --> 1.387960).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8499310
	speed: 0.3982s/iter; left time: 7274.8522s
	iters: 200, epoch: 2 | loss: 0.7696419
	speed: 0.0145s/iter; left time: 263.9403s
	iters: 300, epoch: 2 | loss: 0.8128061
	speed: 0.0144s/iter; left time: 260.8406s
	iters: 400, epoch: 2 | loss: 0.8193308
	speed: 0.0146s/iter; left time: 262.2094s
	iters: 500, epoch: 2 | loss: 0.8688388
	speed: 0.0154s/iter; left time: 275.3418s
	iters: 600, epoch: 2 | loss: 0.8403503
	speed: 0.0163s/iter; left time: 288.9274s
	iters: 700, epoch: 2 | loss: 0.7103823
	speed: 0.0147s/iter; left time: 259.5326s
	iters: 800, epoch: 2 | loss: 0.8089469
	speed: 0.0144s/iter; left time: 252.6938s
	iters: 900, epoch: 2 | loss: 0.8429627
	speed: 0.0140s/iter; left time: 244.8200s
	iters: 1000, epoch: 2 | loss: 0.8757449
	speed: 0.0141s/iter; left time: 245.4276s
	iters: 1100, epoch: 2 | loss: 0.8329081
	speed: 0.0142s/iter; left time: 245.0272s
	iters: 1200, epoch: 2 | loss: 0.8327366
	speed: 0.0142s/iter; left time: 244.5490s
	iters: 1300, epoch: 2 | loss: 0.7808729
	speed: 0.0143s/iter; left time: 244.4156s
	iters: 1400, epoch: 2 | loss: 0.7459823
	speed: 0.0144s/iter; left time: 243.5498s
	iters: 1500, epoch: 2 | loss: 0.7107975
	speed: 0.0142s/iter; left time: 239.4437s
	iters: 1600, epoch: 2 | loss: 0.7972848
	speed: 0.0142s/iter; left time: 238.1633s
	iters: 1700, epoch: 2 | loss: 0.8115385
	speed: 0.0147s/iter; left time: 244.9931s
	iters: 1800, epoch: 2 | loss: 0.7727581
	speed: 0.0141s/iter; left time: 234.2559s
	iters: 1900, epoch: 2 | loss: 0.7434278
	speed: 0.0140s/iter; left time: 231.2547s
	iters: 2000, epoch: 2 | loss: 0.7445658
	speed: 0.0141s/iter; left time: 231.2349s
Epoch: 2 cost time: 29.873119831085205
Epoch: 2, Steps: 2041 | Train Loss: 0.7912833 Vali Loss: 1.3276391 Test Loss: 2.1255457
Validation loss decreased (1.387960 --> 1.327639).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7336164
	speed: 0.3637s/iter; left time: 5901.8802s
	iters: 200, epoch: 3 | loss: 0.8313213
	speed: 0.0148s/iter; left time: 238.4592s
	iters: 300, epoch: 3 | loss: 0.7906126
	speed: 0.0148s/iter; left time: 237.6002s
	iters: 400, epoch: 3 | loss: 0.7065340
	speed: 0.0154s/iter; left time: 244.6797s
	iters: 500, epoch: 3 | loss: 0.7264742
	speed: 0.0149s/iter; left time: 235.8528s
	iters: 600, epoch: 3 | loss: 0.7473928
	speed: 0.0159s/iter; left time: 249.4505s
	iters: 700, epoch: 3 | loss: 0.8332195
	speed: 0.0156s/iter; left time: 243.8955s
	iters: 800, epoch: 3 | loss: 0.7805467
	speed: 0.0148s/iter; left time: 229.0949s
	iters: 900, epoch: 3 | loss: 0.6861858
	speed: 0.0151s/iter; left time: 232.3392s
	iters: 1000, epoch: 3 | loss: 0.6758270
	speed: 0.0149s/iter; left time: 228.7213s
	iters: 1100, epoch: 3 | loss: 0.9651399
	speed: 0.0140s/iter; left time: 213.4740s
	iters: 1200, epoch: 3 | loss: 0.7648038
	speed: 0.0145s/iter; left time: 219.7827s
	iters: 1300, epoch: 3 | loss: 0.7411460
	speed: 0.0142s/iter; left time: 213.8826s
	iters: 1400, epoch: 3 | loss: 0.8228023
	speed: 0.0144s/iter; left time: 215.4137s
	iters: 1500, epoch: 3 | loss: 0.7454697
	speed: 0.0144s/iter; left time: 213.8025s
	iters: 1600, epoch: 3 | loss: 0.7030807
	speed: 0.0149s/iter; left time: 219.0513s
	iters: 1700, epoch: 3 | loss: 0.7492638
	speed: 0.0138s/iter; left time: 202.4436s
	iters: 1800, epoch: 3 | loss: 0.7300541
	speed: 0.0142s/iter; left time: 206.3618s
	iters: 1900, epoch: 3 | loss: 0.6846592
	speed: 0.0144s/iter; left time: 208.4508s
	iters: 2000, epoch: 3 | loss: 0.7976264
	speed: 0.0152s/iter; left time: 218.0838s
Epoch: 3 cost time: 30.424275875091553
Epoch: 3, Steps: 2041 | Train Loss: 0.7436156 Vali Loss: 1.3346583 Test Loss: 2.1643388
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7398440
	speed: 0.5594s/iter; left time: 7937.2188s
	iters: 200, epoch: 4 | loss: 0.6939026
	speed: 0.0164s/iter; left time: 230.8016s
	iters: 300, epoch: 4 | loss: 0.6819206
	speed: 0.0153s/iter; left time: 213.8354s
	iters: 400, epoch: 4 | loss: 0.7827543
	speed: 0.0157s/iter; left time: 218.5705s
	iters: 500, epoch: 4 | loss: 0.7219316
	speed: 0.0140s/iter; left time: 192.8052s
	iters: 600, epoch: 4 | loss: 0.6488180
	speed: 0.0152s/iter; left time: 208.6494s
	iters: 700, epoch: 4 | loss: 0.8071131
	speed: 0.0156s/iter; left time: 211.5123s
	iters: 800, epoch: 4 | loss: 0.7119592
	speed: 0.0155s/iter; left time: 209.0064s
	iters: 900, epoch: 4 | loss: 0.8530731
	speed: 0.0156s/iter; left time: 208.3004s
	iters: 1000, epoch: 4 | loss: 0.7643898
	speed: 0.0154s/iter; left time: 204.8872s
	iters: 1100, epoch: 4 | loss: 0.7968773
	speed: 0.0168s/iter; left time: 221.0832s
	iters: 1200, epoch: 4 | loss: 0.7464032
	speed: 0.0163s/iter; left time: 213.5165s
	iters: 1300, epoch: 4 | loss: 0.7150003
	speed: 0.0166s/iter; left time: 215.5733s
	iters: 1400, epoch: 4 | loss: 0.6194770
	speed: 0.0164s/iter; left time: 211.1039s
	iters: 1500, epoch: 4 | loss: 0.7083908
	speed: 0.0147s/iter; left time: 188.1720s
	iters: 1600, epoch: 4 | loss: 0.8716694
	speed: 0.0137s/iter; left time: 173.9478s
	iters: 1700, epoch: 4 | loss: 0.7480122
	speed: 0.0168s/iter; left time: 211.0814s
	iters: 1800, epoch: 4 | loss: 0.7636471
	speed: 0.0153s/iter; left time: 191.0516s
	iters: 1900, epoch: 4 | loss: 0.7420099
	speed: 0.0155s/iter; left time: 191.6561s
	iters: 2000, epoch: 4 | loss: 0.7443554
	speed: 0.0165s/iter; left time: 202.5576s
Epoch: 4 cost time: 32.28870224952698
Epoch: 4, Steps: 2041 | Train Loss: 0.7236372 Vali Loss: 1.3236563 Test Loss: 2.1321826
Validation loss decreased (1.327639 --> 1.323656).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7624600
	speed: 0.5177s/iter; left time: 6288.4960s
	iters: 200, epoch: 5 | loss: 0.6379274
	speed: 0.0152s/iter; left time: 182.6435s
	iters: 300, epoch: 5 | loss: 0.7937581
	speed: 0.0154s/iter; left time: 183.4647s
	iters: 400, epoch: 5 | loss: 0.6881232
	speed: 0.0151s/iter; left time: 179.4729s
	iters: 500, epoch: 5 | loss: 0.7073423
	speed: 0.0156s/iter; left time: 182.9154s
	iters: 600, epoch: 5 | loss: 0.7374578
	speed: 0.0152s/iter; left time: 177.1417s
	iters: 700, epoch: 5 | loss: 0.6923653
	speed: 0.0162s/iter; left time: 186.5617s
	iters: 800, epoch: 5 | loss: 0.7290428
	speed: 0.0164s/iter; left time: 187.2859s
	iters: 900, epoch: 5 | loss: 0.6671973
	speed: 0.0163s/iter; left time: 184.5862s
	iters: 1000, epoch: 5 | loss: 0.7660803
	speed: 0.0157s/iter; left time: 176.4121s
	iters: 1100, epoch: 5 | loss: 0.7611995
	speed: 0.0152s/iter; left time: 169.6787s
	iters: 1200, epoch: 5 | loss: 0.7422501
	speed: 0.0151s/iter; left time: 166.5239s
	iters: 1300, epoch: 5 | loss: 0.6923457
	speed: 0.0146s/iter; left time: 160.1616s
	iters: 1400, epoch: 5 | loss: 0.6769395
	speed: 0.0142s/iter; left time: 153.6043s
	iters: 1500, epoch: 5 | loss: 0.6151193
	speed: 0.0149s/iter; left time: 159.7207s
	iters: 1600, epoch: 5 | loss: 0.6798707
	speed: 0.0159s/iter; left time: 169.1851s
	iters: 1700, epoch: 5 | loss: 0.7883989
	speed: 0.0146s/iter; left time: 153.6892s
	iters: 1800, epoch: 5 | loss: 0.6455282
	speed: 0.0153s/iter; left time: 159.9494s
	iters: 1900, epoch: 5 | loss: 0.7024539
	speed: 0.0165s/iter; left time: 170.6430s
	iters: 2000, epoch: 5 | loss: 0.6402966
	speed: 0.0155s/iter; left time: 158.7671s
Epoch: 5 cost time: 31.725781440734863
Epoch: 5, Steps: 2041 | Train Loss: 0.7147384 Vali Loss: 1.3497825 Test Loss: 2.2479270
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7188482
	speed: 0.4147s/iter; left time: 4190.8352s
	iters: 200, epoch: 6 | loss: 0.6317331
	speed: 0.0145s/iter; left time: 144.7655s
	iters: 300, epoch: 6 | loss: 0.6964501
	speed: 0.0144s/iter; left time: 142.2665s
	iters: 400, epoch: 6 | loss: 0.7307547
	speed: 0.0145s/iter; left time: 142.4405s
	iters: 500, epoch: 6 | loss: 0.7722119
	speed: 0.0146s/iter; left time: 141.6467s
	iters: 600, epoch: 6 | loss: 0.6322091
	speed: 0.0147s/iter; left time: 141.4923s
	iters: 700, epoch: 6 | loss: 0.6835265
	speed: 0.0147s/iter; left time: 139.9280s
	iters: 800, epoch: 6 | loss: 0.7489992
	speed: 0.0147s/iter; left time: 137.9277s
	iters: 900, epoch: 6 | loss: 0.6912237
	speed: 0.0147s/iter; left time: 136.8824s
	iters: 1000, epoch: 6 | loss: 0.6810419
	speed: 0.0147s/iter; left time: 134.8999s
	iters: 1100, epoch: 6 | loss: 0.7787311
	speed: 0.0146s/iter; left time: 133.1706s
	iters: 1200, epoch: 6 | loss: 0.6728932
	speed: 0.0146s/iter; left time: 131.8429s
	iters: 1300, epoch: 6 | loss: 0.7240689
	speed: 0.0151s/iter; left time: 134.0477s
	iters: 1400, epoch: 6 | loss: 0.7706000
	speed: 0.0170s/iter; left time: 149.4014s
	iters: 1500, epoch: 6 | loss: 0.7674261
	speed: 0.0159s/iter; left time: 138.5293s
	iters: 1600, epoch: 6 | loss: 0.6570583
	speed: 0.0155s/iter; left time: 133.2151s
	iters: 1700, epoch: 6 | loss: 0.6707867
	speed: 0.0165s/iter; left time: 140.5347s
	iters: 1800, epoch: 6 | loss: 0.7277522
	speed: 0.0148s/iter; left time: 124.5643s
	iters: 1900, epoch: 6 | loss: 0.6569574
	speed: 0.0154s/iter; left time: 128.2587s
	iters: 2000, epoch: 6 | loss: 0.7234436
	speed: 0.0155s/iter; left time: 127.0753s
Epoch: 6 cost time: 31.02818465232849
Epoch: 6, Steps: 2041 | Train Loss: 0.7101916 Vali Loss: 1.3504243 Test Loss: 2.2291818
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6667961
	speed: 0.4710s/iter; left time: 3798.3298s
	iters: 200, epoch: 7 | loss: 0.6287233
	speed: 0.0145s/iter; left time: 115.4817s
	iters: 300, epoch: 7 | loss: 0.6391846
	speed: 0.0144s/iter; left time: 113.5881s
	iters: 400, epoch: 7 | loss: 0.7249054
	speed: 0.0154s/iter; left time: 119.3481s
	iters: 500, epoch: 7 | loss: 0.8546566
	speed: 0.0149s/iter; left time: 114.2896s
	iters: 600, epoch: 7 | loss: 0.5870665
	speed: 0.0159s/iter; left time: 120.5587s
	iters: 700, epoch: 7 | loss: 0.6503867
	speed: 0.0158s/iter; left time: 117.7148s
	iters: 800, epoch: 7 | loss: 0.7284679
	speed: 0.0156s/iter; left time: 114.8199s
	iters: 900, epoch: 7 | loss: 0.7157874
	speed: 0.0144s/iter; left time: 104.8705s
	iters: 1000, epoch: 7 | loss: 0.6770766
	speed: 0.0144s/iter; left time: 103.2809s
	iters: 1100, epoch: 7 | loss: 0.6854060
	speed: 0.0142s/iter; left time: 100.6544s
	iters: 1200, epoch: 7 | loss: 0.7045259
	speed: 0.0155s/iter; left time: 107.8137s
	iters: 1300, epoch: 7 | loss: 0.7917233
	speed: 0.0159s/iter; left time: 109.2393s
	iters: 1400, epoch: 7 | loss: 0.7002462
	speed: 0.0151s/iter; left time: 101.8900s
	iters: 1500, epoch: 7 | loss: 0.6875255
	speed: 0.0144s/iter; left time: 95.8847s
	iters: 1600, epoch: 7 | loss: 0.6757278
	speed: 0.0143s/iter; left time: 94.1656s
	iters: 1700, epoch: 7 | loss: 0.7027177
	speed: 0.0144s/iter; left time: 93.0480s
	iters: 1800, epoch: 7 | loss: 0.7258778
	speed: 0.0144s/iter; left time: 91.6615s
	iters: 1900, epoch: 7 | loss: 0.7168438
	speed: 0.0143s/iter; left time: 89.5184s
	iters: 2000, epoch: 7 | loss: 0.8232914
	speed: 0.0145s/iter; left time: 89.2585s
Epoch: 7 cost time: 30.59081196784973
Epoch: 7, Steps: 2041 | Train Loss: 0.7078963 Vali Loss: 1.3564212 Test Loss: 2.2339320
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems05_all_96_192_Mamba_custom_ftM_sl192_ll48_pl192_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 147619
test shape: (14761, 1, 192, 103) (14761, 1, 192, 103)
test shape: (14761, 192, 103) (14761, 192, 103)
mse:2.132178544998169, mae:1.2564020156860352
>>>>>>>Overall time: 609 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
