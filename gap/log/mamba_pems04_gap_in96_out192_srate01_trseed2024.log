Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=822, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems04_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=822, expand=2, factor=1, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems04_all_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=192, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems04_all_96_192_Mamba_custom_ftM_sl192_ll48_pl192_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1269152
val 352909
test 352907
	iters: 100, epoch: 1 | loss: 0.8636638
	speed: 0.1240s/iter; left time: 4903.6919s
	iters: 200, epoch: 1 | loss: 0.6457654
	speed: 0.1012s/iter; left time: 3991.5108s
	iters: 300, epoch: 1 | loss: 0.7870513
	speed: 0.1014s/iter; left time: 3991.3325s
	iters: 400, epoch: 1 | loss: 0.6880362
	speed: 0.1014s/iter; left time: 3981.4419s
	iters: 500, epoch: 1 | loss: 0.6616705
	speed: 0.1014s/iter; left time: 3972.8752s
	iters: 600, epoch: 1 | loss: 0.5864533
	speed: 0.1015s/iter; left time: 3963.0995s
	iters: 700, epoch: 1 | loss: 0.5741792
	speed: 0.1014s/iter; left time: 3950.8916s
	iters: 800, epoch: 1 | loss: 0.5413806
	speed: 0.1014s/iter; left time: 3941.1759s
	iters: 900, epoch: 1 | loss: 0.5547565
	speed: 0.1014s/iter; left time: 3931.2098s
	iters: 1000, epoch: 1 | loss: 0.5979769
	speed: 0.1014s/iter; left time: 3921.1754s
	iters: 1100, epoch: 1 | loss: 0.5301223
	speed: 0.1014s/iter; left time: 3911.2310s
	iters: 1200, epoch: 1 | loss: 0.5969537
	speed: 0.1014s/iter; left time: 3899.5379s
	iters: 1300, epoch: 1 | loss: 0.4599067
	speed: 0.1014s/iter; left time: 3891.4460s
	iters: 1400, epoch: 1 | loss: 0.4313436
	speed: 0.1052s/iter; left time: 4026.4864s
	iters: 1500, epoch: 1 | loss: 0.6308812
	speed: 0.1077s/iter; left time: 4111.1740s
	iters: 1600, epoch: 1 | loss: 0.5450521
	speed: 0.1000s/iter; left time: 3805.7275s
	iters: 1700, epoch: 1 | loss: 0.5015814
	speed: 0.0974s/iter; left time: 3696.0129s
	iters: 1800, epoch: 1 | loss: 0.5036559
	speed: 0.0960s/iter; left time: 3634.2064s
	iters: 1900, epoch: 1 | loss: 0.4723331
	speed: 0.0963s/iter; left time: 3637.6781s
	iters: 2000, epoch: 1 | loss: 0.6024599
	speed: 0.0965s/iter; left time: 3633.4098s
	iters: 2100, epoch: 1 | loss: 0.6080207
	speed: 0.0962s/iter; left time: 3613.2756s
	iters: 2200, epoch: 1 | loss: 0.4091015
	speed: 0.0955s/iter; left time: 3576.8765s
	iters: 2300, epoch: 1 | loss: 0.5823076
	speed: 0.0955s/iter; left time: 3566.8270s
	iters: 2400, epoch: 1 | loss: 0.4554932
	speed: 0.0954s/iter; left time: 3555.3134s
	iters: 2500, epoch: 1 | loss: 0.6827341
	speed: 0.0965s/iter; left time: 3587.7336s
	iters: 2600, epoch: 1 | loss: 0.4965523
	speed: 0.0968s/iter; left time: 3588.5111s
	iters: 2700, epoch: 1 | loss: 0.5466332
	speed: 0.0994s/iter; left time: 3675.2894s
	iters: 2800, epoch: 1 | loss: 0.4010848
	speed: 0.0997s/iter; left time: 3676.7953s
	iters: 2900, epoch: 1 | loss: 0.6389882
	speed: 0.0975s/iter; left time: 3584.2358s
	iters: 3000, epoch: 1 | loss: 0.4194997
	speed: 0.1001s/iter; left time: 3669.7319s
	iters: 3100, epoch: 1 | loss: 0.4337879
	speed: 0.0995s/iter; left time: 3637.0169s
	iters: 3200, epoch: 1 | loss: 0.4559574
	speed: 0.0949s/iter; left time: 3459.5947s
	iters: 3300, epoch: 1 | loss: 0.6374410
	speed: 0.1009s/iter; left time: 3669.6749s
	iters: 3400, epoch: 1 | loss: 0.4477662
	speed: 0.0986s/iter; left time: 3576.0919s
	iters: 3500, epoch: 1 | loss: 0.4042405
	speed: 0.0992s/iter; left time: 3585.5255s
	iters: 3600, epoch: 1 | loss: 0.4844480
	speed: 0.0981s/iter; left time: 3537.1356s
	iters: 3700, epoch: 1 | loss: 0.4055872
	speed: 0.0956s/iter; left time: 3438.1748s
	iters: 3800, epoch: 1 | loss: 0.4234448
	speed: 0.1019s/iter; left time: 3653.3732s
	iters: 3900, epoch: 1 | loss: 0.4288959
	speed: 0.0962s/iter; left time: 3441.5092s
Epoch: 1 cost time: 396.3706679344177
Epoch: 1, Steps: 3966 | Train Loss: 0.5316399 Vali Loss: 0.9831960 Test Loss: 1.4336629
Validation loss decreased (inf --> 0.983196).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3833793
	speed: 3.1596s/iter; left time: 112464.7472s
	iters: 200, epoch: 2 | loss: 0.3743710
	speed: 0.1044s/iter; left time: 3705.3251s
	iters: 300, epoch: 2 | loss: 0.3045787
	speed: 0.1008s/iter; left time: 3567.3074s
	iters: 400, epoch: 2 | loss: 0.3986539
	speed: 0.0987s/iter; left time: 3484.3620s
	iters: 500, epoch: 2 | loss: 0.4326907
	speed: 0.0994s/iter; left time: 3497.1440s
	iters: 600, epoch: 2 | loss: 0.4183831
	speed: 0.0976s/iter; left time: 3423.8742s
	iters: 700, epoch: 2 | loss: 0.4298619
	speed: 0.0984s/iter; left time: 3444.9572s
	iters: 800, epoch: 2 | loss: 0.3391659
	speed: 0.0989s/iter; left time: 3452.6800s
	iters: 900, epoch: 2 | loss: 0.4808169
	speed: 0.0992s/iter; left time: 3452.7416s
	iters: 1000, epoch: 2 | loss: 0.3603079
	speed: 0.0996s/iter; left time: 3454.3257s
	iters: 1100, epoch: 2 | loss: 0.5396916
	speed: 0.0982s/iter; left time: 3397.2046s
	iters: 1200, epoch: 2 | loss: 0.4035924
	speed: 0.0978s/iter; left time: 3373.4621s
	iters: 1300, epoch: 2 | loss: 0.4358070
	speed: 0.0951s/iter; left time: 3269.6117s
	iters: 1400, epoch: 2 | loss: 0.3154788
	speed: 0.0914s/iter; left time: 3135.6166s
	iters: 1500, epoch: 2 | loss: 0.3345615
	speed: 0.0956s/iter; left time: 3270.0312s
	iters: 1600, epoch: 2 | loss: 0.3792821
	speed: 0.0961s/iter; left time: 3277.1325s
	iters: 1700, epoch: 2 | loss: 0.4355234
	speed: 0.0940s/iter; left time: 3195.3332s
	iters: 1800, epoch: 2 | loss: 0.4713039
	speed: 0.0945s/iter; left time: 3201.5433s
	iters: 1900, epoch: 2 | loss: 0.3574579
	speed: 0.0944s/iter; left time: 3190.7968s
	iters: 2000, epoch: 2 | loss: 0.4505827
	speed: 0.1026s/iter; left time: 3458.0398s
	iters: 2100, epoch: 2 | loss: 0.4858324
	speed: 0.1056s/iter; left time: 3547.4106s
	iters: 2200, epoch: 2 | loss: 0.4025511
	speed: 0.1043s/iter; left time: 3492.1852s
	iters: 2300, epoch: 2 | loss: 0.3327040
	speed: 0.1000s/iter; left time: 3339.9747s
	iters: 2400, epoch: 2 | loss: 0.4656192
	speed: 0.1012s/iter; left time: 3369.9320s
	iters: 2500, epoch: 2 | loss: 0.3081009
	speed: 0.1032s/iter; left time: 3425.4171s
	iters: 2600, epoch: 2 | loss: 0.4545415
	speed: 0.1074s/iter; left time: 3554.5347s
	iters: 2700, epoch: 2 | loss: 0.3340776
	speed: 0.1050s/iter; left time: 3465.1989s
	iters: 2800, epoch: 2 | loss: 0.3729659
	speed: 0.1035s/iter; left time: 3403.2281s
	iters: 2900, epoch: 2 | loss: 0.4989531
	speed: 0.1074s/iter; left time: 3520.5445s
	iters: 3000, epoch: 2 | loss: 0.4394407
	speed: 0.1072s/iter; left time: 3505.7640s
	iters: 3100, epoch: 2 | loss: 0.2860775
	speed: 0.1071s/iter; left time: 3489.7521s
	iters: 3200, epoch: 2 | loss: 0.4942251
	speed: 0.1065s/iter; left time: 3459.9841s
	iters: 3300, epoch: 2 | loss: 0.4223333
	speed: 0.1029s/iter; left time: 3333.7038s
	iters: 3400, epoch: 2 | loss: 0.4186853
	speed: 0.1014s/iter; left time: 3274.3443s
	iters: 3500, epoch: 2 | loss: 0.3573623
	speed: 0.1063s/iter; left time: 3423.5296s
	iters: 3600, epoch: 2 | loss: 0.3811701
	speed: 0.1030s/iter; left time: 3306.9209s
	iters: 3700, epoch: 2 | loss: 0.3514204
	speed: 0.1055s/iter; left time: 3375.6306s
	iters: 3800, epoch: 2 | loss: 0.3835817
	speed: 0.1099s/iter; left time: 3503.6891s
	iters: 3900, epoch: 2 | loss: 0.3733704
	speed: 0.1065s/iter; left time: 3385.9540s
Epoch: 2 cost time: 403.81580567359924
Epoch: 2, Steps: 3966 | Train Loss: 0.4145797 Vali Loss: 0.9789296 Test Loss: 1.4379146
Validation loss decreased (0.983196 --> 0.978930).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3765475
	speed: 3.4897s/iter; left time: 110374.3434s
	iters: 200, epoch: 3 | loss: 0.3106301
	speed: 0.1020s/iter; left time: 3216.3547s
	iters: 300, epoch: 3 | loss: 0.3294793
	speed: 0.1026s/iter; left time: 3225.7966s
	iters: 400, epoch: 3 | loss: 0.3829534
	speed: 0.1026s/iter; left time: 3213.4470s
	iters: 500, epoch: 3 | loss: 0.4917631
	speed: 0.1025s/iter; left time: 3202.4244s
	iters: 600, epoch: 3 | loss: 0.4435378
	speed: 0.1023s/iter; left time: 3185.8492s
	iters: 700, epoch: 3 | loss: 0.3856042
	speed: 0.1026s/iter; left time: 3184.1473s
	iters: 800, epoch: 3 | loss: 0.3395197
	speed: 0.1028s/iter; left time: 3177.9710s
	iters: 900, epoch: 3 | loss: 0.3356732
	speed: 0.1025s/iter; left time: 3160.1005s
	iters: 1000, epoch: 3 | loss: 0.3172387
	speed: 0.1030s/iter; left time: 3164.4916s
	iters: 1100, epoch: 3 | loss: 0.3811073
	speed: 0.1093s/iter; left time: 3347.5550s
	iters: 1200, epoch: 3 | loss: 0.3580679
	speed: 0.1043s/iter; left time: 3184.0628s
	iters: 1300, epoch: 3 | loss: 0.5492193
	speed: 0.0994s/iter; left time: 3025.2771s
	iters: 1400, epoch: 3 | loss: 0.3948638
	speed: 0.0975s/iter; left time: 2956.1546s
	iters: 1500, epoch: 3 | loss: 0.2925714
	speed: 0.0964s/iter; left time: 2914.9114s
	iters: 1600, epoch: 3 | loss: 0.3042425
	speed: 0.0976s/iter; left time: 2939.3399s
	iters: 1700, epoch: 3 | loss: 0.3749489
	speed: 0.0976s/iter; left time: 2930.0785s
	iters: 1800, epoch: 3 | loss: 0.2978274
	speed: 0.0965s/iter; left time: 2887.8007s
	iters: 1900, epoch: 3 | loss: 0.3056731
	speed: 0.0969s/iter; left time: 2891.4905s
	iters: 2000, epoch: 3 | loss: 0.3192706
	speed: 0.0969s/iter; left time: 2882.0033s
	iters: 2100, epoch: 3 | loss: 0.3722526
	speed: 0.0974s/iter; left time: 2886.5308s
	iters: 2200, epoch: 3 | loss: 0.3537862
	speed: 0.0976s/iter; left time: 2882.0552s
	iters: 2300, epoch: 3 | loss: 0.3716351
	speed: 0.0971s/iter; left time: 2858.6087s
	iters: 2400, epoch: 3 | loss: 0.3985561
	speed: 0.0971s/iter; left time: 2846.5830s
	iters: 2500, epoch: 3 | loss: 0.3584738
	speed: 0.0966s/iter; left time: 2824.2269s
	iters: 2600, epoch: 3 | loss: 0.2788526
	speed: 0.0962s/iter; left time: 2803.0590s
	iters: 2700, epoch: 3 | loss: 0.4206094
	speed: 0.0962s/iter; left time: 2792.2484s
	iters: 2800, epoch: 3 | loss: 0.4913092
	speed: 0.0970s/iter; left time: 2806.2834s
	iters: 2900, epoch: 3 | loss: 0.3987456
	speed: 0.0973s/iter; left time: 2804.5102s
	iters: 3000, epoch: 3 | loss: 0.3590055
	speed: 0.0969s/iter; left time: 2783.5053s
	iters: 3100, epoch: 3 | loss: 0.5894815
	speed: 0.0968s/iter; left time: 2770.6883s
	iters: 3200, epoch: 3 | loss: 0.3348276
	speed: 0.0996s/iter; left time: 2841.4956s
	iters: 3300, epoch: 3 | loss: 0.3235676
	speed: 0.1003s/iter; left time: 2850.0280s
	iters: 3400, epoch: 3 | loss: 0.3597429
	speed: 0.0961s/iter; left time: 2722.3698s
	iters: 3500, epoch: 3 | loss: 0.3425685
	speed: 0.0991s/iter; left time: 2798.5104s
	iters: 3600, epoch: 3 | loss: 0.3094473
	speed: 0.0981s/iter; left time: 2758.4297s
	iters: 3700, epoch: 3 | loss: 0.3508895
	speed: 0.0967s/iter; left time: 2710.3455s
	iters: 3800, epoch: 3 | loss: 0.3184355
	speed: 0.1016s/iter; left time: 2837.7146s
	iters: 3900, epoch: 3 | loss: 0.3245074
	speed: 0.1018s/iter; left time: 2832.1395s
Epoch: 3 cost time: 396.58098578453064
Epoch: 3, Steps: 3966 | Train Loss: 0.3793092 Vali Loss: 1.0088531 Test Loss: 1.5009077
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3520778
	speed: 3.1870s/iter; left time: 88161.1433s
	iters: 200, epoch: 4 | loss: 0.3534293
	speed: 0.1045s/iter; left time: 2881.6096s
	iters: 300, epoch: 4 | loss: 0.3109525
	speed: 0.1047s/iter; left time: 2875.4682s
	iters: 400, epoch: 4 | loss: 0.3121407
	speed: 0.1044s/iter; left time: 2857.2902s
	iters: 500, epoch: 4 | loss: 0.3542148
	speed: 0.1103s/iter; left time: 3007.4529s
	iters: 600, epoch: 4 | loss: 0.3583753
	speed: 0.1087s/iter; left time: 2951.9703s
	iters: 700, epoch: 4 | loss: 0.3730460
	speed: 0.1022s/iter; left time: 2766.2556s
	iters: 800, epoch: 4 | loss: 0.5310519
	speed: 0.1020s/iter; left time: 2749.1544s
	iters: 900, epoch: 4 | loss: 0.3171844
	speed: 0.1065s/iter; left time: 2861.0148s
	iters: 1000, epoch: 4 | loss: 0.3592217
	speed: 0.1031s/iter; left time: 2758.7898s
	iters: 1100, epoch: 4 | loss: 0.3411799
	speed: 0.0962s/iter; left time: 2564.4940s
	iters: 1200, epoch: 4 | loss: 0.3677646
	speed: 0.0948s/iter; left time: 2519.2928s
	iters: 1300, epoch: 4 | loss: 0.3058349
	speed: 0.0978s/iter; left time: 2586.7940s
	iters: 1400, epoch: 4 | loss: 0.3344288
	speed: 0.0983s/iter; left time: 2590.6187s
	iters: 1500, epoch: 4 | loss: 0.4199677
	speed: 0.0959s/iter; left time: 2517.8569s
	iters: 1600, epoch: 4 | loss: 0.4970815
	speed: 0.0975s/iter; left time: 2552.0127s
	iters: 1700, epoch: 4 | loss: 0.4496346
	speed: 0.0966s/iter; left time: 2518.1115s
	iters: 1800, epoch: 4 | loss: 0.2806721
	speed: 0.0985s/iter; left time: 2556.4104s
	iters: 1900, epoch: 4 | loss: 0.3212571
	speed: 0.0974s/iter; left time: 2518.6103s
	iters: 2000, epoch: 4 | loss: 0.3925797
	speed: 0.1001s/iter; left time: 2577.9412s
	iters: 2100, epoch: 4 | loss: 0.3335946
	speed: 0.1019s/iter; left time: 2614.9401s
	iters: 2200, epoch: 4 | loss: 0.4737024
	speed: 0.1012s/iter; left time: 2586.5417s
	iters: 2300, epoch: 4 | loss: 0.3837061
	speed: 0.1026s/iter; left time: 2613.2556s
	iters: 2400, epoch: 4 | loss: 0.4121100
	speed: 0.1032s/iter; left time: 2616.5863s
	iters: 2500, epoch: 4 | loss: 0.3549588
	speed: 0.1015s/iter; left time: 2563.7830s
	iters: 2600, epoch: 4 | loss: 0.3611303
	speed: 0.1018s/iter; left time: 2561.3650s
	iters: 2700, epoch: 4 | loss: 0.3500915
	speed: 0.1074s/iter; left time: 2690.8485s
	iters: 2800, epoch: 4 | loss: 0.5615597
	speed: 0.1019s/iter; left time: 2543.2714s
	iters: 2900, epoch: 4 | loss: 0.7129354
	speed: 0.1024s/iter; left time: 2545.5717s
	iters: 3000, epoch: 4 | loss: 0.4296803
	speed: 0.1021s/iter; left time: 2529.4502s
	iters: 3100, epoch: 4 | loss: 0.3029353
	speed: 0.1014s/iter; left time: 2502.0365s
	iters: 3200, epoch: 4 | loss: 0.3154461
	speed: 0.1014s/iter; left time: 2491.8980s
	iters: 3300, epoch: 4 | loss: 0.4487998
	speed: 0.1018s/iter; left time: 2490.6153s
	iters: 3400, epoch: 4 | loss: 0.3260269
	speed: 0.1014s/iter; left time: 2469.3094s
	iters: 3500, epoch: 4 | loss: 0.4349419
	speed: 0.1018s/iter; left time: 2470.9953s
	iters: 3600, epoch: 4 | loss: 0.3436753
	speed: 0.1023s/iter; left time: 2472.4062s
	iters: 3700, epoch: 4 | loss: 0.2936948
	speed: 0.1074s/iter; left time: 2583.8176s
	iters: 3800, epoch: 4 | loss: 0.3271788
	speed: 0.1022s/iter; left time: 2450.0163s
	iters: 3900, epoch: 4 | loss: 0.3097054
	speed: 0.1016s/iter; left time: 2425.1844s
Epoch: 4 cost time: 406.8630266189575
Epoch: 4, Steps: 3966 | Train Loss: 0.3653389 Vali Loss: 1.0093501 Test Loss: 1.4788518
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4527339
	speed: 3.0856s/iter; left time: 73119.7003s
	iters: 200, epoch: 5 | loss: 0.3018366
	speed: 0.1017s/iter; left time: 2398.6894s
	iters: 300, epoch: 5 | loss: 0.2855389
	speed: 0.1018s/iter; left time: 2391.6994s
	iters: 400, epoch: 5 | loss: 0.4492443
	speed: 0.1130s/iter; left time: 2643.8312s
	iters: 500, epoch: 5 | loss: 0.3496356
	speed: 0.1027s/iter; left time: 2392.6745s
	iters: 600, epoch: 5 | loss: 0.3550853
	speed: 0.0992s/iter; left time: 2300.8734s
	iters: 700, epoch: 5 | loss: 0.2914614
	speed: 0.0993s/iter; left time: 2294.3067s
	iters: 800, epoch: 5 | loss: 0.4267160
	speed: 0.0969s/iter; left time: 2229.3261s
	iters: 900, epoch: 5 | loss: 0.3576408
	speed: 0.0961s/iter; left time: 2199.7386s
	iters: 1000, epoch: 5 | loss: 0.3326289
	speed: 0.0956s/iter; left time: 2178.7753s
	iters: 1100, epoch: 5 | loss: 0.3462643
	speed: 0.0964s/iter; left time: 2188.5688s
	iters: 1200, epoch: 5 | loss: 0.2943756
	speed: 0.0943s/iter; left time: 2130.9382s
	iters: 1300, epoch: 5 | loss: 0.4113366
	speed: 0.0943s/iter; left time: 2120.5030s
	iters: 1400, epoch: 5 | loss: 0.4340781
	speed: 0.0953s/iter; left time: 2134.1992s
	iters: 1500, epoch: 5 | loss: 0.2660596
	speed: 0.0959s/iter; left time: 2139.3556s
	iters: 1600, epoch: 5 | loss: 0.3806635
	speed: 0.0949s/iter; left time: 2105.4198s
	iters: 1700, epoch: 5 | loss: 0.3170004
	speed: 0.0976s/iter; left time: 2156.8749s
	iters: 1800, epoch: 5 | loss: 0.2939713
	speed: 0.0968s/iter; left time: 2128.4861s
	iters: 1900, epoch: 5 | loss: 0.3106661
	speed: 0.0975s/iter; left time: 2135.8971s
	iters: 2000, epoch: 5 | loss: 0.3121343
	speed: 0.0967s/iter; left time: 2108.8345s
	iters: 2100, epoch: 5 | loss: 0.4322383
	speed: 0.0983s/iter; left time: 2133.2749s
	iters: 2200, epoch: 5 | loss: 0.3111325
	speed: 0.0989s/iter; left time: 2136.8602s
	iters: 2300, epoch: 5 | loss: 0.3084422
	speed: 0.0975s/iter; left time: 2096.7521s
	iters: 2400, epoch: 5 | loss: 0.2951310
	speed: 0.0967s/iter; left time: 2070.0082s
	iters: 2500, epoch: 5 | loss: 0.4586968
	speed: 0.0980s/iter; left time: 2086.0645s
	iters: 2600, epoch: 5 | loss: 0.3802619
	speed: 0.0976s/iter; left time: 2069.0093s
	iters: 2700, epoch: 5 | loss: 0.4041853
	speed: 0.0964s/iter; left time: 2034.6634s
	iters: 2800, epoch: 5 | loss: 0.4207201
	speed: 0.0968s/iter; left time: 2031.8386s
	iters: 2900, epoch: 5 | loss: 0.3484601
	speed: 0.0967s/iter; left time: 2020.1532s
	iters: 3000, epoch: 5 | loss: 0.3657052
	speed: 0.0953s/iter; left time: 1981.9933s
	iters: 3100, epoch: 5 | loss: 0.3891883
	speed: 0.0938s/iter; left time: 1942.3991s
	iters: 3200, epoch: 5 | loss: 0.4125199
	speed: 0.0974s/iter; left time: 2006.8100s
	iters: 3300, epoch: 5 | loss: 0.4205797
	speed: 0.1002s/iter; left time: 2053.8882s
	iters: 3400, epoch: 5 | loss: 0.3439884
	speed: 0.0986s/iter; left time: 2011.9285s
	iters: 3500, epoch: 5 | loss: 0.3371546
	speed: 0.0964s/iter; left time: 1956.6808s
	iters: 3600, epoch: 5 | loss: 0.3043633
	speed: 0.0970s/iter; left time: 1958.2146s
	iters: 3700, epoch: 5 | loss: 0.5059736
	speed: 0.0970s/iter; left time: 1950.0350s
	iters: 3800, epoch: 5 | loss: 0.3197020
	speed: 0.0981s/iter; left time: 1960.7393s
	iters: 3900, epoch: 5 | loss: 0.3851617
	speed: 0.0974s/iter; left time: 1938.0586s
Epoch: 5 cost time: 389.86566972732544
Epoch: 5, Steps: 3966 | Train Loss: 0.3589891 Vali Loss: 1.0164675 Test Loss: 1.5165867
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems04_all_96_192_Mamba_custom_ftM_sl192_ll48_pl192_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 352907
test shape: (35290, 1, 192, 822) (35290, 1, 192, 822)
test shape: (35290, 192, 822) (35290, 192, 822)
mse:1.4379113912582397, mae:0.942452073097229
>>>>>>>Overall time: 4770 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
