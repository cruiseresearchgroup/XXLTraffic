Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=103, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems05_all_common_flow.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems05_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 548119
val 42356
test 42355
	iters: 100, epoch: 1 | loss: 1.3314061
	speed: 0.0169s/iter; left time: 5782.6942s
	iters: 200, epoch: 1 | loss: 1.2933719
	speed: 0.0139s/iter; left time: 4746.1821s
	iters: 300, epoch: 1 | loss: 1.2487279
	speed: 0.0138s/iter; left time: 4725.1702s
	iters: 400, epoch: 1 | loss: 1.3446687
	speed: 0.0138s/iter; left time: 4728.5900s
	iters: 500, epoch: 1 | loss: 1.3283964
	speed: 0.0139s/iter; left time: 4741.2322s
	iters: 600, epoch: 1 | loss: 1.2762338
	speed: 0.0139s/iter; left time: 4748.9334s
	iters: 700, epoch: 1 | loss: 1.3464034
	speed: 0.0139s/iter; left time: 4745.5660s
	iters: 800, epoch: 1 | loss: 1.1687417
	speed: 0.0138s/iter; left time: 4728.3697s
	iters: 900, epoch: 1 | loss: 1.2142457
	speed: 0.0139s/iter; left time: 4738.7068s
	iters: 1000, epoch: 1 | loss: 1.2936591
	speed: 0.0139s/iter; left time: 4742.4756s
	iters: 1100, epoch: 1 | loss: 1.2894469
	speed: 0.0139s/iter; left time: 4735.3798s
	iters: 1200, epoch: 1 | loss: 1.4203670
	speed: 0.0139s/iter; left time: 4754.4622s
	iters: 1300, epoch: 1 | loss: 1.2697202
	speed: 0.0139s/iter; left time: 4737.2405s
	iters: 1400, epoch: 1 | loss: 1.4134141
	speed: 0.0139s/iter; left time: 4746.6565s
	iters: 1500, epoch: 1 | loss: 1.2880317
	speed: 0.0139s/iter; left time: 4735.9494s
	iters: 1600, epoch: 1 | loss: 1.1714808
	speed: 0.0140s/iter; left time: 4773.7608s
	iters: 1700, epoch: 1 | loss: 1.2570964
	speed: 0.0139s/iter; left time: 4739.7716s
Epoch: 1 cost time: 24.13804268836975
Epoch: 1, Steps: 1712 | Train Loss: 1.3159723 Vali Loss: 1.6253664 Test Loss: 2.0404170
Validation loss decreased (inf --> 1.625366).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3055336
	speed: 0.1027s/iter; left time: 34988.8160s
	iters: 200, epoch: 2 | loss: 1.3697619
	speed: 0.0137s/iter; left time: 4663.8043s
	iters: 300, epoch: 2 | loss: 1.3541996
	speed: 0.0137s/iter; left time: 4661.7261s
	iters: 400, epoch: 2 | loss: 1.3306578
	speed: 0.0137s/iter; left time: 4656.9450s
	iters: 500, epoch: 2 | loss: 1.2248573
	speed: 0.0137s/iter; left time: 4654.5107s
	iters: 600, epoch: 2 | loss: 1.2626756
	speed: 0.0137s/iter; left time: 4661.9749s
	iters: 700, epoch: 2 | loss: 1.3312788
	speed: 0.0137s/iter; left time: 4659.7449s
	iters: 800, epoch: 2 | loss: 1.2729347
	speed: 0.0137s/iter; left time: 4658.7973s
	iters: 900, epoch: 2 | loss: 1.2825516
	speed: 0.0137s/iter; left time: 4663.1048s
	iters: 1000, epoch: 2 | loss: 1.1935062
	speed: 0.0138s/iter; left time: 4691.1101s
	iters: 1100, epoch: 2 | loss: 1.3297420
	speed: 0.0138s/iter; left time: 4686.1472s
	iters: 1200, epoch: 2 | loss: 1.2284957
	speed: 0.0138s/iter; left time: 4678.7882s
	iters: 1300, epoch: 2 | loss: 1.2574768
	speed: 0.0137s/iter; left time: 4655.9436s
	iters: 1400, epoch: 2 | loss: 1.2818037
	speed: 0.0138s/iter; left time: 4673.5403s
	iters: 1500, epoch: 2 | loss: 1.3479425
	speed: 0.0138s/iter; left time: 4678.7594s
	iters: 1600, epoch: 2 | loss: 1.3057641
	speed: 0.0138s/iter; left time: 4682.3042s
	iters: 1700, epoch: 2 | loss: 1.3438966
	speed: 0.0137s/iter; left time: 4647.2355s
Epoch: 2 cost time: 23.653841733932495
Epoch: 2, Steps: 1712 | Train Loss: 1.3043237 Vali Loss: 1.5955714 Test Loss: 1.9687833
Validation loss decreased (1.625366 --> 1.595571).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1617697
	speed: 0.1026s/iter; left time: 34778.0618s
	iters: 200, epoch: 3 | loss: 1.3688649
	speed: 0.0138s/iter; left time: 4683.1783s
	iters: 300, epoch: 3 | loss: 1.2189046
	speed: 0.0138s/iter; left time: 4673.0050s
	iters: 400, epoch: 3 | loss: 1.2813841
	speed: 0.0139s/iter; left time: 4695.5184s
	iters: 500, epoch: 3 | loss: 1.2338893
	speed: 0.0138s/iter; left time: 4669.1342s
	iters: 600, epoch: 3 | loss: 1.4809192
	speed: 0.0139s/iter; left time: 4697.0729s
	iters: 700, epoch: 3 | loss: 1.2914107
	speed: 0.0138s/iter; left time: 4677.9229s
	iters: 800, epoch: 3 | loss: 1.1597838
	speed: 0.0138s/iter; left time: 4676.3829s
	iters: 900, epoch: 3 | loss: 1.4203787
	speed: 0.0138s/iter; left time: 4673.1784s
	iters: 1000, epoch: 3 | loss: 1.3200946
	speed: 0.0139s/iter; left time: 4689.6978s
	iters: 1100, epoch: 3 | loss: 1.3779277
	speed: 0.0138s/iter; left time: 4658.8057s
	iters: 1200, epoch: 3 | loss: 1.2789721
	speed: 0.0138s/iter; left time: 4664.5137s
	iters: 1300, epoch: 3 | loss: 1.1934531
	speed: 0.0138s/iter; left time: 4661.5137s
	iters: 1400, epoch: 3 | loss: 1.2664187
	speed: 0.0138s/iter; left time: 4666.3748s
	iters: 1500, epoch: 3 | loss: 1.3407605
	speed: 0.0138s/iter; left time: 4669.0518s
	iters: 1600, epoch: 3 | loss: 1.2199535
	speed: 0.0138s/iter; left time: 4656.6347s
	iters: 1700, epoch: 3 | loss: 1.3334205
	speed: 0.0139s/iter; left time: 4675.4840s
Epoch: 3 cost time: 23.813257455825806
Epoch: 3, Steps: 1712 | Train Loss: 1.3042125 Vali Loss: 1.5391504 Test Loss: 1.9219991
Validation loss decreased (1.595571 --> 1.539150).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3439405
	speed: 0.1021s/iter; left time: 34424.4518s
	iters: 200, epoch: 4 | loss: 1.3234822
	speed: 0.0139s/iter; left time: 4675.2887s
	iters: 300, epoch: 4 | loss: 1.2996986
	speed: 0.0139s/iter; left time: 4675.9085s
	iters: 400, epoch: 4 | loss: 1.2534570
	speed: 0.0139s/iter; left time: 4668.2820s
	iters: 500, epoch: 4 | loss: 1.1909875
	speed: 0.0139s/iter; left time: 4680.0599s
	iters: 600, epoch: 4 | loss: 1.3738689
	speed: 0.0138s/iter; left time: 4658.2551s
	iters: 700, epoch: 4 | loss: 1.2187440
	speed: 0.0139s/iter; left time: 4664.3228s
	iters: 800, epoch: 4 | loss: 1.4195185
	speed: 0.0138s/iter; left time: 4655.1380s
	iters: 900, epoch: 4 | loss: 1.1778973
	speed: 0.0139s/iter; left time: 4667.0172s
	iters: 1000, epoch: 4 | loss: 1.2537600
	speed: 0.0139s/iter; left time: 4679.0778s
	iters: 1100, epoch: 4 | loss: 1.2992949
	speed: 0.0138s/iter; left time: 4651.0010s
	iters: 1200, epoch: 4 | loss: 1.2445446
	speed: 0.0138s/iter; left time: 4648.3162s
	iters: 1300, epoch: 4 | loss: 1.3927301
	speed: 0.0139s/iter; left time: 4658.9657s
	iters: 1400, epoch: 4 | loss: 1.3181248
	speed: 0.0139s/iter; left time: 4674.6681s
	iters: 1500, epoch: 4 | loss: 1.2307931
	speed: 0.0139s/iter; left time: 4682.5640s
	iters: 1600, epoch: 4 | loss: 1.3075519
	speed: 0.0139s/iter; left time: 4652.5775s
	iters: 1700, epoch: 4 | loss: 1.2828907
	speed: 0.0138s/iter; left time: 4645.2959s
Epoch: 4 cost time: 23.89314913749695
Epoch: 4, Steps: 1712 | Train Loss: 1.3042220 Vali Loss: 1.6066839 Test Loss: 2.0194161
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 5 | loss: 1.3145039
	speed: 0.1016s/iter; left time: 34089.8270s
	iters: 200, epoch: 5 | loss: 1.3162026
	speed: 0.0138s/iter; left time: 4625.7042s
	iters: 300, epoch: 5 | loss: 1.2105311
	speed: 0.0138s/iter; left time: 4614.7979s
	iters: 400, epoch: 5 | loss: 1.4704287
	speed: 0.0138s/iter; left time: 4616.3380s
	iters: 500, epoch: 5 | loss: 1.4430443
	speed: 0.0138s/iter; left time: 4621.4272s
	iters: 600, epoch: 5 | loss: 1.3618829
	speed: 0.0138s/iter; left time: 4618.1328s
	iters: 700, epoch: 5 | loss: 1.3302298
	speed: 0.0138s/iter; left time: 4631.8853s
	iters: 800, epoch: 5 | loss: 1.2553076
	speed: 0.0138s/iter; left time: 4631.3584s
	iters: 900, epoch: 5 | loss: 1.3892796
	speed: 0.0139s/iter; left time: 4637.1366s
	iters: 1000, epoch: 5 | loss: 1.3326129
	speed: 0.0138s/iter; left time: 4613.1499s
	iters: 1100, epoch: 5 | loss: 1.4209616
	speed: 0.0137s/iter; left time: 4596.2401s
	iters: 1200, epoch: 5 | loss: 1.4415389
	speed: 0.0138s/iter; left time: 4630.0947s
	iters: 1300, epoch: 5 | loss: 1.3020082
	speed: 0.0137s/iter; left time: 4595.4791s
	iters: 1400, epoch: 5 | loss: 1.3507524
	speed: 0.0138s/iter; left time: 4616.8041s
	iters: 1500, epoch: 5 | loss: 1.2802919
	speed: 0.0138s/iter; left time: 4602.3552s
	iters: 1600, epoch: 5 | loss: 1.2625237
	speed: 0.0138s/iter; left time: 4601.5292s
	iters: 1700, epoch: 5 | loss: 1.3892188
	speed: 0.0138s/iter; left time: 4595.5849s
Epoch: 5 cost time: 23.74184823036194
Epoch: 5, Steps: 1712 | Train Loss: 1.3043536 Vali Loss: 1.6037935 Test Loss: 2.0150599
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 6 | loss: 1.3007785
	speed: 0.1017s/iter; left time: 33944.3173s
	iters: 200, epoch: 6 | loss: 1.3168116
	speed: 0.0138s/iter; left time: 4607.0120s
	iters: 300, epoch: 6 | loss: 1.2793952
	speed: 0.0138s/iter; left time: 4595.6686s
	iters: 400, epoch: 6 | loss: 1.1872205
	speed: 0.0138s/iter; left time: 4600.1959s
	iters: 500, epoch: 6 | loss: 1.3411440
	speed: 0.0138s/iter; left time: 4601.1894s
	iters: 600, epoch: 6 | loss: 1.3647072
	speed: 0.0138s/iter; left time: 4602.8640s
	iters: 700, epoch: 6 | loss: 1.4142669
	speed: 0.0138s/iter; left time: 4593.6608s
	iters: 800, epoch: 6 | loss: 1.2474757
	speed: 0.0138s/iter; left time: 4605.6875s
	iters: 900, epoch: 6 | loss: 1.2567017
	speed: 0.0138s/iter; left time: 4589.2376s
	iters: 1000, epoch: 6 | loss: 1.2465414
	speed: 0.0138s/iter; left time: 4592.4166s
	iters: 1100, epoch: 6 | loss: 1.4042481
	speed: 0.0138s/iter; left time: 4592.1998s
	iters: 1200, epoch: 6 | loss: 1.2077198
	speed: 0.0138s/iter; left time: 4591.9848s
	iters: 1300, epoch: 6 | loss: 1.2267101
	speed: 0.0138s/iter; left time: 4598.4867s
	iters: 1400, epoch: 6 | loss: 1.2709405
	speed: 0.0138s/iter; left time: 4594.1768s
	iters: 1500, epoch: 6 | loss: 1.2522260
	speed: 0.0138s/iter; left time: 4576.2669s
	iters: 1600, epoch: 6 | loss: 1.3333913
	speed: 0.0138s/iter; left time: 4585.1670s
	iters: 1700, epoch: 6 | loss: 1.2416383
	speed: 0.0138s/iter; left time: 4579.9217s
Epoch: 6 cost time: 23.753740549087524
Epoch: 6, Steps: 1712 | Train Loss: 1.3041894 Vali Loss: 1.6312270 Test Loss: 2.0811670
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 7 | loss: 1.4136982
	speed: 0.1018s/iter; left time: 33790.6041s
	iters: 200, epoch: 7 | loss: 1.2974896
	speed: 0.0139s/iter; left time: 4606.5502s
	iters: 300, epoch: 7 | loss: 1.3561488
	speed: 0.0139s/iter; left time: 4609.4954s
	iters: 400, epoch: 7 | loss: 1.1653091
	speed: 0.0139s/iter; left time: 4602.6095s
	iters: 500, epoch: 7 | loss: 1.3901098
	speed: 0.0139s/iter; left time: 4597.0592s
	iters: 600, epoch: 7 | loss: 1.3216342
	speed: 0.0139s/iter; left time: 4609.2304s
	iters: 700, epoch: 7 | loss: 1.2794737
	speed: 0.0139s/iter; left time: 4602.9852s
	iters: 800, epoch: 7 | loss: 1.3693986
	speed: 0.0139s/iter; left time: 4612.8374s
	iters: 900, epoch: 7 | loss: 1.3171180
	speed: 0.0139s/iter; left time: 4596.4817s
	iters: 1000, epoch: 7 | loss: 1.3484104
	speed: 0.0138s/iter; left time: 4583.2937s
	iters: 1100, epoch: 7 | loss: 1.3298930
	speed: 0.0139s/iter; left time: 4588.4508s
	iters: 1200, epoch: 7 | loss: 1.1929225
	speed: 0.0139s/iter; left time: 4595.6892s
	iters: 1300, epoch: 7 | loss: 1.2916257
	speed: 0.0139s/iter; left time: 4590.7282s
	iters: 1400, epoch: 7 | loss: 1.2044258
	speed: 0.0139s/iter; left time: 4582.1295s
	iters: 1500, epoch: 7 | loss: 1.3454432
	speed: 0.0139s/iter; left time: 4580.0031s
	iters: 1600, epoch: 7 | loss: 1.3048990
	speed: 0.0139s/iter; left time: 4593.0666s
	iters: 1700, epoch: 7 | loss: 1.2712746
	speed: 0.0139s/iter; left time: 4584.2771s
Epoch: 7 cost time: 23.91013193130493
Epoch: 7, Steps: 1712 | Train Loss: 1.3041883 Vali Loss: 1.5968721 Test Loss: 1.9811366
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 8 | loss: 1.2071993
	speed: 0.1016s/iter; left time: 33563.9648s
	iters: 200, epoch: 8 | loss: 1.3020827
	speed: 0.0138s/iter; left time: 4544.0408s
	iters: 300, epoch: 8 | loss: 1.2391815
	speed: 0.0138s/iter; left time: 4542.8040s
	iters: 400, epoch: 8 | loss: 1.2398664
	speed: 0.0137s/iter; left time: 4529.8915s
	iters: 500, epoch: 8 | loss: 1.4944865
	speed: 0.0138s/iter; left time: 4557.6461s
	iters: 600, epoch: 8 | loss: 1.3343966
	speed: 0.0137s/iter; left time: 4533.1807s
	iters: 700, epoch: 8 | loss: 1.3616564
	speed: 0.0138s/iter; left time: 4548.7539s
	iters: 800, epoch: 8 | loss: 1.1751907
	speed: 0.0137s/iter; left time: 4519.8469s
	iters: 900, epoch: 8 | loss: 1.3101364
	speed: 0.0138s/iter; left time: 4539.6240s
	iters: 1000, epoch: 8 | loss: 1.3051833
	speed: 0.0137s/iter; left time: 4520.8421s
	iters: 1100, epoch: 8 | loss: 1.3075738
	speed: 0.0137s/iter; left time: 4521.7286s
	iters: 1200, epoch: 8 | loss: 1.3077842
	speed: 0.0138s/iter; left time: 4542.5545s
	iters: 1300, epoch: 8 | loss: 1.3367785
	speed: 0.0137s/iter; left time: 4513.7455s
	iters: 1400, epoch: 8 | loss: 1.2182366
	speed: 0.0137s/iter; left time: 4517.6337s
	iters: 1500, epoch: 8 | loss: 1.3591851
	speed: 0.0137s/iter; left time: 4515.8599s
	iters: 1600, epoch: 8 | loss: 1.2166867
	speed: 0.0138s/iter; left time: 4531.1438s
	iters: 1700, epoch: 8 | loss: 1.4480525
	speed: 0.0138s/iter; left time: 4530.5903s
Epoch: 8 cost time: 23.67944097518921
Epoch: 8, Steps: 1712 | Train Loss: 1.3041680 Vali Loss: 1.5756284 Test Loss: 1.9434240
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems05_all_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 42355
test shape: (4235, 1, 336, 103) (4235, 1, 336, 103)
test shape: (4235, 336, 103) (4235, 336, 103)
mse:1.9220056533813477, mae:1.1389540433883667
>>>>>>>Overall time: 320 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
