Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=107, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems10_all_common_flow.csv', dec_in=107, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=107, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems10_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_all_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 844311
val 141087
test 141085
	iters: 100, epoch: 1 | loss: 1.4516984
	speed: 0.0156s/iter; left time: 8245.0454s
	iters: 200, epoch: 1 | loss: 1.4416986
	speed: 0.0123s/iter; left time: 6473.8747s
	iters: 300, epoch: 1 | loss: 1.3721416
	speed: 0.0122s/iter; left time: 6449.7313s
	iters: 400, epoch: 1 | loss: 1.3678255
	speed: 0.0123s/iter; left time: 6459.6949s
	iters: 500, epoch: 1 | loss: 1.3380364
	speed: 0.0123s/iter; left time: 6468.0143s
	iters: 600, epoch: 1 | loss: 1.1917797
	speed: 0.0123s/iter; left time: 6465.1903s
	iters: 700, epoch: 1 | loss: 1.4877172
	speed: 0.0123s/iter; left time: 6465.3441s
	iters: 800, epoch: 1 | loss: 1.3026342
	speed: 0.0122s/iter; left time: 6445.8336s
	iters: 900, epoch: 1 | loss: 1.3831995
	speed: 0.0122s/iter; left time: 6451.4124s
	iters: 1000, epoch: 1 | loss: 1.3367976
	speed: 0.0123s/iter; left time: 6469.4559s
	iters: 1100, epoch: 1 | loss: 1.2672176
	speed: 0.0123s/iter; left time: 6463.4724s
	iters: 1200, epoch: 1 | loss: 1.3836302
	speed: 0.0123s/iter; left time: 6471.4706s
	iters: 1300, epoch: 1 | loss: 1.3687536
	speed: 0.0123s/iter; left time: 6466.8055s
	iters: 1400, epoch: 1 | loss: 1.3282938
	speed: 0.0123s/iter; left time: 6448.6465s
	iters: 1500, epoch: 1 | loss: 1.5905986
	speed: 0.0123s/iter; left time: 6461.1947s
	iters: 1600, epoch: 1 | loss: 1.3298239
	speed: 0.0123s/iter; left time: 6460.2237s
	iters: 1700, epoch: 1 | loss: 1.1501033
	speed: 0.0123s/iter; left time: 6484.9752s
	iters: 1800, epoch: 1 | loss: 1.3043419
	speed: 0.0124s/iter; left time: 6514.0606s
	iters: 1900, epoch: 1 | loss: 1.3023787
	speed: 0.0123s/iter; left time: 6458.5646s
	iters: 2000, epoch: 1 | loss: 1.4188960
	speed: 0.0123s/iter; left time: 6466.3586s
	iters: 2100, epoch: 1 | loss: 1.3122549
	speed: 0.0123s/iter; left time: 6469.1112s
	iters: 2200, epoch: 1 | loss: 1.4741986
	speed: 0.0123s/iter; left time: 6487.1648s
	iters: 2300, epoch: 1 | loss: 1.1423957
	speed: 0.0123s/iter; left time: 6464.7254s
	iters: 2400, epoch: 1 | loss: 1.4743640
	speed: 0.0123s/iter; left time: 6470.1075s
	iters: 2500, epoch: 1 | loss: 1.4575016
	speed: 0.0123s/iter; left time: 6464.7855s
	iters: 2600, epoch: 1 | loss: 1.4395440
	speed: 0.0123s/iter; left time: 6458.1145s
Epoch: 1 cost time: 32.8261513710022
Epoch: 1, Steps: 2638 | Train Loss: 1.3319025 Vali Loss: 2.3534274 Test Loss: 1.6194255
Validation loss decreased (inf --> 2.353427).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2870097
	speed: 0.2999s/iter; left time: 157420.7832s
	iters: 200, epoch: 2 | loss: 1.3780882
	speed: 0.0123s/iter; left time: 6451.7549s
	iters: 300, epoch: 2 | loss: 1.2489504
	speed: 0.0123s/iter; left time: 6473.2805s
	iters: 400, epoch: 2 | loss: 1.4261712
	speed: 0.0123s/iter; left time: 6441.6107s
	iters: 500, epoch: 2 | loss: 1.3359549
	speed: 0.0124s/iter; left time: 6485.6566s
	iters: 600, epoch: 2 | loss: 1.3198910
	speed: 0.0123s/iter; left time: 6460.5166s
	iters: 700, epoch: 2 | loss: 1.2365991
	speed: 0.0123s/iter; left time: 6458.2958s
	iters: 800, epoch: 2 | loss: 1.3375646
	speed: 0.0123s/iter; left time: 6449.1870s
	iters: 900, epoch: 2 | loss: 1.3785371
	speed: 0.0123s/iter; left time: 6465.9764s
	iters: 1000, epoch: 2 | loss: 1.2734340
	speed: 0.0123s/iter; left time: 6450.4077s
	iters: 1100, epoch: 2 | loss: 1.3326149
	speed: 0.0123s/iter; left time: 6459.2735s
	iters: 1200, epoch: 2 | loss: 1.2943507
	speed: 0.0123s/iter; left time: 6446.9179s
	iters: 1300, epoch: 2 | loss: 1.4521358
	speed: 0.0123s/iter; left time: 6450.3015s
	iters: 1400, epoch: 2 | loss: 1.3973023
	speed: 0.0123s/iter; left time: 6450.0434s
	iters: 1500, epoch: 2 | loss: 1.3991257
	speed: 0.0123s/iter; left time: 6446.8807s
	iters: 1600, epoch: 2 | loss: 1.4456255
	speed: 0.0123s/iter; left time: 6431.4654s
	iters: 1700, epoch: 2 | loss: 1.2260426
	speed: 0.0123s/iter; left time: 6439.2601s
	iters: 1800, epoch: 2 | loss: 1.2719303
	speed: 0.0123s/iter; left time: 6441.0692s
	iters: 1900, epoch: 2 | loss: 1.1596714
	speed: 0.0123s/iter; left time: 6448.0401s
	iters: 2000, epoch: 2 | loss: 1.4010141
	speed: 0.0123s/iter; left time: 6428.3591s
	iters: 2100, epoch: 2 | loss: 1.2816348
	speed: 0.0123s/iter; left time: 6431.0255s
	iters: 2200, epoch: 2 | loss: 1.2036678
	speed: 0.0123s/iter; left time: 6442.5184s
	iters: 2300, epoch: 2 | loss: 1.2278903
	speed: 0.0123s/iter; left time: 6422.4110s
	iters: 2400, epoch: 2 | loss: 1.3595814
	speed: 0.0123s/iter; left time: 6423.2553s
	iters: 2500, epoch: 2 | loss: 1.3382728
	speed: 0.0123s/iter; left time: 6444.4404s
	iters: 2600, epoch: 2 | loss: 1.4357505
	speed: 0.0123s/iter; left time: 6427.4039s
Epoch: 2 cost time: 32.65431809425354
Epoch: 2, Steps: 2638 | Train Loss: 1.3237316 Vali Loss: 2.3698120 Test Loss: 1.5986054
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 1.4778018
	speed: 0.2940s/iter; left time: 153514.7608s
	iters: 200, epoch: 3 | loss: 1.3553475
	speed: 0.0123s/iter; left time: 6415.6557s
	iters: 300, epoch: 3 | loss: 1.5704139
	speed: 0.0123s/iter; left time: 6407.1199s
	iters: 400, epoch: 3 | loss: 1.2315624
	speed: 0.0123s/iter; left time: 6422.4102s
	iters: 500, epoch: 3 | loss: 1.2673391
	speed: 0.0123s/iter; left time: 6404.6714s
	iters: 600, epoch: 3 | loss: 1.2364781
	speed: 0.0123s/iter; left time: 6418.2426s
	iters: 700, epoch: 3 | loss: 1.2639928
	speed: 0.0123s/iter; left time: 6409.4957s
	iters: 800, epoch: 3 | loss: 1.1870415
	speed: 0.0123s/iter; left time: 6407.7186s
	iters: 900, epoch: 3 | loss: 1.3162942
	speed: 0.0123s/iter; left time: 6399.0359s
	iters: 1000, epoch: 3 | loss: 1.2792474
	speed: 0.0123s/iter; left time: 6414.4180s
	iters: 1100, epoch: 3 | loss: 1.4783449
	speed: 0.0124s/iter; left time: 6439.0171s
	iters: 1200, epoch: 3 | loss: 1.3311826
	speed: 0.0123s/iter; left time: 6411.2080s
	iters: 1300, epoch: 3 | loss: 1.2694408
	speed: 0.0123s/iter; left time: 6399.5692s
	iters: 1400, epoch: 3 | loss: 1.2941794
	speed: 0.0123s/iter; left time: 6406.8349s
	iters: 1500, epoch: 3 | loss: 1.2421368
	speed: 0.0123s/iter; left time: 6397.6342s
	iters: 1600, epoch: 3 | loss: 1.2488056
	speed: 0.0124s/iter; left time: 6441.4526s
	iters: 1700, epoch: 3 | loss: 1.2150329
	speed: 0.0123s/iter; left time: 6392.6701s
	iters: 1800, epoch: 3 | loss: 1.1500781
	speed: 0.0123s/iter; left time: 6391.9858s
	iters: 1900, epoch: 3 | loss: 1.3256018
	speed: 0.0123s/iter; left time: 6400.0166s
	iters: 2000, epoch: 3 | loss: 1.3817899
	speed: 0.0123s/iter; left time: 6382.1473s
	iters: 2100, epoch: 3 | loss: 1.2220454
	speed: 0.0123s/iter; left time: 6391.8504s
	iters: 2200, epoch: 3 | loss: 1.2937518
	speed: 0.0123s/iter; left time: 6384.9843s
	iters: 2300, epoch: 3 | loss: 1.4726434
	speed: 0.0125s/iter; left time: 6477.6520s
	iters: 2400, epoch: 3 | loss: 1.3345366
	speed: 0.0123s/iter; left time: 6377.8298s
	iters: 2500, epoch: 3 | loss: 1.4938887
	speed: 0.0123s/iter; left time: 6375.6935s
	iters: 2600, epoch: 3 | loss: 1.3171251
	speed: 0.0123s/iter; left time: 6387.2906s
Epoch: 3 cost time: 32.60209369659424
Epoch: 3, Steps: 2638 | Train Loss: 1.3237916 Vali Loss: 2.3752236 Test Loss: 1.6031798
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 4 | loss: 1.2552998
	speed: 0.2952s/iter; left time: 153361.3635s
	iters: 200, epoch: 4 | loss: 1.3743377
	speed: 0.0124s/iter; left time: 6424.1554s
	iters: 300, epoch: 4 | loss: 1.2534238
	speed: 0.0124s/iter; left time: 6419.2286s
	iters: 400, epoch: 4 | loss: 1.3091850
	speed: 0.0124s/iter; left time: 6429.0586s
	iters: 500, epoch: 4 | loss: 1.2703124
	speed: 0.0124s/iter; left time: 6422.8680s
	iters: 600, epoch: 4 | loss: 1.2740985
	speed: 0.0124s/iter; left time: 6435.7630s
	iters: 700, epoch: 4 | loss: 1.2204599
	speed: 0.0124s/iter; left time: 6445.3687s
	iters: 800, epoch: 4 | loss: 1.2117591
	speed: 0.0124s/iter; left time: 6415.1039s
	iters: 900, epoch: 4 | loss: 1.3899459
	speed: 0.0124s/iter; left time: 6416.2102s
	iters: 1000, epoch: 4 | loss: 1.3122413
	speed: 0.0124s/iter; left time: 6433.5206s
	iters: 1100, epoch: 4 | loss: 1.1900494
	speed: 0.0124s/iter; left time: 6421.4704s
	iters: 1200, epoch: 4 | loss: 1.2374066
	speed: 0.0124s/iter; left time: 6422.5821s
	iters: 1300, epoch: 4 | loss: 1.3061701
	speed: 0.0124s/iter; left time: 6405.8819s
	iters: 1400, epoch: 4 | loss: 1.2153641
	speed: 0.0123s/iter; left time: 6398.6431s
	iters: 1500, epoch: 4 | loss: 1.2595116
	speed: 0.0124s/iter; left time: 6403.3943s
	iters: 1600, epoch: 4 | loss: 1.1470076
	speed: 0.0123s/iter; left time: 6391.5358s
	iters: 1700, epoch: 4 | loss: 1.3567741
	speed: 0.0123s/iter; left time: 6384.9571s
	iters: 1800, epoch: 4 | loss: 1.4510094
	speed: 0.0123s/iter; left time: 6371.9574s
	iters: 1900, epoch: 4 | loss: 1.3993555
	speed: 0.0124s/iter; left time: 6395.5331s
	iters: 2000, epoch: 4 | loss: 1.2735054
	speed: 0.0123s/iter; left time: 6380.3532s
	iters: 2100, epoch: 4 | loss: 1.3693907
	speed: 0.0123s/iter; left time: 6377.7571s
	iters: 2200, epoch: 4 | loss: 1.3329428
	speed: 0.0123s/iter; left time: 6375.0678s
	iters: 2300, epoch: 4 | loss: 1.2123979
	speed: 0.0123s/iter; left time: 6385.6705s
	iters: 2400, epoch: 4 | loss: 1.2587717
	speed: 0.0123s/iter; left time: 6354.7740s
	iters: 2500, epoch: 4 | loss: 1.2035497
	speed: 0.0123s/iter; left time: 6366.5939s
	iters: 2600, epoch: 4 | loss: 1.3173015
	speed: 0.0123s/iter; left time: 6355.9009s
Epoch: 4 cost time: 32.74971556663513
Epoch: 4, Steps: 2638 | Train Loss: 1.3238009 Vali Loss: 2.3577557 Test Loss: 1.6116644
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 5 | loss: 1.3057545
	speed: 0.2961s/iter; left time: 153091.3368s
	iters: 200, epoch: 5 | loss: 1.2939792
	speed: 0.0125s/iter; left time: 6436.0904s
	iters: 300, epoch: 5 | loss: 1.2177572
	speed: 0.0125s/iter; left time: 6436.3569s
	iters: 400, epoch: 5 | loss: 1.3981249
	speed: 0.0124s/iter; left time: 6405.3243s
	iters: 500, epoch: 5 | loss: 1.2420799
	speed: 0.0124s/iter; left time: 6421.5872s
	iters: 600, epoch: 5 | loss: 1.4945295
	speed: 0.0124s/iter; left time: 6397.9355s
	iters: 700, epoch: 5 | loss: 1.2580261
	speed: 0.0125s/iter; left time: 6436.8123s
	iters: 800, epoch: 5 | loss: 1.2572553
	speed: 0.0124s/iter; left time: 6397.3791s
	iters: 900, epoch: 5 | loss: 1.1623300
	speed: 0.0124s/iter; left time: 6377.3881s
	iters: 1000, epoch: 5 | loss: 1.1953257
	speed: 0.0124s/iter; left time: 6387.1113s
	iters: 1100, epoch: 5 | loss: 1.3615415
	speed: 0.0124s/iter; left time: 6381.7564s
	iters: 1200, epoch: 5 | loss: 1.3559625
	speed: 0.0124s/iter; left time: 6384.1305s
	iters: 1300, epoch: 5 | loss: 1.2721062
	speed: 0.0124s/iter; left time: 6376.8922s
	iters: 1400, epoch: 5 | loss: 1.2076564
	speed: 0.0124s/iter; left time: 6408.3100s
	iters: 1500, epoch: 5 | loss: 1.4150947
	speed: 0.0123s/iter; left time: 6355.3009s
	iters: 1600, epoch: 5 | loss: 1.4561441
	speed: 0.0124s/iter; left time: 6369.8697s
	iters: 1700, epoch: 5 | loss: 1.3897755
	speed: 0.0123s/iter; left time: 6354.8321s
	iters: 1800, epoch: 5 | loss: 1.4343443
	speed: 0.0124s/iter; left time: 6363.5580s
	iters: 1900, epoch: 5 | loss: 1.2973126
	speed: 0.0123s/iter; left time: 6348.0880s
	iters: 2000, epoch: 5 | loss: 1.4010398
	speed: 0.0123s/iter; left time: 6344.4894s
	iters: 2100, epoch: 5 | loss: 1.4009573
	speed: 0.0123s/iter; left time: 6348.8536s
	iters: 2200, epoch: 5 | loss: 1.2688001
	speed: 0.0124s/iter; left time: 6375.9427s
	iters: 2300, epoch: 5 | loss: 1.2595216
	speed: 0.0123s/iter; left time: 6348.3821s
	iters: 2400, epoch: 5 | loss: 1.2387196
	speed: 0.0123s/iter; left time: 6328.2711s
	iters: 2500, epoch: 5 | loss: 1.1271126
	speed: 0.0124s/iter; left time: 6359.5806s
	iters: 2600, epoch: 5 | loss: 1.3459002
	speed: 0.0123s/iter; left time: 6322.6376s
Epoch: 5 cost time: 32.80237078666687
Epoch: 5, Steps: 2638 | Train Loss: 1.3238053 Vali Loss: 2.3630118 Test Loss: 1.6015918
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 6 | loss: 1.2737499
	speed: 0.2956s/iter; left time: 152040.1471s
	iters: 200, epoch: 6 | loss: 1.2557607
	speed: 0.0125s/iter; left time: 6429.4605s
	iters: 300, epoch: 6 | loss: 1.3194028
	speed: 0.0125s/iter; left time: 6406.3234s
	iters: 400, epoch: 6 | loss: 1.4552537
	speed: 0.0125s/iter; left time: 6410.6791s
	iters: 500, epoch: 6 | loss: 1.5905085
	speed: 0.0126s/iter; left time: 6464.5869s
	iters: 600, epoch: 6 | loss: 1.2418606
	speed: 0.0125s/iter; left time: 6406.2051s
	iters: 700, epoch: 6 | loss: 1.2897260
	speed: 0.0124s/iter; left time: 6385.2062s
	iters: 800, epoch: 6 | loss: 1.2879797
	speed: 0.0126s/iter; left time: 6478.9646s
	iters: 900, epoch: 6 | loss: 1.3895078
	speed: 0.0124s/iter; left time: 6376.3637s
	iters: 1000, epoch: 6 | loss: 1.4248108
	speed: 0.0124s/iter; left time: 6385.7395s
	iters: 1100, epoch: 6 | loss: 1.2789646
	speed: 0.0125s/iter; left time: 6424.9922s
	iters: 1200, epoch: 6 | loss: 1.4273175
	speed: 0.0125s/iter; left time: 6425.4756s
	iters: 1300, epoch: 6 | loss: 1.2809659
	speed: 0.0125s/iter; left time: 6398.4831s
	iters: 1400, epoch: 6 | loss: 1.2837027
	speed: 0.0124s/iter; left time: 6358.5245s
	iters: 1500, epoch: 6 | loss: 1.3207024
	speed: 0.0125s/iter; left time: 6405.6755s
	iters: 1600, epoch: 6 | loss: 1.2692903
	speed: 0.0124s/iter; left time: 6349.6121s
	iters: 1700, epoch: 6 | loss: 1.4147455
	speed: 0.0124s/iter; left time: 6354.3111s
	iters: 1800, epoch: 6 | loss: 1.2376064
	speed: 0.0124s/iter; left time: 6340.7927s
	iters: 1900, epoch: 6 | loss: 1.4223596
	speed: 0.0124s/iter; left time: 6346.0050s
	iters: 2000, epoch: 6 | loss: 1.3679273
	speed: 0.0124s/iter; left time: 6353.3418s
	iters: 2100, epoch: 6 | loss: 1.4249676
	speed: 0.0124s/iter; left time: 6343.2379s
	iters: 2200, epoch: 6 | loss: 1.2988955
	speed: 0.0124s/iter; left time: 6360.5608s
	iters: 2300, epoch: 6 | loss: 1.3153710
	speed: 0.0124s/iter; left time: 6349.6380s
	iters: 2400, epoch: 6 | loss: 1.2987850
	speed: 0.0124s/iter; left time: 6336.6461s
	iters: 2500, epoch: 6 | loss: 1.3944488
	speed: 0.0124s/iter; left time: 6329.4745s
	iters: 2600, epoch: 6 | loss: 1.3338190
	speed: 0.0124s/iter; left time: 6323.6414s
Epoch: 6 cost time: 32.991570472717285
Epoch: 6, Steps: 2638 | Train Loss: 1.3238064 Vali Loss: 2.3950133 Test Loss: 1.6141421
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems10_all_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 141085
test shape: (14108, 1, 336, 107) (14108, 1, 336, 107)
test shape: (14108, 336, 107) (14108, 336, 107)
mse:1.6194249391555786, mae:0.9893766641616821
>>>>>>>Overall time: 465 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
