Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=130, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems06_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=130, expand=2, factor=1, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems06_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=336, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_all_96_336_Mamba_custom_ftM_sl336_ll48_pl336_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 795318
val 194916
test 194914
	iters: 100, epoch: 1 | loss: 1.0582085
	speed: 0.0459s/iter; left time: 1135.7330s
	iters: 200, epoch: 1 | loss: 0.7383894
	speed: 0.0272s/iter; left time: 669.9306s
	iters: 300, epoch: 1 | loss: 0.7084998
	speed: 0.0274s/iter; left time: 672.2816s
	iters: 400, epoch: 1 | loss: 0.7682136
	speed: 0.0297s/iter; left time: 726.0262s
	iters: 500, epoch: 1 | loss: 0.7575938
	speed: 0.0284s/iter; left time: 692.6948s
	iters: 600, epoch: 1 | loss: 0.6219289
	speed: 0.0282s/iter; left time: 684.8239s
	iters: 700, epoch: 1 | loss: 0.7321275
	speed: 0.0288s/iter; left time: 696.6103s
	iters: 800, epoch: 1 | loss: 0.8246364
	speed: 0.0305s/iter; left time: 733.3597s
	iters: 900, epoch: 1 | loss: 0.7687172
	speed: 0.0304s/iter; left time: 727.5436s
	iters: 1000, epoch: 1 | loss: 0.6519011
	speed: 0.0300s/iter; left time: 715.5920s
	iters: 1100, epoch: 1 | loss: 0.6089946
	speed: 0.0309s/iter; left time: 733.1371s
	iters: 1200, epoch: 1 | loss: 0.6911250
	speed: 0.0299s/iter; left time: 706.5686s
	iters: 1300, epoch: 1 | loss: 0.8784311
	speed: 0.0294s/iter; left time: 692.6976s
	iters: 1400, epoch: 1 | loss: 0.7161124
	speed: 0.0302s/iter; left time: 707.9657s
	iters: 1500, epoch: 1 | loss: 0.7630010
	speed: 0.0298s/iter; left time: 695.4445s
	iters: 1600, epoch: 1 | loss: 0.7772331
	speed: 0.0267s/iter; left time: 620.8574s
	iters: 1700, epoch: 1 | loss: 0.6001536
	speed: 0.0292s/iter; left time: 675.6302s
	iters: 1800, epoch: 1 | loss: 0.6104819
	speed: 0.0285s/iter; left time: 656.5903s
	iters: 1900, epoch: 1 | loss: 0.6056770
	speed: 0.0274s/iter; left time: 629.7439s
	iters: 2000, epoch: 1 | loss: 0.7674501
	speed: 0.0266s/iter; left time: 607.9661s
	iters: 2100, epoch: 1 | loss: 0.7180105
	speed: 0.0275s/iter; left time: 625.2323s
	iters: 2200, epoch: 1 | loss: 0.6906935
	speed: 0.0269s/iter; left time: 609.0166s
	iters: 2300, epoch: 1 | loss: 0.5382302
	speed: 0.0295s/iter; left time: 664.1703s
	iters: 2400, epoch: 1 | loss: 0.5620594
	speed: 0.0272s/iter; left time: 609.9247s
Epoch: 1 cost time: 72.85862827301025
Epoch: 1, Steps: 2485 | Train Loss: 0.7373154 Vali Loss: 1.5131323 Test Loss: 2.1809754
Validation loss decreased (inf --> 1.513132).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5258224
	speed: 0.8584s/iter; left time: 19113.6348s
	iters: 200, epoch: 2 | loss: 0.6634967
	speed: 0.0295s/iter; left time: 654.5765s
	iters: 300, epoch: 2 | loss: 0.5989820
	speed: 0.0295s/iter; left time: 651.7344s
	iters: 400, epoch: 2 | loss: 0.5879425
	speed: 0.0286s/iter; left time: 629.2327s
	iters: 500, epoch: 2 | loss: 0.6324074
	speed: 0.0298s/iter; left time: 652.1842s
	iters: 600, epoch: 2 | loss: 0.6138281
	speed: 0.0256s/iter; left time: 556.9227s
	iters: 700, epoch: 2 | loss: 0.6842043
	speed: 0.0270s/iter; left time: 584.1841s
	iters: 800, epoch: 2 | loss: 0.5459911
	speed: 0.0268s/iter; left time: 576.9635s
	iters: 900, epoch: 2 | loss: 0.4674158
	speed: 0.0285s/iter; left time: 612.1261s
	iters: 1000, epoch: 2 | loss: 0.5238618
	speed: 0.0268s/iter; left time: 571.6779s
	iters: 1100, epoch: 2 | loss: 0.6123415
	speed: 0.0294s/iter; left time: 625.7753s
	iters: 1200, epoch: 2 | loss: 0.5156444
	speed: 0.0271s/iter; left time: 573.3817s
	iters: 1300, epoch: 2 | loss: 0.5858182
	speed: 0.0273s/iter; left time: 574.5049s
	iters: 1400, epoch: 2 | loss: 0.5680459
	speed: 0.0282s/iter; left time: 590.8111s
	iters: 1500, epoch: 2 | loss: 0.6417642
	speed: 0.0270s/iter; left time: 563.2587s
	iters: 1600, epoch: 2 | loss: 0.4912503
	speed: 0.0276s/iter; left time: 573.6329s
	iters: 1700, epoch: 2 | loss: 0.5475289
	speed: 0.0272s/iter; left time: 562.0995s
	iters: 1800, epoch: 2 | loss: 0.6723518
	speed: 0.0269s/iter; left time: 552.7414s
	iters: 1900, epoch: 2 | loss: 0.6859947
	speed: 0.0268s/iter; left time: 549.3045s
	iters: 2000, epoch: 2 | loss: 0.4959357
	speed: 0.0273s/iter; left time: 555.4460s
	iters: 2100, epoch: 2 | loss: 0.5493518
	speed: 0.0272s/iter; left time: 551.3266s
	iters: 2200, epoch: 2 | loss: 0.5756487
	speed: 0.0268s/iter; left time: 541.3914s
	iters: 2300, epoch: 2 | loss: 0.5711100
	speed: 0.0265s/iter; left time: 532.2530s
	iters: 2400, epoch: 2 | loss: 0.6381302
	speed: 0.0264s/iter; left time: 526.5206s
Epoch: 2 cost time: 69.13447737693787
Epoch: 2, Steps: 2485 | Train Loss: 0.5904102 Vali Loss: 1.5903527 Test Loss: 2.3102002
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4882625
	speed: 0.6851s/iter; left time: 13551.7663s
	iters: 200, epoch: 3 | loss: 0.5439079
	speed: 0.0244s/iter; left time: 481.1258s
	iters: 300, epoch: 3 | loss: 0.5732546
	speed: 0.0243s/iter; left time: 476.6873s
	iters: 400, epoch: 3 | loss: 0.5503051
	speed: 0.0243s/iter; left time: 472.8183s
	iters: 500, epoch: 3 | loss: 0.4915031
	speed: 0.0242s/iter; left time: 469.6097s
	iters: 600, epoch: 3 | loss: 0.5478072
	speed: 0.0242s/iter; left time: 467.2775s
	iters: 700, epoch: 3 | loss: 0.5338992
	speed: 0.0242s/iter; left time: 463.5069s
	iters: 800, epoch: 3 | loss: 0.4959738
	speed: 0.0249s/iter; left time: 476.0357s
	iters: 900, epoch: 3 | loss: 0.5609903
	speed: 0.0251s/iter; left time: 476.2953s
	iters: 1000, epoch: 3 | loss: 0.6189482
	speed: 0.0248s/iter; left time: 468.7928s
	iters: 1100, epoch: 3 | loss: 0.4617940
	speed: 0.0250s/iter; left time: 469.5925s
	iters: 1200, epoch: 3 | loss: 0.4534348
	speed: 0.0256s/iter; left time: 478.3159s
	iters: 1300, epoch: 3 | loss: 0.5413405
	speed: 0.0242s/iter; left time: 450.4579s
	iters: 1400, epoch: 3 | loss: 0.5751579
	speed: 0.0242s/iter; left time: 448.0775s
	iters: 1500, epoch: 3 | loss: 0.6186016
	speed: 0.0245s/iter; left time: 450.8582s
	iters: 1600, epoch: 3 | loss: 0.5921345
	speed: 0.0243s/iter; left time: 444.2257s
	iters: 1700, epoch: 3 | loss: 0.6363597
	speed: 0.0242s/iter; left time: 439.6718s
	iters: 1800, epoch: 3 | loss: 0.6709088
	speed: 0.0243s/iter; left time: 439.5366s
	iters: 1900, epoch: 3 | loss: 0.4830935
	speed: 0.0247s/iter; left time: 444.9011s
	iters: 2000, epoch: 3 | loss: 0.5607939
	speed: 0.0246s/iter; left time: 439.2693s
	iters: 2100, epoch: 3 | loss: 0.4901849
	speed: 0.0245s/iter; left time: 436.1839s
	iters: 2200, epoch: 3 | loss: 0.5356604
	speed: 0.0245s/iter; left time: 433.8907s
	iters: 2300, epoch: 3 | loss: 0.5632291
	speed: 0.0284s/iter; left time: 499.9167s
	iters: 2400, epoch: 3 | loss: 0.5307359
	speed: 0.0275s/iter; left time: 480.9858s
Epoch: 3 cost time: 62.43516540527344
Epoch: 3, Steps: 2485 | Train Loss: 0.5517962 Vali Loss: 1.5441973 Test Loss: 2.1914947
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5969818
	speed: 0.8995s/iter; left time: 15557.0303s
	iters: 200, epoch: 4 | loss: 0.5342490
	speed: 0.0242s/iter; left time: 415.5004s
	iters: 300, epoch: 4 | loss: 0.5130190
	speed: 0.0241s/iter; left time: 412.5894s
	iters: 400, epoch: 4 | loss: 0.5695265
	speed: 0.0240s/iter; left time: 407.4830s
	iters: 500, epoch: 4 | loss: 0.6034105
	speed: 0.0237s/iter; left time: 400.8303s
	iters: 600, epoch: 4 | loss: 0.4889028
	speed: 0.0242s/iter; left time: 406.1518s
	iters: 700, epoch: 4 | loss: 0.5692497
	speed: 0.0240s/iter; left time: 400.2998s
	iters: 800, epoch: 4 | loss: 0.6104426
	speed: 0.0239s/iter; left time: 397.3216s
	iters: 900, epoch: 4 | loss: 0.6524367
	speed: 0.0237s/iter; left time: 390.9276s
	iters: 1000, epoch: 4 | loss: 0.5304946
	speed: 0.0247s/iter; left time: 405.0227s
	iters: 1100, epoch: 4 | loss: 0.5393807
	speed: 0.0250s/iter; left time: 407.0358s
	iters: 1200, epoch: 4 | loss: 0.5050818
	speed: 0.0252s/iter; left time: 407.9696s
	iters: 1300, epoch: 4 | loss: 0.5038405
	speed: 0.0253s/iter; left time: 407.8080s
	iters: 1400, epoch: 4 | loss: 0.5080169
	speed: 0.0254s/iter; left time: 405.6679s
	iters: 1500, epoch: 4 | loss: 0.4319524
	speed: 0.0260s/iter; left time: 413.4686s
	iters: 1600, epoch: 4 | loss: 0.6257394
	speed: 0.0251s/iter; left time: 395.8669s
	iters: 1700, epoch: 4 | loss: 0.5880865
	speed: 0.0256s/iter; left time: 401.9964s
	iters: 1800, epoch: 4 | loss: 0.5463675
	speed: 0.0253s/iter; left time: 394.9287s
	iters: 1900, epoch: 4 | loss: 0.6144313
	speed: 0.0253s/iter; left time: 392.6575s
	iters: 2000, epoch: 4 | loss: 0.5441880
	speed: 0.0243s/iter; left time: 373.4275s
	iters: 2100, epoch: 4 | loss: 0.6750567
	speed: 0.0238s/iter; left time: 363.7210s
	iters: 2200, epoch: 4 | loss: 0.4301923
	speed: 0.0248s/iter; left time: 376.3602s
	iters: 2300, epoch: 4 | loss: 0.4983802
	speed: 0.0243s/iter; left time: 367.1925s
	iters: 2400, epoch: 4 | loss: 0.6268517
	speed: 0.0241s/iter; left time: 361.5706s
Epoch: 4 cost time: 61.747633934020996
Epoch: 4, Steps: 2485 | Train Loss: 0.5374964 Vali Loss: 1.5300620 Test Loss: 2.1675789
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems06_all_96_336_Mamba_custom_ftM_sl336_ll48_pl336_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 194914
test shape: (19491, 1, 336, 130) (19491, 1, 336, 130)
test shape: (19491, 336, 130) (19491, 336, 130)
mse:2.1809775829315186, mae:1.2116469144821167
>>>>>>>Overall time: 703 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
