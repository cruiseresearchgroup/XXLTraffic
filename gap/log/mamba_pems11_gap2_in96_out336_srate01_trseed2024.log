Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=521, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems11_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=521, expand=2, factor=1, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems11_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=336, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems11_all_96_336_Mamba_custom_ftM_sl336_ll48_pl336_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1148200
val 242462
test 242462
	iters: 100, epoch: 1 | loss: 0.8667745
	speed: 0.1088s/iter; left time: 3892.2326s
	iters: 200, epoch: 1 | loss: 0.8814763
	speed: 0.0870s/iter; left time: 3103.9014s
	iters: 300, epoch: 1 | loss: 0.8149181
	speed: 0.0857s/iter; left time: 3049.8822s
	iters: 400, epoch: 1 | loss: 0.7701033
	speed: 0.0846s/iter; left time: 3003.0397s
	iters: 500, epoch: 1 | loss: 0.7575508
	speed: 0.0848s/iter; left time: 2998.7988s
	iters: 600, epoch: 1 | loss: 0.6740458
	speed: 0.0845s/iter; left time: 2982.8169s
	iters: 700, epoch: 1 | loss: 0.6263812
	speed: 0.0848s/iter; left time: 2981.6829s
	iters: 800, epoch: 1 | loss: 0.7151411
	speed: 0.0851s/iter; left time: 2984.8724s
	iters: 900, epoch: 1 | loss: 0.6568948
	speed: 0.0853s/iter; left time: 2984.6147s
	iters: 1000, epoch: 1 | loss: 0.6104504
	speed: 0.0855s/iter; left time: 2981.3471s
	iters: 1100, epoch: 1 | loss: 0.6235608
	speed: 0.0854s/iter; left time: 2970.7799s
	iters: 1200, epoch: 1 | loss: 0.5560061
	speed: 0.0858s/iter; left time: 2973.9154s
	iters: 1300, epoch: 1 | loss: 0.5153739
	speed: 0.0857s/iter; left time: 2961.9886s
	iters: 1400, epoch: 1 | loss: 0.7396685
	speed: 0.0856s/iter; left time: 2952.2188s
	iters: 1500, epoch: 1 | loss: 0.6324587
	speed: 0.0856s/iter; left time: 2943.4662s
	iters: 1600, epoch: 1 | loss: 0.6225941
	speed: 0.0853s/iter; left time: 2924.8223s
	iters: 1700, epoch: 1 | loss: 0.6495656
	speed: 0.0852s/iter; left time: 2911.8453s
	iters: 1800, epoch: 1 | loss: 0.6475516
	speed: 0.0859s/iter; left time: 2927.1283s
	iters: 1900, epoch: 1 | loss: 0.4406598
	speed: 0.0858s/iter; left time: 2915.5337s
	iters: 2000, epoch: 1 | loss: 0.5538195
	speed: 0.0851s/iter; left time: 2882.3609s
	iters: 2100, epoch: 1 | loss: 0.6160504
	speed: 0.0851s/iter; left time: 2875.9296s
	iters: 2200, epoch: 1 | loss: 0.4732223
	speed: 0.0851s/iter; left time: 2864.9754s
	iters: 2300, epoch: 1 | loss: 0.8353466
	speed: 0.0852s/iter; left time: 2861.0641s
	iters: 2400, epoch: 1 | loss: 0.5107573
	speed: 0.0852s/iter; left time: 2853.3003s
	iters: 2500, epoch: 1 | loss: 0.7255042
	speed: 0.0853s/iter; left time: 2846.9334s
	iters: 2600, epoch: 1 | loss: 0.7067114
	speed: 0.0854s/iter; left time: 2840.9987s
	iters: 2700, epoch: 1 | loss: 0.5855538
	speed: 0.0856s/iter; left time: 2840.1053s
	iters: 2800, epoch: 1 | loss: 0.7549778
	speed: 0.0854s/iter; left time: 2823.8471s
	iters: 2900, epoch: 1 | loss: 0.6027856
	speed: 0.0855s/iter; left time: 2818.5644s
	iters: 3000, epoch: 1 | loss: 0.5293930
	speed: 0.0854s/iter; left time: 2808.8524s
	iters: 3100, epoch: 1 | loss: 0.6425653
	speed: 0.0855s/iter; left time: 2802.3895s
	iters: 3200, epoch: 1 | loss: 0.5510001
	speed: 0.0855s/iter; left time: 2794.8953s
	iters: 3300, epoch: 1 | loss: 0.5408313
	speed: 0.0857s/iter; left time: 2792.8339s
	iters: 3400, epoch: 1 | loss: 0.6304301
	speed: 0.0858s/iter; left time: 2788.1783s
	iters: 3500, epoch: 1 | loss: 0.5513628
	speed: 0.0856s/iter; left time: 2773.0299s
Epoch: 1 cost time: 308.965886592865
Epoch: 1, Steps: 3588 | Train Loss: 0.6534026 Vali Loss: 2.6744783 Test Loss: 6.5410738
Validation loss decreased (inf --> 2.674478).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5750893
	speed: 1.9871s/iter; left time: 63971.9245s
	iters: 200, epoch: 2 | loss: 0.5583904
	speed: 0.0877s/iter; left time: 2815.1546s
	iters: 300, epoch: 2 | loss: 0.5683323
	speed: 0.0875s/iter; left time: 2799.9760s
	iters: 400, epoch: 2 | loss: 0.6216542
	speed: 0.0876s/iter; left time: 2792.3693s
	iters: 500, epoch: 2 | loss: 0.6093125
	speed: 0.0876s/iter; left time: 2785.1727s
	iters: 600, epoch: 2 | loss: 0.5448288
	speed: 0.0874s/iter; left time: 2771.2996s
	iters: 700, epoch: 2 | loss: 0.5748081
	speed: 0.0876s/iter; left time: 2767.8696s
	iters: 800, epoch: 2 | loss: 0.5731341
	speed: 0.0876s/iter; left time: 2758.2085s
	iters: 900, epoch: 2 | loss: 0.5241139
	speed: 0.0876s/iter; left time: 2748.7795s
	iters: 1000, epoch: 2 | loss: 0.7023399
	speed: 0.0878s/iter; left time: 2746.6730s
	iters: 1100, epoch: 2 | loss: 0.5750967
	speed: 0.0877s/iter; left time: 2737.1719s
	iters: 1200, epoch: 2 | loss: 0.5406261
	speed: 0.0878s/iter; left time: 2728.5587s
	iters: 1300, epoch: 2 | loss: 0.5875399
	speed: 0.0876s/iter; left time: 2716.0438s
	iters: 1400, epoch: 2 | loss: 0.4924509
	speed: 0.0875s/iter; left time: 2701.7420s
	iters: 1500, epoch: 2 | loss: 0.4595367
	speed: 0.0877s/iter; left time: 2700.2231s
	iters: 1600, epoch: 2 | loss: 0.5209212
	speed: 0.0876s/iter; left time: 2688.1845s
	iters: 1700, epoch: 2 | loss: 0.6324390
	speed: 0.0881s/iter; left time: 2694.7105s
	iters: 1800, epoch: 2 | loss: 0.5541459
	speed: 0.0878s/iter; left time: 2676.9624s
	iters: 1900, epoch: 2 | loss: 0.6185541
	speed: 0.0877s/iter; left time: 2664.6760s
	iters: 2000, epoch: 2 | loss: 0.5436541
	speed: 0.0876s/iter; left time: 2652.6640s
	iters: 2100, epoch: 2 | loss: 0.4557227
	speed: 0.0877s/iter; left time: 2647.0781s
	iters: 2200, epoch: 2 | loss: 0.7196633
	speed: 0.0877s/iter; left time: 2638.1993s
	iters: 2300, epoch: 2 | loss: 0.5217089
	speed: 0.0877s/iter; left time: 2630.1046s
	iters: 2400, epoch: 2 | loss: 0.4984559
	speed: 0.0880s/iter; left time: 2630.2658s
	iters: 2500, epoch: 2 | loss: 0.6061015
	speed: 0.0878s/iter; left time: 2617.1895s
	iters: 2600, epoch: 2 | loss: 0.4380714
	speed: 0.0876s/iter; left time: 2601.0063s
	iters: 2700, epoch: 2 | loss: 0.4333733
	speed: 0.0877s/iter; left time: 2593.9124s
	iters: 2800, epoch: 2 | loss: 0.4841158
	speed: 0.0876s/iter; left time: 2583.7666s
	iters: 2900, epoch: 2 | loss: 0.5494139
	speed: 0.0876s/iter; left time: 2575.8287s
	iters: 3000, epoch: 2 | loss: 0.4455530
	speed: 0.0877s/iter; left time: 2568.0683s
	iters: 3100, epoch: 2 | loss: 0.4826450
	speed: 0.0879s/iter; left time: 2566.7243s
	iters: 3200, epoch: 2 | loss: 0.4519516
	speed: 0.0877s/iter; left time: 2552.5688s
	iters: 3300, epoch: 2 | loss: 0.4677193
	speed: 0.0877s/iter; left time: 2541.7056s
	iters: 3400, epoch: 2 | loss: 0.4710751
	speed: 0.0876s/iter; left time: 2531.4392s
	iters: 3500, epoch: 2 | loss: 0.6944121
	speed: 0.0877s/iter; left time: 2524.6496s
Epoch: 2 cost time: 315.5315821170807
Epoch: 2, Steps: 3588 | Train Loss: 0.5639724 Vali Loss: 6.0981789 Test Loss: 8.6940498
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5420582
	speed: 2.0788s/iter; left time: 59463.4736s
	iters: 200, epoch: 3 | loss: 0.5148274
	speed: 0.0873s/iter; left time: 2488.5094s
	iters: 300, epoch: 3 | loss: 0.5091437
	speed: 0.0873s/iter; left time: 2479.9127s
	iters: 400, epoch: 3 | loss: 0.5667372
	speed: 0.0874s/iter; left time: 2472.7555s
	iters: 500, epoch: 3 | loss: 0.6717318
	speed: 0.0874s/iter; left time: 2465.0730s
	iters: 600, epoch: 3 | loss: 0.5726887
	speed: 0.0874s/iter; left time: 2456.7072s
	iters: 700, epoch: 3 | loss: 0.4956003
	speed: 0.0873s/iter; left time: 2445.3436s
	iters: 800, epoch: 3 | loss: 0.5588949
	speed: 0.0875s/iter; left time: 2442.0734s
	iters: 900, epoch: 3 | loss: 0.5550111
	speed: 0.0873s/iter; left time: 2428.3438s
	iters: 1000, epoch: 3 | loss: 0.4831069
	speed: 0.0875s/iter; left time: 2423.1922s
	iters: 1100, epoch: 3 | loss: 0.4638235
	speed: 0.0874s/iter; left time: 2412.2253s
	iters: 1200, epoch: 3 | loss: 0.4751728
	speed: 0.0874s/iter; left time: 2403.8619s
	iters: 1300, epoch: 3 | loss: 0.6517769
	speed: 0.0874s/iter; left time: 2395.6501s
	iters: 1400, epoch: 3 | loss: 0.5856505
	speed: 0.0873s/iter; left time: 2384.7185s
	iters: 1500, epoch: 3 | loss: 0.6243583
	speed: 0.0874s/iter; left time: 2376.9437s
	iters: 1600, epoch: 3 | loss: 0.4573788
	speed: 0.0873s/iter; left time: 2366.5852s
	iters: 1700, epoch: 3 | loss: 0.5610986
	speed: 0.0873s/iter; left time: 2357.1485s
	iters: 1800, epoch: 3 | loss: 0.6399817
	speed: 0.0873s/iter; left time: 2349.2720s
	iters: 1900, epoch: 3 | loss: 0.5466104
	speed: 0.0873s/iter; left time: 2339.3961s
	iters: 2000, epoch: 3 | loss: 0.4835567
	speed: 0.0877s/iter; left time: 2341.6090s
	iters: 2100, epoch: 3 | loss: 0.5830022
	speed: 0.0875s/iter; left time: 2328.3268s
	iters: 2200, epoch: 3 | loss: 0.5721686
	speed: 0.0875s/iter; left time: 2319.4200s
	iters: 2300, epoch: 3 | loss: 0.5444592
	speed: 0.0873s/iter; left time: 2305.6713s
	iters: 2400, epoch: 3 | loss: 0.6356249
	speed: 0.0873s/iter; left time: 2296.5922s
	iters: 2500, epoch: 3 | loss: 0.6336400
	speed: 0.0874s/iter; left time: 2290.6079s
	iters: 2600, epoch: 3 | loss: 0.4938861
	speed: 0.0874s/iter; left time: 2281.1762s
	iters: 2700, epoch: 3 | loss: 0.5028245
	speed: 0.0877s/iter; left time: 2279.5801s
	iters: 2800, epoch: 3 | loss: 0.3634788
	speed: 0.0876s/iter; left time: 2269.7447s
	iters: 2900, epoch: 3 | loss: 0.5231937
	speed: 0.0875s/iter; left time: 2258.5427s
	iters: 3000, epoch: 3 | loss: 0.4224341
	speed: 0.0874s/iter; left time: 2246.6406s
	iters: 3100, epoch: 3 | loss: 0.4272164
	speed: 0.0875s/iter; left time: 2239.5113s
	iters: 3200, epoch: 3 | loss: 0.5698158
	speed: 0.0874s/iter; left time: 2229.8058s
	iters: 3300, epoch: 3 | loss: 0.5211173
	speed: 0.0874s/iter; left time: 2221.4424s
	iters: 3400, epoch: 3 | loss: 0.4921009
	speed: 0.0876s/iter; left time: 2216.9940s
	iters: 3500, epoch: 3 | loss: 0.5854259
	speed: 0.0878s/iter; left time: 2213.3307s
Epoch: 3 cost time: 314.5554120540619
Epoch: 3, Steps: 3588 | Train Loss: 0.5388809 Vali Loss: 7.4825401 Test Loss: 9.4011259
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4711322
	speed: 1.8522s/iter; left time: 46335.5320s
	iters: 200, epoch: 4 | loss: 0.4445522
	speed: 0.0881s/iter; left time: 2195.2350s
	iters: 300, epoch: 4 | loss: 0.5798211
	speed: 0.0884s/iter; left time: 2193.6140s
	iters: 400, epoch: 4 | loss: 0.5887651
	speed: 0.0880s/iter; left time: 2175.5442s
	iters: 500, epoch: 4 | loss: 0.5516960
	speed: 0.0882s/iter; left time: 2171.5952s
	iters: 600, epoch: 4 | loss: 0.6340051
	speed: 0.0881s/iter; left time: 2160.4810s
	iters: 700, epoch: 4 | loss: 0.4567110
	speed: 0.0881s/iter; left time: 2150.3459s
	iters: 800, epoch: 4 | loss: 0.5056695
	speed: 0.0882s/iter; left time: 2145.4956s
	iters: 900, epoch: 4 | loss: 0.4701711
	speed: 0.0883s/iter; left time: 2139.5018s
	iters: 1000, epoch: 4 | loss: 0.6028360
	speed: 0.0885s/iter; left time: 2133.7928s
	iters: 1100, epoch: 4 | loss: 0.4359260
	speed: 0.0882s/iter; left time: 2118.5556s
	iters: 1200, epoch: 4 | loss: 0.6373622
	speed: 0.0881s/iter; left time: 2107.5022s
	iters: 1300, epoch: 4 | loss: 0.4790669
	speed: 0.0882s/iter; left time: 2101.6538s
	iters: 1400, epoch: 4 | loss: 0.5258209
	speed: 0.0886s/iter; left time: 2100.3403s
	iters: 1500, epoch: 4 | loss: 0.5857740
	speed: 0.0885s/iter; left time: 2088.9965s
	iters: 1600, epoch: 4 | loss: 0.4835121
	speed: 0.0881s/iter; left time: 2072.4408s
	iters: 1700, epoch: 4 | loss: 0.5970896
	speed: 0.0881s/iter; left time: 2063.8785s
	iters: 1800, epoch: 4 | loss: 0.4852467
	speed: 0.0883s/iter; left time: 2058.0586s
	iters: 1900, epoch: 4 | loss: 0.4557702
	speed: 0.0883s/iter; left time: 2049.4715s
	iters: 2000, epoch: 4 | loss: 0.5727611
	speed: 0.0887s/iter; left time: 2051.1601s
	iters: 2100, epoch: 4 | loss: 0.5807089
	speed: 0.0885s/iter; left time: 2036.5341s
	iters: 2200, epoch: 4 | loss: 0.6338792
	speed: 0.0886s/iter; left time: 2030.5403s
	iters: 2300, epoch: 4 | loss: 0.4941815
	speed: 0.0881s/iter; left time: 2011.1014s
	iters: 2400, epoch: 4 | loss: 0.4931617
	speed: 0.0882s/iter; left time: 2003.7383s
	iters: 2500, epoch: 4 | loss: 0.5468285
	speed: 0.0882s/iter; left time: 1995.7074s
	iters: 2600, epoch: 4 | loss: 0.5022140
	speed: 0.0883s/iter; left time: 1987.2765s
	iters: 2700, epoch: 4 | loss: 0.5901536
	speed: 0.0890s/iter; left time: 1994.9687s
	iters: 2800, epoch: 4 | loss: 0.6456216
	speed: 0.0887s/iter; left time: 1979.7541s
	iters: 2900, epoch: 4 | loss: 0.6637418
	speed: 0.0885s/iter; left time: 1966.7942s
	iters: 3000, epoch: 4 | loss: 0.5967786
	speed: 0.0882s/iter; left time: 1951.0086s
	iters: 3100, epoch: 4 | loss: 0.5813559
	speed: 0.0883s/iter; left time: 1943.3582s
	iters: 3200, epoch: 4 | loss: 0.4397187
	speed: 0.0883s/iter; left time: 1934.6808s
	iters: 3300, epoch: 4 | loss: 0.4560088
	speed: 0.0883s/iter; left time: 1926.3618s
	iters: 3400, epoch: 4 | loss: 0.5664985
	speed: 0.0890s/iter; left time: 1932.5614s
	iters: 3500, epoch: 4 | loss: 0.5263385
	speed: 0.0885s/iter; left time: 1913.0378s
Epoch: 4 cost time: 318.18262362480164
Epoch: 4, Steps: 3588 | Train Loss: 0.5289773 Vali Loss: 9.2054882 Test Loss: 10.5011778
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems11_all_96_336_Mamba_custom_ftM_sl336_ll48_pl336_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 242462
test shape: (24246, 1, 336, 521) (24246, 1, 336, 521)
test shape: (24246, 336, 521) (24246, 336, 521)
mse:6.541094779968262, mae:1.0856653451919556
>>>>>>>Overall time: 2588 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
