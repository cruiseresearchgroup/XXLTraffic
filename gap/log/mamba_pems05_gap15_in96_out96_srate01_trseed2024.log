Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=103, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems05_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=103, expand=2, factor=1, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems05_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_96_Mamba_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 600775
val 95012
test 95011
	iters: 100, epoch: 1 | loss: 1.5683463
	speed: 0.0254s/iter; left time: 473.5733s
	iters: 200, epoch: 1 | loss: 1.2886306
	speed: 0.0085s/iter; left time: 157.5060s
	iters: 300, epoch: 1 | loss: 1.2837858
	speed: 0.0084s/iter; left time: 155.8566s
	iters: 400, epoch: 1 | loss: 1.2576389
	speed: 0.0084s/iter; left time: 155.1721s
	iters: 500, epoch: 1 | loss: 1.2561994
	speed: 0.0084s/iter; left time: 154.1593s
	iters: 600, epoch: 1 | loss: 1.1638460
	speed: 0.0084s/iter; left time: 153.2866s
	iters: 700, epoch: 1 | loss: 1.1609652
	speed: 0.0084s/iter; left time: 152.3417s
	iters: 800, epoch: 1 | loss: 1.0034006
	speed: 0.0084s/iter; left time: 151.6327s
	iters: 900, epoch: 1 | loss: 1.2060519
	speed: 0.0084s/iter; left time: 150.6536s
	iters: 1000, epoch: 1 | loss: 1.2272511
	speed: 0.0085s/iter; left time: 150.3801s
	iters: 1100, epoch: 1 | loss: 1.0205930
	speed: 0.0085s/iter; left time: 149.4794s
	iters: 1200, epoch: 1 | loss: 1.0303726
	speed: 0.0085s/iter; left time: 148.5436s
	iters: 1300, epoch: 1 | loss: 1.0494537
	speed: 0.0084s/iter; left time: 147.1379s
	iters: 1400, epoch: 1 | loss: 1.0261168
	speed: 0.0084s/iter; left time: 146.6368s
	iters: 1500, epoch: 1 | loss: 1.0276650
	speed: 0.0084s/iter; left time: 145.7965s
	iters: 1600, epoch: 1 | loss: 1.0086123
	speed: 0.0084s/iter; left time: 144.8679s
	iters: 1700, epoch: 1 | loss: 1.1097729
	speed: 0.0085s/iter; left time: 145.1632s
	iters: 1800, epoch: 1 | loss: 1.2119318
	speed: 0.0085s/iter; left time: 143.6377s
Epoch: 1 cost time: 17.59606409072876
Epoch: 1, Steps: 1877 | Train Loss: 1.2002361 Vali Loss: 1.4730169 Test Loss: 2.0216939
Validation loss decreased (inf --> 1.473017).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 1.1087568
	speed: 0.2066s/iter; left time: 3470.1354s
	iters: 200, epoch: 2 | loss: 0.9924775
	speed: 0.0085s/iter; left time: 142.7249s
	iters: 300, epoch: 2 | loss: 1.0108613
	speed: 0.0086s/iter; left time: 142.4961s
	iters: 400, epoch: 2 | loss: 0.9785465
	speed: 0.0085s/iter; left time: 140.8821s
	iters: 500, epoch: 2 | loss: 1.0508186
	speed: 0.0085s/iter; left time: 139.7905s
	iters: 600, epoch: 2 | loss: 0.9546095
	speed: 0.0085s/iter; left time: 139.1084s
	iters: 700, epoch: 2 | loss: 0.9625738
	speed: 0.0085s/iter; left time: 138.0653s
	iters: 800, epoch: 2 | loss: 0.9302477
	speed: 0.0085s/iter; left time: 137.5951s
	iters: 900, epoch: 2 | loss: 0.9458930
	speed: 0.0085s/iter; left time: 136.1533s
	iters: 1000, epoch: 2 | loss: 0.9442119
	speed: 0.0085s/iter; left time: 135.2295s
	iters: 1100, epoch: 2 | loss: 0.9507303
	speed: 0.0086s/iter; left time: 135.0910s
	iters: 1200, epoch: 2 | loss: 0.9235447
	speed: 0.0085s/iter; left time: 133.7633s
	iters: 1300, epoch: 2 | loss: 0.8151998
	speed: 0.0086s/iter; left time: 133.4702s
	iters: 1400, epoch: 2 | loss: 0.8744259
	speed: 0.0085s/iter; left time: 131.9886s
	iters: 1500, epoch: 2 | loss: 0.8585566
	speed: 0.0085s/iter; left time: 131.1129s
	iters: 1600, epoch: 2 | loss: 1.0817399
	speed: 0.0085s/iter; left time: 130.4109s
	iters: 1700, epoch: 2 | loss: 0.8515325
	speed: 0.0085s/iter; left time: 129.0402s
	iters: 1800, epoch: 2 | loss: 1.0775356
	speed: 0.0086s/iter; left time: 130.4988s
Epoch: 2 cost time: 16.408034324645996
Epoch: 2, Steps: 1877 | Train Loss: 0.9595126 Vali Loss: 1.4358878 Test Loss: 1.8516266
Validation loss decreased (1.473017 --> 1.435888).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.9191359
	speed: 0.2051s/iter; left time: 3059.7567s
	iters: 200, epoch: 3 | loss: 0.8526977
	speed: 0.0085s/iter; left time: 126.0050s
	iters: 300, epoch: 3 | loss: 0.8735755
	speed: 0.0085s/iter; left time: 125.0287s
	iters: 400, epoch: 3 | loss: 0.9680441
	speed: 0.0085s/iter; left time: 124.4915s
	iters: 500, epoch: 3 | loss: 0.8259161
	speed: 0.0085s/iter; left time: 123.6494s
	iters: 600, epoch: 3 | loss: 0.8471302
	speed: 0.0085s/iter; left time: 122.8664s
	iters: 700, epoch: 3 | loss: 0.9331683
	speed: 0.0085s/iter; left time: 121.6774s
	iters: 800, epoch: 3 | loss: 0.9910516
	speed: 0.0085s/iter; left time: 120.7932s
	iters: 900, epoch: 3 | loss: 0.9411132
	speed: 0.0085s/iter; left time: 120.2714s
	iters: 1000, epoch: 3 | loss: 1.0027071
	speed: 0.0085s/iter; left time: 118.9700s
	iters: 1100, epoch: 3 | loss: 0.9644499
	speed: 0.0085s/iter; left time: 118.4398s
	iters: 1200, epoch: 3 | loss: 0.8757163
	speed: 0.0085s/iter; left time: 117.6158s
	iters: 1300, epoch: 3 | loss: 0.8618980
	speed: 0.0085s/iter; left time: 116.4387s
	iters: 1400, epoch: 3 | loss: 0.9210561
	speed: 0.0085s/iter; left time: 115.3531s
	iters: 1500, epoch: 3 | loss: 0.9510065
	speed: 0.0085s/iter; left time: 114.5904s
	iters: 1600, epoch: 3 | loss: 1.0240356
	speed: 0.0085s/iter; left time: 113.6121s
	iters: 1700, epoch: 3 | loss: 0.8283021
	speed: 0.0085s/iter; left time: 113.0734s
	iters: 1800, epoch: 3 | loss: 0.8750702
	speed: 0.0085s/iter; left time: 112.0333s
Epoch: 3 cost time: 16.223931789398193
Epoch: 3, Steps: 1877 | Train Loss: 0.8899004 Vali Loss: 1.4626107 Test Loss: 2.1713893
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8710362
	speed: 0.2069s/iter; left time: 2698.3974s
	iters: 200, epoch: 4 | loss: 0.7876587
	speed: 0.0086s/iter; left time: 111.1832s
	iters: 300, epoch: 4 | loss: 0.7834159
	speed: 0.0086s/iter; left time: 110.2443s
	iters: 400, epoch: 4 | loss: 0.8073505
	speed: 0.0086s/iter; left time: 109.4289s
	iters: 500, epoch: 4 | loss: 0.9200238
	speed: 0.0086s/iter; left time: 108.9371s
	iters: 600, epoch: 4 | loss: 0.8595948
	speed: 0.0086s/iter; left time: 107.8870s
	iters: 700, epoch: 4 | loss: 0.8371093
	speed: 0.0086s/iter; left time: 107.1301s
	iters: 800, epoch: 4 | loss: 1.0255527
	speed: 0.0086s/iter; left time: 106.0007s
	iters: 900, epoch: 4 | loss: 0.8924410
	speed: 0.0086s/iter; left time: 105.3218s
	iters: 1000, epoch: 4 | loss: 0.8875855
	speed: 0.0086s/iter; left time: 104.7246s
	iters: 1100, epoch: 4 | loss: 0.8363384
	speed: 0.0086s/iter; left time: 103.3580s
	iters: 1200, epoch: 4 | loss: 0.8698383
	speed: 0.0086s/iter; left time: 102.3057s
	iters: 1300, epoch: 4 | loss: 0.8787682
	speed: 0.0086s/iter; left time: 101.4185s
	iters: 1400, epoch: 4 | loss: 0.8159466
	speed: 0.0086s/iter; left time: 100.7992s
	iters: 1500, epoch: 4 | loss: 0.8829907
	speed: 0.0086s/iter; left time: 99.9448s
	iters: 1600, epoch: 4 | loss: 0.8041062
	speed: 0.0086s/iter; left time: 98.9735s
	iters: 1700, epoch: 4 | loss: 0.9553466
	speed: 0.0085s/iter; left time: 97.6563s
	iters: 1800, epoch: 4 | loss: 0.8551948
	speed: 0.0086s/iter; left time: 97.1311s
Epoch: 4 cost time: 16.368256330490112
Epoch: 4, Steps: 1877 | Train Loss: 0.8632627 Vali Loss: 1.4394006 Test Loss: 2.0401037
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8684399
	speed: 0.2660s/iter; left time: 2969.8692s
	iters: 200, epoch: 5 | loss: 0.8741414
	speed: 0.0096s/iter; left time: 106.6972s
	iters: 300, epoch: 5 | loss: 0.7383634
	speed: 0.0096s/iter; left time: 105.2021s
	iters: 400, epoch: 5 | loss: 0.8906509
	speed: 0.0091s/iter; left time: 99.2456s
	iters: 500, epoch: 5 | loss: 0.9312164
	speed: 0.0098s/iter; left time: 105.7980s
	iters: 600, epoch: 5 | loss: 0.8975376
	speed: 0.0094s/iter; left time: 99.8274s
	iters: 700, epoch: 5 | loss: 0.8691706
	speed: 0.0092s/iter; left time: 96.7680s
	iters: 800, epoch: 5 | loss: 0.6839183
	speed: 0.0088s/iter; left time: 92.1137s
	iters: 900, epoch: 5 | loss: 0.9117606
	speed: 0.0088s/iter; left time: 91.4654s
	iters: 1000, epoch: 5 | loss: 0.7857758
	speed: 0.0095s/iter; left time: 97.4253s
	iters: 1100, epoch: 5 | loss: 0.8715677
	speed: 0.0094s/iter; left time: 95.0398s
	iters: 1200, epoch: 5 | loss: 0.8563166
	speed: 0.0095s/iter; left time: 95.2863s
	iters: 1300, epoch: 5 | loss: 0.8761852
	speed: 0.0090s/iter; left time: 90.0181s
	iters: 1400, epoch: 5 | loss: 0.7975230
	speed: 0.0094s/iter; left time: 92.8547s
	iters: 1500, epoch: 5 | loss: 0.7571703
	speed: 0.0101s/iter; left time: 98.3084s
	iters: 1600, epoch: 5 | loss: 0.8916119
	speed: 0.0094s/iter; left time: 90.5263s
	iters: 1700, epoch: 5 | loss: 0.8697888
	speed: 0.0094s/iter; left time: 90.3320s
	iters: 1800, epoch: 5 | loss: 0.8250540
	speed: 0.0092s/iter; left time: 87.2533s
Epoch: 5 cost time: 17.890851497650146
Epoch: 5, Steps: 1877 | Train Loss: 0.8509456 Vali Loss: 1.4417529 Test Loss: 2.0823627
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems05_all_96_96_Mamba_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 95011
test shape: (9501, 1, 96, 103) (9501, 1, 96, 103)
test shape: (9501, 96, 103) (9501, 96, 103)
mse:1.8516279458999634, mae:1.1219590902328491
>>>>>>>Overall time: 253 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
