nohup: ignoring input
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=151, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems03_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems03_hour_96_3', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=3, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_hour_96_3_DLinear_custom_ftM_sl96_ll48_pl3_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1499169
val 124077
test 353274
	iters: 100, epoch: 1 | loss: 1.0513519
	speed: 0.0106s/iter; left time: 9952.7384s
	iters: 200, epoch: 1 | loss: 0.9934880
	speed: 0.0066s/iter; left time: 6146.0243s
	iters: 300, epoch: 1 | loss: 0.9516807
	speed: 0.0065s/iter; left time: 6124.2414s
	iters: 400, epoch: 1 | loss: 0.9547159
	speed: 0.0065s/iter; left time: 6130.4414s
	iters: 500, epoch: 1 | loss: 0.8339085
	speed: 0.0067s/iter; left time: 6286.7319s
	iters: 600, epoch: 1 | loss: 0.8816469
	speed: 0.0066s/iter; left time: 6160.1132s
	iters: 700, epoch: 1 | loss: 0.8003619
	speed: 0.0066s/iter; left time: 6165.9923s
	iters: 800, epoch: 1 | loss: 0.9366063
	speed: 0.0066s/iter; left time: 6147.5991s
	iters: 900, epoch: 1 | loss: 1.1045613
	speed: 0.0066s/iter; left time: 6193.6491s
	iters: 1000, epoch: 1 | loss: 1.3677421
	speed: 0.0066s/iter; left time: 6211.5949s
	iters: 1100, epoch: 1 | loss: 0.9949521
	speed: 0.0067s/iter; left time: 6228.4681s
	iters: 1200, epoch: 1 | loss: 1.0490813
	speed: 0.0065s/iter; left time: 6120.4169s
	iters: 1300, epoch: 1 | loss: 0.9278453
	speed: 0.0066s/iter; left time: 6160.5346s
	iters: 1400, epoch: 1 | loss: 0.8416883
	speed: 0.0066s/iter; left time: 6202.8002s
	iters: 1500, epoch: 1 | loss: 0.8759104
	speed: 0.0066s/iter; left time: 6195.6257s
	iters: 1600, epoch: 1 | loss: 1.2495154
	speed: 0.0066s/iter; left time: 6173.4445s
	iters: 1700, epoch: 1 | loss: 0.9063891
	speed: 0.0066s/iter; left time: 6160.9237s
	iters: 1800, epoch: 1 | loss: 0.9101986
	speed: 0.0066s/iter; left time: 6176.3018s
	iters: 1900, epoch: 1 | loss: 0.9597719
	speed: 0.0068s/iter; left time: 6341.3657s
	iters: 2000, epoch: 1 | loss: 0.8910112
	speed: 0.0066s/iter; left time: 6142.2249s
	iters: 2100, epoch: 1 | loss: 0.8860541
	speed: 0.0068s/iter; left time: 6351.0759s
	iters: 2200, epoch: 1 | loss: 1.0058622
	speed: 0.0066s/iter; left time: 6214.2117s
	iters: 2300, epoch: 1 | loss: 0.7531568
	speed: 0.0067s/iter; left time: 6217.3255s
	iters: 2400, epoch: 1 | loss: 1.0362636
	speed: 0.0066s/iter; left time: 6209.1793s
	iters: 2500, epoch: 1 | loss: 1.0041806
	speed: 0.0067s/iter; left time: 6228.2263s
	iters: 2600, epoch: 1 | loss: 1.0885563
	speed: 0.0067s/iter; left time: 6213.2782s
	iters: 2700, epoch: 1 | loss: 0.8883128
	speed: 0.0066s/iter; left time: 6200.4444s
	iters: 2800, epoch: 1 | loss: 0.9062074
	speed: 0.0066s/iter; left time: 6186.7203s
	iters: 2900, epoch: 1 | loss: 0.9990782
	speed: 0.0066s/iter; left time: 6199.2571s
	iters: 3000, epoch: 1 | loss: 1.1138619
	speed: 0.0066s/iter; left time: 6188.9109s
	iters: 3100, epoch: 1 | loss: 1.0732166
	speed: 0.0066s/iter; left time: 6181.4830s
	iters: 3200, epoch: 1 | loss: 0.9299714
	speed: 0.0067s/iter; left time: 6274.4948s
	iters: 3300, epoch: 1 | loss: 0.7391829
	speed: 0.0066s/iter; left time: 6181.3496s
	iters: 3400, epoch: 1 | loss: 0.8281948
	speed: 0.0067s/iter; left time: 6227.2606s
	iters: 3500, epoch: 1 | loss: 0.8602974
	speed: 0.0067s/iter; left time: 6251.3573s
	iters: 3600, epoch: 1 | loss: 0.8814667
	speed: 0.0067s/iter; left time: 6241.7744s
	iters: 3700, epoch: 1 | loss: 1.0458291
	speed: 0.0067s/iter; left time: 6238.1201s
	iters: 3800, epoch: 1 | loss: 1.0651314
	speed: 0.0067s/iter; left time: 6222.7123s
	iters: 3900, epoch: 1 | loss: 0.6968508
	speed: 0.0067s/iter; left time: 6227.8595s
	iters: 4000, epoch: 1 | loss: 0.8036544
	speed: 0.0066s/iter; left time: 6186.8290s
	iters: 4100, epoch: 1 | loss: 1.0269618
	speed: 0.0067s/iter; left time: 6223.3933s
	iters: 4200, epoch: 1 | loss: 0.8207839
	speed: 0.0066s/iter; left time: 6190.9323s
	iters: 4300, epoch: 1 | loss: 0.9781250
	speed: 0.0066s/iter; left time: 6187.5383s
	iters: 4400, epoch: 1 | loss: 0.7029533
	speed: 0.0067s/iter; left time: 6205.5948s
	iters: 4500, epoch: 1 | loss: 1.0138654
	speed: 0.0067s/iter; left time: 6223.0004s
	iters: 4600, epoch: 1 | loss: 0.8490606
	speed: 0.0067s/iter; left time: 6215.9631s
Epoch: 1 cost time: 31.583808422088623
Epoch: 1, Steps: 4684 | Train Loss: 0.9575459 Vali Loss: 2.3608048 Test Loss: 1.5489078
Validation loss decreased (inf --> 2.360805).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2498459
	speed: 0.4516s/iter; left time: 420923.7389s
	iters: 200, epoch: 2 | loss: 0.8936568
	speed: 0.0074s/iter; left time: 6903.5314s
	iters: 300, epoch: 2 | loss: 1.1191999
	speed: 0.0076s/iter; left time: 7119.2213s
	iters: 400, epoch: 2 | loss: 1.0722078
	speed: 0.0068s/iter; left time: 6322.7922s
	iters: 500, epoch: 2 | loss: 0.8523195
	speed: 0.0067s/iter; left time: 6238.2985s
	iters: 600, epoch: 2 | loss: 0.8302128
	speed: 0.0067s/iter; left time: 6272.5572s
	iters: 700, epoch: 2 | loss: 1.1930611
	speed: 0.0068s/iter; left time: 6345.1859s
	iters: 800, epoch: 2 | loss: 1.2583008
	speed: 0.0068s/iter; left time: 6307.0993s
	iters: 900, epoch: 2 | loss: 0.8228679
	speed: 0.0066s/iter; left time: 6175.2996s
	iters: 1000, epoch: 2 | loss: 0.9625039
	speed: 0.0066s/iter; left time: 6162.5488s
	iters: 1100, epoch: 2 | loss: 0.9374455
	speed: 0.0066s/iter; left time: 6167.4940s
	iters: 1200, epoch: 2 | loss: 0.7409167
	speed: 0.0066s/iter; left time: 6144.2661s
	iters: 1300, epoch: 2 | loss: 0.9497809
	speed: 0.0067s/iter; left time: 6228.6651s
	iters: 1400, epoch: 2 | loss: 0.8655044
	speed: 0.0067s/iter; left time: 6209.4140s
	iters: 1500, epoch: 2 | loss: 0.6002460
	speed: 0.0067s/iter; left time: 6240.7991s
	iters: 1600, epoch: 2 | loss: 0.7431203
	speed: 0.0067s/iter; left time: 6223.8379s
	iters: 1700, epoch: 2 | loss: 0.8366538
	speed: 0.0067s/iter; left time: 6223.0071s
	iters: 1800, epoch: 2 | loss: 0.7758336
	speed: 0.0067s/iter; left time: 6204.8245s
	iters: 1900, epoch: 2 | loss: 0.7311936
	speed: 0.0067s/iter; left time: 6214.6500s
	iters: 2000, epoch: 2 | loss: 0.9132189
	speed: 0.0067s/iter; left time: 6196.6228s
	iters: 2100, epoch: 2 | loss: 0.9803623
	speed: 0.0067s/iter; left time: 6215.1143s
	iters: 2200, epoch: 2 | loss: 0.7777133
	speed: 0.0067s/iter; left time: 6216.1266s
	iters: 2300, epoch: 2 | loss: 0.8571482
	speed: 0.0067s/iter; left time: 6204.8483s
	iters: 2400, epoch: 2 | loss: 0.9789663
	speed: 0.0067s/iter; left time: 6215.1067s
	iters: 2500, epoch: 2 | loss: 0.7666367
	speed: 0.0066s/iter; left time: 6174.4059s
	iters: 2600, epoch: 2 | loss: 1.1750170
	speed: 0.0066s/iter; left time: 6155.1771s
	iters: 2700, epoch: 2 | loss: 0.8063288
	speed: 0.0066s/iter; left time: 6142.2987s
	iters: 2800, epoch: 2 | loss: 0.9638088
	speed: 0.0066s/iter; left time: 6146.3970s
	iters: 2900, epoch: 2 | loss: 0.8852955
	speed: 0.0066s/iter; left time: 6150.7093s
	iters: 3000, epoch: 2 | loss: 1.1074841
	speed: 0.0067s/iter; left time: 6179.0597s
	iters: 3100, epoch: 2 | loss: 1.1145643
	speed: 0.0067s/iter; left time: 6222.8376s
	iters: 3200, epoch: 2 | loss: 0.9925175
	speed: 0.0067s/iter; left time: 6211.8627s
	iters: 3300, epoch: 2 | loss: 0.9497426
	speed: 0.0067s/iter; left time: 6214.3053s
	iters: 3400, epoch: 2 | loss: 1.0441912
	speed: 0.0067s/iter; left time: 6201.6816s
	iters: 3500, epoch: 2 | loss: 0.7571682
	speed: 0.0067s/iter; left time: 6195.5497s
	iters: 3600, epoch: 2 | loss: 1.0541095
	speed: 0.0067s/iter; left time: 6200.9814s
	iters: 3700, epoch: 2 | loss: 0.9905062
	speed: 0.0067s/iter; left time: 6199.7580s
	iters: 3800, epoch: 2 | loss: 0.8036243
	speed: 0.0067s/iter; left time: 6190.2968s
	iters: 3900, epoch: 2 | loss: 1.0008638
	speed: 0.0067s/iter; left time: 6218.1539s
	iters: 4000, epoch: 2 | loss: 1.0337232
	speed: 0.0067s/iter; left time: 6206.1744s
	iters: 4100, epoch: 2 | loss: 0.7396778
	speed: 0.0067s/iter; left time: 6190.0531s
	iters: 4200, epoch: 2 | loss: 0.9715505
	speed: 0.0067s/iter; left time: 6210.8258s
	iters: 4300, epoch: 2 | loss: 0.9761326
	speed: 0.0067s/iter; left time: 6205.3496s
	iters: 4400, epoch: 2 | loss: 0.9612079
	speed: 0.0067s/iter; left time: 6180.6424s
	iters: 4500, epoch: 2 | loss: 1.0166684
	speed: 0.0067s/iter; left time: 6204.4808s
	iters: 4600, epoch: 2 | loss: 1.1582813
	speed: 0.0067s/iter; left time: 6252.5462s
Epoch: 2 cost time: 31.650943756103516
Epoch: 2, Steps: 4684 | Train Loss: 0.9505740 Vali Loss: 2.3657215 Test Loss: 1.5578725
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 0.6289770
	speed: 0.4509s/iter; left time: 418167.3874s
	iters: 200, epoch: 3 | loss: 1.0218709
	speed: 0.0067s/iter; left time: 6172.4261s
	iters: 300, epoch: 3 | loss: 0.9880348
	speed: 0.0066s/iter; left time: 6129.5097s
	iters: 400, epoch: 3 | loss: 1.2648028
	speed: 0.0066s/iter; left time: 6151.8482s
	iters: 500, epoch: 3 | loss: 1.1968873
	speed: 0.0067s/iter; left time: 6167.2334s
	iters: 600, epoch: 3 | loss: 0.9928887
	speed: 0.0066s/iter; left time: 6151.1905s
	iters: 700, epoch: 3 | loss: 0.9672760
	speed: 0.0066s/iter; left time: 6128.5776s
	iters: 800, epoch: 3 | loss: 0.8743179
	speed: 0.0067s/iter; left time: 6162.6769s
	iters: 900, epoch: 3 | loss: 0.9597874
	speed: 0.0067s/iter; left time: 6181.6324s
	iters: 1000, epoch: 3 | loss: 1.0284065
	speed: 0.0068s/iter; left time: 6330.2197s
	iters: 1100, epoch: 3 | loss: 0.9083909
	speed: 0.0067s/iter; left time: 6217.1234s
	iters: 1200, epoch: 3 | loss: 0.8095908
	speed: 0.0067s/iter; left time: 6229.6359s
	iters: 1300, epoch: 3 | loss: 1.0028999
	speed: 0.0066s/iter; left time: 6124.9167s
	iters: 1400, epoch: 3 | loss: 0.6342985
	speed: 0.0067s/iter; left time: 6204.9627s
	iters: 1500, epoch: 3 | loss: 1.0786165
	speed: 0.0067s/iter; left time: 6205.5687s
	iters: 1600, epoch: 3 | loss: 0.9612285
	speed: 0.0069s/iter; left time: 6414.0434s
	iters: 1700, epoch: 3 | loss: 0.8510128
	speed: 0.0067s/iter; left time: 6214.3369s
	iters: 1800, epoch: 3 | loss: 0.9042788
	speed: 0.0067s/iter; left time: 6209.2651s
	iters: 1900, epoch: 3 | loss: 0.7882436
	speed: 0.0068s/iter; left time: 6265.7066s
	iters: 2000, epoch: 3 | loss: 1.0397863
	speed: 0.0067s/iter; left time: 6170.1123s
	iters: 2100, epoch: 3 | loss: 0.7513283
	speed: 0.0067s/iter; left time: 6184.3239s
	iters: 2200, epoch: 3 | loss: 0.8367810
	speed: 0.0067s/iter; left time: 6171.3708s
	iters: 2300, epoch: 3 | loss: 0.9502479
	speed: 0.0067s/iter; left time: 6174.7887s
	iters: 2400, epoch: 3 | loss: 0.8360618
	speed: 0.0067s/iter; left time: 6177.5287s
	iters: 2500, epoch: 3 | loss: 1.0167768
	speed: 0.0067s/iter; left time: 6185.1701s
	iters: 2600, epoch: 3 | loss: 1.1329938
	speed: 0.0067s/iter; left time: 6201.5811s
	iters: 2700, epoch: 3 | loss: 1.2773322
	speed: 0.0067s/iter; left time: 6176.4733s
	iters: 2800, epoch: 3 | loss: 0.9909017
	speed: 0.0067s/iter; left time: 6160.7222s
	iters: 2900, epoch: 3 | loss: 0.9424701
	speed: 0.0067s/iter; left time: 6173.2043s
	iters: 3000, epoch: 3 | loss: 1.2034274
	speed: 0.0067s/iter; left time: 6174.4431s
	iters: 3100, epoch: 3 | loss: 0.9426291
	speed: 0.0066s/iter; left time: 6145.1723s
	iters: 3200, epoch: 3 | loss: 1.0203396
	speed: 0.0067s/iter; left time: 6209.6045s
	iters: 3300, epoch: 3 | loss: 0.9630592
	speed: 0.0067s/iter; left time: 6163.6570s
	iters: 3400, epoch: 3 | loss: 0.8514132
	speed: 0.0067s/iter; left time: 6165.7747s
	iters: 3500, epoch: 3 | loss: 1.2682589
	speed: 0.0067s/iter; left time: 6146.0838s
	iters: 3600, epoch: 3 | loss: 0.8676681
	speed: 0.0067s/iter; left time: 6146.3767s
	iters: 3700, epoch: 3 | loss: 0.9245610
	speed: 0.0067s/iter; left time: 6210.1632s
	iters: 3800, epoch: 3 | loss: 1.0389557
	speed: 0.0066s/iter; left time: 6083.4221s
	iters: 3900, epoch: 3 | loss: 0.9048585
	speed: 0.0067s/iter; left time: 6197.2522s
	iters: 4000, epoch: 3 | loss: 0.8520797
	speed: 0.0066s/iter; left time: 6132.6632s
	iters: 4100, epoch: 3 | loss: 1.0315013
	speed: 0.0067s/iter; left time: 6165.4670s
	iters: 4200, epoch: 3 | loss: 1.0151200
	speed: 0.0066s/iter; left time: 6123.3360s
	iters: 4300, epoch: 3 | loss: 0.9037899
	speed: 0.0066s/iter; left time: 6078.8084s
	iters: 4400, epoch: 3 | loss: 0.8075300
	speed: 0.0066s/iter; left time: 6111.2636s
	iters: 4500, epoch: 3 | loss: 1.3237953
	speed: 0.0066s/iter; left time: 6113.3740s
	iters: 4600, epoch: 3 | loss: 0.8528979
	speed: 0.0067s/iter; left time: 6171.2349s
Epoch: 3 cost time: 31.444321393966675
Epoch: 3, Steps: 4684 | Train Loss: 0.9505873 Vali Loss: 2.4388700 Test Loss: 1.6096355
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 4 | loss: 1.0652837
	speed: 0.9062s/iter; left time: 836090.3584s
	iters: 200, epoch: 4 | loss: 1.1960778
	speed: 0.0067s/iter; left time: 6179.4426s
	iters: 300, epoch: 4 | loss: 0.9871289
	speed: 0.0066s/iter; left time: 6129.6054s
	iters: 400, epoch: 4 | loss: 0.9430342
	speed: 0.0066s/iter; left time: 6128.2042s
	iters: 500, epoch: 4 | loss: 1.0447096
	speed: 0.0066s/iter; left time: 6129.6617s
	iters: 600, epoch: 4 | loss: 0.9988388
	speed: 0.0067s/iter; left time: 6147.6190s
	iters: 700, epoch: 4 | loss: 0.9093273
	speed: 0.0067s/iter; left time: 6151.5534s
	iters: 800, epoch: 4 | loss: 0.9505917
	speed: 0.0067s/iter; left time: 6197.2991s
	iters: 900, epoch: 4 | loss: 0.8231979
	speed: 0.0067s/iter; left time: 6219.2407s
	iters: 1000, epoch: 4 | loss: 1.0552056
	speed: 0.0067s/iter; left time: 6151.4924s
	iters: 1100, epoch: 4 | loss: 0.8816551
	speed: 0.0066s/iter; left time: 6119.9958s
	iters: 1200, epoch: 4 | loss: 0.8487331
	speed: 0.0066s/iter; left time: 6114.3223s
	iters: 1300, epoch: 4 | loss: 0.9968939
	speed: 0.0067s/iter; left time: 6190.2144s
	iters: 1400, epoch: 4 | loss: 0.8711672
	speed: 0.0067s/iter; left time: 6192.3960s
	iters: 1500, epoch: 4 | loss: 0.9679557
	speed: 0.0068s/iter; left time: 6270.1848s
	iters: 1600, epoch: 4 | loss: 0.8319348
	speed: 0.0066s/iter; left time: 6104.7306s
	iters: 1700, epoch: 4 | loss: 0.8891929
	speed: 0.0066s/iter; left time: 6113.2140s
	iters: 1800, epoch: 4 | loss: 0.9583085
	speed: 0.0066s/iter; left time: 6111.1757s
	iters: 1900, epoch: 4 | loss: 0.8539066
	speed: 0.0066s/iter; left time: 6114.6682s
	iters: 2000, epoch: 4 | loss: 0.7711772
	speed: 0.0067s/iter; left time: 6176.3204s
	iters: 2100, epoch: 4 | loss: 0.7333792
	speed: 0.0067s/iter; left time: 6198.4666s
	iters: 2200, epoch: 4 | loss: 0.8825865
	speed: 0.0067s/iter; left time: 6131.0902s
	iters: 2300, epoch: 4 | loss: 0.9721356
	speed: 0.0067s/iter; left time: 6137.8680s
	iters: 2400, epoch: 4 | loss: 1.0768946
	speed: 0.0067s/iter; left time: 6163.2802s
	iters: 2500, epoch: 4 | loss: 1.1630899
	speed: 0.0067s/iter; left time: 6153.7246s
	iters: 2600, epoch: 4 | loss: 0.8090462
	speed: 0.0067s/iter; left time: 6144.1491s
	iters: 2700, epoch: 4 | loss: 0.6235254
	speed: 0.0067s/iter; left time: 6139.7238s
	iters: 2800, epoch: 4 | loss: 0.8271611
	speed: 0.0067s/iter; left time: 6152.0497s
	iters: 2900, epoch: 4 | loss: 0.8773369
	speed: 0.0067s/iter; left time: 6143.9486s
	iters: 3000, epoch: 4 | loss: 0.8382236
	speed: 0.0066s/iter; left time: 6114.7648s
	iters: 3100, epoch: 4 | loss: 0.9338983
	speed: 0.0067s/iter; left time: 6141.6151s
	iters: 3200, epoch: 4 | loss: 0.8427996
	speed: 0.0067s/iter; left time: 6188.6862s
	iters: 3300, epoch: 4 | loss: 0.9035132
	speed: 0.0067s/iter; left time: 6119.8794s
	iters: 3400, epoch: 4 | loss: 1.0998189
	speed: 0.0066s/iter; left time: 6108.7409s
	iters: 3500, epoch: 4 | loss: 0.8739126
	speed: 0.0066s/iter; left time: 6093.9424s
	iters: 3600, epoch: 4 | loss: 0.8253691
	speed: 0.0066s/iter; left time: 6085.3816s
	iters: 3700, epoch: 4 | loss: 0.9885377
	speed: 0.0066s/iter; left time: 6106.6358s
	iters: 3800, epoch: 4 | loss: 1.0085574
	speed: 0.0066s/iter; left time: 6102.7397s
	iters: 3900, epoch: 4 | loss: 0.9302588
	speed: 0.0067s/iter; left time: 6111.5131s
	iters: 4000, epoch: 4 | loss: 0.9495659
	speed: 0.0067s/iter; left time: 6120.9592s
	iters: 4100, epoch: 4 | loss: 0.7466455
	speed: 0.0066s/iter; left time: 6095.2149s
	iters: 4200, epoch: 4 | loss: 0.8228323
	speed: 0.0066s/iter; left time: 6092.4293s
	iters: 4300, epoch: 4 | loss: 0.9946305
	speed: 0.0068s/iter; left time: 6261.1543s
	iters: 4400, epoch: 4 | loss: 0.7515590
	speed: 0.0066s/iter; left time: 6064.2680s
	iters: 4500, epoch: 4 | loss: 1.0307223
	speed: 0.0066s/iter; left time: 6071.0184s
	iters: 4600, epoch: 4 | loss: 0.8894883
	speed: 0.0066s/iter; left time: 6084.0694s
Epoch: 4 cost time: 31.435904502868652
Epoch: 4, Steps: 4684 | Train Loss: 0.9505796 Vali Loss: 2.4059424 Test Loss: 1.5832220
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 5 | loss: 0.8907305
	speed: 0.4518s/iter; left time: 414698.5410s
	iters: 200, epoch: 5 | loss: 1.0995146
	speed: 0.0067s/iter; left time: 6190.5332s
	iters: 300, epoch: 5 | loss: 0.7549541
	speed: 0.0067s/iter; left time: 6182.2813s
	iters: 400, epoch: 5 | loss: 1.0854847
	speed: 0.0068s/iter; left time: 6216.4935s
	iters: 500, epoch: 5 | loss: 0.8178317
	speed: 0.0067s/iter; left time: 6163.8726s
	iters: 600, epoch: 5 | loss: 0.8406911
	speed: 0.0067s/iter; left time: 6116.1366s
	iters: 700, epoch: 5 | loss: 1.1375430
	speed: 0.0066s/iter; left time: 6093.9023s
	iters: 800, epoch: 5 | loss: 1.0501028
	speed: 0.0066s/iter; left time: 6085.2163s
	iters: 900, epoch: 5 | loss: 1.0398312
	speed: 0.0066s/iter; left time: 6078.3121s
	iters: 1000, epoch: 5 | loss: 0.7715371
	speed: 0.0066s/iter; left time: 6085.8770s
	iters: 1100, epoch: 5 | loss: 0.7707455
	speed: 0.0066s/iter; left time: 6096.3325s
	iters: 1200, epoch: 5 | loss: 1.1095471
	speed: 0.0067s/iter; left time: 6118.4914s
	iters: 1300, epoch: 5 | loss: 0.8036135
	speed: 0.0067s/iter; left time: 6106.7052s
	iters: 1400, epoch: 5 | loss: 0.9034185
	speed: 0.0066s/iter; left time: 6086.3893s
	iters: 1500, epoch: 5 | loss: 0.8389927
	speed: 0.0066s/iter; left time: 6075.1334s
	iters: 1600, epoch: 5 | loss: 0.9738967
	speed: 0.0066s/iter; left time: 6073.3911s
	iters: 1700, epoch: 5 | loss: 0.9784862
	speed: 0.0066s/iter; left time: 6071.5137s
	iters: 1800, epoch: 5 | loss: 0.7752773
	speed: 0.0066s/iter; left time: 6090.2302s
	iters: 1900, epoch: 5 | loss: 0.8465385
	speed: 0.0066s/iter; left time: 6081.3591s
	iters: 2000, epoch: 5 | loss: 1.0143343
	speed: 0.0066s/iter; left time: 6067.4031s
	iters: 2100, epoch: 5 | loss: 1.2444568
	speed: 0.0066s/iter; left time: 6086.1332s
	iters: 2200, epoch: 5 | loss: 0.8030825
	speed: 0.0066s/iter; left time: 6074.4263s
	iters: 2300, epoch: 5 | loss: 0.8571543
	speed: 0.0066s/iter; left time: 6073.4290s
	iters: 2400, epoch: 5 | loss: 1.0351018
	speed: 0.0066s/iter; left time: 6070.3556s
	iters: 2500, epoch: 5 | loss: 0.9779179
	speed: 0.0066s/iter; left time: 6049.5120s
	iters: 2600, epoch: 5 | loss: 0.9682632
	speed: 0.0066s/iter; left time: 6046.0094s
	iters: 2700, epoch: 5 | loss: 0.9074808
	speed: 0.0066s/iter; left time: 6063.1312s
	iters: 2800, epoch: 5 | loss: 1.1788318
	speed: 0.0066s/iter; left time: 6049.2493s
	iters: 2900, epoch: 5 | loss: 0.9622203
	speed: 0.0066s/iter; left time: 6048.5164s
	iters: 3000, epoch: 5 | loss: 0.9092992
	speed: 0.0066s/iter; left time: 6044.8775s
	iters: 3100, epoch: 5 | loss: 0.9331377
	speed: 0.0066s/iter; left time: 6036.2524s
	iters: 3200, epoch: 5 | loss: 0.7612856
	speed: 0.0066s/iter; left time: 6039.4229s
	iters: 3300, epoch: 5 | loss: 0.9969085
	speed: 0.0066s/iter; left time: 6045.7397s
	iters: 3400, epoch: 5 | loss: 0.9485903
	speed: 0.0066s/iter; left time: 6044.2893s
	iters: 3500, epoch: 5 | loss: 0.8247598
	speed: 0.0066s/iter; left time: 6047.0213s
	iters: 3600, epoch: 5 | loss: 0.8570382
	speed: 0.0066s/iter; left time: 6045.5535s
	iters: 3700, epoch: 5 | loss: 0.8319421
	speed: 0.0066s/iter; left time: 6038.0079s
	iters: 3800, epoch: 5 | loss: 1.0261565
	speed: 0.0066s/iter; left time: 6039.7954s
	iters: 3900, epoch: 5 | loss: 0.8033117
	speed: 0.0066s/iter; left time: 6037.4348s
	iters: 4000, epoch: 5 | loss: 0.9140566
	speed: 0.0066s/iter; left time: 6040.6426s
	iters: 4100, epoch: 5 | loss: 0.6637082
	speed: 0.0066s/iter; left time: 6034.2116s
	iters: 4200, epoch: 5 | loss: 0.9596587
	speed: 0.0066s/iter; left time: 6034.3837s
	iters: 4300, epoch: 5 | loss: 1.0141985
	speed: 0.0066s/iter; left time: 6041.6425s
	iters: 4400, epoch: 5 | loss: 0.9143300
	speed: 0.0066s/iter; left time: 6056.1884s
	iters: 4500, epoch: 5 | loss: 0.8964667
	speed: 0.0066s/iter; left time: 6035.5653s
	iters: 4600, epoch: 5 | loss: 1.1393057
	speed: 0.0066s/iter; left time: 6047.4884s
Epoch: 5 cost time: 31.255913257598877
Epoch: 5, Steps: 4684 | Train Loss: 0.9505265 Vali Loss: 2.4116926 Test Loss: 1.5889009
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 6 | loss: 1.1457735
	speed: 0.9038s/iter; left time: 825430.8070s
	iters: 200, epoch: 6 | loss: 0.8683912
	speed: 0.0074s/iter; left time: 6738.9898s
	iters: 300, epoch: 6 | loss: 0.8303875
	speed: 0.0074s/iter; left time: 6763.2280s
	iters: 400, epoch: 6 | loss: 0.9663021
	speed: 0.0078s/iter; left time: 7154.4008s
	iters: 500, epoch: 6 | loss: 1.2906774
	speed: 0.0068s/iter; left time: 6234.2402s
	iters: 600, epoch: 6 | loss: 1.1627281
	speed: 0.0067s/iter; left time: 6082.5633s
	iters: 700, epoch: 6 | loss: 1.1445760
	speed: 0.0067s/iter; left time: 6120.3512s
	iters: 800, epoch: 6 | loss: 0.6994441
	speed: 0.0068s/iter; left time: 6233.4664s
	iters: 900, epoch: 6 | loss: 0.6649481
	speed: 0.0072s/iter; left time: 6556.0880s
	iters: 1000, epoch: 6 | loss: 1.0682150
	speed: 0.0069s/iter; left time: 6310.3954s
	iters: 1100, epoch: 6 | loss: 1.1538477
	speed: 0.0074s/iter; left time: 6732.3198s
	iters: 1200, epoch: 6 | loss: 0.7191343
	speed: 0.0075s/iter; left time: 6821.5537s
	iters: 1300, epoch: 6 | loss: 1.0215876
	speed: 0.0075s/iter; left time: 6872.0822s
	iters: 1400, epoch: 6 | loss: 0.8514090
	speed: 0.0071s/iter; left time: 6447.1557s
	iters: 1500, epoch: 6 | loss: 0.9303089
	speed: 0.0075s/iter; left time: 6828.3653s
	iters: 1600, epoch: 6 | loss: 0.9155986
	speed: 0.0073s/iter; left time: 6678.0205s
	iters: 1700, epoch: 6 | loss: 0.8945810
	speed: 0.0070s/iter; left time: 6401.0170s
	iters: 1800, epoch: 6 | loss: 1.1809862
	speed: 0.0075s/iter; left time: 6817.1863s
	iters: 1900, epoch: 6 | loss: 0.9281149
	speed: 0.0094s/iter; left time: 8567.5547s
	iters: 2000, epoch: 6 | loss: 1.0290927
	speed: 0.0101s/iter; left time: 9209.6806s
	iters: 2100, epoch: 6 | loss: 1.1862675
	speed: 0.0100s/iter; left time: 9088.4327s
	iters: 2200, epoch: 6 | loss: 1.0764582
	speed: 0.0098s/iter; left time: 8903.6005s
	iters: 2300, epoch: 6 | loss: 0.9354423
	speed: 0.0096s/iter; left time: 8772.8200s
	iters: 2400, epoch: 6 | loss: 1.2522644
	speed: 0.0097s/iter; left time: 8855.7355s
	iters: 2500, epoch: 6 | loss: 0.9668249
	speed: 0.0084s/iter; left time: 7637.3335s
	iters: 2600, epoch: 6 | loss: 0.6815331
	speed: 0.0091s/iter; left time: 8260.8993s
	iters: 2700, epoch: 6 | loss: 0.6442301
	speed: 0.0107s/iter; left time: 9781.1515s
	iters: 2800, epoch: 6 | loss: 0.8508999
	speed: 0.0106s/iter; left time: 9612.7610s
	iters: 2900, epoch: 6 | loss: 1.1374344
	speed: 0.0104s/iter; left time: 9435.5420s
	iters: 3000, epoch: 6 | loss: 0.9622008
	speed: 0.0085s/iter; left time: 7699.5091s
	iters: 3100, epoch: 6 | loss: 0.9048385
	speed: 0.0097s/iter; left time: 8824.2460s
	iters: 3200, epoch: 6 | loss: 1.2887903
	speed: 0.0083s/iter; left time: 7578.4697s
	iters: 3300, epoch: 6 | loss: 1.1666373
	speed: 0.0110s/iter; left time: 10036.3354s
	iters: 3400, epoch: 6 | loss: 0.9765064
	speed: 0.0109s/iter; left time: 9918.5882s
	iters: 3500, epoch: 6 | loss: 1.2179335
	speed: 0.0106s/iter; left time: 9637.0413s
	iters: 3600, epoch: 6 | loss: 0.8969623
	speed: 0.0107s/iter; left time: 9758.2601s
	iters: 3700, epoch: 6 | loss: 0.7580699
	speed: 0.0105s/iter; left time: 9576.8000s
	iters: 3800, epoch: 6 | loss: 0.9013097
	speed: 0.0112s/iter; left time: 10227.6466s
	iters: 3900, epoch: 6 | loss: 0.8932846
	speed: 0.0105s/iter; left time: 9559.8607s
	iters: 4000, epoch: 6 | loss: 0.8878333
	speed: 0.0107s/iter; left time: 9723.8218s
	iters: 4100, epoch: 6 | loss: 1.2918488
	speed: 0.0110s/iter; left time: 10000.0848s
	iters: 4200, epoch: 6 | loss: 0.8061742
	speed: 0.0107s/iter; left time: 9683.1033s
	iters: 4300, epoch: 6 | loss: 0.8127188
	speed: 0.0075s/iter; left time: 6829.3109s
	iters: 4400, epoch: 6 | loss: 0.9605139
	speed: 0.0070s/iter; left time: 6390.9064s
	iters: 4500, epoch: 6 | loss: 0.8311896
	speed: 0.0069s/iter; left time: 6258.4533s
	iters: 4600, epoch: 6 | loss: 1.2056863
	speed: 0.0067s/iter; left time: 6097.3117s
Epoch: 6 cost time: 40.759846687316895
Epoch: 6, Steps: 4684 | Train Loss: 0.9506188 Vali Loss: 2.4095919 Test Loss: 1.5860450
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems03_hour_96_3_DLinear_custom_ftM_sl96_ll48_pl3_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 353274
test shape: (35327, 1, 3, 151) (35327, 1, 3, 151)
test shape: (35327, 3, 151) (35327, 3, 151)
mse:1.5489070415496826, mae:0.9105470776557922
>>>>>>>Overall time: 1011 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
