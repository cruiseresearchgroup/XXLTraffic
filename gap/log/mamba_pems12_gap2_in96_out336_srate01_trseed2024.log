Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=867, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems12_all_filter10.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=867, expand=2, factor=1, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems12_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=336, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems12_all_96_336_Mamba_custom_ftM_sl336_ll48_pl336_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1190186
val 256458
test 256457
	iters: 100, epoch: 1 | loss: 0.7150013
	speed: 0.1481s/iter; left time: 5494.2404s
	iters: 200, epoch: 1 | loss: 0.6135563
	speed: 0.1256s/iter; left time: 4645.2213s
	iters: 300, epoch: 1 | loss: 0.6560014
	speed: 0.1260s/iter; left time: 4647.5678s
	iters: 400, epoch: 1 | loss: 0.6459759
	speed: 0.1261s/iter; left time: 4638.8720s
	iters: 500, epoch: 1 | loss: 0.5631197
	speed: 0.1236s/iter; left time: 4536.6420s
	iters: 600, epoch: 1 | loss: 0.6029012
	speed: 0.1233s/iter; left time: 4511.1381s
	iters: 700, epoch: 1 | loss: 0.5440481
	speed: 0.1234s/iter; left time: 4501.6127s
	iters: 800, epoch: 1 | loss: 0.5527255
	speed: 0.1232s/iter; left time: 4483.5588s
	iters: 900, epoch: 1 | loss: 0.5468493
	speed: 0.1233s/iter; left time: 4473.6860s
	iters: 1000, epoch: 1 | loss: 0.4545642
	speed: 0.1234s/iter; left time: 4467.1794s
	iters: 1100, epoch: 1 | loss: 0.5108771
	speed: 0.1235s/iter; left time: 4457.0779s
	iters: 1200, epoch: 1 | loss: 0.4239614
	speed: 0.1235s/iter; left time: 4444.3769s
	iters: 1300, epoch: 1 | loss: 0.4706026
	speed: 0.1237s/iter; left time: 4441.3944s
	iters: 1400, epoch: 1 | loss: 0.4698981
	speed: 0.1237s/iter; left time: 4427.1004s
	iters: 1500, epoch: 1 | loss: 0.4918015
	speed: 0.1232s/iter; left time: 4396.4513s
	iters: 1600, epoch: 1 | loss: 0.4092824
	speed: 0.1241s/iter; left time: 4416.5483s
	iters: 1700, epoch: 1 | loss: 0.4760684
	speed: 0.1235s/iter; left time: 4382.4341s
	iters: 1800, epoch: 1 | loss: 0.4790195
	speed: 0.1245s/iter; left time: 4406.9269s
	iters: 1900, epoch: 1 | loss: 0.3970504
	speed: 0.1242s/iter; left time: 4383.3059s
	iters: 2000, epoch: 1 | loss: 0.4767583
	speed: 0.1238s/iter; left time: 4355.1504s
	iters: 2100, epoch: 1 | loss: 0.5120156
	speed: 0.1243s/iter; left time: 4363.4690s
	iters: 2200, epoch: 1 | loss: 0.3867522
	speed: 0.1241s/iter; left time: 4341.1610s
	iters: 2300, epoch: 1 | loss: 0.4307612
	speed: 0.1244s/iter; left time: 4339.6472s
	iters: 2400, epoch: 1 | loss: 0.3942854
	speed: 0.1242s/iter; left time: 4319.4562s
	iters: 2500, epoch: 1 | loss: 0.4298371
	speed: 0.1245s/iter; left time: 4320.4223s
	iters: 2600, epoch: 1 | loss: 0.4573113
	speed: 0.1236s/iter; left time: 4273.7226s
	iters: 2700, epoch: 1 | loss: 0.4494081
	speed: 0.1240s/iter; left time: 4276.8749s
	iters: 2800, epoch: 1 | loss: 0.3783495
	speed: 0.1240s/iter; left time: 4265.9608s
	iters: 2900, epoch: 1 | loss: 0.3988019
	speed: 0.1240s/iter; left time: 4252.9560s
	iters: 3000, epoch: 1 | loss: 0.3433970
	speed: 0.1237s/iter; left time: 4228.6216s
	iters: 3100, epoch: 1 | loss: 0.3662146
	speed: 0.1236s/iter; left time: 4213.9362s
	iters: 3200, epoch: 1 | loss: 0.4240606
	speed: 0.1237s/iter; left time: 4204.9996s
	iters: 3300, epoch: 1 | loss: 0.3371577
	speed: 0.1240s/iter; left time: 4201.6517s
	iters: 3400, epoch: 1 | loss: 0.3688925
	speed: 0.1243s/iter; left time: 4199.7586s
	iters: 3500, epoch: 1 | loss: 0.3594355
	speed: 0.1241s/iter; left time: 4180.3685s
	iters: 3600, epoch: 1 | loss: 0.4009759
	speed: 0.1240s/iter; left time: 4165.9512s
	iters: 3700, epoch: 1 | loss: 0.3698704
	speed: 0.1246s/iter; left time: 4174.1997s
Epoch: 1 cost time: 463.8827340602875
Epoch: 1, Steps: 3719 | Train Loss: 0.4720716 Vali Loss: 2.0996540 Test Loss: 0.8139371
Validation loss decreased (inf --> 2.099654).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4578761
	speed: 3.4733s/iter; left time: 115909.3970s
	iters: 200, epoch: 2 | loss: 0.3539666
	speed: 0.1245s/iter; left time: 4143.8247s
	iters: 300, epoch: 2 | loss: 0.3704948
	speed: 0.1245s/iter; left time: 4129.7373s
	iters: 400, epoch: 2 | loss: 0.3647129
	speed: 0.1246s/iter; left time: 4120.7210s
	iters: 500, epoch: 2 | loss: 0.3475230
	speed: 0.1245s/iter; left time: 4106.0688s
	iters: 600, epoch: 2 | loss: 0.3598239
	speed: 0.1246s/iter; left time: 4094.5534s
	iters: 700, epoch: 2 | loss: 0.3361597
	speed: 0.1247s/iter; left time: 4085.1999s
	iters: 800, epoch: 2 | loss: 0.3691116
	speed: 0.1248s/iter; left time: 4079.0173s
	iters: 900, epoch: 2 | loss: 0.3456938
	speed: 0.1250s/iter; left time: 4070.6112s
	iters: 1000, epoch: 2 | loss: 0.3425933
	speed: 0.1251s/iter; left time: 4062.0620s
	iters: 1100, epoch: 2 | loss: 0.3108914
	speed: 0.1247s/iter; left time: 4037.6404s
	iters: 1200, epoch: 2 | loss: 0.3455459
	speed: 0.1248s/iter; left time: 4028.4431s
	iters: 1300, epoch: 2 | loss: 0.3539797
	speed: 0.1249s/iter; left time: 4019.2217s
	iters: 1400, epoch: 2 | loss: 0.3713610
	speed: 0.1248s/iter; left time: 4003.3348s
	iters: 1500, epoch: 2 | loss: 0.3221005
	speed: 0.1249s/iter; left time: 3993.0056s
	iters: 1600, epoch: 2 | loss: 0.3320592
	speed: 0.1252s/iter; left time: 3991.9658s
	iters: 1700, epoch: 2 | loss: 0.3507366
	speed: 0.1253s/iter; left time: 3980.2758s
	iters: 1800, epoch: 2 | loss: 0.3300748
	speed: 0.1254s/iter; left time: 3970.3731s
	iters: 1900, epoch: 2 | loss: 0.3330426
	speed: 0.1252s/iter; left time: 3952.5112s
	iters: 2000, epoch: 2 | loss: 0.3271199
	speed: 0.1251s/iter; left time: 3936.5953s
	iters: 2100, epoch: 2 | loss: 0.3464582
	speed: 0.1251s/iter; left time: 3925.0164s
	iters: 2200, epoch: 2 | loss: 0.3421770
	speed: 0.1251s/iter; left time: 3911.7276s
	iters: 2300, epoch: 2 | loss: 0.3006356
	speed: 0.1253s/iter; left time: 3904.4273s
	iters: 2400, epoch: 2 | loss: 0.2858678
	speed: 0.1254s/iter; left time: 3896.2644s
	iters: 2500, epoch: 2 | loss: 0.3417777
	speed: 0.1254s/iter; left time: 3884.8750s
	iters: 2600, epoch: 2 | loss: 0.3328395
	speed: 0.1255s/iter; left time: 3875.5600s
	iters: 2700, epoch: 2 | loss: 0.3659173
	speed: 0.1253s/iter; left time: 3855.9244s
	iters: 2800, epoch: 2 | loss: 0.3300584
	speed: 0.1252s/iter; left time: 3841.0244s
	iters: 2900, epoch: 2 | loss: 0.3001864
	speed: 0.1253s/iter; left time: 3831.5140s
	iters: 3000, epoch: 2 | loss: 0.3154670
	speed: 0.1254s/iter; left time: 3820.2663s
	iters: 3100, epoch: 2 | loss: 0.3023304
	speed: 0.1253s/iter; left time: 3806.6358s
	iters: 3200, epoch: 2 | loss: 0.2846543
	speed: 0.1256s/iter; left time: 3801.0428s
	iters: 3300, epoch: 2 | loss: 0.3202099
	speed: 0.1256s/iter; left time: 3790.5934s
	iters: 3400, epoch: 2 | loss: 0.3042511
	speed: 0.1255s/iter; left time: 3775.0256s
	iters: 3500, epoch: 2 | loss: 0.3206785
	speed: 0.1255s/iter; left time: 3760.0928s
	iters: 3600, epoch: 2 | loss: 0.3573487
	speed: 0.1254s/iter; left time: 3745.3577s
	iters: 3700, epoch: 2 | loss: 0.3391938
	speed: 0.1255s/iter; left time: 3735.5564s
Epoch: 2 cost time: 466.3848717212677
Epoch: 2, Steps: 3719 | Train Loss: 0.3428968 Vali Loss: 2.1809659 Test Loss: 0.9201171
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2905478
	speed: 3.5515s/iter; left time: 105312.0744s
	iters: 200, epoch: 3 | loss: 0.3068377
	speed: 0.1288s/iter; left time: 3807.8132s
	iters: 300, epoch: 3 | loss: 0.3677880
	speed: 0.1288s/iter; left time: 3794.5507s
	iters: 400, epoch: 3 | loss: 0.3311818
	speed: 0.1290s/iter; left time: 3785.2128s
	iters: 500, epoch: 3 | loss: 0.2732205
	speed: 0.1289s/iter; left time: 3769.9567s
	iters: 600, epoch: 3 | loss: 0.2712069
	speed: 0.1290s/iter; left time: 3760.2591s
	iters: 700, epoch: 3 | loss: 0.3079526
	speed: 0.1290s/iter; left time: 3747.5871s
	iters: 800, epoch: 3 | loss: 0.2838245
	speed: 0.1290s/iter; left time: 3734.4780s
	iters: 900, epoch: 3 | loss: 0.2983562
	speed: 0.1287s/iter; left time: 3714.7338s
	iters: 1000, epoch: 3 | loss: 0.3229476
	speed: 0.1288s/iter; left time: 3704.5407s
	iters: 1100, epoch: 3 | loss: 0.3136590
	speed: 0.1290s/iter; left time: 3695.4135s
	iters: 1200, epoch: 3 | loss: 0.3544515
	speed: 0.1290s/iter; left time: 3684.0342s
	iters: 1300, epoch: 3 | loss: 0.3080517
	speed: 0.1291s/iter; left time: 3673.7254s
	iters: 1400, epoch: 3 | loss: 0.3024833
	speed: 0.1289s/iter; left time: 3654.8471s
	iters: 1500, epoch: 3 | loss: 0.3354093
	speed: 0.1286s/iter; left time: 3632.8427s
	iters: 1600, epoch: 3 | loss: 0.3921650
	speed: 0.1286s/iter; left time: 3620.2776s
	iters: 1700, epoch: 3 | loss: 0.3758250
	speed: 0.1292s/iter; left time: 3625.2013s
	iters: 1800, epoch: 3 | loss: 0.2685770
	speed: 0.1287s/iter; left time: 3596.8390s
	iters: 1900, epoch: 3 | loss: 0.3004227
	speed: 0.1288s/iter; left time: 3587.5578s
	iters: 2000, epoch: 3 | loss: 0.3357333
	speed: 0.1289s/iter; left time: 3577.9600s
	iters: 2100, epoch: 3 | loss: 0.3266088
	speed: 0.1288s/iter; left time: 3561.7454s
	iters: 2200, epoch: 3 | loss: 0.3308364
	speed: 0.1286s/iter; left time: 3542.9229s
	iters: 2300, epoch: 3 | loss: 0.2916722
	speed: 0.1285s/iter; left time: 3528.4113s
	iters: 2400, epoch: 3 | loss: 0.3286699
	speed: 0.1285s/iter; left time: 3515.5146s
	iters: 2500, epoch: 3 | loss: 0.3578406
	speed: 0.1286s/iter; left time: 3503.6446s
	iters: 2600, epoch: 3 | loss: 0.3230459
	speed: 0.1286s/iter; left time: 3492.0348s
	iters: 2700, epoch: 3 | loss: 0.2931780
	speed: 0.1287s/iter; left time: 3481.0834s
	iters: 2800, epoch: 3 | loss: 0.2963238
	speed: 0.1290s/iter; left time: 3476.6545s
	iters: 2900, epoch: 3 | loss: 0.3085521
	speed: 0.1285s/iter; left time: 3451.9032s
	iters: 3000, epoch: 3 | loss: 0.3317951
	speed: 0.1284s/iter; left time: 3436.3543s
	iters: 3100, epoch: 3 | loss: 0.2870228
	speed: 0.1285s/iter; left time: 3424.7583s
	iters: 3200, epoch: 3 | loss: 0.3039308
	speed: 0.1285s/iter; left time: 3411.2381s
	iters: 3300, epoch: 3 | loss: 0.3432257
	speed: 0.1287s/iter; left time: 3404.6468s
	iters: 3400, epoch: 3 | loss: 0.3383815
	speed: 0.1285s/iter; left time: 3386.3599s
	iters: 3500, epoch: 3 | loss: 0.2739865
	speed: 0.1288s/iter; left time: 3380.1444s
	iters: 3600, epoch: 3 | loss: 0.2682778
	speed: 0.1291s/iter; left time: 3375.1268s
	iters: 3700, epoch: 3 | loss: 0.2605654
	speed: 0.1285s/iter; left time: 3348.4527s
Epoch: 3 cost time: 480.1327819824219
Epoch: 3, Steps: 3719 | Train Loss: 0.3063375 Vali Loss: 2.1630447 Test Loss: 0.8912827
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3170797
	speed: 3.5547s/iter; left time: 92188.8689s
	iters: 200, epoch: 4 | loss: 0.3037196
	speed: 0.1295s/iter; left time: 3344.8544s
	iters: 300, epoch: 4 | loss: 0.3064869
	speed: 0.1294s/iter; left time: 3330.2529s
	iters: 400, epoch: 4 | loss: 0.3163238
	speed: 0.1293s/iter; left time: 3314.3984s
	iters: 500, epoch: 4 | loss: 0.3052124
	speed: 0.1293s/iter; left time: 3302.1026s
	iters: 600, epoch: 4 | loss: 0.3053224
	speed: 0.1293s/iter; left time: 3289.6541s
	iters: 700, epoch: 4 | loss: 0.2892130
	speed: 0.1293s/iter; left time: 3274.7784s
	iters: 800, epoch: 4 | loss: 0.2772665
	speed: 0.1293s/iter; left time: 3263.0081s
	iters: 900, epoch: 4 | loss: 0.3093350
	speed: 0.1293s/iter; left time: 3249.0098s
	iters: 1000, epoch: 4 | loss: 0.2695483
	speed: 0.1293s/iter; left time: 3236.4668s
	iters: 1100, epoch: 4 | loss: 0.2922882
	speed: 0.1293s/iter; left time: 3223.0554s
	iters: 1200, epoch: 4 | loss: 0.2875832
	speed: 0.1292s/iter; left time: 3209.5238s
	iters: 1300, epoch: 4 | loss: 0.2815391
	speed: 0.1297s/iter; left time: 3208.8347s
	iters: 1400, epoch: 4 | loss: 0.3018789
	speed: 0.1294s/iter; left time: 3187.5913s
	iters: 1500, epoch: 4 | loss: 0.3271681
	speed: 0.1294s/iter; left time: 3175.7312s
	iters: 1600, epoch: 4 | loss: 0.2908128
	speed: 0.1293s/iter; left time: 3160.3378s
	iters: 1700, epoch: 4 | loss: 0.2783394
	speed: 0.1293s/iter; left time: 3147.4600s
	iters: 1800, epoch: 4 | loss: 0.2716361
	speed: 0.1294s/iter; left time: 3135.5871s
	iters: 1900, epoch: 4 | loss: 0.2762975
	speed: 0.1294s/iter; left time: 3123.8668s
	iters: 2000, epoch: 4 | loss: 0.3127747
	speed: 0.1295s/iter; left time: 3113.2823s
	iters: 2100, epoch: 4 | loss: 0.3035134
	speed: 0.1298s/iter; left time: 3106.6337s
	iters: 2200, epoch: 4 | loss: 0.2761354
	speed: 0.1294s/iter; left time: 3083.0697s
	iters: 2300, epoch: 4 | loss: 0.3039183
	speed: 0.1294s/iter; left time: 3070.3879s
	iters: 2400, epoch: 4 | loss: 0.2617342
	speed: 0.1294s/iter; left time: 3057.1460s
	iters: 2500, epoch: 4 | loss: 0.3256058
	speed: 0.1293s/iter; left time: 3043.1529s
	iters: 2600, epoch: 4 | loss: 0.2683165
	speed: 0.1293s/iter; left time: 3029.4787s
	iters: 2700, epoch: 4 | loss: 0.2848398
	speed: 0.1293s/iter; left time: 3016.2471s
	iters: 2800, epoch: 4 | loss: 0.3076784
	speed: 0.1300s/iter; left time: 3021.4145s
	iters: 2900, epoch: 4 | loss: 0.2683660
	speed: 0.1296s/iter; left time: 2999.1494s
	iters: 3000, epoch: 4 | loss: 0.2783632
	speed: 0.1293s/iter; left time: 2978.6760s
	iters: 3100, epoch: 4 | loss: 0.2998705
	speed: 0.1294s/iter; left time: 2968.0290s
	iters: 3200, epoch: 4 | loss: 0.2872561
	speed: 0.1294s/iter; left time: 2953.7771s
	iters: 3300, epoch: 4 | loss: 0.2719847
	speed: 0.1293s/iter; left time: 2940.4609s
	iters: 3400, epoch: 4 | loss: 0.2830154
	speed: 0.1294s/iter; left time: 2927.9367s
	iters: 3500, epoch: 4 | loss: 0.2768514
	speed: 0.1294s/iter; left time: 2916.6196s
	iters: 3600, epoch: 4 | loss: 0.2755904
	speed: 0.1301s/iter; left time: 2918.9408s
	iters: 3700, epoch: 4 | loss: 0.2735621
	speed: 0.1293s/iter; left time: 2888.5752s
Epoch: 4 cost time: 482.54319763183594
Epoch: 4, Steps: 3719 | Train Loss: 0.2919508 Vali Loss: 2.1451008 Test Loss: 0.8536127
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems12_all_96_336_Mamba_custom_ftM_sl336_ll48_pl336_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 256457
test shape: (25645, 1, 336, 867) (25645, 1, 336, 867)
test shape: (25645, 336, 867) (25645, 336, 867)
mse:0.8139248490333557, mae:0.627688467502594
>>>>>>>Overall time: 4288 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
