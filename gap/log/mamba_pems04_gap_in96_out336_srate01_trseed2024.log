Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=822, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems04_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=822, expand=2, factor=1, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems04_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=336, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems04_all_96_336_Mamba_custom_ftM_sl336_ll48_pl336_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1268864
val 352765
test 352763
	iters: 100, epoch: 1 | loss: 0.6999137
	speed: 0.1882s/iter; left time: 7442.8343s
	iters: 200, epoch: 1 | loss: 0.5706610
	speed: 0.1614s/iter; left time: 6368.6010s
	iters: 300, epoch: 1 | loss: 0.6520798
	speed: 0.1618s/iter; left time: 6368.3126s
	iters: 400, epoch: 1 | loss: 0.6082913
	speed: 0.1621s/iter; left time: 6363.8132s
	iters: 500, epoch: 1 | loss: 0.5145293
	speed: 0.1621s/iter; left time: 6345.1021s
	iters: 600, epoch: 1 | loss: 0.5620459
	speed: 0.1622s/iter; left time: 6334.6237s
	iters: 700, epoch: 1 | loss: 0.4337747
	speed: 0.1624s/iter; left time: 6326.5298s
	iters: 800, epoch: 1 | loss: 0.5329340
	speed: 0.1625s/iter; left time: 6314.2986s
	iters: 900, epoch: 1 | loss: 0.6133645
	speed: 0.1694s/iter; left time: 6566.2615s
	iters: 1000, epoch: 1 | loss: 0.4803759
	speed: 0.1644s/iter; left time: 6354.5485s
	iters: 1100, epoch: 1 | loss: 0.4051511
	speed: 0.1620s/iter; left time: 6243.8642s
	iters: 1200, epoch: 1 | loss: 0.4420178
	speed: 0.1616s/iter; left time: 6212.7751s
	iters: 1300, epoch: 1 | loss: 0.3861354
	speed: 0.1621s/iter; left time: 6216.6372s
	iters: 1400, epoch: 1 | loss: 0.4409903
	speed: 0.1627s/iter; left time: 6223.3780s
	iters: 1500, epoch: 1 | loss: 0.5157756
	speed: 0.1623s/iter; left time: 6192.1297s
	iters: 1600, epoch: 1 | loss: 0.4909416
	speed: 0.1583s/iter; left time: 6025.0409s
	iters: 1700, epoch: 1 | loss: 0.4664310
	speed: 0.1611s/iter; left time: 6113.4870s
	iters: 1800, epoch: 1 | loss: 0.5017445
	speed: 0.1618s/iter; left time: 6123.0479s
	iters: 1900, epoch: 1 | loss: 0.5178778
	speed: 0.1591s/iter; left time: 6005.6605s
	iters: 2000, epoch: 1 | loss: 0.4528764
	speed: 0.1591s/iter; left time: 5991.5949s
	iters: 2100, epoch: 1 | loss: 0.4407665
	speed: 0.1580s/iter; left time: 5932.3277s
	iters: 2200, epoch: 1 | loss: 0.5332512
	speed: 0.1593s/iter; left time: 5967.4473s
	iters: 2300, epoch: 1 | loss: 0.4769702
	speed: 0.1685s/iter; left time: 6294.4792s
	iters: 2400, epoch: 1 | loss: 0.4476221
	speed: 0.1673s/iter; left time: 6231.6027s
	iters: 2500, epoch: 1 | loss: 0.4485857
	speed: 0.1626s/iter; left time: 6040.6251s
	iters: 2600, epoch: 1 | loss: 0.5861502
	speed: 0.1475s/iter; left time: 5466.2348s
	iters: 2700, epoch: 1 | loss: 0.4743761
	speed: 0.1542s/iter; left time: 5698.7031s
	iters: 2800, epoch: 1 | loss: 0.3634759
	speed: 0.1585s/iter; left time: 5842.7058s
	iters: 2900, epoch: 1 | loss: 0.4076724
	speed: 0.1569s/iter; left time: 5765.8413s
	iters: 3000, epoch: 1 | loss: 0.3569471
	speed: 0.1658s/iter; left time: 6078.5573s
	iters: 3100, epoch: 1 | loss: 0.4542893
	speed: 0.1702s/iter; left time: 6219.2044s
	iters: 3200, epoch: 1 | loss: 0.4033428
	speed: 0.1600s/iter; left time: 5831.6276s
	iters: 3300, epoch: 1 | loss: 0.3889967
	speed: 0.1525s/iter; left time: 5544.9150s
	iters: 3400, epoch: 1 | loss: 0.4585021
	speed: 0.1541s/iter; left time: 5588.0905s
	iters: 3500, epoch: 1 | loss: 0.4287645
	speed: 0.1522s/iter; left time: 5501.1450s
	iters: 3600, epoch: 1 | loss: 0.5614532
	speed: 0.1484s/iter; left time: 5348.2121s
	iters: 3700, epoch: 1 | loss: 0.3691865
	speed: 0.1602s/iter; left time: 5760.4952s
	iters: 3800, epoch: 1 | loss: 0.3705716
	speed: 0.1580s/iter; left time: 5662.9537s
	iters: 3900, epoch: 1 | loss: 0.3915679
	speed: 0.1538s/iter; left time: 5497.9366s
Epoch: 1 cost time: 638.0447685718536
Epoch: 1, Steps: 3965 | Train Loss: 0.4791964 Vali Loss: 0.9865235 Test Loss: 1.4088916
Validation loss decreased (inf --> 0.986524).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3466396
	speed: 5.1029s/iter; left time: 181592.5009s
	iters: 200, epoch: 2 | loss: 0.3254588
	speed: 0.1728s/iter; left time: 6133.0168s
	iters: 300, epoch: 2 | loss: 0.4275640
	speed: 0.1644s/iter; left time: 5816.5294s
	iters: 400, epoch: 2 | loss: 0.3107055
	speed: 0.1592s/iter; left time: 5617.9950s
	iters: 500, epoch: 2 | loss: 0.3475246
	speed: 0.1527s/iter; left time: 5373.6716s
	iters: 600, epoch: 2 | loss: 0.3655268
	speed: 0.1558s/iter; left time: 5467.6843s
	iters: 700, epoch: 2 | loss: 0.4644931
	speed: 0.1561s/iter; left time: 5459.9431s
	iters: 800, epoch: 2 | loss: 0.4273985
	speed: 0.1531s/iter; left time: 5340.7210s
	iters: 900, epoch: 2 | loss: 0.5066608
	speed: 0.1515s/iter; left time: 5269.9720s
	iters: 1000, epoch: 2 | loss: 0.5082896
	speed: 0.1494s/iter; left time: 5180.8748s
	iters: 1100, epoch: 2 | loss: 0.4105606
	speed: 0.1486s/iter; left time: 5137.7591s
	iters: 1200, epoch: 2 | loss: 0.3849815
	speed: 0.1593s/iter; left time: 5492.6325s
	iters: 1300, epoch: 2 | loss: 0.3915220
	speed: 0.1502s/iter; left time: 5164.4443s
	iters: 1400, epoch: 2 | loss: 0.3325135
	speed: 0.1515s/iter; left time: 5193.8986s
	iters: 1500, epoch: 2 | loss: 0.3420722
	speed: 0.1490s/iter; left time: 5095.0205s
	iters: 1600, epoch: 2 | loss: 0.3578756
	speed: 0.1485s/iter; left time: 5061.7934s
	iters: 1700, epoch: 2 | loss: 0.3371141
	speed: 0.1499s/iter; left time: 5094.0429s
	iters: 1800, epoch: 2 | loss: 0.3630808
	speed: 0.1544s/iter; left time: 5230.6444s
	iters: 1900, epoch: 2 | loss: 0.4030092
	speed: 0.1565s/iter; left time: 5286.0174s
	iters: 2000, epoch: 2 | loss: 0.3863392
	speed: 0.1561s/iter; left time: 5257.0898s
	iters: 2100, epoch: 2 | loss: 0.3265179
	speed: 0.1623s/iter; left time: 5450.9193s
	iters: 2200, epoch: 2 | loss: 0.4653739
	speed: 0.1591s/iter; left time: 5327.9207s
	iters: 2300, epoch: 2 | loss: 0.3425074
	speed: 0.1583s/iter; left time: 5284.1743s
	iters: 2400, epoch: 2 | loss: 0.4513440
	speed: 0.1572s/iter; left time: 5233.6849s
	iters: 2500, epoch: 2 | loss: 0.4027844
	speed: 0.1590s/iter; left time: 5277.4357s
	iters: 2600, epoch: 2 | loss: 0.4276617
	speed: 0.1579s/iter; left time: 5225.0131s
	iters: 2700, epoch: 2 | loss: 0.3302650
	speed: 0.1610s/iter; left time: 5309.8519s
	iters: 2800, epoch: 2 | loss: 0.3744725
	speed: 0.1603s/iter; left time: 5272.2526s
	iters: 2900, epoch: 2 | loss: 0.3008085
	speed: 0.1619s/iter; left time: 5309.6404s
	iters: 3000, epoch: 2 | loss: 0.3901902
	speed: 0.1594s/iter; left time: 5209.2910s
	iters: 3100, epoch: 2 | loss: 0.3677059
	speed: 0.1586s/iter; left time: 5167.5189s
	iters: 3200, epoch: 2 | loss: 0.3478830
	speed: 0.1619s/iter; left time: 5258.6702s
	iters: 3300, epoch: 2 | loss: 0.4242097
	speed: 0.1655s/iter; left time: 5360.1159s
	iters: 3400, epoch: 2 | loss: 0.2808000
	speed: 0.1605s/iter; left time: 5180.3158s
	iters: 3500, epoch: 2 | loss: 0.2801701
	speed: 0.1602s/iter; left time: 5156.7980s
	iters: 3600, epoch: 2 | loss: 0.3619330
	speed: 0.1617s/iter; left time: 5189.0483s
	iters: 3700, epoch: 2 | loss: 0.2973612
	speed: 0.1597s/iter; left time: 5106.6629s
	iters: 3800, epoch: 2 | loss: 0.3083033
	speed: 0.1597s/iter; left time: 5092.3636s
	iters: 3900, epoch: 2 | loss: 0.3074667
	speed: 0.1577s/iter; left time: 5013.5151s
Epoch: 2 cost time: 626.7689814567566
Epoch: 2, Steps: 3965 | Train Loss: 0.3747515 Vali Loss: 0.9662749 Test Loss: 1.4235177
Validation loss decreased (0.986524 --> 0.966275).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3571034
	speed: 5.2469s/iter; left time: 165911.7148s
	iters: 200, epoch: 3 | loss: 0.3434132
	speed: 0.1672s/iter; left time: 5271.2613s
	iters: 300, epoch: 3 | loss: 0.3228737
	speed: 0.1670s/iter; left time: 5246.8631s
	iters: 400, epoch: 3 | loss: 0.2587392
	speed: 0.1614s/iter; left time: 5056.4695s
	iters: 500, epoch: 3 | loss: 0.3925888
	speed: 0.1596s/iter; left time: 4984.0502s
	iters: 600, epoch: 3 | loss: 0.3787195
	speed: 0.1544s/iter; left time: 4806.5134s
	iters: 700, epoch: 3 | loss: 0.3108052
	speed: 0.1534s/iter; left time: 4758.3383s
	iters: 800, epoch: 3 | loss: 0.4082300
	speed: 0.1554s/iter; left time: 4804.0981s
	iters: 900, epoch: 3 | loss: 0.3398180
	speed: 0.1555s/iter; left time: 4792.8405s
	iters: 1000, epoch: 3 | loss: 0.4082258
	speed: 0.1571s/iter; left time: 4825.2114s
	iters: 1100, epoch: 3 | loss: 0.3272172
	speed: 0.1558s/iter; left time: 4771.5502s
	iters: 1200, epoch: 3 | loss: 0.3178242
	speed: 0.1606s/iter; left time: 4901.8835s
	iters: 1300, epoch: 3 | loss: 0.2941755
	speed: 0.1716s/iter; left time: 5220.9444s
	iters: 1400, epoch: 3 | loss: 0.3186609
	speed: 0.1617s/iter; left time: 4903.3942s
	iters: 1500, epoch: 3 | loss: 0.4818374
	speed: 0.1574s/iter; left time: 4756.6357s
	iters: 1600, epoch: 3 | loss: 0.3290669
	speed: 0.1686s/iter; left time: 5077.2893s
	iters: 1700, epoch: 3 | loss: 0.2738258
	speed: 0.1715s/iter; left time: 5149.2258s
	iters: 1800, epoch: 3 | loss: 0.3514473
	speed: 0.1587s/iter; left time: 4748.1299s
	iters: 1900, epoch: 3 | loss: 0.3180898
	speed: 0.1617s/iter; left time: 4821.8926s
	iters: 2000, epoch: 3 | loss: 0.3001902
	speed: 0.1756s/iter; left time: 5217.6640s
	iters: 2100, epoch: 3 | loss: 0.3141275
	speed: 0.1669s/iter; left time: 4943.4809s
	iters: 2200, epoch: 3 | loss: 0.4135480
	speed: 0.1604s/iter; left time: 4736.3986s
	iters: 2300, epoch: 3 | loss: 0.3504066
	speed: 0.1595s/iter; left time: 4692.9284s
	iters: 2400, epoch: 3 | loss: 0.3807167
	speed: 0.1591s/iter; left time: 4664.4375s
	iters: 2500, epoch: 3 | loss: 0.3806943
	speed: 0.1590s/iter; left time: 4645.2050s
	iters: 2600, epoch: 3 | loss: 0.3120737
	speed: 0.1584s/iter; left time: 4612.6660s
	iters: 2700, epoch: 3 | loss: 0.3403678
	speed: 0.1583s/iter; left time: 4594.6437s
	iters: 2800, epoch: 3 | loss: 0.4808267
	speed: 0.1553s/iter; left time: 4490.1705s
	iters: 2900, epoch: 3 | loss: 0.3534613
	speed: 0.1532s/iter; left time: 4414.9404s
	iters: 3000, epoch: 3 | loss: 0.3132818
	speed: 0.1532s/iter; left time: 4400.3832s
	iters: 3100, epoch: 3 | loss: 0.3029964
	speed: 0.1536s/iter; left time: 4395.6727s
	iters: 3200, epoch: 3 | loss: 0.2938246
	speed: 0.1546s/iter; left time: 4409.3274s
	iters: 3300, epoch: 3 | loss: 0.2385649
	speed: 0.1542s/iter; left time: 4382.5051s
	iters: 3400, epoch: 3 | loss: 0.3160641
	speed: 0.1535s/iter; left time: 4346.6503s
	iters: 3500, epoch: 3 | loss: 0.3722560
	speed: 0.1535s/iter; left time: 4331.1531s
	iters: 3600, epoch: 3 | loss: 0.2606450
	speed: 0.1539s/iter; left time: 4327.4125s
	iters: 3700, epoch: 3 | loss: 0.3319506
	speed: 0.1544s/iter; left time: 4326.4059s
	iters: 3800, epoch: 3 | loss: 0.2904021
	speed: 0.1612s/iter; left time: 4499.9147s
	iters: 3900, epoch: 3 | loss: 0.3494492
	speed: 0.1608s/iter; left time: 4472.3645s
Epoch: 3 cost time: 636.0095927715302
Epoch: 3, Steps: 3965 | Train Loss: 0.3431454 Vali Loss: 0.9603739 Test Loss: 1.4246720
Validation loss decreased (0.966275 --> 0.960374).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3330790
	speed: 5.4819s/iter; left time: 151608.0008s
	iters: 200, epoch: 4 | loss: 0.2819088
	speed: 0.1699s/iter; left time: 4681.0814s
	iters: 300, epoch: 4 | loss: 0.3361849
	speed: 0.1705s/iter; left time: 4682.4703s
	iters: 400, epoch: 4 | loss: 0.2434857
	speed: 0.1707s/iter; left time: 4670.3680s
	iters: 500, epoch: 4 | loss: 0.3193870
	speed: 0.1709s/iter; left time: 4659.2728s
	iters: 600, epoch: 4 | loss: 0.2687324
	speed: 0.1765s/iter; left time: 4792.3664s
	iters: 700, epoch: 4 | loss: 0.3568963
	speed: 0.1641s/iter; left time: 4440.1132s
	iters: 800, epoch: 4 | loss: 0.4980391
	speed: 0.1584s/iter; left time: 4269.1633s
	iters: 900, epoch: 4 | loss: 0.3806977
	speed: 0.1586s/iter; left time: 4258.2396s
	iters: 1000, epoch: 4 | loss: 0.3030181
	speed: 0.1580s/iter; left time: 4227.7465s
	iters: 1100, epoch: 4 | loss: 0.3945469
	speed: 0.1585s/iter; left time: 4225.2157s
	iters: 1200, epoch: 4 | loss: 0.3203154
	speed: 0.1585s/iter; left time: 4210.4430s
	iters: 1300, epoch: 4 | loss: 0.2758203
	speed: 0.1594s/iter; left time: 4218.0986s
	iters: 1400, epoch: 4 | loss: 0.2874075
	speed: 0.1584s/iter; left time: 4175.9306s
	iters: 1500, epoch: 4 | loss: 0.4748112
	speed: 0.1582s/iter; left time: 4154.3841s
	iters: 1600, epoch: 4 | loss: 0.4281403
	speed: 0.1582s/iter; left time: 4136.7630s
	iters: 1700, epoch: 4 | loss: 0.2858369
	speed: 0.1586s/iter; left time: 4133.0000s
	iters: 1800, epoch: 4 | loss: 0.2741649
	speed: 0.1587s/iter; left time: 4119.3698s
	iters: 1900, epoch: 4 | loss: 0.4259623
	speed: 0.1591s/iter; left time: 4113.7929s
	iters: 2000, epoch: 4 | loss: 0.4022794
	speed: 0.1584s/iter; left time: 4079.3216s
	iters: 2100, epoch: 4 | loss: 0.4157355
	speed: 0.1582s/iter; left time: 4059.1222s
	iters: 2200, epoch: 4 | loss: 0.3982793
	speed: 0.1561s/iter; left time: 3990.2593s
	iters: 2300, epoch: 4 | loss: 0.4311886
	speed: 0.1574s/iter; left time: 4006.0088s
	iters: 2400, epoch: 4 | loss: 0.2841736
	speed: 0.1573s/iter; left time: 3988.3464s
	iters: 2500, epoch: 4 | loss: 0.3331521
	speed: 0.1592s/iter; left time: 4021.4517s
	iters: 2600, epoch: 4 | loss: 0.3083232
	speed: 0.1580s/iter; left time: 3975.0946s
	iters: 2700, epoch: 4 | loss: 0.3360020
	speed: 0.1571s/iter; left time: 3937.3589s
	iters: 2800, epoch: 4 | loss: 0.3443812
	speed: 0.1599s/iter; left time: 3990.3005s
	iters: 2900, epoch: 4 | loss: 0.2896720
	speed: 0.1584s/iter; left time: 3937.1708s
	iters: 3000, epoch: 4 | loss: 0.2644481
	speed: 0.1595s/iter; left time: 3948.4194s
	iters: 3100, epoch: 4 | loss: 0.3160768
	speed: 0.1593s/iter; left time: 3927.7691s
	iters: 3200, epoch: 4 | loss: 0.3433698
	speed: 0.1586s/iter; left time: 3893.7703s
	iters: 3300, epoch: 4 | loss: 0.3115007
	speed: 0.1575s/iter; left time: 3851.3142s
	iters: 3400, epoch: 4 | loss: 0.2951417
	speed: 0.1552s/iter; left time: 3779.5870s
	iters: 3500, epoch: 4 | loss: 0.2956175
	speed: 0.1578s/iter; left time: 3827.9396s
	iters: 3600, epoch: 4 | loss: 0.2671262
	speed: 0.1593s/iter; left time: 3849.1315s
	iters: 3700, epoch: 4 | loss: 0.2830207
	speed: 0.1607s/iter; left time: 3866.9514s
	iters: 3800, epoch: 4 | loss: 0.2572289
	speed: 0.1602s/iter; left time: 3838.4735s
	iters: 3900, epoch: 4 | loss: 0.5123629
	speed: 0.1618s/iter; left time: 3860.7853s
Epoch: 4 cost time: 639.6707468032837
Epoch: 4, Steps: 3965 | Train Loss: 0.3308684 Vali Loss: 0.9692622 Test Loss: 1.4185923
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3733683
	speed: 5.6032s/iter; left time: 132745.7440s
	iters: 200, epoch: 5 | loss: 0.2586890
	speed: 0.1649s/iter; left time: 3889.6793s
	iters: 300, epoch: 5 | loss: 0.3748852
	speed: 0.1651s/iter; left time: 3878.3073s
	iters: 400, epoch: 5 | loss: 0.3612450
	speed: 0.1651s/iter; left time: 3861.6315s
	iters: 500, epoch: 5 | loss: 0.3779038
	speed: 0.1652s/iter; left time: 3847.7208s
	iters: 600, epoch: 5 | loss: 0.3340832
	speed: 0.1651s/iter; left time: 3828.7158s
	iters: 700, epoch: 5 | loss: 0.3645694
	speed: 0.1651s/iter; left time: 3813.4234s
	iters: 800, epoch: 5 | loss: 0.3269698
	speed: 0.1651s/iter; left time: 3795.8780s
	iters: 900, epoch: 5 | loss: 0.2668161
	speed: 0.1652s/iter; left time: 3781.3490s
	iters: 1000, epoch: 5 | loss: 0.3431767
	speed: 0.1651s/iter; left time: 3762.8271s
	iters: 1100, epoch: 5 | loss: 0.3048870
	speed: 0.1656s/iter; left time: 3758.3065s
	iters: 1200, epoch: 5 | loss: 0.2751248
	speed: 0.1753s/iter; left time: 3959.5078s
	iters: 1300, epoch: 5 | loss: 0.2877567
	speed: 0.1616s/iter; left time: 3635.0155s
	iters: 1400, epoch: 5 | loss: 0.4286980
	speed: 0.1583s/iter; left time: 3545.3593s
	iters: 1500, epoch: 5 | loss: 0.2457851
	speed: 0.1581s/iter; left time: 3524.4931s
	iters: 1600, epoch: 5 | loss: 0.3018572
	speed: 0.1578s/iter; left time: 3502.6399s
	iters: 1700, epoch: 5 | loss: 0.3049656
	speed: 0.1576s/iter; left time: 3482.2916s
	iters: 1800, epoch: 5 | loss: 0.2442210
	speed: 0.1574s/iter; left time: 3461.6201s
	iters: 1900, epoch: 5 | loss: 0.2787074
	speed: 0.1583s/iter; left time: 3466.3981s
	iters: 2000, epoch: 5 | loss: 0.3102345
	speed: 0.1577s/iter; left time: 3436.9687s
	iters: 2100, epoch: 5 | loss: 0.4554358
	speed: 0.1579s/iter; left time: 3424.4719s
	iters: 2200, epoch: 5 | loss: 0.3356957
	speed: 0.1580s/iter; left time: 3411.9479s
	iters: 2300, epoch: 5 | loss: 0.2833009
	speed: 0.1574s/iter; left time: 3382.6537s
	iters: 2400, epoch: 5 | loss: 0.3208409
	speed: 0.1575s/iter; left time: 3369.2503s
	iters: 2500, epoch: 5 | loss: 0.2945347
	speed: 0.1583s/iter; left time: 3371.3411s
	iters: 2600, epoch: 5 | loss: 0.3029413
	speed: 0.1583s/iter; left time: 3354.2182s
	iters: 2700, epoch: 5 | loss: 0.2918297
	speed: 0.1573s/iter; left time: 3317.9942s
	iters: 2800, epoch: 5 | loss: 0.2909381
	speed: 0.1574s/iter; left time: 3303.8795s
	iters: 2900, epoch: 5 | loss: 0.3439856
	speed: 0.1576s/iter; left time: 3292.6330s
	iters: 3000, epoch: 5 | loss: 0.2757797
	speed: 0.1577s/iter; left time: 3279.4606s
	iters: 3100, epoch: 5 | loss: 0.2312899
	speed: 0.1585s/iter; left time: 3279.4188s
	iters: 3200, epoch: 5 | loss: 0.3219250
	speed: 0.1582s/iter; left time: 3258.2431s
	iters: 3300, epoch: 5 | loss: 0.4874500
	speed: 0.1577s/iter; left time: 3231.2959s
	iters: 3400, epoch: 5 | loss: 0.3303470
	speed: 0.1574s/iter; left time: 3209.4145s
	iters: 3500, epoch: 5 | loss: 0.4895695
	speed: 0.1579s/iter; left time: 3203.2722s
	iters: 3600, epoch: 5 | loss: 0.2547754
	speed: 0.1578s/iter; left time: 3186.8515s
	iters: 3700, epoch: 5 | loss: 0.2736353
	speed: 0.1587s/iter; left time: 3188.2178s
	iters: 3800, epoch: 5 | loss: 0.3460693
	speed: 0.1585s/iter; left time: 3168.1944s
	iters: 3900, epoch: 5 | loss: 0.3480178
	speed: 0.1580s/iter; left time: 3142.5813s
Epoch: 5 cost time: 638.610821723938
Epoch: 5, Steps: 3965 | Train Loss: 0.3251432 Vali Loss: 0.9688887 Test Loss: 1.4107985
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2549571
	speed: 5.4016s/iter; left time: 106552.6444s
	iters: 200, epoch: 6 | loss: 0.2761019
	speed: 0.1384s/iter; left time: 2717.1702s
	iters: 300, epoch: 6 | loss: 0.3423543
	speed: 0.1397s/iter; left time: 2728.1043s
	iters: 400, epoch: 6 | loss: 0.4035408
	speed: 0.1404s/iter; left time: 2727.8555s
	iters: 500, epoch: 6 | loss: 0.4589637
	speed: 0.1441s/iter; left time: 2785.3186s
	iters: 600, epoch: 6 | loss: 0.3198589
	speed: 0.1459s/iter; left time: 2805.1674s
	iters: 700, epoch: 6 | loss: 0.2489326
	speed: 0.1458s/iter; left time: 2787.8591s
	iters: 800, epoch: 6 | loss: 0.3693914
	speed: 0.1446s/iter; left time: 2750.2654s
	iters: 900, epoch: 6 | loss: 0.3619896
	speed: 0.1474s/iter; left time: 2789.2196s
	iters: 1000, epoch: 6 | loss: 0.4477036
	speed: 0.1452s/iter; left time: 2734.0400s
	iters: 1100, epoch: 6 | loss: 0.3308355
	speed: 0.1460s/iter; left time: 2733.7037s
	iters: 1200, epoch: 6 | loss: 0.2742648
	speed: 0.1473s/iter; left time: 2743.3312s
	iters: 1300, epoch: 6 | loss: 0.3125748
	speed: 0.1456s/iter; left time: 2697.6082s
	iters: 1400, epoch: 6 | loss: 0.3159209
	speed: 0.1461s/iter; left time: 2692.1586s
	iters: 1500, epoch: 6 | loss: 0.3642346
	speed: 0.1483s/iter; left time: 2717.2789s
	iters: 1600, epoch: 6 | loss: 0.3448920
	speed: 0.1448s/iter; left time: 2639.8866s
	iters: 1700, epoch: 6 | loss: 0.2998360
	speed: 0.1452s/iter; left time: 2632.6461s
	iters: 1800, epoch: 6 | loss: 0.4080310
	speed: 0.1479s/iter; left time: 2665.2944s
	iters: 1900, epoch: 6 | loss: 0.2345677
	speed: 0.1459s/iter; left time: 2614.5835s
	iters: 2000, epoch: 6 | loss: 0.3454301
	speed: 0.1464s/iter; left time: 2609.3809s
	iters: 2100, epoch: 6 | loss: 0.3143259
	speed: 0.1466s/iter; left time: 2598.6164s
	iters: 2200, epoch: 6 | loss: 0.2829781
	speed: 0.1493s/iter; left time: 2631.9385s
	iters: 2300, epoch: 6 | loss: 0.3391004
	speed: 0.1476s/iter; left time: 2586.1369s
	iters: 2400, epoch: 6 | loss: 0.4533170
	speed: 0.1465s/iter; left time: 2552.0669s
	iters: 2500, epoch: 6 | loss: 0.3428156
	speed: 0.1445s/iter; left time: 2502.8368s
	iters: 2600, epoch: 6 | loss: 0.3505414
	speed: 0.1469s/iter; left time: 2529.9122s
	iters: 2700, epoch: 6 | loss: 0.2832358
	speed: 0.1446s/iter; left time: 2476.3623s
	iters: 2800, epoch: 6 | loss: 0.3160910
	speed: 0.1458s/iter; left time: 2482.5776s
	iters: 2900, epoch: 6 | loss: 0.2858840
	speed: 0.1465s/iter; left time: 2479.9231s
	iters: 3000, epoch: 6 | loss: 0.3184472
	speed: 0.1455s/iter; left time: 2447.9109s
	iters: 3100, epoch: 6 | loss: 0.3220318
	speed: 0.1453s/iter; left time: 2429.6502s
	iters: 3200, epoch: 6 | loss: 0.3557062
	speed: 0.1445s/iter; left time: 2403.2414s
	iters: 3300, epoch: 6 | loss: 0.3774568
	speed: 0.1472s/iter; left time: 2431.8841s
	iters: 3400, epoch: 6 | loss: 0.4724286
	speed: 0.1473s/iter; left time: 2419.0358s
	iters: 3500, epoch: 6 | loss: 0.2772579
	speed: 0.1476s/iter; left time: 2409.0090s
	iters: 3600, epoch: 6 | loss: 0.2649527
	speed: 0.1476s/iter; left time: 2395.3403s
	iters: 3700, epoch: 6 | loss: 0.3843473
	speed: 0.1444s/iter; left time: 2327.9015s
	iters: 3800, epoch: 6 | loss: 0.5021906
	speed: 0.1471s/iter; left time: 2357.4500s
	iters: 3900, epoch: 6 | loss: 0.2802608
	speed: 0.1462s/iter; left time: 2328.5116s
Epoch: 6 cost time: 580.0178806781769
Epoch: 6, Steps: 3965 | Train Loss: 0.3222939 Vali Loss: 0.9704248 Test Loss: 1.4191704
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems04_all_96_336_Mamba_custom_ftM_sl336_ll48_pl336_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 352763
test shape: (35276, 1, 336, 822) (35276, 1, 336, 822)
test shape: (35276, 336, 822) (35276, 336, 822)
mse:1.4243638515472412, mae:0.934587299823761
>>>>>>>Overall time: 8128 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
