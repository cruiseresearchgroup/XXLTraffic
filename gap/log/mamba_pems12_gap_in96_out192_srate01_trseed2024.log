Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=867, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems12_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=867, expand=2, factor=1, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems12_all_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=192, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems12_all_96_192_Mamba_custom_ftM_sl192_ll48_pl192_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1295594
val 361722
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=867, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems12_all_filter10.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=867, expand=2, factor=1, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems12_all_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=192, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems12_all_96_192_Mamba_custom_ftM_sl192_ll48_pl192_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1295594
val 361722
test 361721
	iters: 100, epoch: 1 | loss: 0.7871885
	speed: 0.1002s/iter; left time: 4047.5721s
	iters: 200, epoch: 1 | loss: 0.6574452
	speed: 0.0759s/iter; left time: 3058.1472s
	iters: 300, epoch: 1 | loss: 0.5374576
	speed: 0.0757s/iter; left time: 3041.2718s
	iters: 400, epoch: 1 | loss: 0.5135757
	speed: 0.0768s/iter; left time: 3078.7089s
	iters: 500, epoch: 1 | loss: 0.5554064
	speed: 0.0766s/iter; left time: 3061.6953s
	iters: 600, epoch: 1 | loss: 0.5627589
	speed: 0.0762s/iter; left time: 3037.1581s
	iters: 700, epoch: 1 | loss: 0.5549251
	speed: 0.0760s/iter; left time: 3023.8578s
	iters: 800, epoch: 1 | loss: 0.4607138
	speed: 0.0756s/iter; left time: 2999.9653s
	iters: 900, epoch: 1 | loss: 0.5167152
	speed: 0.0753s/iter; left time: 2981.5244s
	iters: 1000, epoch: 1 | loss: 0.5017744
	speed: 0.0760s/iter; left time: 3000.6296s
	iters: 1100, epoch: 1 | loss: 0.4756348
	speed: 0.0761s/iter; left time: 2996.1337s
	iters: 1200, epoch: 1 | loss: 0.5006103
	speed: 0.0782s/iter; left time: 3071.9395s
	iters: 1300, epoch: 1 | loss: 0.5023572
	speed: 0.0770s/iter; left time: 3015.6647s
	iters: 1400, epoch: 1 | loss: 0.5292872
	speed: 0.0770s/iter; left time: 3007.4571s
	iters: 1500, epoch: 1 | loss: 0.5264615
	speed: 0.0775s/iter; left time: 3020.1410s
	iters: 1600, epoch: 1 | loss: 0.4285805
	speed: 0.0786s/iter; left time: 3056.5483s
	iters: 1700, epoch: 1 | loss: 0.4838586
	speed: 0.0773s/iter; left time: 2998.6424s
	iters: 1800, epoch: 1 | loss: 0.4429568
	speed: 0.0767s/iter; left time: 2967.6795s
	iters: 1900, epoch: 1 | loss: 0.4480439
	speed: 0.0777s/iter; left time: 2996.9132s
	iters: 2000, epoch: 1 | loss: 0.3706632
	speed: 0.0771s/iter; left time: 2968.1233s
	iters: 2100, epoch: 1 | loss: 0.3355940
	speed: 0.0756s/iter; left time: 2902.8634s
	iters: 2200, epoch: 1 | loss: 0.4127041
	speed: 0.0760s/iter; left time: 2910.2552s
	iters: 2300, epoch: 1 | loss: 0.3906516
	speed: 0.0757s/iter; left time: 2889.7866s
	iters: 2400, epoch: 1 | loss: 0.3823148
	speed: 0.0763s/iter; left time: 2904.6598s
	iters: 2500, epoch: 1 | loss: 0.3811653
	speed: 0.0756s/iter; left time: 2871.6981s
	iters: 2600, epoch: 1 | loss: 0.3522825
	speed: 0.0778s/iter; left time: 2948.5530s
	iters: 2700, epoch: 1 | loss: 0.3810564
	speed: 0.0759s/iter; left time: 2869.0318s
	iters: 2800, epoch: 1 | loss: 0.3760963
	speed: 0.0755s/iter; left time: 2846.5041s
	iters: 2900, epoch: 1 | loss: 0.3578396
	speed: 0.0754s/iter; left time: 2832.2371s
	iters: 3000, epoch: 1 | loss: 0.3800766
	speed: 0.0763s/iter; left time: 2858.7407s
	iters: 3100, epoch: 1 | loss: 0.3654683
	speed: 0.0759s/iter; left time: 2835.5314s
	iters: 3200, epoch: 1 | loss: 0.3727801
	speed: 0.0759s/iter; left time: 2830.9248s
	iters: 3300, epoch: 1 | loss: 0.3857454
	speed: 0.0760s/iter; left time: 2824.7600s
	iters: 3400, epoch: 1 | loss: 0.3500992
	speed: 0.0757s/iter; left time: 2808.7853s
	iters: 3500, epoch: 1 | loss: 0.3610811
	speed: 0.0760s/iter; left time: 2811.7471s
	iters: 3600, epoch: 1 | loss: 0.3557108
	speed: 0.0768s/iter; left time: 2831.0392s
	iters: 3700, epoch: 1 | loss: 0.3743545
	speed: 0.0760s/iter; left time: 2796.1166s
	iters: 3800, epoch: 1 | loss: 0.3609139
	speed: 0.0760s/iter; left time: 2788.0059s
	iters: 3900, epoch: 1 | loss: 0.3380138
	speed: 0.0759s/iter; left time: 2775.4991s
	iters: 4000, epoch: 1 | loss: 0.3391906
	speed: 0.0757s/iter; left time: 2761.4197s
Epoch: 1 cost time: 311.6413223743439
Epoch: 1, Steps: 4048 | Train Loss: 0.4514473 Vali Loss: 1.2318095 Test Loss: 1.7262647
Validation loss decreased (inf --> 1.231809).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3560794
	speed: 3.2733s/iter; left time: 118929.2496s
	iters: 200, epoch: 2 | loss: 0.3520954
	speed: 0.0793s/iter; left time: 2875.0510s
	iters: 300, epoch: 2 | loss: 0.3382061
	speed: 0.0794s/iter; left time: 2868.6641s
	iters: 400, epoch: 2 | loss: 0.3440084
	speed: 0.0791s/iter; left time: 2848.6101s
	iters: 500, epoch: 2 | loss: 0.3347453
	speed: 0.0779s/iter; left time: 2797.8478s
	iters: 600, epoch: 2 | loss: 0.3764205
	speed: 0.0772s/iter; left time: 2765.4428s
	iters: 700, epoch: 2 | loss: 0.3440527
	speed: 0.0775s/iter; left time: 2768.0399s
	iters: 800, epoch: 2 | loss: 0.3348584
	speed: 0.0776s/iter; left time: 2763.8592s
	iters: 900, epoch: 2 | loss: 0.3180206
	speed: 0.0776s/iter; left time: 2755.7303s
	iters: 1000, epoch: 2 | loss: 0.3620570
	speed: 0.0777s/iter; left time: 2752.4652s
	iters: 1100, epoch: 2 | loss: 0.3322044
	speed: 0.0778s/iter; left time: 2750.5480s
	iters: 1200, epoch: 2 | loss: 0.3314652
	speed: 0.0781s/iter; left time: 2751.1012s
	iters: 1300, epoch: 2 | loss: 0.3198281
	speed: 0.0777s/iter; left time: 2728.1246s
	iters: 1400, epoch: 2 | loss: 0.3421019
	speed: 0.0770s/iter; left time: 2696.7018s
	iters: 1500, epoch: 2 | loss: 0.3260150
	speed: 0.0772s/iter; left time: 2698.0086s
	iters: 1600, epoch: 2 | loss: 0.3429143
	speed: 0.0773s/iter; left time: 2691.1214s
	iters: 1700, epoch: 2 | loss: 0.3156521
	speed: 0.0771s/iter; left time: 2679.3744s
	iters: 1800, epoch: 2 | loss: 0.3763863
	speed: 0.0772s/iter; left time: 2675.1197s
	iters: 1900, epoch: 2 | loss: 0.3746277
	speed: 0.0772s/iter; left time: 2666.3193s
	iters: 2000, epoch: 2 | loss: 0.3970970
	speed: 0.0774s/iter; left time: 2664.6948s
	iters: 2100, epoch: 2 | loss: 0.3498457
	speed: 0.0782s/iter; left time: 2684.4359s
	iters: 2200, epoch: 2 | loss: 0.2994656
	speed: 0.0766s/iter; left time: 2620.8349s
	iters: 2300, epoch: 2 | loss: 0.3286159
	speed: 0.0772s/iter; left time: 2634.8833s
	iters: 2400, epoch: 2 | loss: 0.3364264
	speed: 0.0772s/iter; left time: 2627.5663s
	iters: 2500, epoch: 2 | loss: 0.3106771
	speed: 0.0777s/iter; left time: 2637.3077s
	iters: 2600, epoch: 2 | loss: 0.3457786
	speed: 0.0778s/iter; left time: 2631.1347s
	iters: 2700, epoch: 2 | loss: 0.3721375
	speed: 0.0772s/iter; left time: 2605.5020s
	iters: 2800, epoch: 2 | loss: 0.3465649
	speed: 0.0772s/iter; left time: 2595.4452s
	iters: 2900, epoch: 2 | loss: 0.3424031
	speed: 0.0770s/iter; left time: 2583.4348s
	iters: 3000, epoch: 2 | loss: 0.3647691
	speed: 0.0770s/iter; left time: 2574.6910s
	iters: 3100, epoch: 2 | loss: 0.2655728
	speed: 0.0772s/iter; left time: 2572.8857s
	iters: 3200, epoch: 2 | loss: 0.2928035
	speed: 0.0773s/iter; left time: 2569.4449s
	iters: 3300, epoch: 2 | loss: 0.3464440
	speed: 0.0770s/iter; left time: 2550.6109s
	iters: 3400, epoch: 2 | loss: 0.3161789
	speed: 0.0771s/iter; left time: 2546.1396s
	iters: 3500, epoch: 2 | loss: 0.3000852
	speed: 0.0772s/iter; left time: 2542.8408s
	iters: 3600, epoch: 2 | loss: 0.2968885
	speed: 0.0770s/iter; left time: 2528.5275s
	iters: 3700, epoch: 2 | loss: 0.2975097
	speed: 0.0770s/iter; left time: 2520.8055s
	iters: 3800, epoch: 2 | loss: 0.3808424
	speed: 0.0777s/iter; left time: 2534.2497s
	iters: 3900, epoch: 2 | loss: 0.3331042
	speed: 0.0777s/iter; left time: 2526.6389s
	iters: 4000, epoch: 2 | loss: 0.2685618
	speed: 0.0773s/iter; left time: 2507.5329s
Epoch: 2 cost time: 315.3514552116394
Epoch: 2, Steps: 4048 | Train Loss: 0.3386628 Vali Loss: 1.2369840 Test Loss: 1.7636348
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3123688
	speed: 2.6626s/iter; left time: 85963.1928s
	iters: 200, epoch: 3 | loss: 0.3182532
	speed: 0.0772s/iter; left time: 2485.9644s
	iters: 300, epoch: 3 | loss: 0.3049301
	speed: 0.0770s/iter; left time: 2469.9695s
	iters: 400, epoch: 3 | loss: 0.3873167
	speed: 0.0771s/iter; left time: 2467.1454s
	iters: 500, epoch: 3 | loss: 0.2990522
	speed: 0.0770s/iter; left time: 2455.1664s
	iters: 600, epoch: 3 | loss: 0.2678949
	speed: 0.0770s/iter; left time: 2447.8932s
	iters: 700, epoch: 3 | loss: 0.3150223
	speed: 0.0770s/iter; left time: 2440.7898s
	iters: 800, epoch: 3 | loss: 0.2809688
	speed: 0.0767s/iter; left time: 2422.7209s
	iters: 900, epoch: 3 | loss: 0.2875786
	speed: 0.0768s/iter; left time: 2417.6734s
	iters: 1000, epoch: 3 | loss: 0.2968327
	speed: 0.0767s/iter; left time: 2406.9788s
	iters: 1100, epoch: 3 | loss: 0.2906166
	speed: 0.0777s/iter; left time: 2429.5558s
	iters: 1200, epoch: 3 | loss: 0.3089013
	speed: 0.0770s/iter; left time: 2400.6826s
	iters: 1300, epoch: 3 | loss: 0.3005980
	speed: 0.0768s/iter; left time: 2386.6964s
	iters: 1400, epoch: 3 | loss: 0.3202155
	speed: 0.0769s/iter; left time: 2381.3632s
	iters: 1500, epoch: 3 | loss: 0.3219434
	speed: 0.0768s/iter; left time: 2370.9488s
	iters: 1600, epoch: 3 | loss: 0.2774025
	speed: 0.0768s/iter; left time: 2365.7912s
	iters: 1700, epoch: 3 | loss: 0.2822172
	speed: 0.0769s/iter; left time: 2358.8621s
	iters: 1800, epoch: 3 | loss: 0.2856071
	speed: 0.0768s/iter; left time: 2349.6747s
	iters: 1900, epoch: 3 | loss: 0.3307652
	speed: 0.0767s/iter; left time: 2338.2524s
	iters: 2000, epoch: 3 | loss: 0.2996316
	speed: 0.0765s/iter; left time: 2325.3262s
	iters: 2100, epoch: 3 | loss: 0.3236845
	speed: 0.0766s/iter; left time: 2320.1053s
	iters: 2200, epoch: 3 | loss: 0.2787813
	speed: 0.0765s/iter; left time: 2310.5454s
	iters: 2300, epoch: 3 | loss: 0.3048159
	speed: 0.0766s/iter; left time: 2304.1021s
	iters: 2400, epoch: 3 | loss: 0.2716017
	speed: 0.0769s/iter; left time: 2307.3118s
	iters: 2500, epoch: 3 | loss: 0.2707826
	speed: 0.0764s/iter; left time: 2282.7877s
	iters: 2600, epoch: 3 | loss: 0.2940077
	speed: 0.0766s/iter; left time: 2281.4366s
	iters: 2700, epoch: 3 | loss: 0.3782644
	speed: 0.0765s/iter; left time: 2270.3478s
	iters: 2800, epoch: 3 | loss: 0.2940301
	speed: 0.0765s/iter; left time: 2261.9034s
	iters: 2900, epoch: 3 | loss: 0.3130277
	speed: 0.0764s/iter; left time: 2251.2889s
	iters: 3000, epoch: 3 | loss: 0.3719162
	speed: 0.0764s/iter; left time: 2244.0056s
	iters: 3100, epoch: 3 | loss: 0.2852426
	speed: 0.0765s/iter; left time: 2240.0818s
	iters: 3200, epoch: 3 | loss: 0.3137860
	speed: 0.0779s/iter; left time: 2274.0389s
	iters: 3300, epoch: 3 | loss: 0.3466457
	speed: 0.0766s/iter; left time: 2227.8741s
	iters: 3400, epoch: 3 | loss: 0.2817851
	speed: 0.0766s/iter; left time: 2218.8443s
	iters: 3500, epoch: 3 | loss: 0.3084247
	speed: 0.0766s/iter; left time: 2213.9451s
	iters: 3600, epoch: 3 | loss: 0.2787926
	speed: 0.0766s/iter; left time: 2204.5649s
	iters: 3700, epoch: 3 | loss: 0.3191307
	speed: 0.0766s/iter; left time: 2197.1043s
	iters: 3800, epoch: 3 | loss: 0.3107724
	speed: 0.0766s/iter; left time: 2189.1508s
	iters: 3900, epoch: 3 | loss: 0.2983531
	speed: 0.0766s/iter; left time: 2183.0389s
	iters: 4000, epoch: 3 | loss: 0.3279797
	speed: 0.0766s/iter; left time: 2173.0271s
Epoch: 3 cost time: 312.4294195175171
Epoch: 3, Steps: 4048 | Train Loss: 0.3078377 Vali Loss: 1.2510310 Test Loss: 1.7923137
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3203211
	speed: 2.6381s/iter; left time: 74491.6375s
	iters: 200, epoch: 4 | loss: 0.2784873
	speed: 0.0790s/iter; left time: 2223.9815s
	iters: 300, epoch: 4 | loss: 0.2865583
	speed: 0.0785s/iter; left time: 2201.3556s
	iters: 400, epoch: 4 | loss: 0.2842425
	speed: 0.0791s/iter; left time: 2208.7665s
	iters: 500, epoch: 4 | loss: 0.3024788
	speed: 0.0785s/iter; left time: 2186.5915s
	iters: 600, epoch: 4 | loss: 0.2781607
	speed: 0.0739s/iter; left time: 2048.8704s
	iters: 700, epoch: 4 | loss: 0.2997513
	speed: 0.0743s/iter; left time: 2052.1594s
	iters: 800, epoch: 4 | loss: 0.2618069
	speed: 0.0751s/iter; left time: 2067.6643s
	iters: 900, epoch: 4 | loss: 0.2954391
	speed: 0.0753s/iter; left time: 2065.6718s
	iters: 1000, epoch: 4 | loss: 0.2787742
	speed: 0.0753s/iter; left time: 2059.7318s
	iters: 1100, epoch: 4 | loss: 0.2602391
	speed: 0.0754s/iter; left time: 2054.4481s
	iters: 1200, epoch: 4 | loss: 0.2778915
	speed: 0.0755s/iter; left time: 2048.8499s
	iters: 1300, epoch: 4 | loss: 0.2759406
	speed: 0.0758s/iter; left time: 2048.2652s
	iters: 1400, epoch: 4 | loss: 0.2758586
	speed: 0.0757s/iter; left time: 2038.9855s
	iters: 1500, epoch: 4 | loss: 0.3240477
	speed: 0.0759s/iter; left time: 2037.3480s
	iters: 1600, epoch: 4 | loss: 0.2793647
	speed: 0.0760s/iter; left time: 2031.0242s
	iters: 1700, epoch: 4 | loss: 0.2906078
	speed: 0.0759s/iter; left time: 2022.3327s
	iters: 1800, epoch: 4 | loss: 0.2826718
	speed: 0.0762s/iter; left time: 2022.4729s
	iters: 1900, epoch: 4 | loss: 0.3208032
	speed: 0.0759s/iter; left time: 2005.2588s
	iters: 2000, epoch: 4 | loss: 0.2815845
	speed: 0.0759s/iter; left time: 2000.0405s
	iters: 2100, epoch: 4 | loss: 0.2996637
	speed: 0.0760s/iter; left time: 1994.4874s
	iters: 2200, epoch: 4 | loss: 0.2775715
	speed: 0.0760s/iter; left time: 1987.1790s
	iters: 2300, epoch: 4 | loss: 0.3022024
	speed: 0.0761s/iter; left time: 1980.2392s
	iters: 2400, epoch: 4 | loss: 0.2747445
	speed: 0.0762s/iter; left time: 1976.0761s
	iters: 2500, epoch: 4 | loss: 0.3021625
	speed: 0.0761s/iter; left time: 1967.0697s
	iters: 2600, epoch: 4 | loss: 0.3016125
	speed: 0.0762s/iter; left time: 1962.3622s
	iters: 2700, epoch: 4 | loss: 0.2808347
	speed: 0.0767s/iter; left time: 1965.9489s
	iters: 2800, epoch: 4 | loss: 0.2858676
	speed: 0.0764s/iter; left time: 1950.8755s
	iters: 2900, epoch: 4 | loss: 0.2974216
	speed: 0.0764s/iter; left time: 1944.5278s
	iters: 3000, epoch: 4 | loss: 0.3105109
	speed: 0.0764s/iter; left time: 1934.7796s
	iters: 3100, epoch: 4 | loss: 0.2584328
	speed: 0.0761s/iter; left time: 1921.2245s
	iters: 3200, epoch: 4 | loss: 0.3551423
	speed: 0.0763s/iter; left time: 1918.5082s
	iters: 3300, epoch: 4 | loss: 0.3074546
	speed: 0.0762s/iter; left time: 1908.0100s
	iters: 3400, epoch: 4 | loss: 0.2796858
	speed: 0.0763s/iter; left time: 1903.8813s
	iters: 3500, epoch: 4 | loss: 0.3315353
	speed: 0.0764s/iter; left time: 1897.1744s
	iters: 3600, epoch: 4 | loss: 0.2782789
	speed: 0.0765s/iter; left time: 1892.5734s
	iters: 3700, epoch: 4 | loss: 0.3015701
	speed: 0.0764s/iter; left time: 1882.9611s
	iters: 3800, epoch: 4 | loss: 0.2836402
	speed: 0.0763s/iter; left time: 1871.8068s
	iters: 3900, epoch: 4 | loss: 0.2666688
	speed: 0.0760s/iter; left time: 1856.1138s
	iters: 4000, epoch: 4 | loss: 0.2725694
	speed: 0.0766s/iter; left time: 1864.9493s
Epoch: 4 cost time: 310.45557045936584
Epoch: 4, Steps: 4048 | Train Loss: 0.2947186 Vali Loss: 1.2587812 Test Loss: 1.7855078
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems12_all_96_192_Mamba_custom_ftM_sl192_ll48_pl192_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 361721
test shape: (36172, 1, 192, 867) (36172, 1, 192, 867)
test shape: (36172, 192, 867) (36172, 192, 867)
mse:1.7262330055236816, mae:1.0242421627044678
>>>>>>>Overall time: 3416 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
