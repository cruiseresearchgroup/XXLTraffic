Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=521, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems11_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=521, expand=2, factor=1, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems11_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems11_all_96_96_Mamba_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1201096
val 295118
test 295118
	iters: 100, epoch: 1 | loss: 1.8818396
	speed: 0.0512s/iter; left time: 1917.0165s
	iters: 200, epoch: 1 | loss: 1.2821900
	speed: 0.0310s/iter; left time: 1155.9833s
	iters: 300, epoch: 1 | loss: 1.2567379
	speed: 0.0310s/iter; left time: 1153.2421s
	iters: 400, epoch: 1 | loss: 1.2130492
	speed: 0.0310s/iter; left time: 1150.0936s
	iters: 500, epoch: 1 | loss: 1.0869710
	speed: 0.0310s/iter; left time: 1148.5452s
	iters: 600, epoch: 1 | loss: 1.0424104
	speed: 0.0309s/iter; left time: 1142.4440s
	iters: 700, epoch: 1 | loss: 0.8933614
	speed: 0.0309s/iter; left time: 1139.8611s
	iters: 800, epoch: 1 | loss: 0.9504477
	speed: 0.0309s/iter; left time: 1135.7116s
	iters: 900, epoch: 1 | loss: 0.9012110
	speed: 0.0309s/iter; left time: 1133.0556s
	iters: 1000, epoch: 1 | loss: 0.7788228
	speed: 0.0309s/iter; left time: 1128.5634s
	iters: 1100, epoch: 1 | loss: 0.8779594
	speed: 0.0309s/iter; left time: 1127.3512s
	iters: 1200, epoch: 1 | loss: 0.8130585
	speed: 0.0309s/iter; left time: 1122.7555s
	iters: 1300, epoch: 1 | loss: 1.0641965
	speed: 0.0309s/iter; left time: 1120.9740s
	iters: 1400, epoch: 1 | loss: 0.7112073
	speed: 0.0310s/iter; left time: 1118.6331s
	iters: 1500, epoch: 1 | loss: 0.6656558
	speed: 0.0309s/iter; left time: 1114.6336s
	iters: 1600, epoch: 1 | loss: 0.7041327
	speed: 0.0309s/iter; left time: 1111.6251s
	iters: 1700, epoch: 1 | loss: 0.7055073
	speed: 0.0310s/iter; left time: 1109.2204s
	iters: 1800, epoch: 1 | loss: 0.6733571
	speed: 0.0310s/iter; left time: 1107.9598s
	iters: 1900, epoch: 1 | loss: 0.7606878
	speed: 0.0309s/iter; left time: 1099.8716s
	iters: 2000, epoch: 1 | loss: 0.8453362
	speed: 0.0309s/iter; left time: 1096.9654s
	iters: 2100, epoch: 1 | loss: 0.7453058
	speed: 0.0309s/iter; left time: 1093.1784s
	iters: 2200, epoch: 1 | loss: 0.7441272
	speed: 0.0309s/iter; left time: 1091.3785s
	iters: 2300, epoch: 1 | loss: 0.7147824
	speed: 0.0309s/iter; left time: 1087.8289s
	iters: 2400, epoch: 1 | loss: 0.5652320
	speed: 0.0308s/iter; left time: 1083.2621s
	iters: 2500, epoch: 1 | loss: 0.6145353
	speed: 0.0309s/iter; left time: 1083.1392s
	iters: 2600, epoch: 1 | loss: 0.8305901
	speed: 0.0310s/iter; left time: 1082.6781s
	iters: 2700, epoch: 1 | loss: 0.8085724
	speed: 0.0308s/iter; left time: 1073.8079s
	iters: 2800, epoch: 1 | loss: 0.6247043
	speed: 0.0310s/iter; left time: 1076.4950s
	iters: 2900, epoch: 1 | loss: 0.6971608
	speed: 0.0309s/iter; left time: 1068.9644s
	iters: 3000, epoch: 1 | loss: 0.8365823
	speed: 0.0309s/iter; left time: 1067.1652s
	iters: 3100, epoch: 1 | loss: 0.8425605
	speed: 0.0309s/iter; left time: 1064.1960s
	iters: 3200, epoch: 1 | loss: 0.6472068
	speed: 0.0309s/iter; left time: 1060.2700s
	iters: 3300, epoch: 1 | loss: 0.8691648
	speed: 0.0308s/iter; left time: 1055.9045s
	iters: 3400, epoch: 1 | loss: 0.6419283
	speed: 0.0308s/iter; left time: 1051.5232s
	iters: 3500, epoch: 1 | loss: 0.6970580
	speed: 0.0308s/iter; left time: 1048.3256s
	iters: 3600, epoch: 1 | loss: 0.7406620
	speed: 0.0309s/iter; left time: 1049.8541s
	iters: 3700, epoch: 1 | loss: 0.7073415
	speed: 0.0308s/iter; left time: 1043.4194s
Epoch: 1 cost time: 118.18757319450378
Epoch: 1, Steps: 3753 | Train Loss: 0.8703916 Vali Loss: 1.4794332 Test Loss: 5.9295220
Validation loss decreased (inf --> 1.479433).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7907771
	speed: 1.0324s/iter; left time: 34767.7327s
	iters: 200, epoch: 2 | loss: 0.6222311
	speed: 0.0309s/iter; left time: 1036.7645s
	iters: 300, epoch: 2 | loss: 0.7512946
	speed: 0.0309s/iter; left time: 1033.3171s
	iters: 400, epoch: 2 | loss: 0.7285265
	speed: 0.0311s/iter; left time: 1038.9167s
	iters: 500, epoch: 2 | loss: 0.5973980
	speed: 0.0308s/iter; left time: 1026.4987s
	iters: 600, epoch: 2 | loss: 0.8323778
	speed: 0.0309s/iter; left time: 1025.0690s
	iters: 700, epoch: 2 | loss: 0.5428157
	speed: 0.0308s/iter; left time: 1019.7946s
	iters: 800, epoch: 2 | loss: 0.6520450
	speed: 0.0309s/iter; left time: 1020.0318s
	iters: 900, epoch: 2 | loss: 0.6785644
	speed: 0.0308s/iter; left time: 1013.8275s
	iters: 1000, epoch: 2 | loss: 0.5006741
	speed: 0.0309s/iter; left time: 1012.2512s
	iters: 1100, epoch: 2 | loss: 0.7090284
	speed: 0.0309s/iter; left time: 1010.0155s
	iters: 1200, epoch: 2 | loss: 0.6635024
	speed: 0.0309s/iter; left time: 1007.3066s
	iters: 1300, epoch: 2 | loss: 0.7831216
	speed: 0.0310s/iter; left time: 1005.3748s
	iters: 1400, epoch: 2 | loss: 0.6938719
	speed: 0.0309s/iter; left time: 999.6696s
	iters: 1500, epoch: 2 | loss: 0.5582451
	speed: 0.0309s/iter; left time: 997.1104s
	iters: 1600, epoch: 2 | loss: 0.7152919
	speed: 0.0309s/iter; left time: 995.4624s
	iters: 1700, epoch: 2 | loss: 0.6515349
	speed: 0.0309s/iter; left time: 991.3503s
	iters: 1800, epoch: 2 | loss: 0.7051553
	speed: 0.0309s/iter; left time: 988.6316s
	iters: 1900, epoch: 2 | loss: 0.7030104
	speed: 0.0312s/iter; left time: 993.9545s
	iters: 2000, epoch: 2 | loss: 0.5654607
	speed: 0.0312s/iter; left time: 991.0981s
	iters: 2100, epoch: 2 | loss: 0.6088516
	speed: 0.0311s/iter; left time: 986.1936s
	iters: 2200, epoch: 2 | loss: 0.6409449
	speed: 0.0311s/iter; left time: 980.9123s
	iters: 2300, epoch: 2 | loss: 0.6265435
	speed: 0.0311s/iter; left time: 978.1800s
	iters: 2400, epoch: 2 | loss: 0.7807405
	speed: 0.0310s/iter; left time: 971.6681s
	iters: 2500, epoch: 2 | loss: 0.7217083
	speed: 0.0310s/iter; left time: 969.9626s
	iters: 2600, epoch: 2 | loss: 0.7475497
	speed: 0.0310s/iter; left time: 965.1029s
	iters: 2700, epoch: 2 | loss: 0.7161252
	speed: 0.0310s/iter; left time: 963.3149s
	iters: 2800, epoch: 2 | loss: 0.5771656
	speed: 0.0311s/iter; left time: 963.7994s
	iters: 2900, epoch: 2 | loss: 0.6540404
	speed: 0.0310s/iter; left time: 958.1580s
	iters: 3000, epoch: 2 | loss: 0.6174952
	speed: 0.0310s/iter; left time: 954.3794s
	iters: 3100, epoch: 2 | loss: 0.7105640
	speed: 0.0310s/iter; left time: 949.8813s
	iters: 3200, epoch: 2 | loss: 0.6492620
	speed: 0.0311s/iter; left time: 951.2186s
	iters: 3300, epoch: 2 | loss: 0.8351074
	speed: 0.0310s/iter; left time: 943.9939s
	iters: 3400, epoch: 2 | loss: 0.5820631
	speed: 0.0310s/iter; left time: 940.4332s
	iters: 3500, epoch: 2 | loss: 0.5205800
	speed: 0.0310s/iter; left time: 938.3888s
	iters: 3600, epoch: 2 | loss: 0.7445313
	speed: 0.0311s/iter; left time: 937.1302s
	iters: 3700, epoch: 2 | loss: 0.7065584
	speed: 0.0311s/iter; left time: 936.3165s
Epoch: 2 cost time: 116.89415454864502
Epoch: 2, Steps: 3753 | Train Loss: 0.6796216 Vali Loss: 1.3899924 Test Loss: 5.8185153
Validation loss decreased (1.479433 --> 1.389992).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6950755
	speed: 1.0471s/iter; left time: 31333.6508s
	iters: 200, epoch: 3 | loss: 0.6599849
	speed: 0.0311s/iter; left time: 928.8469s
	iters: 300, epoch: 3 | loss: 0.6491963
	speed: 0.0311s/iter; left time: 924.4791s
	iters: 400, epoch: 3 | loss: 0.5334180
	speed: 0.0311s/iter; left time: 921.7071s
	iters: 500, epoch: 3 | loss: 0.6711515
	speed: 0.0310s/iter; left time: 915.1653s
	iters: 600, epoch: 3 | loss: 0.6634260
	speed: 0.0310s/iter; left time: 912.6705s
	iters: 700, epoch: 3 | loss: 0.7804753
	speed: 0.0310s/iter; left time: 910.4990s
	iters: 800, epoch: 3 | loss: 0.5801672
	speed: 0.0310s/iter; left time: 905.8571s
	iters: 900, epoch: 3 | loss: 0.6289737
	speed: 0.0310s/iter; left time: 902.3935s
	iters: 1000, epoch: 3 | loss: 0.6380845
	speed: 0.0310s/iter; left time: 899.5604s
	iters: 1100, epoch: 3 | loss: 0.7203546
	speed: 0.0310s/iter; left time: 896.9203s
	iters: 1200, epoch: 3 | loss: 0.6726953
	speed: 0.0310s/iter; left time: 892.7923s
	iters: 1300, epoch: 3 | loss: 0.7217089
	speed: 0.0310s/iter; left time: 890.0347s
	iters: 1400, epoch: 3 | loss: 0.7085701
	speed: 0.0310s/iter; left time: 887.4981s
	iters: 1500, epoch: 3 | loss: 0.5964249
	speed: 0.0310s/iter; left time: 883.2398s
	iters: 1600, epoch: 3 | loss: 0.6389388
	speed: 0.0310s/iter; left time: 882.0359s
	iters: 1700, epoch: 3 | loss: 0.5044690
	speed: 0.0312s/iter; left time: 884.0915s
	iters: 1800, epoch: 3 | loss: 0.6174222
	speed: 0.0311s/iter; left time: 877.9687s
	iters: 1900, epoch: 3 | loss: 0.5966877
	speed: 0.0310s/iter; left time: 871.2880s
	iters: 2000, epoch: 3 | loss: 0.6256386
	speed: 0.0310s/iter; left time: 869.7601s
	iters: 2100, epoch: 3 | loss: 0.5968256
	speed: 0.0309s/iter; left time: 863.9204s
	iters: 2200, epoch: 3 | loss: 0.6354181
	speed: 0.0313s/iter; left time: 869.8555s
	iters: 2300, epoch: 3 | loss: 0.5977737
	speed: 0.0310s/iter; left time: 860.4905s
	iters: 2400, epoch: 3 | loss: 0.5412290
	speed: 0.0309s/iter; left time: 854.4447s
	iters: 2500, epoch: 3 | loss: 0.7052956
	speed: 0.0311s/iter; left time: 854.7840s
	iters: 2600, epoch: 3 | loss: 0.7055150
	speed: 0.0309s/iter; left time: 848.5671s
	iters: 2700, epoch: 3 | loss: 0.5346951
	speed: 0.0311s/iter; left time: 848.8671s
	iters: 2800, epoch: 3 | loss: 0.6304871
	speed: 0.0309s/iter; left time: 842.1650s
	iters: 2900, epoch: 3 | loss: 0.7744573
	speed: 0.0310s/iter; left time: 839.8667s
	iters: 3000, epoch: 3 | loss: 0.6344630
	speed: 0.0311s/iter; left time: 841.2604s
	iters: 3100, epoch: 3 | loss: 0.6614676
	speed: 0.0309s/iter; left time: 831.8302s
	iters: 3200, epoch: 3 | loss: 0.6526147
	speed: 0.0309s/iter; left time: 830.0285s
	iters: 3300, epoch: 3 | loss: 0.6378444
	speed: 0.0310s/iter; left time: 828.6350s
	iters: 3400, epoch: 3 | loss: 0.6177702
	speed: 0.0309s/iter; left time: 823.1602s
	iters: 3500, epoch: 3 | loss: 0.5600203
	speed: 0.0309s/iter; left time: 820.7870s
	iters: 3600, epoch: 3 | loss: 0.6153952
	speed: 0.0309s/iter; left time: 817.6596s
	iters: 3700, epoch: 3 | loss: 0.5923138
	speed: 0.0312s/iter; left time: 820.1477s
Epoch: 3 cost time: 117.1025903224945
Epoch: 3, Steps: 3753 | Train Loss: 0.6353450 Vali Loss: 1.3690234 Test Loss: 5.8705873
Validation loss decreased (1.389992 --> 1.369023).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5979328
	speed: 1.0485s/iter; left time: 27442.2244s
	iters: 200, epoch: 4 | loss: 0.7550164
	speed: 0.0309s/iter; left time: 805.7559s
	iters: 300, epoch: 4 | loss: 0.7029881
	speed: 0.0307s/iter; left time: 797.8101s
	iters: 400, epoch: 4 | loss: 0.5655400
	speed: 0.0307s/iter; left time: 794.7509s
	iters: 500, epoch: 4 | loss: 0.6210548
	speed: 0.0306s/iter; left time: 789.8389s
	iters: 600, epoch: 4 | loss: 0.5846498
	speed: 0.0308s/iter; left time: 791.5653s
	iters: 700, epoch: 4 | loss: 0.5842857
	speed: 0.0308s/iter; left time: 788.4516s
	iters: 800, epoch: 4 | loss: 0.6035199
	speed: 0.0307s/iter; left time: 781.6327s
	iters: 900, epoch: 4 | loss: 0.6286760
	speed: 0.0306s/iter; left time: 777.5931s
	iters: 1000, epoch: 4 | loss: 0.5572071
	speed: 0.0307s/iter; left time: 775.0561s
	iters: 1100, epoch: 4 | loss: 0.7030014
	speed: 0.0307s/iter; left time: 771.9678s
	iters: 1200, epoch: 4 | loss: 0.5968326
	speed: 0.0307s/iter; left time: 770.3308s
	iters: 1300, epoch: 4 | loss: 0.5818389
	speed: 0.0307s/iter; left time: 766.9777s
	iters: 1400, epoch: 4 | loss: 0.6634596
	speed: 0.0307s/iter; left time: 763.4480s
	iters: 1500, epoch: 4 | loss: 0.6895517
	speed: 0.0307s/iter; left time: 761.2757s
	iters: 1600, epoch: 4 | loss: 0.5339597
	speed: 0.0307s/iter; left time: 757.3241s
	iters: 1700, epoch: 4 | loss: 0.5589235
	speed: 0.0306s/iter; left time: 753.0939s
	iters: 1800, epoch: 4 | loss: 0.5781144
	speed: 0.0307s/iter; left time: 750.4521s
	iters: 1900, epoch: 4 | loss: 0.6915460
	speed: 0.0307s/iter; left time: 748.9913s
	iters: 2000, epoch: 4 | loss: 0.7048863
	speed: 0.0308s/iter; left time: 747.4449s
	iters: 2100, epoch: 4 | loss: 0.5987512
	speed: 0.0308s/iter; left time: 743.3004s
	iters: 2200, epoch: 4 | loss: 0.4544094
	speed: 0.0310s/iter; left time: 745.8607s
	iters: 2300, epoch: 4 | loss: 0.7144796
	speed: 0.0309s/iter; left time: 740.0164s
	iters: 2400, epoch: 4 | loss: 0.5250086
	speed: 0.0308s/iter; left time: 735.1784s
	iters: 2500, epoch: 4 | loss: 0.5780432
	speed: 0.0309s/iter; left time: 734.9107s
	iters: 2600, epoch: 4 | loss: 0.6577347
	speed: 0.0307s/iter; left time: 727.1930s
	iters: 2700, epoch: 4 | loss: 0.6295466
	speed: 0.0307s/iter; left time: 724.1048s
	iters: 2800, epoch: 4 | loss: 0.5451854
	speed: 0.0307s/iter; left time: 720.5012s
	iters: 2900, epoch: 4 | loss: 0.5528502
	speed: 0.0307s/iter; left time: 717.7427s
	iters: 3000, epoch: 4 | loss: 0.4537170
	speed: 0.0308s/iter; left time: 715.6936s
	iters: 3100, epoch: 4 | loss: 0.7189924
	speed: 0.0307s/iter; left time: 712.1955s
	iters: 3200, epoch: 4 | loss: 0.6611096
	speed: 0.0308s/iter; left time: 709.7173s
	iters: 3300, epoch: 4 | loss: 0.7930768
	speed: 0.0307s/iter; left time: 705.9915s
	iters: 3400, epoch: 4 | loss: 0.6360325
	speed: 0.0308s/iter; left time: 703.6683s
	iters: 3500, epoch: 4 | loss: 0.5155979
	speed: 0.0307s/iter; left time: 699.7982s
	iters: 3600, epoch: 4 | loss: 0.5849431
	speed: 0.0308s/iter; left time: 697.1901s
	iters: 3700, epoch: 4 | loss: 0.5950048
	speed: 0.0308s/iter; left time: 694.4324s
Epoch: 4 cost time: 116.09517860412598
Epoch: 4, Steps: 3753 | Train Loss: 0.6175125 Vali Loss: 1.3772783 Test Loss: 5.8976216
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6844405
	speed: 1.0390s/iter; left time: 23294.0210s
	iters: 200, epoch: 5 | loss: 0.7300448
	speed: 0.0308s/iter; left time: 688.1964s
	iters: 300, epoch: 5 | loss: 0.5984031
	speed: 0.0308s/iter; left time: 683.4858s
	iters: 400, epoch: 5 | loss: 0.6263918
	speed: 0.0307s/iter; left time: 679.6984s
	iters: 500, epoch: 5 | loss: 0.6772558
	speed: 0.0307s/iter; left time: 676.8662s
	iters: 600, epoch: 5 | loss: 0.5503220
	speed: 0.0309s/iter; left time: 676.9134s
	iters: 700, epoch: 5 | loss: 0.5934183
	speed: 0.0308s/iter; left time: 671.8072s
	iters: 800, epoch: 5 | loss: 0.5182213
	speed: 0.0308s/iter; left time: 668.1459s
	iters: 900, epoch: 5 | loss: 0.7276830
	speed: 0.0308s/iter; left time: 666.1378s
	iters: 1000, epoch: 5 | loss: 0.5514814
	speed: 0.0307s/iter; left time: 661.5118s
	iters: 1100, epoch: 5 | loss: 0.6405295
	speed: 0.0308s/iter; left time: 658.6526s
	iters: 1200, epoch: 5 | loss: 0.6567690
	speed: 0.0307s/iter; left time: 655.2940s
	iters: 1300, epoch: 5 | loss: 0.5625372
	speed: 0.0307s/iter; left time: 651.6148s
	iters: 1400, epoch: 5 | loss: 0.5503551
	speed: 0.0308s/iter; left time: 649.4324s
	iters: 1500, epoch: 5 | loss: 0.6167086
	speed: 0.0307s/iter; left time: 645.8028s
	iters: 1600, epoch: 5 | loss: 0.6915268
	speed: 0.0308s/iter; left time: 643.4555s
	iters: 1700, epoch: 5 | loss: 0.6724418
	speed: 0.0307s/iter; left time: 640.1391s
	iters: 1800, epoch: 5 | loss: 0.5838895
	speed: 0.0307s/iter; left time: 636.9061s
	iters: 1900, epoch: 5 | loss: 0.4927486
	speed: 0.0307s/iter; left time: 633.5666s
	iters: 2000, epoch: 5 | loss: 0.6106759
	speed: 0.0307s/iter; left time: 630.5789s
	iters: 2100, epoch: 5 | loss: 0.6444998
	speed: 0.0309s/iter; left time: 630.8719s
	iters: 2200, epoch: 5 | loss: 0.6395056
	speed: 0.0310s/iter; left time: 629.4708s
	iters: 2300, epoch: 5 | loss: 0.8038300
	speed: 0.0308s/iter; left time: 623.2381s
	iters: 2400, epoch: 5 | loss: 0.5682997
	speed: 0.0309s/iter; left time: 621.9419s
	iters: 2500, epoch: 5 | loss: 0.5984598
	speed: 0.0308s/iter; left time: 615.8852s
	iters: 2600, epoch: 5 | loss: 0.8809910
	speed: 0.0309s/iter; left time: 615.9118s
	iters: 2700, epoch: 5 | loss: 0.6551129
	speed: 0.0308s/iter; left time: 609.5144s
	iters: 2800, epoch: 5 | loss: 0.5907800
	speed: 0.0308s/iter; left time: 606.6580s
	iters: 2900, epoch: 5 | loss: 0.5639613
	speed: 0.0307s/iter; left time: 602.7346s
	iters: 3000, epoch: 5 | loss: 0.5079352
	speed: 0.0309s/iter; left time: 603.1380s
	iters: 3100, epoch: 5 | loss: 0.6213049
	speed: 0.0307s/iter; left time: 596.5670s
	iters: 3200, epoch: 5 | loss: 0.6024306
	speed: 0.0308s/iter; left time: 594.4832s
	iters: 3300, epoch: 5 | loss: 0.6609432
	speed: 0.0307s/iter; left time: 590.8416s
	iters: 3400, epoch: 5 | loss: 0.6785129
	speed: 0.0307s/iter; left time: 587.7803s
	iters: 3500, epoch: 5 | loss: 0.6310820
	speed: 0.0307s/iter; left time: 583.8446s
	iters: 3600, epoch: 5 | loss: 0.6315888
	speed: 0.0308s/iter; left time: 583.2533s
	iters: 3700, epoch: 5 | loss: 0.5544596
	speed: 0.0308s/iter; left time: 579.1981s
Epoch: 5 cost time: 116.32851123809814
Epoch: 5, Steps: 3753 | Train Loss: 0.6094237 Vali Loss: 1.4003803 Test Loss: 5.9120207
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5610173
	speed: 1.0520s/iter; left time: 19636.5749s
	iters: 200, epoch: 6 | loss: 0.6805377
	speed: 0.0309s/iter; left time: 574.5105s
	iters: 300, epoch: 6 | loss: 0.6736009
	speed: 0.0310s/iter; left time: 572.0512s
	iters: 400, epoch: 6 | loss: 0.4648051
	speed: 0.0310s/iter; left time: 569.3025s
	iters: 500, epoch: 6 | loss: 0.4507150
	speed: 0.0309s/iter; left time: 563.7771s
	iters: 600, epoch: 6 | loss: 0.5823662
	speed: 0.0309s/iter; left time: 561.1541s
	iters: 700, epoch: 6 | loss: 0.6536655
	speed: 0.0309s/iter; left time: 558.6203s
	iters: 800, epoch: 6 | loss: 0.6416760
	speed: 0.0310s/iter; left time: 556.2267s
	iters: 900, epoch: 6 | loss: 0.5607157
	speed: 0.0310s/iter; left time: 553.5910s
	iters: 1000, epoch: 6 | loss: 0.6367269
	speed: 0.0310s/iter; left time: 550.1487s
	iters: 1100, epoch: 6 | loss: 0.7243449
	speed: 0.0309s/iter; left time: 545.3668s
	iters: 1200, epoch: 6 | loss: 0.5439281
	speed: 0.0309s/iter; left time: 543.2052s
	iters: 1300, epoch: 6 | loss: 0.6257322
	speed: 0.0309s/iter; left time: 539.9365s
	iters: 1400, epoch: 6 | loss: 0.5617501
	speed: 0.0309s/iter; left time: 536.7496s
	iters: 1500, epoch: 6 | loss: 0.6272144
	speed: 0.0309s/iter; left time: 534.2135s
	iters: 1600, epoch: 6 | loss: 0.8038954
	speed: 0.0310s/iter; left time: 532.7461s
	iters: 1700, epoch: 6 | loss: 0.6677211
	speed: 0.0309s/iter; left time: 527.0765s
	iters: 1800, epoch: 6 | loss: 0.4738039
	speed: 0.0310s/iter; left time: 525.9030s
	iters: 1900, epoch: 6 | loss: 0.5883512
	speed: 0.0312s/iter; left time: 526.7982s
	iters: 2000, epoch: 6 | loss: 0.5452559
	speed: 0.0310s/iter; left time: 519.8328s
	iters: 2100, epoch: 6 | loss: 0.4562813
	speed: 0.0309s/iter; left time: 515.6620s
	iters: 2200, epoch: 6 | loss: 0.5631920
	speed: 0.0309s/iter; left time: 512.0612s
	iters: 2300, epoch: 6 | loss: 0.7488340
	speed: 0.0310s/iter; left time: 510.0338s
	iters: 2400, epoch: 6 | loss: 0.5289778
	speed: 0.0310s/iter; left time: 507.7743s
	iters: 2500, epoch: 6 | loss: 0.6102253
	speed: 0.0311s/iter; left time: 505.6433s
	iters: 2600, epoch: 6 | loss: 0.5232145
	speed: 0.0310s/iter; left time: 501.7140s
	iters: 2700, epoch: 6 | loss: 0.5780599
	speed: 0.0310s/iter; left time: 497.6708s
	iters: 2800, epoch: 6 | loss: 0.6956080
	speed: 0.0309s/iter; left time: 494.1168s
	iters: 2900, epoch: 6 | loss: 0.6698191
	speed: 0.0309s/iter; left time: 490.4157s
	iters: 3000, epoch: 6 | loss: 0.5704016
	speed: 0.0309s/iter; left time: 487.3552s
	iters: 3100, epoch: 6 | loss: 0.5938240
	speed: 0.0310s/iter; left time: 485.1992s
	iters: 3200, epoch: 6 | loss: 0.6837712
	speed: 0.0309s/iter; left time: 480.9485s
	iters: 3300, epoch: 6 | loss: 0.7265858
	speed: 0.0309s/iter; left time: 478.2221s
	iters: 3400, epoch: 6 | loss: 0.5167509
	speed: 0.0311s/iter; left time: 477.3154s
	iters: 3500, epoch: 6 | loss: 0.5379440
	speed: 0.0310s/iter; left time: 472.7328s
	iters: 3600, epoch: 6 | loss: 0.7672315
	speed: 0.0309s/iter; left time: 469.1027s
	iters: 3700, epoch: 6 | loss: 0.7271155
	speed: 0.0310s/iter; left time: 467.6754s
Epoch: 6 cost time: 116.95634722709656
Epoch: 6, Steps: 3753 | Train Loss: 0.6053820 Vali Loss: 1.3923317 Test Loss: 5.9092813
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems11_all_96_96_Mamba_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 295118
test shape: (29511, 1, 96, 521) (29511, 1, 96, 521)
test shape: (29511, 96, 521) (29511, 96, 521)
mse:5.870551586151123, mae:0.9678476452827454
>>>>>>>Overall time: 1790 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
