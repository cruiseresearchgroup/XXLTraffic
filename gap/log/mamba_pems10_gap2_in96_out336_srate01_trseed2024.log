Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=107, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems10_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=107, expand=2, factor=1, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems10_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=336, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_all_96_336_Mamba_custom_ftM_sl336_ll48_pl336_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 844071
val 141087
test 141085
	iters: 100, epoch: 1 | loss: 0.9091743
	speed: 0.0348s/iter; left time: 914.2438s
	iters: 200, epoch: 1 | loss: 0.8687567
	speed: 0.0170s/iter; left time: 445.4303s
	iters: 300, epoch: 1 | loss: 0.8587770
	speed: 0.0170s/iter; left time: 443.5096s
	iters: 400, epoch: 1 | loss: 0.8479507
	speed: 0.0172s/iter; left time: 445.9913s
	iters: 500, epoch: 1 | loss: 0.5877852
	speed: 0.0171s/iter; left time: 441.7753s
	iters: 600, epoch: 1 | loss: 0.7567568
	speed: 0.0171s/iter; left time: 439.4701s
	iters: 700, epoch: 1 | loss: 0.7310670
	speed: 0.0170s/iter; left time: 437.6148s
	iters: 800, epoch: 1 | loss: 0.5695540
	speed: 0.0170s/iter; left time: 435.8585s
	iters: 900, epoch: 1 | loss: 0.5889323
	speed: 0.0170s/iter; left time: 434.2617s
	iters: 1000, epoch: 1 | loss: 0.5927840
	speed: 0.0171s/iter; left time: 432.7949s
	iters: 1100, epoch: 1 | loss: 0.6381434
	speed: 0.0170s/iter; left time: 430.4275s
	iters: 1200, epoch: 1 | loss: 0.7924738
	speed: 0.0171s/iter; left time: 429.9853s
	iters: 1300, epoch: 1 | loss: 0.5226617
	speed: 0.0171s/iter; left time: 428.7494s
	iters: 1400, epoch: 1 | loss: 0.6612084
	speed: 0.0171s/iter; left time: 427.8136s
	iters: 1500, epoch: 1 | loss: 0.6728820
	speed: 0.0171s/iter; left time: 424.7425s
	iters: 1600, epoch: 1 | loss: 0.6529147
	speed: 0.0171s/iter; left time: 422.8287s
	iters: 1700, epoch: 1 | loss: 0.5397205
	speed: 0.0171s/iter; left time: 422.3294s
	iters: 1800, epoch: 1 | loss: 0.6539426
	speed: 0.0172s/iter; left time: 422.2259s
	iters: 1900, epoch: 1 | loss: 0.5379959
	speed: 0.0172s/iter; left time: 420.7298s
	iters: 2000, epoch: 1 | loss: 0.6890596
	speed: 0.0171s/iter; left time: 416.8887s
	iters: 2100, epoch: 1 | loss: 0.6173720
	speed: 0.0171s/iter; left time: 415.2056s
	iters: 2200, epoch: 1 | loss: 0.6737675
	speed: 0.0172s/iter; left time: 415.5244s
	iters: 2300, epoch: 1 | loss: 0.6590087
	speed: 0.0171s/iter; left time: 412.7038s
	iters: 2400, epoch: 1 | loss: 0.4973384
	speed: 0.0171s/iter; left time: 410.6987s
	iters: 2500, epoch: 1 | loss: 0.6062033
	speed: 0.0172s/iter; left time: 410.0199s
	iters: 2600, epoch: 1 | loss: 0.5950740
	speed: 0.0172s/iter; left time: 407.8180s
Epoch: 1 cost time: 46.936129331588745
Epoch: 1, Steps: 2637 | Train Loss: 0.6735044 Vali Loss: 2.5024045 Test Loss: 1.0214897
Validation loss decreased (inf --> 2.502404).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6760480
	speed: 0.3957s/iter; left time: 9352.0107s
	iters: 200, epoch: 2 | loss: 0.7005984
	speed: 0.0174s/iter; left time: 408.9615s
	iters: 300, epoch: 2 | loss: 0.6458866
	speed: 0.0174s/iter; left time: 407.0936s
	iters: 400, epoch: 2 | loss: 0.7130222
	speed: 0.0174s/iter; left time: 405.5376s
	iters: 500, epoch: 2 | loss: 0.5686997
	speed: 0.0174s/iter; left time: 403.7311s
	iters: 600, epoch: 2 | loss: 0.5504163
	speed: 0.0174s/iter; left time: 403.3496s
	iters: 700, epoch: 2 | loss: 0.5559852
	speed: 0.0174s/iter; left time: 400.5373s
	iters: 800, epoch: 2 | loss: 0.5178476
	speed: 0.0174s/iter; left time: 399.3052s
	iters: 900, epoch: 2 | loss: 0.5661260
	speed: 0.0174s/iter; left time: 397.0354s
	iters: 1000, epoch: 2 | loss: 0.4525006
	speed: 0.0174s/iter; left time: 394.6726s
	iters: 1100, epoch: 2 | loss: 0.5858635
	speed: 0.0174s/iter; left time: 393.3575s
	iters: 1200, epoch: 2 | loss: 0.5133912
	speed: 0.0174s/iter; left time: 391.7033s
	iters: 1300, epoch: 2 | loss: 0.5556469
	speed: 0.0174s/iter; left time: 389.7535s
	iters: 1400, epoch: 2 | loss: 0.4347647
	speed: 0.0174s/iter; left time: 389.0104s
	iters: 1500, epoch: 2 | loss: 0.4956215
	speed: 0.0174s/iter; left time: 386.6425s
	iters: 1600, epoch: 2 | loss: 0.4719244
	speed: 0.0174s/iter; left time: 385.3120s
	iters: 1700, epoch: 2 | loss: 0.5213278
	speed: 0.0174s/iter; left time: 383.7855s
	iters: 1800, epoch: 2 | loss: 0.5462916
	speed: 0.0174s/iter; left time: 382.0089s
	iters: 1900, epoch: 2 | loss: 0.5037258
	speed: 0.0174s/iter; left time: 379.9728s
	iters: 2000, epoch: 2 | loss: 0.5282745
	speed: 0.0174s/iter; left time: 377.9269s
	iters: 2100, epoch: 2 | loss: 0.6122263
	speed: 0.0174s/iter; left time: 376.9545s
	iters: 2200, epoch: 2 | loss: 0.5029910
	speed: 0.0174s/iter; left time: 375.3949s
	iters: 2300, epoch: 2 | loss: 0.4767725
	speed: 0.0174s/iter; left time: 373.0366s
	iters: 2400, epoch: 2 | loss: 0.4444430
	speed: 0.0174s/iter; left time: 371.3866s
	iters: 2500, epoch: 2 | loss: 0.4823066
	speed: 0.0174s/iter; left time: 369.3955s
	iters: 2600, epoch: 2 | loss: 0.6381924
	speed: 0.0174s/iter; left time: 367.7991s
Epoch: 2 cost time: 46.175817012786865
Epoch: 2, Steps: 2637 | Train Loss: 0.5309364 Vali Loss: 2.5403666 Test Loss: 0.9460509
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4608412
	speed: 0.3975s/iter; left time: 8346.9297s
	iters: 200, epoch: 3 | loss: 0.4617518
	speed: 0.0177s/iter; left time: 368.8958s
	iters: 300, epoch: 3 | loss: 0.4361949
	speed: 0.0177s/iter; left time: 367.3873s
	iters: 400, epoch: 3 | loss: 0.4457798
	speed: 0.0176s/iter; left time: 364.0881s
	iters: 500, epoch: 3 | loss: 0.4897690
	speed: 0.0176s/iter; left time: 363.1299s
	iters: 600, epoch: 3 | loss: 0.4909321
	speed: 0.0176s/iter; left time: 360.9807s
	iters: 700, epoch: 3 | loss: 0.5833572
	speed: 0.0177s/iter; left time: 361.1363s
	iters: 800, epoch: 3 | loss: 0.4397547
	speed: 0.0176s/iter; left time: 358.1693s
	iters: 900, epoch: 3 | loss: 0.5429775
	speed: 0.0177s/iter; left time: 356.5650s
	iters: 1000, epoch: 3 | loss: 0.4465642
	speed: 0.0177s/iter; left time: 354.8899s
	iters: 1100, epoch: 3 | loss: 0.4353355
	speed: 0.0177s/iter; left time: 353.8540s
	iters: 1200, epoch: 3 | loss: 0.4736262
	speed: 0.0177s/iter; left time: 351.6193s
	iters: 1300, epoch: 3 | loss: 0.4075172
	speed: 0.0177s/iter; left time: 350.8134s
	iters: 1400, epoch: 3 | loss: 0.4298328
	speed: 0.0177s/iter; left time: 347.7746s
	iters: 1500, epoch: 3 | loss: 0.6509364
	speed: 0.0176s/iter; left time: 345.4633s
	iters: 1600, epoch: 3 | loss: 0.4951711
	speed: 0.0177s/iter; left time: 345.6379s
	iters: 1700, epoch: 3 | loss: 0.4879144
	speed: 0.0176s/iter; left time: 341.9124s
	iters: 1800, epoch: 3 | loss: 0.4807647
	speed: 0.0176s/iter; left time: 340.4712s
	iters: 1900, epoch: 3 | loss: 0.4411849
	speed: 0.0177s/iter; left time: 339.2879s
	iters: 2000, epoch: 3 | loss: 0.4890706
	speed: 0.0177s/iter; left time: 337.1029s
	iters: 2100, epoch: 3 | loss: 0.5009960
	speed: 0.0176s/iter; left time: 335.0419s
	iters: 2200, epoch: 3 | loss: 0.4453600
	speed: 0.0176s/iter; left time: 333.0712s
	iters: 2300, epoch: 3 | loss: 0.4824491
	speed: 0.0176s/iter; left time: 331.1685s
	iters: 2400, epoch: 3 | loss: 0.4401963
	speed: 0.0176s/iter; left time: 329.7523s
	iters: 2500, epoch: 3 | loss: 0.4135503
	speed: 0.0177s/iter; left time: 328.2981s
	iters: 2600, epoch: 3 | loss: 0.4547755
	speed: 0.0176s/iter; left time: 326.0058s
Epoch: 3 cost time: 46.81822204589844
Epoch: 3, Steps: 2637 | Train Loss: 0.4949498 Vali Loss: 2.5448697 Test Loss: 1.0298535
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6078533
	speed: 0.3975s/iter; left time: 7297.4888s
	iters: 200, epoch: 4 | loss: 0.4350170
	speed: 0.0176s/iter; left time: 320.6797s
	iters: 300, epoch: 4 | loss: 0.4784925
	speed: 0.0175s/iter; left time: 318.6433s
	iters: 400, epoch: 4 | loss: 0.6062920
	speed: 0.0177s/iter; left time: 318.9918s
	iters: 500, epoch: 4 | loss: 0.4410803
	speed: 0.0176s/iter; left time: 315.4499s
	iters: 600, epoch: 4 | loss: 0.4624815
	speed: 0.0175s/iter; left time: 313.2979s
	iters: 700, epoch: 4 | loss: 0.4519601
	speed: 0.0178s/iter; left time: 315.2896s
	iters: 800, epoch: 4 | loss: 0.5322155
	speed: 0.0176s/iter; left time: 311.2701s
	iters: 900, epoch: 4 | loss: 0.4600375
	speed: 0.0175s/iter; left time: 307.9805s
	iters: 1000, epoch: 4 | loss: 0.4813352
	speed: 0.0176s/iter; left time: 306.5959s
	iters: 1100, epoch: 4 | loss: 0.5093721
	speed: 0.0176s/iter; left time: 305.9859s
	iters: 1200, epoch: 4 | loss: 0.5390047
	speed: 0.0176s/iter; left time: 303.3540s
	iters: 1300, epoch: 4 | loss: 0.4478400
	speed: 0.0176s/iter; left time: 301.4452s
	iters: 1400, epoch: 4 | loss: 0.5577727
	speed: 0.0176s/iter; left time: 300.1245s
	iters: 1500, epoch: 4 | loss: 0.5654723
	speed: 0.0176s/iter; left time: 297.8142s
	iters: 1600, epoch: 4 | loss: 0.4469185
	speed: 0.0177s/iter; left time: 298.1410s
	iters: 1700, epoch: 4 | loss: 0.4602139
	speed: 0.0176s/iter; left time: 294.7235s
	iters: 1800, epoch: 4 | loss: 0.4950891
	speed: 0.0176s/iter; left time: 292.8919s
	iters: 1900, epoch: 4 | loss: 0.4340741
	speed: 0.0176s/iter; left time: 291.0084s
	iters: 2000, epoch: 4 | loss: 0.4366864
	speed: 0.0176s/iter; left time: 289.2283s
	iters: 2100, epoch: 4 | loss: 0.4771375
	speed: 0.0176s/iter; left time: 287.8099s
	iters: 2200, epoch: 4 | loss: 0.4746879
	speed: 0.0176s/iter; left time: 286.5156s
	iters: 2300, epoch: 4 | loss: 0.4308209
	speed: 0.0176s/iter; left time: 283.6829s
	iters: 2400, epoch: 4 | loss: 0.4842344
	speed: 0.0176s/iter; left time: 282.5495s
	iters: 2500, epoch: 4 | loss: 0.5265712
	speed: 0.0175s/iter; left time: 279.8830s
	iters: 2600, epoch: 4 | loss: 0.5501491
	speed: 0.0176s/iter; left time: 278.4684s
Epoch: 4 cost time: 46.67080521583557
Epoch: 4, Steps: 2637 | Train Loss: 0.4808260 Vali Loss: 2.5054743 Test Loss: 1.0008526
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems10_all_96_336_Mamba_custom_ftM_sl336_ll48_pl336_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 141085
test shape: (14108, 1, 336, 107) (14108, 1, 336, 107)
test shape: (14108, 336, 107) (14108, 336, 107)
mse:1.0214965343475342, mae:0.7640124559402466
>>>>>>>Overall time: 441 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
