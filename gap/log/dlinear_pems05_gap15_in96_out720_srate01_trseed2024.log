Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=103, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems05_all_common_flow.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems05_all_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_720_DLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 600151
val 94388
test 94387
	iters: 100, epoch: 1 | loss: 1.4344895
	speed: 0.0264s/iter; left time: 9904.5965s
	iters: 200, epoch: 1 | loss: 1.3523874
	speed: 0.0233s/iter; left time: 8745.8773s
	iters: 300, epoch: 1 | loss: 1.4043766
	speed: 0.0233s/iter; left time: 8745.2797s
	iters: 400, epoch: 1 | loss: 1.1593145
	speed: 0.0234s/iter; left time: 8749.2297s
	iters: 500, epoch: 1 | loss: 1.3770635
	speed: 0.0234s/iter; left time: 8772.1546s
	iters: 600, epoch: 1 | loss: 1.3437164
	speed: 0.0234s/iter; left time: 8759.7985s
	iters: 700, epoch: 1 | loss: 1.4312843
	speed: 0.0234s/iter; left time: 8754.1632s
	iters: 800, epoch: 1 | loss: 1.3554513
	speed: 0.0234s/iter; left time: 8750.8573s
	iters: 900, epoch: 1 | loss: 1.2741185
	speed: 0.0235s/iter; left time: 8799.3541s
	iters: 1000, epoch: 1 | loss: 1.3285542
	speed: 0.0235s/iter; left time: 8785.8050s
	iters: 1100, epoch: 1 | loss: 1.3260373
	speed: 0.0235s/iter; left time: 8773.5920s
	iters: 1200, epoch: 1 | loss: 1.4491183
	speed: 0.0235s/iter; left time: 8785.4470s
	iters: 1300, epoch: 1 | loss: 1.3366132
	speed: 0.0234s/iter; left time: 8762.9821s
	iters: 1400, epoch: 1 | loss: 1.3670115
	speed: 0.0234s/iter; left time: 8759.7241s
	iters: 1500, epoch: 1 | loss: 1.2911620
	speed: 0.0236s/iter; left time: 8803.4413s
	iters: 1600, epoch: 1 | loss: 1.3864350
	speed: 0.0235s/iter; left time: 8773.5281s
	iters: 1700, epoch: 1 | loss: 1.2495065
	speed: 0.0236s/iter; left time: 8796.0234s
	iters: 1800, epoch: 1 | loss: 1.2926157
	speed: 0.0235s/iter; left time: 8784.1384s
Epoch: 1 cost time: 44.336817026138306
Epoch: 1, Steps: 1875 | Train Loss: 1.3348842 Vali Loss: 1.5105205 Test Loss: 1.9811711
Validation loss decreased (inf --> 1.510520).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4739944
	speed: 0.2951s/iter; left time: 110098.5763s
	iters: 200, epoch: 2 | loss: 1.2918236
	speed: 0.0234s/iter; left time: 8724.7281s
	iters: 300, epoch: 2 | loss: 1.4221425
	speed: 0.0233s/iter; left time: 8704.7717s
	iters: 400, epoch: 2 | loss: 1.3561412
	speed: 0.0234s/iter; left time: 8709.2421s
	iters: 500, epoch: 2 | loss: 1.3545799
	speed: 0.0234s/iter; left time: 8733.6360s
	iters: 600, epoch: 2 | loss: 1.3944070
	speed: 0.0234s/iter; left time: 8715.1506s
	iters: 700, epoch: 2 | loss: 1.2567821
	speed: 0.0234s/iter; left time: 8713.9894s
	iters: 800, epoch: 2 | loss: 1.2462119
	speed: 0.0234s/iter; left time: 8713.1737s
	iters: 900, epoch: 2 | loss: 1.3681964
	speed: 0.0235s/iter; left time: 8734.2766s
	iters: 1000, epoch: 2 | loss: 1.2956085
	speed: 0.0235s/iter; left time: 8744.3387s
	iters: 1100, epoch: 2 | loss: 1.2380811
	speed: 0.0236s/iter; left time: 8771.0445s
	iters: 1200, epoch: 2 | loss: 1.2372632
	speed: 0.0235s/iter; left time: 8738.5546s
	iters: 1300, epoch: 2 | loss: 1.3629625
	speed: 0.0235s/iter; left time: 8753.5149s
	iters: 1400, epoch: 2 | loss: 1.3321770
	speed: 0.0235s/iter; left time: 8743.1905s
	iters: 1500, epoch: 2 | loss: 1.2857459
	speed: 0.0235s/iter; left time: 8729.0720s
	iters: 1600, epoch: 2 | loss: 1.2267654
	speed: 0.0236s/iter; left time: 8781.0679s
	iters: 1700, epoch: 2 | loss: 1.3259044
	speed: 0.0235s/iter; left time: 8716.0891s
	iters: 1800, epoch: 2 | loss: 1.2244811
	speed: 0.0235s/iter; left time: 8717.9503s
Epoch: 2 cost time: 44.14044523239136
Epoch: 2, Steps: 1875 | Train Loss: 1.3244230 Vali Loss: 1.4850225 Test Loss: 1.8696373
Validation loss decreased (1.510520 --> 1.485023).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3405049
	speed: 0.2946s/iter; left time: 109358.2747s
	iters: 200, epoch: 3 | loss: 1.3706113
	speed: 0.0233s/iter; left time: 8631.1805s
	iters: 300, epoch: 3 | loss: 1.4531085
	speed: 0.0233s/iter; left time: 8627.4110s
	iters: 400, epoch: 3 | loss: 1.4676673
	speed: 0.0232s/iter; left time: 8611.9640s
	iters: 500, epoch: 3 | loss: 1.3115460
	speed: 0.0233s/iter; left time: 8634.9534s
	iters: 600, epoch: 3 | loss: 1.3748772
	speed: 0.0232s/iter; left time: 8611.7028s
	iters: 700, epoch: 3 | loss: 1.2007705
	speed: 0.0232s/iter; left time: 8605.3534s
	iters: 800, epoch: 3 | loss: 1.3528421
	speed: 0.0233s/iter; left time: 8628.1217s
	iters: 900, epoch: 3 | loss: 1.3659765
	speed: 0.0233s/iter; left time: 8614.7439s
	iters: 1000, epoch: 3 | loss: 1.3578511
	speed: 0.0233s/iter; left time: 8620.3316s
	iters: 1100, epoch: 3 | loss: 1.4433312
	speed: 0.0233s/iter; left time: 8618.4199s
	iters: 1200, epoch: 3 | loss: 1.3186808
	speed: 0.0233s/iter; left time: 8616.3218s
	iters: 1300, epoch: 3 | loss: 1.3440003
	speed: 0.0232s/iter; left time: 8600.5336s
	iters: 1400, epoch: 3 | loss: 1.2522012
	speed: 0.0233s/iter; left time: 8606.1211s
	iters: 1500, epoch: 3 | loss: 1.2468388
	speed: 0.0233s/iter; left time: 8606.4627s
	iters: 1600, epoch: 3 | loss: 1.2511123
	speed: 0.0233s/iter; left time: 8604.7370s
	iters: 1700, epoch: 3 | loss: 1.2425334
	speed: 0.0233s/iter; left time: 8612.9892s
	iters: 1800, epoch: 3 | loss: 1.3926598
	speed: 0.0233s/iter; left time: 8601.7612s
Epoch: 3 cost time: 43.77000069618225
Epoch: 3, Steps: 1875 | Train Loss: 1.3244356 Vali Loss: 1.5211540 Test Loss: 1.9620405
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 4 | loss: 1.3222636
	speed: 0.2940s/iter; left time: 108577.5016s
	iters: 200, epoch: 4 | loss: 1.3007829
	speed: 0.0235s/iter; left time: 8668.6012s
	iters: 300, epoch: 4 | loss: 1.2809048
	speed: 0.0234s/iter; left time: 8625.7052s
	iters: 400, epoch: 4 | loss: 1.3348324
	speed: 0.0234s/iter; left time: 8645.5666s
	iters: 500, epoch: 4 | loss: 1.3951626
	speed: 0.0234s/iter; left time: 8627.2471s
	iters: 600, epoch: 4 | loss: 1.4768949
	speed: 0.0235s/iter; left time: 8660.8442s
	iters: 700, epoch: 4 | loss: 1.2387290
	speed: 0.0234s/iter; left time: 8628.6767s
	iters: 800, epoch: 4 | loss: 1.2855892
	speed: 0.0234s/iter; left time: 8631.6448s
	iters: 900, epoch: 4 | loss: 1.3761946
	speed: 0.0235s/iter; left time: 8646.3602s
	iters: 1000, epoch: 4 | loss: 1.2873856
	speed: 0.0235s/iter; left time: 8652.4768s
	iters: 1100, epoch: 4 | loss: 1.2959939
	speed: 0.0234s/iter; left time: 8636.0065s
	iters: 1200, epoch: 4 | loss: 1.4655064
	speed: 0.0235s/iter; left time: 8668.0642s
	iters: 1300, epoch: 4 | loss: 1.4033935
	speed: 0.0234s/iter; left time: 8622.2469s
	iters: 1400, epoch: 4 | loss: 1.2401429
	speed: 0.0235s/iter; left time: 8630.3831s
	iters: 1500, epoch: 4 | loss: 1.2863172
	speed: 0.0234s/iter; left time: 8625.3477s
	iters: 1600, epoch: 4 | loss: 1.3719723
	speed: 0.0235s/iter; left time: 8636.1348s
	iters: 1700, epoch: 4 | loss: 1.2849084
	speed: 0.0235s/iter; left time: 8650.4991s
	iters: 1800, epoch: 4 | loss: 1.3717239
	speed: 0.0235s/iter; left time: 8625.8234s
Epoch: 4 cost time: 44.121572494506836
Epoch: 4, Steps: 1875 | Train Loss: 1.3244237 Vali Loss: 1.5087992 Test Loss: 1.9486120
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 5 | loss: 1.3293846
	speed: 0.2962s/iter; left time: 108825.3855s
	iters: 200, epoch: 5 | loss: 1.2823648
	speed: 0.0235s/iter; left time: 8646.2125s
	iters: 300, epoch: 5 | loss: 1.3204890
	speed: 0.0235s/iter; left time: 8630.1258s
	iters: 400, epoch: 5 | loss: 1.3528452
	speed: 0.0235s/iter; left time: 8629.2433s
	iters: 500, epoch: 5 | loss: 1.4130257
	speed: 0.0235s/iter; left time: 8641.3082s
	iters: 600, epoch: 5 | loss: 1.2912663
	speed: 0.0235s/iter; left time: 8629.2780s
	iters: 700, epoch: 5 | loss: 1.1962271
	speed: 0.0235s/iter; left time: 8615.2791s
	iters: 800, epoch: 5 | loss: 1.3402261
	speed: 0.0235s/iter; left time: 8615.0662s
	iters: 900, epoch: 5 | loss: 1.4500836
	speed: 0.0234s/iter; left time: 8593.4101s
	iters: 1000, epoch: 5 | loss: 1.2489076
	speed: 0.0235s/iter; left time: 8594.8112s
	iters: 1100, epoch: 5 | loss: 1.3407881
	speed: 0.0235s/iter; left time: 8604.5903s
	iters: 1200, epoch: 5 | loss: 1.4012140
	speed: 0.0234s/iter; left time: 8573.1216s
	iters: 1300, epoch: 5 | loss: 1.3236696
	speed: 0.0235s/iter; left time: 8598.7297s
	iters: 1400, epoch: 5 | loss: 1.3313932
	speed: 0.0235s/iter; left time: 8588.5076s
	iters: 1500, epoch: 5 | loss: 1.3841937
	speed: 0.0234s/iter; left time: 8564.4816s
	iters: 1600, epoch: 5 | loss: 1.3489317
	speed: 0.0234s/iter; left time: 8565.8326s
	iters: 1700, epoch: 5 | loss: 1.3238875
	speed: 0.0234s/iter; left time: 8555.3589s
	iters: 1800, epoch: 5 | loss: 1.3680344
	speed: 0.0234s/iter; left time: 8542.3123s
Epoch: 5 cost time: 44.15747952461243
Epoch: 5, Steps: 1875 | Train Loss: 1.3244347 Vali Loss: 1.5019797 Test Loss: 1.9795957
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 6 | loss: 1.3468413
	speed: 0.2957s/iter; left time: 108094.2273s
	iters: 200, epoch: 6 | loss: 1.2459328
	speed: 0.0236s/iter; left time: 8609.5975s
	iters: 300, epoch: 6 | loss: 1.3980309
	speed: 0.0236s/iter; left time: 8610.4006s
	iters: 400, epoch: 6 | loss: 1.2823318
	speed: 0.0235s/iter; left time: 8600.1311s
	iters: 500, epoch: 6 | loss: 1.3102612
	speed: 0.0236s/iter; left time: 8611.0197s
	iters: 600, epoch: 6 | loss: 1.2864949
	speed: 0.0235s/iter; left time: 8590.5001s
	iters: 700, epoch: 6 | loss: 1.1845992
	speed: 0.0235s/iter; left time: 8587.8787s
	iters: 800, epoch: 6 | loss: 1.3366258
	speed: 0.0235s/iter; left time: 8576.3880s
	iters: 900, epoch: 6 | loss: 1.4421064
	speed: 0.0235s/iter; left time: 8577.6703s
	iters: 1000, epoch: 6 | loss: 1.1897773
	speed: 0.0236s/iter; left time: 8611.1099s
	iters: 1100, epoch: 6 | loss: 1.4252198
	speed: 0.0235s/iter; left time: 8580.2089s
	iters: 1200, epoch: 6 | loss: 1.2520126
	speed: 0.0235s/iter; left time: 8556.4551s
	iters: 1300, epoch: 6 | loss: 1.3342589
	speed: 0.0236s/iter; left time: 8589.2359s
	iters: 1400, epoch: 6 | loss: 1.3336880
	speed: 0.0235s/iter; left time: 8545.6892s
	iters: 1500, epoch: 6 | loss: 1.3148620
	speed: 0.0235s/iter; left time: 8558.6952s
	iters: 1600, epoch: 6 | loss: 1.4005618
	speed: 0.0235s/iter; left time: 8541.0904s
	iters: 1700, epoch: 6 | loss: 1.4268354
	speed: 0.0236s/iter; left time: 8591.6076s
	iters: 1800, epoch: 6 | loss: 1.4060754
	speed: 0.0235s/iter; left time: 8547.1739s
Epoch: 6 cost time: 44.27123975753784
Epoch: 6, Steps: 1875 | Train Loss: 1.3246408 Vali Loss: 1.5156794 Test Loss: 1.9976670
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 7 | loss: 1.3032125
	speed: 0.2951s/iter; left time: 107314.4271s
	iters: 200, epoch: 7 | loss: 1.4256860
	speed: 0.0237s/iter; left time: 8634.0441s
	iters: 300, epoch: 7 | loss: 1.3127415
	speed: 0.0237s/iter; left time: 8608.4938s
	iters: 400, epoch: 7 | loss: 1.4404155
	speed: 0.0237s/iter; left time: 8599.2615s
	iters: 500, epoch: 7 | loss: 1.2846798
	speed: 0.0237s/iter; left time: 8600.4587s
	iters: 600, epoch: 7 | loss: 1.2786022
	speed: 0.0237s/iter; left time: 8597.3898s
	iters: 700, epoch: 7 | loss: 1.3815672
	speed: 0.0236s/iter; left time: 8578.9381s
	iters: 800, epoch: 7 | loss: 1.3136555
	speed: 0.0236s/iter; left time: 8579.3935s
	iters: 900, epoch: 7 | loss: 1.1975299
	speed: 0.0237s/iter; left time: 8586.2171s
	iters: 1000, epoch: 7 | loss: 1.3336334
	speed: 0.0236s/iter; left time: 8577.2536s
	iters: 1100, epoch: 7 | loss: 1.2051582
	speed: 0.0236s/iter; left time: 8560.8069s
	iters: 1200, epoch: 7 | loss: 1.3982258
	speed: 0.0237s/iter; left time: 8578.3627s
	iters: 1300, epoch: 7 | loss: 1.2247519
	speed: 0.0236s/iter; left time: 8569.2052s
	iters: 1400, epoch: 7 | loss: 1.4588621
	speed: 0.0233s/iter; left time: 8457.2641s
	iters: 1500, epoch: 7 | loss: 1.4006871
	speed: 0.0233s/iter; left time: 8428.0595s
	iters: 1600, epoch: 7 | loss: 1.3276486
	speed: 0.0233s/iter; left time: 8422.2144s
	iters: 1700, epoch: 7 | loss: 1.2602774
	speed: 0.0233s/iter; left time: 8423.2544s
	iters: 1800, epoch: 7 | loss: 1.2484906
	speed: 0.0232s/iter; left time: 8413.9094s
Epoch: 7 cost time: 44.30834484100342
Epoch: 7, Steps: 1875 | Train Loss: 1.3245008 Vali Loss: 1.5126384 Test Loss: 1.9545996
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems05_all_96_720_DLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 94387
test shape: (9438, 1, 720, 103) (9438, 1, 720, 103)
test shape: (9438, 720, 103) (9438, 720, 103)
mse:1.8696329593658447, mae:1.1233268976211548
>>>>>>>Overall time: 563 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
