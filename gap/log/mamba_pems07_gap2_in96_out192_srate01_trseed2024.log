Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=1613, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems07_all_filter10.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=1613, expand=2, factor=1, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems07_all_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=192, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems07_all_96_192_Mamba_custom_ftM_sl192_ll48_pl192_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1164145
val 247825
test 247825
	iters: 100, epoch: 1 | loss: 0.6381565
	speed: 0.2029s/iter; left time: 7359.0403s
	iters: 200, epoch: 1 | loss: 0.5676951
	speed: 0.1679s/iter; left time: 6071.4740s
	iters: 300, epoch: 1 | loss: 0.6539560
	speed: 0.1678s/iter; left time: 6053.7653s
	iters: 400, epoch: 1 | loss: 0.5547516
	speed: 0.1678s/iter; left time: 6035.1643s
	iters: 500, epoch: 1 | loss: 0.5723447
	speed: 0.1677s/iter; left time: 6017.2536s
	iters: 600, epoch: 1 | loss: 0.4862148
	speed: 0.1680s/iter; left time: 6009.1425s
	iters: 700, epoch: 1 | loss: 0.4745332
	speed: 0.1678s/iter; left time: 5985.8495s
	iters: 800, epoch: 1 | loss: 0.4668809
	speed: 0.1681s/iter; left time: 5978.5434s
	iters: 900, epoch: 1 | loss: 0.4954277
	speed: 0.1681s/iter; left time: 5960.9328s
	iters: 1000, epoch: 1 | loss: 0.4698677
	speed: 0.1680s/iter; left time: 5940.6718s
	iters: 1100, epoch: 1 | loss: 0.4632488
	speed: 0.1679s/iter; left time: 5922.5221s
	iters: 1200, epoch: 1 | loss: 0.4426407
	speed: 0.1682s/iter; left time: 5914.0834s
	iters: 1300, epoch: 1 | loss: 0.4568389
	speed: 0.1687s/iter; left time: 5914.9088s
	iters: 1400, epoch: 1 | loss: 0.4269128
	speed: 0.1731s/iter; left time: 6054.9948s
	iters: 1500, epoch: 1 | loss: 0.4384643
	speed: 0.2073s/iter; left time: 7228.7044s
	iters: 1600, epoch: 1 | loss: 0.4273836
	speed: 0.1690s/iter; left time: 5877.7418s
	iters: 1700, epoch: 1 | loss: 0.5042266
	speed: 0.1672s/iter; left time: 5797.8590s
	iters: 1800, epoch: 1 | loss: 0.4300135
	speed: 0.1676s/iter; left time: 5793.2001s
	iters: 1900, epoch: 1 | loss: 0.4185157
	speed: 0.1677s/iter; left time: 5779.1536s
	iters: 2000, epoch: 1 | loss: 0.4392793
	speed: 0.1679s/iter; left time: 5770.3028s
	iters: 2100, epoch: 1 | loss: 0.4298922
	speed: 0.1679s/iter; left time: 5754.3146s
	iters: 2200, epoch: 1 | loss: 0.4120226
	speed: 0.1681s/iter; left time: 5742.7687s
	iters: 2300, epoch: 1 | loss: 0.3917117
	speed: 0.1677s/iter; left time: 5714.2219s
	iters: 2400, epoch: 1 | loss: 0.4121015
	speed: 0.1679s/iter; left time: 5704.1520s
	iters: 2500, epoch: 1 | loss: 0.4054070
	speed: 0.1684s/iter; left time: 5703.9802s
	iters: 2600, epoch: 1 | loss: 0.4320253
	speed: 0.1685s/iter; left time: 5690.9078s
	iters: 2700, epoch: 1 | loss: 0.3932131
	speed: 0.1682s/iter; left time: 5663.3841s
	iters: 2800, epoch: 1 | loss: 0.4023352
	speed: 0.1686s/iter; left time: 5660.5228s
	iters: 2900, epoch: 1 | loss: 0.3872420
	speed: 0.1677s/iter; left time: 5613.7777s
	iters: 3000, epoch: 1 | loss: 0.3942162
	speed: 0.1679s/iter; left time: 5604.2182s
	iters: 3100, epoch: 1 | loss: 0.3862249
	speed: 0.1686s/iter; left time: 5609.5756s
	iters: 3200, epoch: 1 | loss: 0.4040111
	speed: 0.1678s/iter; left time: 5565.9782s
	iters: 3300, epoch: 1 | loss: 0.4118254
	speed: 0.1690s/iter; left time: 5589.2484s
	iters: 3400, epoch: 1 | loss: 0.4076893
	speed: 0.1670s/iter; left time: 5506.5263s
	iters: 3500, epoch: 1 | loss: 0.3855726
	speed: 0.1664s/iter; left time: 5470.4475s
	iters: 3600, epoch: 1 | loss: 0.3676523
	speed: 0.1667s/iter; left time: 5462.9298s
Epoch: 1 cost time: 619.305299282074
Epoch: 1, Steps: 3637 | Train Loss: 0.4689158 Vali Loss: 1.0259979 Test Loss: 1.3691690
Validation loss decreased (inf --> 1.025998).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3879558
	speed: 3.5528s/iter; left time: 115941.2069s
	iters: 200, epoch: 2 | loss: 0.3989659
	speed: 0.1726s/iter; left time: 5616.2316s
	iters: 300, epoch: 2 | loss: 0.3689695
	speed: 0.1729s/iter; left time: 5608.5291s
	iters: 400, epoch: 2 | loss: 0.4560812
	speed: 0.1728s/iter; left time: 5586.8467s
	iters: 500, epoch: 2 | loss: 0.4345502
	speed: 0.1729s/iter; left time: 5573.1304s
	iters: 600, epoch: 2 | loss: 0.3886722
	speed: 0.1731s/iter; left time: 5561.7660s
	iters: 700, epoch: 2 | loss: 0.3668619
	speed: 0.1728s/iter; left time: 5536.8249s
	iters: 800, epoch: 2 | loss: 0.3761498
	speed: 0.1730s/iter; left time: 5524.7853s
	iters: 900, epoch: 2 | loss: 0.4172574
	speed: 0.1730s/iter; left time: 5507.7042s
	iters: 1000, epoch: 2 | loss: 0.4061209
	speed: 0.1739s/iter; left time: 5518.1891s
	iters: 1100, epoch: 2 | loss: 0.3834755
	speed: 0.1946s/iter; left time: 6157.1261s
	iters: 1200, epoch: 2 | loss: 0.3747321
	speed: 0.2087s/iter; left time: 6582.5842s
	iters: 1300, epoch: 2 | loss: 0.3750666
	speed: 0.2040s/iter; left time: 6413.8554s
	iters: 1400, epoch: 2 | loss: 0.3650864
	speed: 0.1673s/iter; left time: 5242.1834s
	iters: 1500, epoch: 2 | loss: 0.3656736
	speed: 0.1664s/iter; left time: 5196.8281s
	iters: 1600, epoch: 2 | loss: 0.3680751
	speed: 0.1658s/iter; left time: 5163.2807s
	iters: 1700, epoch: 2 | loss: 0.3806082
	speed: 0.1658s/iter; left time: 5145.6752s
	iters: 1800, epoch: 2 | loss: 0.3279149
	speed: 0.1661s/iter; left time: 5137.7199s
	iters: 1900, epoch: 2 | loss: 0.3638795
	speed: 0.1722s/iter; left time: 5308.3935s
	iters: 2000, epoch: 2 | loss: 0.3736335
	speed: 0.1721s/iter; left time: 5287.8732s
	iters: 2100, epoch: 2 | loss: 0.3377548
	speed: 0.1720s/iter; left time: 5270.2962s
	iters: 2200, epoch: 2 | loss: 0.3533497
	speed: 0.1721s/iter; left time: 5255.4939s
	iters: 2300, epoch: 2 | loss: 0.3412794
	speed: 0.1721s/iter; left time: 5237.2074s
	iters: 2400, epoch: 2 | loss: 0.4017200
	speed: 0.1721s/iter; left time: 5221.0699s
	iters: 2500, epoch: 2 | loss: 0.3477009
	speed: 0.1721s/iter; left time: 5204.6375s
	iters: 2600, epoch: 2 | loss: 0.3427674
	speed: 0.1722s/iter; left time: 5189.3811s
	iters: 2700, epoch: 2 | loss: 0.3710366
	speed: 0.1722s/iter; left time: 5171.2111s
	iters: 2800, epoch: 2 | loss: 0.3804564
	speed: 0.1720s/iter; left time: 5150.0174s
	iters: 2900, epoch: 2 | loss: 0.3825097
	speed: 0.1670s/iter; left time: 4982.3418s
	iters: 3000, epoch: 2 | loss: 0.3222592
	speed: 0.1695s/iter; left time: 5038.7656s
	iters: 3100, epoch: 2 | loss: 0.3432812
	speed: 0.1720s/iter; left time: 5097.0130s
	iters: 3200, epoch: 2 | loss: 0.3476961
	speed: 0.1720s/iter; left time: 5080.9567s
	iters: 3300, epoch: 2 | loss: 0.3999637
	speed: 0.1720s/iter; left time: 5062.3211s
	iters: 3400, epoch: 2 | loss: 0.3382567
	speed: 0.1721s/iter; left time: 5047.1585s
	iters: 3500, epoch: 2 | loss: 0.3237552
	speed: 0.1721s/iter; left time: 5029.9959s
	iters: 3600, epoch: 2 | loss: 0.3503551
	speed: 0.1720s/iter; left time: 5011.8671s
Epoch: 2 cost time: 634.0505068302155
Epoch: 2, Steps: 3637 | Train Loss: 0.3658182 Vali Loss: 1.0614469 Test Loss: 1.3459002
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3680900
	speed: 3.6484s/iter; left time: 105792.6611s
	iters: 200, epoch: 3 | loss: 0.3385323
	speed: 0.1722s/iter; left time: 4975.5145s
	iters: 300, epoch: 3 | loss: 0.3243952
	speed: 0.1722s/iter; left time: 4957.6158s
	iters: 400, epoch: 3 | loss: 0.3802240
	speed: 0.1721s/iter; left time: 4938.7877s
	iters: 500, epoch: 3 | loss: 0.3318870
	speed: 0.1722s/iter; left time: 4923.6000s
	iters: 600, epoch: 3 | loss: 0.3461362
	speed: 0.1721s/iter; left time: 4904.2357s
	iters: 700, epoch: 3 | loss: 0.3427111
	speed: 0.1721s/iter; left time: 4887.1014s
	iters: 800, epoch: 3 | loss: 0.3055602
	speed: 0.1721s/iter; left time: 4869.0209s
	iters: 900, epoch: 3 | loss: 0.3474701
	speed: 0.1721s/iter; left time: 4851.6846s
	iters: 1000, epoch: 3 | loss: 0.3108767
	speed: 0.1726s/iter; left time: 4848.9053s
	iters: 1100, epoch: 3 | loss: 0.3258392
	speed: 0.2127s/iter; left time: 5955.2855s
	iters: 1200, epoch: 3 | loss: 0.2812004
	speed: 0.2075s/iter; left time: 5789.2306s
	iters: 1300, epoch: 3 | loss: 0.3873296
	speed: 0.1873s/iter; left time: 5205.2460s
	iters: 1400, epoch: 3 | loss: 0.3485019
	speed: 0.1693s/iter; left time: 4689.4807s
	iters: 1500, epoch: 3 | loss: 0.3899640
	speed: 0.1710s/iter; left time: 4720.4261s
	iters: 1600, epoch: 3 | loss: 0.3261290
	speed: 0.1720s/iter; left time: 4728.3310s
	iters: 1700, epoch: 3 | loss: 0.3080662
	speed: 0.1719s/iter; left time: 4710.4156s
	iters: 1800, epoch: 3 | loss: 0.3346710
	speed: 0.1719s/iter; left time: 4692.9695s
	iters: 1900, epoch: 3 | loss: 0.3072059
	speed: 0.1696s/iter; left time: 4612.4254s
	iters: 2000, epoch: 3 | loss: 0.3197965
	speed: 0.1701s/iter; left time: 4607.9654s
	iters: 2100, epoch: 3 | loss: 0.3177905
	speed: 0.1698s/iter; left time: 4583.7746s
	iters: 2200, epoch: 3 | loss: 0.3136528
	speed: 0.1702s/iter; left time: 4577.8657s
	iters: 2300, epoch: 3 | loss: 0.2872719
	speed: 0.1716s/iter; left time: 4599.2317s
	iters: 2400, epoch: 3 | loss: 0.3109678
	speed: 0.1720s/iter; left time: 4592.1560s
	iters: 2500, epoch: 3 | loss: 0.3568486
	speed: 0.1720s/iter; left time: 4575.1947s
	iters: 2600, epoch: 3 | loss: 0.3042870
	speed: 0.1720s/iter; left time: 4557.8708s
	iters: 2700, epoch: 3 | loss: 0.3075189
	speed: 0.1720s/iter; left time: 4540.2943s
	iters: 2800, epoch: 3 | loss: 0.3255672
	speed: 0.1721s/iter; left time: 4525.5594s
	iters: 2900, epoch: 3 | loss: 0.3268362
	speed: 0.1721s/iter; left time: 4509.4926s
	iters: 3000, epoch: 3 | loss: 0.2840789
	speed: 0.1720s/iter; left time: 4489.9651s
	iters: 3100, epoch: 3 | loss: 0.3178449
	speed: 0.1721s/iter; left time: 4473.4975s
	iters: 3200, epoch: 3 | loss: 0.2851395
	speed: 0.1722s/iter; left time: 4458.9051s
	iters: 3300, epoch: 3 | loss: 0.3211100
	speed: 0.1700s/iter; left time: 4386.7382s
	iters: 3400, epoch: 3 | loss: 0.3099170
	speed: 0.1700s/iter; left time: 4369.1269s
	iters: 3500, epoch: 3 | loss: 0.2975599
	speed: 0.1722s/iter; left time: 4409.0705s
	iters: 3600, epoch: 3 | loss: 0.3019929
	speed: 0.1721s/iter; left time: 4388.2679s
Epoch: 3 cost time: 634.9313724040985
Epoch: 3, Steps: 3637 | Train Loss: 0.3260425 Vali Loss: 1.0747998 Test Loss: 1.3898028
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3294437
	speed: 3.7514s/iter; left time: 95134.4210s
	iters: 200, epoch: 4 | loss: 0.3325049
	speed: 0.1729s/iter; left time: 4368.1775s
	iters: 300, epoch: 4 | loss: 0.3223979
	speed: 0.2056s/iter; left time: 5172.8995s
	iters: 400, epoch: 4 | loss: 0.3235157
	speed: 0.1962s/iter; left time: 4915.5625s
	iters: 500, epoch: 4 | loss: 0.2939951
	speed: 0.2128s/iter; left time: 5312.2902s
	iters: 600, epoch: 4 | loss: 0.3029856
	speed: 0.1726s/iter; left time: 4291.3284s
	iters: 700, epoch: 4 | loss: 0.3291659
	speed: 0.1722s/iter; left time: 4263.0283s
	iters: 800, epoch: 4 | loss: 0.2850742
	speed: 0.1722s/iter; left time: 4246.1660s
	iters: 900, epoch: 4 | loss: 0.2910334
	speed: 0.1721s/iter; left time: 4227.1519s
	iters: 1000, epoch: 4 | loss: 0.3402986
	speed: 0.1722s/iter; left time: 4212.4933s
	iters: 1100, epoch: 4 | loss: 0.3234788
	speed: 0.1721s/iter; left time: 4193.1318s
	iters: 1200, epoch: 4 | loss: 0.3425955
	speed: 0.1722s/iter; left time: 4177.4660s
	iters: 1300, epoch: 4 | loss: 0.3007858
	speed: 0.1721s/iter; left time: 4157.5257s
	iters: 1400, epoch: 4 | loss: 0.3176945
	speed: 0.1726s/iter; left time: 4151.5760s
	iters: 1500, epoch: 4 | loss: 0.3083750
	speed: 0.1724s/iter; left time: 4130.1814s
	iters: 1600, epoch: 4 | loss: 0.3054017
	speed: 0.1720s/iter; left time: 4104.4573s
	iters: 1700, epoch: 4 | loss: 0.2866077
	speed: 0.1721s/iter; left time: 4088.2730s
	iters: 1800, epoch: 4 | loss: 0.3420935
	speed: 0.1720s/iter; left time: 4070.3831s
	iters: 1900, epoch: 4 | loss: 0.2739368
	speed: 0.1721s/iter; left time: 4054.0728s
	iters: 2000, epoch: 4 | loss: 0.3087087
	speed: 0.1721s/iter; left time: 4037.0806s
	iters: 2100, epoch: 4 | loss: 0.3166866
	speed: 0.1720s/iter; left time: 4018.7961s
	iters: 2200, epoch: 4 | loss: 0.3134351
	speed: 0.1721s/iter; left time: 4003.1735s
	iters: 2300, epoch: 4 | loss: 0.2829798
	speed: 0.1725s/iter; left time: 3995.1596s
	iters: 2400, epoch: 4 | loss: 0.2936381
	speed: 0.1723s/iter; left time: 3972.6627s
	iters: 2500, epoch: 4 | loss: 0.2956904
	speed: 0.1722s/iter; left time: 3952.6253s
	iters: 2600, epoch: 4 | loss: 0.3002156
	speed: 0.1721s/iter; left time: 3934.0218s
	iters: 2700, epoch: 4 | loss: 0.3163897
	speed: 0.1721s/iter; left time: 3917.1062s
	iters: 2800, epoch: 4 | loss: 0.2790846
	speed: 0.1721s/iter; left time: 3899.9708s
	iters: 2900, epoch: 4 | loss: 0.2810619
	speed: 0.1721s/iter; left time: 3882.1028s
	iters: 3000, epoch: 4 | loss: 0.3065922
	speed: 0.1730s/iter; left time: 3885.6553s
	iters: 3100, epoch: 4 | loss: 0.2737662
	speed: 0.1723s/iter; left time: 3852.3466s
	iters: 3200, epoch: 4 | loss: 0.3150889
	speed: 0.1721s/iter; left time: 3831.9208s
	iters: 3300, epoch: 4 | loss: 0.2936581
	speed: 0.1722s/iter; left time: 3815.4679s
	iters: 3400, epoch: 4 | loss: 0.2953236
	speed: 0.1722s/iter; left time: 3799.5510s
	iters: 3500, epoch: 4 | loss: 0.3123112
	speed: 0.1721s/iter; left time: 3779.7298s
	iters: 3600, epoch: 4 | loss: 0.2791231
	speed: 0.1722s/iter; left time: 3763.9996s
Epoch: 4 cost time: 638.0883595943451
Epoch: 4, Steps: 3637 | Train Loss: 0.3088662 Vali Loss: 1.0664979 Test Loss: 1.3540922
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems07_all_96_192_Mamba_custom_ftM_sl192_ll48_pl192_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 247825
test shape: (24782, 1, 192, 1613) (24782, 1, 192, 1613)
test shape: (24782, 192, 1613) (24782, 192, 1613)
mse:1.369136929512024, mae:0.8778271675109863
>>>>>>>Overall time: 6490 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
