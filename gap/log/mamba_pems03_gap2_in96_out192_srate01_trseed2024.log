Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=151, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems03_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=151, expand=2, factor=1, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems03_all_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=192, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_all_96_192_Mamba_custom_ftM_sl192_ll48_pl192_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1164566
val 247966
test 247965
	iters: 100, epoch: 1 | loss: 0.9946733
	speed: 0.0338s/iter; left time: 1228.3204s
	iters: 200, epoch: 1 | loss: 0.9633030
	speed: 0.0147s/iter; left time: 532.6748s
	iters: 300, epoch: 1 | loss: 0.8413355
	speed: 0.0147s/iter; left time: 531.7759s
	iters: 400, epoch: 1 | loss: 0.8806576
	speed: 0.0148s/iter; left time: 531.9376s
	iters: 500, epoch: 1 | loss: 0.7296722
	speed: 0.0145s/iter; left time: 521.6241s
	iters: 600, epoch: 1 | loss: 0.7126769
	speed: 0.0152s/iter; left time: 544.4675s
	iters: 700, epoch: 1 | loss: 0.6714216
	speed: 0.0147s/iter; left time: 525.7045s
	iters: 800, epoch: 1 | loss: 0.7006944
	speed: 0.0149s/iter; left time: 530.2765s
	iters: 900, epoch: 1 | loss: 0.7485829
	speed: 0.0152s/iter; left time: 540.1883s
	iters: 1000, epoch: 1 | loss: 0.6743159
	speed: 0.0150s/iter; left time: 531.7797s
	iters: 1100, epoch: 1 | loss: 0.6667906
	speed: 0.0151s/iter; left time: 532.2791s
	iters: 1200, epoch: 1 | loss: 0.6299267
	speed: 0.0150s/iter; left time: 528.9326s
	iters: 1300, epoch: 1 | loss: 0.7294168
	speed: 0.0151s/iter; left time: 528.7604s
	iters: 1400, epoch: 1 | loss: 0.6724450
	speed: 0.0151s/iter; left time: 526.7905s
	iters: 1500, epoch: 1 | loss: 0.7537785
	speed: 0.0151s/iter; left time: 526.0961s
	iters: 1600, epoch: 1 | loss: 0.6768546
	speed: 0.0151s/iter; left time: 524.0589s
	iters: 1700, epoch: 1 | loss: 0.7441458
	speed: 0.0151s/iter; left time: 523.7334s
	iters: 1800, epoch: 1 | loss: 0.6250430
	speed: 0.0155s/iter; left time: 537.0643s
	iters: 1900, epoch: 1 | loss: 0.6671612
	speed: 0.0152s/iter; left time: 524.3532s
	iters: 2000, epoch: 1 | loss: 0.7238860
	speed: 0.0155s/iter; left time: 532.7535s
	iters: 2100, epoch: 1 | loss: 0.6643940
	speed: 0.0154s/iter; left time: 527.1701s
	iters: 2200, epoch: 1 | loss: 0.6770014
	speed: 0.0153s/iter; left time: 521.7377s
	iters: 2300, epoch: 1 | loss: 0.5866268
	speed: 0.0153s/iter; left time: 523.0878s
	iters: 2400, epoch: 1 | loss: 0.6772751
	speed: 0.0154s/iter; left time: 524.3724s
	iters: 2500, epoch: 1 | loss: 0.6609142
	speed: 0.0154s/iter; left time: 523.2868s
	iters: 2600, epoch: 1 | loss: 0.6882345
	speed: 0.0157s/iter; left time: 529.1406s
	iters: 2700, epoch: 1 | loss: 0.6621797
	speed: 0.0153s/iter; left time: 514.9877s
	iters: 2800, epoch: 1 | loss: 0.6442789
	speed: 0.0154s/iter; left time: 518.2419s
	iters: 2900, epoch: 1 | loss: 0.5873220
	speed: 0.0154s/iter; left time: 516.6936s
	iters: 3000, epoch: 1 | loss: 0.7760405
	speed: 0.0154s/iter; left time: 514.8634s
	iters: 3100, epoch: 1 | loss: 0.6401692
	speed: 0.0153s/iter; left time: 510.6836s
	iters: 3200, epoch: 1 | loss: 0.6780858
	speed: 0.0155s/iter; left time: 515.3852s
	iters: 3300, epoch: 1 | loss: 0.6492521
	speed: 0.0153s/iter; left time: 505.5886s
	iters: 3400, epoch: 1 | loss: 0.5974743
	speed: 0.0155s/iter; left time: 512.7169s
	iters: 3500, epoch: 1 | loss: 0.5968052
	speed: 0.0154s/iter; left time: 508.1454s
	iters: 3600, epoch: 1 | loss: 0.6448634
	speed: 0.0157s/iter; left time: 514.3643s
Epoch: 1 cost time: 57.30672097206116
Epoch: 1, Steps: 3639 | Train Loss: 0.7097992 Vali Loss: 1.6981293 Test Loss: 1.2155885
Validation loss decreased (inf --> 1.698129).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6255648
	speed: 0.8123s/iter; left time: 26523.8613s
	iters: 200, epoch: 2 | loss: 0.6858004
	speed: 0.0153s/iter; left time: 499.2593s
	iters: 300, epoch: 2 | loss: 0.6726478
	speed: 0.0153s/iter; left time: 497.7190s
	iters: 400, epoch: 2 | loss: 0.6179793
	speed: 0.0153s/iter; left time: 496.5185s
	iters: 500, epoch: 2 | loss: 0.6063036
	speed: 0.0153s/iter; left time: 494.5351s
	iters: 600, epoch: 2 | loss: 0.5731929
	speed: 0.0153s/iter; left time: 493.4251s
	iters: 700, epoch: 2 | loss: 0.6036754
	speed: 0.0154s/iter; left time: 492.1682s
	iters: 800, epoch: 2 | loss: 0.5120551
	speed: 0.0154s/iter; left time: 490.4926s
	iters: 900, epoch: 2 | loss: 0.6137257
	speed: 0.0153s/iter; left time: 488.7397s
	iters: 1000, epoch: 2 | loss: 0.6612082
	speed: 0.0154s/iter; left time: 489.8200s
	iters: 1100, epoch: 2 | loss: 0.5933926
	speed: 0.0154s/iter; left time: 486.2619s
	iters: 1200, epoch: 2 | loss: 0.5661079
	speed: 0.0154s/iter; left time: 486.4795s
	iters: 1300, epoch: 2 | loss: 0.6410291
	speed: 0.0154s/iter; left time: 482.8921s
	iters: 1400, epoch: 2 | loss: 0.5650859
	speed: 0.0153s/iter; left time: 480.9422s
	iters: 1500, epoch: 2 | loss: 0.5724152
	speed: 0.0154s/iter; left time: 479.8498s
	iters: 1600, epoch: 2 | loss: 0.5717987
	speed: 0.0153s/iter; left time: 477.1536s
	iters: 1700, epoch: 2 | loss: 0.6780329
	speed: 0.0154s/iter; left time: 479.6128s
	iters: 1800, epoch: 2 | loss: 0.5744991
	speed: 0.0153s/iter; left time: 472.1742s
	iters: 1900, epoch: 2 | loss: 0.5533836
	speed: 0.0152s/iter; left time: 470.4061s
	iters: 2000, epoch: 2 | loss: 0.5983979
	speed: 0.0153s/iter; left time: 469.2335s
	iters: 2100, epoch: 2 | loss: 0.6060673
	speed: 0.0153s/iter; left time: 468.6759s
	iters: 2200, epoch: 2 | loss: 0.5448195
	speed: 0.0153s/iter; left time: 466.6626s
	iters: 2300, epoch: 2 | loss: 0.5817422
	speed: 0.0153s/iter; left time: 465.7285s
	iters: 2400, epoch: 2 | loss: 0.6476925
	speed: 0.0153s/iter; left time: 463.6460s
	iters: 2500, epoch: 2 | loss: 0.6238966
	speed: 0.0153s/iter; left time: 461.5130s
	iters: 2600, epoch: 2 | loss: 0.7318955
	speed: 0.0152s/iter; left time: 459.7098s
	iters: 2700, epoch: 2 | loss: 0.6307102
	speed: 0.0153s/iter; left time: 458.7509s
	iters: 2800, epoch: 2 | loss: 0.6160634
	speed: 0.0152s/iter; left time: 455.9721s
	iters: 2900, epoch: 2 | loss: 0.5418833
	speed: 0.0152s/iter; left time: 454.4321s
	iters: 3000, epoch: 2 | loss: 0.5604379
	speed: 0.0153s/iter; left time: 455.0307s
	iters: 3100, epoch: 2 | loss: 0.5853653
	speed: 0.0153s/iter; left time: 452.4778s
	iters: 3200, epoch: 2 | loss: 0.5407997
	speed: 0.0153s/iter; left time: 451.0710s
	iters: 3300, epoch: 2 | loss: 0.5460307
	speed: 0.0153s/iter; left time: 450.2093s
	iters: 3400, epoch: 2 | loss: 0.5665072
	speed: 0.0153s/iter; left time: 448.4610s
	iters: 3500, epoch: 2 | loss: 0.5743186
	speed: 0.0153s/iter; left time: 447.6478s
	iters: 3600, epoch: 2 | loss: 0.5694150
	speed: 0.0153s/iter; left time: 445.0816s
Epoch: 2 cost time: 56.01866364479065
Epoch: 2, Steps: 3639 | Train Loss: 0.6009094 Vali Loss: 1.7116686 Test Loss: 1.2361466
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5968378
	speed: 0.6316s/iter; left time: 18325.9326s
	iters: 200, epoch: 3 | loss: 0.6156734
	speed: 0.0155s/iter; left time: 448.7860s
	iters: 300, epoch: 3 | loss: 0.5859113
	speed: 0.0156s/iter; left time: 449.5379s
	iters: 400, epoch: 3 | loss: 0.6021357
	speed: 0.0155s/iter; left time: 446.0798s
	iters: 500, epoch: 3 | loss: 0.5729961
	speed: 0.0155s/iter; left time: 444.6292s
	iters: 600, epoch: 3 | loss: 0.5653762
	speed: 0.0156s/iter; left time: 444.6408s
	iters: 700, epoch: 3 | loss: 0.6285930
	speed: 0.0155s/iter; left time: 441.3705s
	iters: 800, epoch: 3 | loss: 0.6195493
	speed: 0.0155s/iter; left time: 439.7136s
	iters: 900, epoch: 3 | loss: 0.5955186
	speed: 0.0155s/iter; left time: 438.2955s
	iters: 1000, epoch: 3 | loss: 0.6023241
	speed: 0.0155s/iter; left time: 436.1965s
	iters: 1100, epoch: 3 | loss: 0.6383567
	speed: 0.0155s/iter; left time: 434.4136s
	iters: 1200, epoch: 3 | loss: 0.6148261
	speed: 0.0155s/iter; left time: 433.1657s
	iters: 1300, epoch: 3 | loss: 0.5460582
	speed: 0.0156s/iter; left time: 432.6944s
	iters: 1400, epoch: 3 | loss: 0.5866197
	speed: 0.0156s/iter; left time: 431.1826s
	iters: 1500, epoch: 3 | loss: 0.5184295
	speed: 0.0155s/iter; left time: 428.3114s
	iters: 1600, epoch: 3 | loss: 0.5690836
	speed: 0.0155s/iter; left time: 426.0959s
	iters: 1700, epoch: 3 | loss: 0.5348936
	speed: 0.0155s/iter; left time: 425.6104s
	iters: 1800, epoch: 3 | loss: 0.5813830
	speed: 0.0155s/iter; left time: 422.0646s
	iters: 1900, epoch: 3 | loss: 0.5265377
	speed: 0.0155s/iter; left time: 421.5137s
	iters: 2000, epoch: 3 | loss: 0.5807138
	speed: 0.0156s/iter; left time: 421.6369s
	iters: 2100, epoch: 3 | loss: 0.6100810
	speed: 0.0156s/iter; left time: 420.5667s
	iters: 2200, epoch: 3 | loss: 0.5687383
	speed: 0.0155s/iter; left time: 416.1143s
	iters: 2300, epoch: 3 | loss: 0.5714712
	speed: 0.0155s/iter; left time: 414.7253s
	iters: 2400, epoch: 3 | loss: 0.4988872
	speed: 0.0155s/iter; left time: 412.9604s
	iters: 2500, epoch: 3 | loss: 0.5796271
	speed: 0.0155s/iter; left time: 412.4488s
	iters: 2600, epoch: 3 | loss: 0.6042126
	speed: 0.0154s/iter; left time: 409.2658s
	iters: 2700, epoch: 3 | loss: 0.5972314
	speed: 0.0154s/iter; left time: 407.8319s
	iters: 2800, epoch: 3 | loss: 0.5506533
	speed: 0.0154s/iter; left time: 406.2780s
	iters: 2900, epoch: 3 | loss: 0.4631342
	speed: 0.0155s/iter; left time: 405.0007s
	iters: 3000, epoch: 3 | loss: 0.4957757
	speed: 0.0154s/iter; left time: 402.4457s
	iters: 3100, epoch: 3 | loss: 0.5148990
	speed: 0.0154s/iter; left time: 401.1981s
	iters: 3200, epoch: 3 | loss: 0.5479832
	speed: 0.0154s/iter; left time: 399.4400s
	iters: 3300, epoch: 3 | loss: 0.5959135
	speed: 0.0154s/iter; left time: 398.4259s
	iters: 3400, epoch: 3 | loss: 0.6277622
	speed: 0.0154s/iter; left time: 396.5752s
	iters: 3500, epoch: 3 | loss: 0.5593499
	speed: 0.0154s/iter; left time: 394.9811s
	iters: 3600, epoch: 3 | loss: 0.5984223
	speed: 0.0154s/iter; left time: 392.7529s
Epoch: 3 cost time: 56.69783306121826
Epoch: 3, Steps: 3639 | Train Loss: 0.5744595 Vali Loss: 1.7474413 Test Loss: 1.2709112
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5589756
	speed: 0.6348s/iter; left time: 16106.2826s
	iters: 200, epoch: 4 | loss: 0.6254614
	speed: 0.0154s/iter; left time: 388.4349s
	iters: 300, epoch: 4 | loss: 0.5565775
	speed: 0.0154s/iter; left time: 386.9107s
	iters: 400, epoch: 4 | loss: 0.4989099
	speed: 0.0153s/iter; left time: 384.6661s
	iters: 500, epoch: 4 | loss: 0.5874398
	speed: 0.0153s/iter; left time: 383.2819s
	iters: 600, epoch: 4 | loss: 0.7750784
	speed: 0.0153s/iter; left time: 381.5285s
	iters: 700, epoch: 4 | loss: 0.5954776
	speed: 0.0154s/iter; left time: 380.2868s
	iters: 800, epoch: 4 | loss: 0.5351185
	speed: 0.0153s/iter; left time: 378.4508s
	iters: 900, epoch: 4 | loss: 0.6161368
	speed: 0.0153s/iter; left time: 376.9166s
	iters: 1000, epoch: 4 | loss: 0.5623577
	speed: 0.0153s/iter; left time: 375.5258s
	iters: 1100, epoch: 4 | loss: 0.5239145
	speed: 0.0154s/iter; left time: 374.6575s
	iters: 1200, epoch: 4 | loss: 0.5585297
	speed: 0.0154s/iter; left time: 372.8262s
	iters: 1300, epoch: 4 | loss: 0.6050362
	speed: 0.0153s/iter; left time: 370.8335s
	iters: 1400, epoch: 4 | loss: 0.5457625
	speed: 0.0154s/iter; left time: 369.7667s
	iters: 1500, epoch: 4 | loss: 0.5390342
	speed: 0.0154s/iter; left time: 368.3968s
	iters: 1600, epoch: 4 | loss: 0.6050193
	speed: 0.0154s/iter; left time: 366.9376s
	iters: 1700, epoch: 4 | loss: 0.5971786
	speed: 0.0154s/iter; left time: 365.0889s
	iters: 1800, epoch: 4 | loss: 0.5491790
	speed: 0.0154s/iter; left time: 364.0418s
	iters: 1900, epoch: 4 | loss: 0.5978558
	speed: 0.0155s/iter; left time: 364.8905s
	iters: 2000, epoch: 4 | loss: 0.6010562
	speed: 0.0154s/iter; left time: 360.9103s
	iters: 2100, epoch: 4 | loss: 0.6248248
	speed: 0.0154s/iter; left time: 359.8176s
	iters: 2200, epoch: 4 | loss: 0.5086551
	speed: 0.0154s/iter; left time: 358.0172s
	iters: 2300, epoch: 4 | loss: 0.5341955
	speed: 0.0154s/iter; left time: 356.5517s
	iters: 2400, epoch: 4 | loss: 0.5926002
	speed: 0.0154s/iter; left time: 355.5782s
	iters: 2500, epoch: 4 | loss: 0.6018534
	speed: 0.0154s/iter; left time: 353.9600s
	iters: 2600, epoch: 4 | loss: 0.5525216
	speed: 0.0154s/iter; left time: 352.6795s
	iters: 2700, epoch: 4 | loss: 0.5364195
	speed: 0.0154s/iter; left time: 351.7907s
	iters: 2800, epoch: 4 | loss: 0.4811336
	speed: 0.0154s/iter; left time: 348.4502s
	iters: 2900, epoch: 4 | loss: 0.5194212
	speed: 0.0154s/iter; left time: 347.2352s
	iters: 3000, epoch: 4 | loss: 0.5569014
	speed: 0.0154s/iter; left time: 345.7206s
	iters: 3100, epoch: 4 | loss: 0.5357480
	speed: 0.0154s/iter; left time: 344.1329s
	iters: 3200, epoch: 4 | loss: 0.5341610
	speed: 0.0154s/iter; left time: 342.7530s
	iters: 3300, epoch: 4 | loss: 0.5843339
	speed: 0.0154s/iter; left time: 341.0515s
	iters: 3400, epoch: 4 | loss: 0.5235401
	speed: 0.0154s/iter; left time: 339.7865s
	iters: 3500, epoch: 4 | loss: 0.5800405
	speed: 0.0155s/iter; left time: 340.1369s
	iters: 3600, epoch: 4 | loss: 0.5796815
	speed: 0.0154s/iter; left time: 336.4464s
Epoch: 4 cost time: 56.28173041343689
Epoch: 4, Steps: 3639 | Train Loss: 0.5644624 Vali Loss: 1.7306501 Test Loss: 1.2642040
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems03_all_96_192_Mamba_custom_ftM_sl192_ll48_pl192_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 247965
test shape: (24796, 1, 192, 151) (24796, 1, 192, 151)
test shape: (24796, 192, 151) (24796, 192, 151)
mse:1.215585470199585, mae:0.7721022367477417
>>>>>>>Overall time: 662 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
