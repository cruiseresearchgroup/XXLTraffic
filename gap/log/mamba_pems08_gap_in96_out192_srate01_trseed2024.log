Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=212, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems08_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=212, expand=2, factor=1, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems08_all_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=192, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems08_all_96_192_Mamba_custom_ftM_sl192_ll48_pl192_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1348436
val 379337
test 379335
	iters: 100, epoch: 1 | loss: 0.9563961
	speed: 0.0439s/iter; left time: 1846.0682s
	iters: 200, epoch: 1 | loss: 0.7646230
	speed: 0.0243s/iter; left time: 1019.3105s
	iters: 300, epoch: 1 | loss: 0.7379833
	speed: 0.0243s/iter; left time: 1017.0372s
	iters: 400, epoch: 1 | loss: 0.7210442
	speed: 0.0243s/iter; left time: 1014.8204s
	iters: 500, epoch: 1 | loss: 0.7100953
	speed: 0.0240s/iter; left time: 1000.9131s
	iters: 600, epoch: 1 | loss: 0.6934785
	speed: 0.0239s/iter; left time: 994.5954s
	iters: 700, epoch: 1 | loss: 0.6337196
	speed: 0.0238s/iter; left time: 985.8218s
	iters: 800, epoch: 1 | loss: 0.6483489
	speed: 0.0245s/iter; left time: 1011.3336s
	iters: 900, epoch: 1 | loss: 0.6657048
	speed: 0.0244s/iter; left time: 1007.6060s
	iters: 1000, epoch: 1 | loss: 0.6720399
	speed: 0.0244s/iter; left time: 1004.4671s
	iters: 1100, epoch: 1 | loss: 0.6682506
	speed: 0.0244s/iter; left time: 1001.4492s
	iters: 1200, epoch: 1 | loss: 0.6176105
	speed: 0.0244s/iter; left time: 998.3028s
	iters: 1300, epoch: 1 | loss: 0.6725203
	speed: 0.0244s/iter; left time: 995.8118s
	iters: 1400, epoch: 1 | loss: 0.6422924
	speed: 0.0244s/iter; left time: 992.5896s
	iters: 1500, epoch: 1 | loss: 0.6347036
	speed: 0.0244s/iter; left time: 990.1010s
	iters: 1600, epoch: 1 | loss: 0.6057853
	speed: 0.0244s/iter; left time: 987.7547s
	iters: 1700, epoch: 1 | loss: 0.5492119
	speed: 0.0240s/iter; left time: 969.9374s
	iters: 1800, epoch: 1 | loss: 0.6140866
	speed: 0.0238s/iter; left time: 958.4876s
	iters: 1900, epoch: 1 | loss: 0.6022586
	speed: 0.0238s/iter; left time: 956.4343s
	iters: 2000, epoch: 1 | loss: 0.6439137
	speed: 0.0238s/iter; left time: 955.0189s
	iters: 2100, epoch: 1 | loss: 0.5513477
	speed: 0.0237s/iter; left time: 950.3709s
	iters: 2200, epoch: 1 | loss: 0.6012713
	speed: 0.0238s/iter; left time: 948.7383s
	iters: 2300, epoch: 1 | loss: 0.5410011
	speed: 0.0238s/iter; left time: 947.8410s
	iters: 2400, epoch: 1 | loss: 0.6055646
	speed: 0.0237s/iter; left time: 943.0051s
	iters: 2500, epoch: 1 | loss: 0.5720220
	speed: 0.0238s/iter; left time: 942.2910s
	iters: 2600, epoch: 1 | loss: 0.5823117
	speed: 0.0237s/iter; left time: 937.4720s
	iters: 2700, epoch: 1 | loss: 0.5951606
	speed: 0.0237s/iter; left time: 936.0324s
	iters: 2800, epoch: 1 | loss: 0.5273556
	speed: 0.0247s/iter; left time: 970.4401s
	iters: 2900, epoch: 1 | loss: 0.5765312
	speed: 0.0262s/iter; left time: 1028.3290s
	iters: 3000, epoch: 1 | loss: 0.6024008
	speed: 0.0244s/iter; left time: 955.3456s
	iters: 3100, epoch: 1 | loss: 0.5614160
	speed: 0.0245s/iter; left time: 954.4032s
	iters: 3200, epoch: 1 | loss: 0.5807601
	speed: 0.0247s/iter; left time: 963.1265s
	iters: 3300, epoch: 1 | loss: 0.6278157
	speed: 0.0246s/iter; left time: 955.0566s
	iters: 3400, epoch: 1 | loss: 0.5539865
	speed: 0.0244s/iter; left time: 945.5061s
	iters: 3500, epoch: 1 | loss: 0.5576522
	speed: 0.0238s/iter; left time: 920.9749s
	iters: 3600, epoch: 1 | loss: 0.5592453
	speed: 0.0239s/iter; left time: 922.0722s
	iters: 3700, epoch: 1 | loss: 0.5384058
	speed: 0.0239s/iter; left time: 917.9319s
	iters: 3800, epoch: 1 | loss: 0.4892646
	speed: 0.0238s/iter; left time: 913.8344s
	iters: 3900, epoch: 1 | loss: 0.4914019
	speed: 0.0238s/iter; left time: 908.4462s
	iters: 4000, epoch: 1 | loss: 0.5446734
	speed: 0.0238s/iter; left time: 906.7048s
	iters: 4100, epoch: 1 | loss: 0.5129716
	speed: 0.0238s/iter; left time: 906.2103s
	iters: 4200, epoch: 1 | loss: 0.5383382
	speed: 0.0238s/iter; left time: 901.6320s
Epoch: 1 cost time: 103.81730842590332
Epoch: 1, Steps: 4213 | Train Loss: 0.6155139 Vali Loss: 8.8391943 Test Loss: 12.6203508
Validation loss decreased (inf --> 8.839194).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5395048
	speed: 1.1112s/iter; left time: 42024.7979s
	iters: 200, epoch: 2 | loss: 0.4923635
	speed: 0.0249s/iter; left time: 939.0724s
	iters: 300, epoch: 2 | loss: 0.4753210
	speed: 0.0248s/iter; left time: 934.0643s
	iters: 400, epoch: 2 | loss: 0.4863936
	speed: 0.0249s/iter; left time: 932.4674s
	iters: 500, epoch: 2 | loss: 0.5352849
	speed: 0.0247s/iter; left time: 924.0939s
	iters: 600, epoch: 2 | loss: 0.5456660
	speed: 0.0241s/iter; left time: 899.8268s
	iters: 700, epoch: 2 | loss: 0.5341994
	speed: 0.0239s/iter; left time: 889.8599s
	iters: 800, epoch: 2 | loss: 0.4928494
	speed: 0.0240s/iter; left time: 890.6619s
	iters: 900, epoch: 2 | loss: 0.4914016
	speed: 0.0240s/iter; left time: 887.0101s
	iters: 1000, epoch: 2 | loss: 0.5335519
	speed: 0.0243s/iter; left time: 895.6746s
	iters: 1100, epoch: 2 | loss: 0.4729299
	speed: 0.0240s/iter; left time: 883.5752s
	iters: 1200, epoch: 2 | loss: 0.4926571
	speed: 0.0239s/iter; left time: 875.7866s
	iters: 1300, epoch: 2 | loss: 0.5433635
	speed: 0.0238s/iter; left time: 871.2964s
	iters: 1400, epoch: 2 | loss: 0.5424682
	speed: 0.0237s/iter; left time: 866.5596s
	iters: 1500, epoch: 2 | loss: 0.4468684
	speed: 0.0238s/iter; left time: 865.9333s
	iters: 1600, epoch: 2 | loss: 0.5100238
	speed: 0.0240s/iter; left time: 872.6819s
	iters: 1700, epoch: 2 | loss: 0.5451202
	speed: 0.0242s/iter; left time: 876.4126s
	iters: 1800, epoch: 2 | loss: 0.5335783
	speed: 0.0241s/iter; left time: 872.1910s
	iters: 1900, epoch: 2 | loss: 0.4984855
	speed: 0.0242s/iter; left time: 870.5992s
	iters: 2000, epoch: 2 | loss: 0.6066986
	speed: 0.0241s/iter; left time: 864.5522s
	iters: 2100, epoch: 2 | loss: 0.5428174
	speed: 0.0241s/iter; left time: 863.4710s
	iters: 2200, epoch: 2 | loss: 0.4730948
	speed: 0.0242s/iter; left time: 864.3218s
	iters: 2300, epoch: 2 | loss: 0.4975180
	speed: 0.0240s/iter; left time: 855.2030s
	iters: 2400, epoch: 2 | loss: 0.5033823
	speed: 0.0248s/iter; left time: 880.1577s
	iters: 2500, epoch: 2 | loss: 0.4513004
	speed: 0.0236s/iter; left time: 836.8840s
	iters: 2600, epoch: 2 | loss: 0.5248497
	speed: 0.0237s/iter; left time: 837.9340s
	iters: 2700, epoch: 2 | loss: 0.5345482
	speed: 0.0236s/iter; left time: 832.0075s
	iters: 2800, epoch: 2 | loss: 0.5026560
	speed: 0.0240s/iter; left time: 841.7442s
	iters: 2900, epoch: 2 | loss: 0.5020575
	speed: 0.0242s/iter; left time: 845.9714s
	iters: 3000, epoch: 2 | loss: 0.4881209
	speed: 0.0243s/iter; left time: 848.6179s
	iters: 3100, epoch: 2 | loss: 0.5528383
	speed: 0.0239s/iter; left time: 833.6966s
	iters: 3200, epoch: 2 | loss: 0.5520426
	speed: 0.0238s/iter; left time: 827.0944s
	iters: 3300, epoch: 2 | loss: 0.5152761
	speed: 0.0245s/iter; left time: 847.2156s
	iters: 3400, epoch: 2 | loss: 0.4967304
	speed: 0.0248s/iter; left time: 854.5778s
	iters: 3500, epoch: 2 | loss: 0.4692035
	speed: 0.0242s/iter; left time: 834.5686s
	iters: 3600, epoch: 2 | loss: 0.4693592
	speed: 0.0242s/iter; left time: 830.7956s
	iters: 3700, epoch: 2 | loss: 0.5152470
	speed: 0.0241s/iter; left time: 824.4734s
	iters: 3800, epoch: 2 | loss: 0.4622929
	speed: 0.0239s/iter; left time: 816.5465s
	iters: 3900, epoch: 2 | loss: 0.5179026
	speed: 0.0238s/iter; left time: 808.5029s
	iters: 4000, epoch: 2 | loss: 0.4657927
	speed: 0.0240s/iter; left time: 813.2243s
	iters: 4100, epoch: 2 | loss: 0.5267751
	speed: 0.0232s/iter; left time: 783.4618s
	iters: 4200, epoch: 2 | loss: 0.5742994
	speed: 0.0237s/iter; left time: 798.2912s
Epoch: 2 cost time: 101.95632243156433
Epoch: 2, Steps: 4213 | Train Loss: 0.5090047 Vali Loss: 22.9008446 Test Loss: 27.9109116
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4923183
	speed: 1.1527s/iter; left time: 38737.5260s
	iters: 200, epoch: 3 | loss: 0.5116649
	speed: 0.0242s/iter; left time: 811.8434s
	iters: 300, epoch: 3 | loss: 0.4927572
	speed: 0.0241s/iter; left time: 806.2152s
	iters: 400, epoch: 3 | loss: 0.4482925
	speed: 0.0244s/iter; left time: 812.6735s
	iters: 500, epoch: 3 | loss: 0.4680902
	speed: 0.0242s/iter; left time: 803.4430s
	iters: 600, epoch: 3 | loss: 0.5000977
	speed: 0.0244s/iter; left time: 806.9023s
	iters: 700, epoch: 3 | loss: 0.3900919
	speed: 0.0243s/iter; left time: 800.6745s
	iters: 800, epoch: 3 | loss: 0.4675833
	speed: 0.0242s/iter; left time: 794.8163s
	iters: 900, epoch: 3 | loss: 0.4705704
	speed: 0.0243s/iter; left time: 797.0709s
	iters: 1000, epoch: 3 | loss: 0.4541825
	speed: 0.0244s/iter; left time: 797.0005s
	iters: 1100, epoch: 3 | loss: 0.5019546
	speed: 0.0245s/iter; left time: 798.1985s
	iters: 1200, epoch: 3 | loss: 0.4668998
	speed: 0.0245s/iter; left time: 796.7012s
	iters: 1300, epoch: 3 | loss: 0.4464708
	speed: 0.0248s/iter; left time: 804.2026s
	iters: 1400, epoch: 3 | loss: 0.5208221
	speed: 0.0246s/iter; left time: 795.9746s
	iters: 1500, epoch: 3 | loss: 0.4843825
	speed: 0.0244s/iter; left time: 784.3139s
	iters: 1600, epoch: 3 | loss: 0.5534506
	speed: 0.0254s/iter; left time: 815.1848s
	iters: 1700, epoch: 3 | loss: 0.4826099
	speed: 0.0248s/iter; left time: 793.3242s
	iters: 1800, epoch: 3 | loss: 0.4520245
	speed: 0.0245s/iter; left time: 781.4984s
	iters: 1900, epoch: 3 | loss: 0.5145277
	speed: 0.0243s/iter; left time: 773.3589s
	iters: 2000, epoch: 3 | loss: 0.5344911
	speed: 0.0249s/iter; left time: 790.1847s
	iters: 2100, epoch: 3 | loss: 0.5621732
	speed: 0.0242s/iter; left time: 765.4068s
	iters: 2200, epoch: 3 | loss: 0.4779137
	speed: 0.0243s/iter; left time: 764.4559s
	iters: 2300, epoch: 3 | loss: 0.5863066
	speed: 0.0247s/iter; left time: 776.8049s
	iters: 2400, epoch: 3 | loss: 0.4443199
	speed: 0.0239s/iter; left time: 748.2933s
	iters: 2500, epoch: 3 | loss: 0.4476569
	speed: 0.0241s/iter; left time: 751.2532s
	iters: 2600, epoch: 3 | loss: 0.4223750
	speed: 0.0238s/iter; left time: 740.6215s
	iters: 2700, epoch: 3 | loss: 0.5202178
	speed: 0.0237s/iter; left time: 735.0887s
	iters: 2800, epoch: 3 | loss: 0.4825982
	speed: 0.0240s/iter; left time: 741.9837s
	iters: 2900, epoch: 3 | loss: 0.4857128
	speed: 0.0239s/iter; left time: 735.6971s
	iters: 3000, epoch: 3 | loss: 0.4894251
	speed: 0.0251s/iter; left time: 771.1992s
	iters: 3100, epoch: 3 | loss: 0.5180964
	speed: 0.0251s/iter; left time: 767.1045s
	iters: 3200, epoch: 3 | loss: 0.4678178
	speed: 0.0239s/iter; left time: 728.4994s
	iters: 3300, epoch: 3 | loss: 0.4443383
	speed: 0.0239s/iter; left time: 727.5453s
	iters: 3400, epoch: 3 | loss: 0.4866112
	speed: 0.0240s/iter; left time: 726.3137s
	iters: 3500, epoch: 3 | loss: 0.4605227
	speed: 0.0245s/iter; left time: 739.9975s
	iters: 3600, epoch: 3 | loss: 0.5307120
	speed: 0.0254s/iter; left time: 765.0188s
	iters: 3700, epoch: 3 | loss: 0.4492508
	speed: 0.0253s/iter; left time: 758.1499s
	iters: 3800, epoch: 3 | loss: 0.4267879
	speed: 0.0247s/iter; left time: 737.2883s
	iters: 3900, epoch: 3 | loss: 0.5394129
	speed: 0.0245s/iter; left time: 729.4441s
	iters: 4000, epoch: 3 | loss: 0.4409075
	speed: 0.0243s/iter; left time: 721.4016s
	iters: 4100, epoch: 3 | loss: 0.5047331
	speed: 0.0242s/iter; left time: 717.2148s
	iters: 4200, epoch: 3 | loss: 0.4795820
	speed: 0.0249s/iter; left time: 734.6548s
Epoch: 3 cost time: 103.33995079994202
Epoch: 3, Steps: 4213 | Train Loss: 0.4833033 Vali Loss: 32.8549728 Test Loss: 37.3799706
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5498233
	speed: 1.4099s/iter; left time: 41438.5318s
	iters: 200, epoch: 4 | loss: 0.4515606
	speed: 0.0277s/iter; left time: 812.0299s
	iters: 300, epoch: 4 | loss: 0.4459084
	speed: 0.0277s/iter; left time: 808.2617s
	iters: 400, epoch: 4 | loss: 0.4417854
	speed: 0.0277s/iter; left time: 806.6186s
	iters: 500, epoch: 4 | loss: 0.4891447
	speed: 0.0279s/iter; left time: 809.4191s
	iters: 600, epoch: 4 | loss: 0.4512386
	speed: 0.0279s/iter; left time: 806.9811s
	iters: 700, epoch: 4 | loss: 0.4556735
	speed: 0.0278s/iter; left time: 801.0756s
	iters: 800, epoch: 4 | loss: 0.4947262
	speed: 0.0279s/iter; left time: 801.4271s
	iters: 900, epoch: 4 | loss: 0.4779676
	speed: 0.0279s/iter; left time: 797.8240s
	iters: 1000, epoch: 4 | loss: 0.4755570
	speed: 0.0279s/iter; left time: 794.3307s
	iters: 1100, epoch: 4 | loss: 0.4427409
	speed: 0.0279s/iter; left time: 791.7671s
	iters: 1200, epoch: 4 | loss: 0.4664873
	speed: 0.0279s/iter; left time: 789.1947s
	iters: 1300, epoch: 4 | loss: 0.4671530
	speed: 0.0279s/iter; left time: 786.8634s
	iters: 1400, epoch: 4 | loss: 0.5242274
	speed: 0.0279s/iter; left time: 784.2725s
	iters: 1500, epoch: 4 | loss: 0.4449109
	speed: 0.0279s/iter; left time: 780.3632s
	iters: 1600, epoch: 4 | loss: 0.4219144
	speed: 0.0303s/iter; left time: 846.2778s
	iters: 1700, epoch: 4 | loss: 0.5099862
	speed: 0.0294s/iter; left time: 817.7499s
	iters: 1800, epoch: 4 | loss: 0.4564333
	speed: 0.0281s/iter; left time: 779.1277s
	iters: 1900, epoch: 4 | loss: 0.4809737
	speed: 0.0278s/iter; left time: 767.1485s
	iters: 2000, epoch: 4 | loss: 0.5215710
	speed: 0.0269s/iter; left time: 740.6500s
	iters: 2100, epoch: 4 | loss: 0.4807176
	speed: 0.0271s/iter; left time: 741.9045s
	iters: 2200, epoch: 4 | loss: 0.4767902
	speed: 0.0273s/iter; left time: 746.2081s
	iters: 2300, epoch: 4 | loss: 0.5155684
	speed: 0.0279s/iter; left time: 758.2932s
	iters: 2400, epoch: 4 | loss: 0.5101384
	speed: 0.0285s/iter; left time: 771.2839s
	iters: 2500, epoch: 4 | loss: 0.4744878
	speed: 0.0270s/iter; left time: 729.6728s
	iters: 2600, epoch: 4 | loss: 0.4522035
	speed: 0.0269s/iter; left time: 724.4595s
	iters: 2700, epoch: 4 | loss: 0.4532481
	speed: 0.0270s/iter; left time: 722.5360s
	iters: 2800, epoch: 4 | loss: 0.4571089
	speed: 0.0271s/iter; left time: 722.2700s
	iters: 2900, epoch: 4 | loss: 0.4873152
	speed: 0.0282s/iter; left time: 749.7829s
	iters: 3000, epoch: 4 | loss: 0.4814523
	speed: 0.0272s/iter; left time: 720.9062s
	iters: 3100, epoch: 4 | loss: 0.4443986
	speed: 0.0269s/iter; left time: 711.2438s
	iters: 3200, epoch: 4 | loss: 0.4166200
	speed: 0.0270s/iter; left time: 709.6303s
	iters: 3300, epoch: 4 | loss: 0.4654427
	speed: 0.0273s/iter; left time: 714.5261s
	iters: 3400, epoch: 4 | loss: 0.4354267
	speed: 0.0280s/iter; left time: 730.9645s
	iters: 3500, epoch: 4 | loss: 0.4585335
	speed: 0.0280s/iter; left time: 727.8791s
	iters: 3600, epoch: 4 | loss: 0.5045344
	speed: 0.0271s/iter; left time: 701.4153s
	iters: 3700, epoch: 4 | loss: 0.5170130
	speed: 0.0274s/iter; left time: 707.1602s
	iters: 3800, epoch: 4 | loss: 0.4807715
	speed: 0.0271s/iter; left time: 696.9024s
	iters: 3900, epoch: 4 | loss: 0.4779426
	speed: 0.0274s/iter; left time: 700.5777s
	iters: 4000, epoch: 4 | loss: 0.4675615
	speed: 0.0273s/iter; left time: 696.7675s
	iters: 4100, epoch: 4 | loss: 0.5448380
	speed: 0.0273s/iter; left time: 693.6371s
	iters: 4200, epoch: 4 | loss: 0.4606091
	speed: 0.0271s/iter; left time: 685.6694s
Epoch: 4 cost time: 117.13440656661987
Epoch: 4, Steps: 4213 | Train Loss: 0.4741408 Vali Loss: 39.6060143 Test Loss: 44.2852898
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems08_all_96_192_Mamba_custom_ftM_sl192_ll48_pl192_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 379335
test shape: (37933, 1, 192, 212) (37933, 1, 192, 212)
test shape: (37933, 192, 212) (37933, 192, 212)
mse:12.620339393615723, mae:1.3696695566177368
>>>>>>>Overall time: 1258 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
