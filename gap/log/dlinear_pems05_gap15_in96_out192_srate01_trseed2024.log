Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=103, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems05_all_common_flow.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems05_all_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_192_DLinear_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 600679
val 94916
test 94915
	iters: 100, epoch: 1 | loss: 1.4848688
	speed: 0.0135s/iter; left time: 5072.5967s
	iters: 200, epoch: 1 | loss: 1.2279831
	speed: 0.0104s/iter; left time: 3889.9235s
	iters: 300, epoch: 1 | loss: 1.3006690
	speed: 0.0104s/iter; left time: 3904.4048s
	iters: 400, epoch: 1 | loss: 1.5136811
	speed: 0.0104s/iter; left time: 3888.2210s
	iters: 500, epoch: 1 | loss: 1.3355694
	speed: 0.0104s/iter; left time: 3914.2360s
	iters: 600, epoch: 1 | loss: 1.1642506
	speed: 0.0105s/iter; left time: 3916.9388s
	iters: 700, epoch: 1 | loss: 1.4603866
	speed: 0.0105s/iter; left time: 3918.7275s
	iters: 800, epoch: 1 | loss: 1.1311455
	speed: 0.0105s/iter; left time: 3921.3506s
	iters: 900, epoch: 1 | loss: 1.3888124
	speed: 0.0105s/iter; left time: 3922.2681s
	iters: 1000, epoch: 1 | loss: 1.3240731
	speed: 0.0105s/iter; left time: 3912.5470s
	iters: 1100, epoch: 1 | loss: 1.3968955
	speed: 0.0105s/iter; left time: 3922.8355s
	iters: 1200, epoch: 1 | loss: 1.4864382
	speed: 0.0105s/iter; left time: 3917.6353s
	iters: 1300, epoch: 1 | loss: 1.2362026
	speed: 0.0105s/iter; left time: 3909.4761s
	iters: 1400, epoch: 1 | loss: 1.3221649
	speed: 0.0105s/iter; left time: 3916.7773s
	iters: 1500, epoch: 1 | loss: 1.3503445
	speed: 0.0105s/iter; left time: 3910.8877s
	iters: 1600, epoch: 1 | loss: 1.2897764
	speed: 0.0105s/iter; left time: 3924.9825s
	iters: 1700, epoch: 1 | loss: 1.4488565
	speed: 0.0104s/iter; left time: 3894.4422s
	iters: 1800, epoch: 1 | loss: 1.4229133
	speed: 0.0104s/iter; left time: 3891.9865s
Epoch: 1 cost time: 19.97271752357483
Epoch: 1, Steps: 1877 | Train Loss: 1.3671040 Vali Loss: 1.4561293 Test Loss: 1.6329324
Validation loss decreased (inf --> 1.456129).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2254398
	speed: 0.1824s/iter; left time: 68107.1486s
	iters: 200, epoch: 2 | loss: 1.6625175
	speed: 0.0104s/iter; left time: 3867.0911s
	iters: 300, epoch: 2 | loss: 1.2431782
	speed: 0.0103s/iter; left time: 3858.4703s
	iters: 400, epoch: 2 | loss: 1.4207666
	speed: 0.0104s/iter; left time: 3885.7648s
	iters: 500, epoch: 2 | loss: 1.3614002
	speed: 0.0105s/iter; left time: 3911.5606s
	iters: 600, epoch: 2 | loss: 1.2633700
	speed: 0.0105s/iter; left time: 3906.9538s
	iters: 700, epoch: 2 | loss: 1.3450043
	speed: 0.0105s/iter; left time: 3908.4723s
	iters: 800, epoch: 2 | loss: 1.4656991
	speed: 0.0105s/iter; left time: 3902.1401s
	iters: 900, epoch: 2 | loss: 1.4298592
	speed: 0.0105s/iter; left time: 3911.0460s
	iters: 1000, epoch: 2 | loss: 1.3397582
	speed: 0.0104s/iter; left time: 3890.4816s
	iters: 1100, epoch: 2 | loss: 1.2689849
	speed: 0.0105s/iter; left time: 3905.7121s
	iters: 1200, epoch: 2 | loss: 1.3475305
	speed: 0.0105s/iter; left time: 3910.9908s
	iters: 1300, epoch: 2 | loss: 1.3413719
	speed: 0.0105s/iter; left time: 3896.8700s
	iters: 1400, epoch: 2 | loss: 1.2348521
	speed: 0.0104s/iter; left time: 3880.6801s
	iters: 1500, epoch: 2 | loss: 1.3430231
	speed: 0.0106s/iter; left time: 3928.1290s
	iters: 1600, epoch: 2 | loss: 1.3224800
	speed: 0.0104s/iter; left time: 3873.1907s
	iters: 1700, epoch: 2 | loss: 1.3338956
	speed: 0.0104s/iter; left time: 3874.0295s
	iters: 1800, epoch: 2 | loss: 1.2254364
	speed: 0.0105s/iter; left time: 3886.4579s
Epoch: 2 cost time: 19.750288248062134
Epoch: 2, Steps: 1877 | Train Loss: 1.3551284 Vali Loss: 1.4664018 Test Loss: 1.6440487
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 1.4087476
	speed: 0.1826s/iter; left time: 67849.7538s
	iters: 200, epoch: 3 | loss: 1.2905045
	speed: 0.0104s/iter; left time: 3854.5009s
	iters: 300, epoch: 3 | loss: 1.3710507
	speed: 0.0103s/iter; left time: 3828.1321s
	iters: 400, epoch: 3 | loss: 1.2713323
	speed: 0.0103s/iter; left time: 3831.0276s
	iters: 500, epoch: 3 | loss: 1.3543072
	speed: 0.0104s/iter; left time: 3876.9804s
	iters: 600, epoch: 3 | loss: 1.4261904
	speed: 0.0103s/iter; left time: 3834.4079s
	iters: 700, epoch: 3 | loss: 1.2833169
	speed: 0.0104s/iter; left time: 3875.8198s
	iters: 800, epoch: 3 | loss: 1.3549601
	speed: 0.0104s/iter; left time: 3848.5620s
	iters: 900, epoch: 3 | loss: 1.2914344
	speed: 0.0103s/iter; left time: 3833.5237s
	iters: 1000, epoch: 3 | loss: 1.4842161
	speed: 0.0103s/iter; left time: 3833.8179s
	iters: 1100, epoch: 3 | loss: 1.3800331
	speed: 0.0103s/iter; left time: 3831.4230s
	iters: 1200, epoch: 3 | loss: 1.3745661
	speed: 0.0104s/iter; left time: 3838.7265s
	iters: 1300, epoch: 3 | loss: 1.3902217
	speed: 0.0103s/iter; left time: 3830.3899s
	iters: 1400, epoch: 3 | loss: 1.2722934
	speed: 0.0104s/iter; left time: 3843.0548s
	iters: 1500, epoch: 3 | loss: 1.3865983
	speed: 0.0105s/iter; left time: 3868.2482s
	iters: 1600, epoch: 3 | loss: 1.3177668
	speed: 0.0103s/iter; left time: 3821.2224s
	iters: 1700, epoch: 3 | loss: 1.2298019
	speed: 0.0104s/iter; left time: 3841.3706s
	iters: 1800, epoch: 3 | loss: 1.4106221
	speed: 0.0105s/iter; left time: 3864.9023s
Epoch: 3 cost time: 19.590556621551514
Epoch: 3, Steps: 1877 | Train Loss: 1.3549673 Vali Loss: 1.4748362 Test Loss: 1.6922615
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 4 | loss: 1.3728628
	speed: 0.1824s/iter; left time: 67432.0139s
	iters: 200, epoch: 4 | loss: 1.4154768
	speed: 0.0103s/iter; left time: 3803.4068s
	iters: 300, epoch: 4 | loss: 1.2520765
	speed: 0.0103s/iter; left time: 3819.5109s
	iters: 400, epoch: 4 | loss: 1.3096194
	speed: 0.0104s/iter; left time: 3826.9542s
	iters: 500, epoch: 4 | loss: 1.3636382
	speed: 0.0103s/iter; left time: 3818.2744s
	iters: 600, epoch: 4 | loss: 1.3523878
	speed: 0.0104s/iter; left time: 3824.7456s
	iters: 700, epoch: 4 | loss: 1.3776999
	speed: 0.0104s/iter; left time: 3827.0850s
	iters: 800, epoch: 4 | loss: 1.5121567
	speed: 0.0105s/iter; left time: 3875.7762s
	iters: 900, epoch: 4 | loss: 1.4273831
	speed: 0.0104s/iter; left time: 3828.2246s
	iters: 1000, epoch: 4 | loss: 1.4977808
	speed: 0.0104s/iter; left time: 3842.1633s
	iters: 1100, epoch: 4 | loss: 1.3245831
	speed: 0.0105s/iter; left time: 3852.6053s
	iters: 1200, epoch: 4 | loss: 1.4124629
	speed: 0.0104s/iter; left time: 3832.7834s
	iters: 1300, epoch: 4 | loss: 1.2150861
	speed: 0.0104s/iter; left time: 3838.2567s
	iters: 1400, epoch: 4 | loss: 1.3341036
	speed: 0.0104s/iter; left time: 3827.3477s
	iters: 1500, epoch: 4 | loss: 1.5603344
	speed: 0.0104s/iter; left time: 3829.5908s
	iters: 1600, epoch: 4 | loss: 1.4375583
	speed: 0.0104s/iter; left time: 3823.4519s
	iters: 1700, epoch: 4 | loss: 1.3036458
	speed: 0.0104s/iter; left time: 3822.3484s
	iters: 1800, epoch: 4 | loss: 1.2599893
	speed: 0.0104s/iter; left time: 3845.2262s
Epoch: 4 cost time: 19.632015228271484
Epoch: 4, Steps: 1877 | Train Loss: 1.3551725 Vali Loss: 1.4764011 Test Loss: 1.7442324
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 5 | loss: 1.3906634
	speed: 0.1835s/iter; left time: 67491.6786s
	iters: 200, epoch: 5 | loss: 1.3194337
	speed: 0.0104s/iter; left time: 3807.0308s
	iters: 300, epoch: 5 | loss: 1.2583313
	speed: 0.0103s/iter; left time: 3794.3698s
	iters: 400, epoch: 5 | loss: 1.2660288
	speed: 0.0104s/iter; left time: 3804.9285s
	iters: 500, epoch: 5 | loss: 1.3171997
	speed: 0.0103s/iter; left time: 3794.0782s
	iters: 600, epoch: 5 | loss: 1.4008338
	speed: 0.0104s/iter; left time: 3826.8141s
	iters: 700, epoch: 5 | loss: 1.2378576
	speed: 0.0104s/iter; left time: 3819.1625s
	iters: 800, epoch: 5 | loss: 1.4031228
	speed: 0.0105s/iter; left time: 3842.8526s
	iters: 900, epoch: 5 | loss: 1.3097385
	speed: 0.0103s/iter; left time: 3788.7190s
	iters: 1000, epoch: 5 | loss: 1.1545737
	speed: 0.0104s/iter; left time: 3802.4015s
	iters: 1100, epoch: 5 | loss: 1.4434218
	speed: 0.0105s/iter; left time: 3833.6334s
	iters: 1200, epoch: 5 | loss: 1.3701212
	speed: 0.0104s/iter; left time: 3818.7206s
	iters: 1300, epoch: 5 | loss: 1.3856419
	speed: 0.0104s/iter; left time: 3817.6714s
	iters: 1400, epoch: 5 | loss: 1.4056768
	speed: 0.0105s/iter; left time: 3832.3817s
	iters: 1500, epoch: 5 | loss: 1.3304218
	speed: 0.0105s/iter; left time: 3865.2857s
	iters: 1600, epoch: 5 | loss: 1.2130872
	speed: 0.0104s/iter; left time: 3793.3013s
	iters: 1700, epoch: 5 | loss: 1.3415339
	speed: 0.0104s/iter; left time: 3798.2567s
	iters: 1800, epoch: 5 | loss: 1.3989760
	speed: 0.0105s/iter; left time: 3834.0138s
Epoch: 5 cost time: 19.656094789505005
Epoch: 5, Steps: 1877 | Train Loss: 1.3550744 Vali Loss: 1.4732338 Test Loss: 1.6777242
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 6 | loss: 1.6245085
	speed: 0.1831s/iter; left time: 67001.5836s
	iters: 200, epoch: 6 | loss: 1.2304968
	speed: 0.0104s/iter; left time: 3814.4098s
	iters: 300, epoch: 6 | loss: 1.2349354
	speed: 0.0104s/iter; left time: 3805.7386s
	iters: 400, epoch: 6 | loss: 1.4625376
	speed: 0.0104s/iter; left time: 3803.7434s
	iters: 500, epoch: 6 | loss: 1.5121014
	speed: 0.0105s/iter; left time: 3826.5096s
	iters: 600, epoch: 6 | loss: 1.2886736
	speed: 0.0105s/iter; left time: 3829.6193s
	iters: 700, epoch: 6 | loss: 1.4456062
	speed: 0.0104s/iter; left time: 3796.6890s
	iters: 800, epoch: 6 | loss: 1.4826323
	speed: 0.0104s/iter; left time: 3791.6234s
	iters: 900, epoch: 6 | loss: 1.4590929
	speed: 0.0104s/iter; left time: 3808.1668s
	iters: 1000, epoch: 6 | loss: 1.2750274
	speed: 0.0105s/iter; left time: 3818.0726s
	iters: 1100, epoch: 6 | loss: 1.2616423
	speed: 0.0105s/iter; left time: 3814.9559s
	iters: 1200, epoch: 6 | loss: 1.3064518
	speed: 0.0105s/iter; left time: 3827.4366s
	iters: 1300, epoch: 6 | loss: 1.2755281
	speed: 0.0103s/iter; left time: 3770.5240s
	iters: 1400, epoch: 6 | loss: 1.5682902
	speed: 0.0104s/iter; left time: 3784.8901s
	iters: 1500, epoch: 6 | loss: 1.4052268
	speed: 0.0104s/iter; left time: 3804.0458s
	iters: 1600, epoch: 6 | loss: 1.1250161
	speed: 0.0104s/iter; left time: 3779.0345s
	iters: 1700, epoch: 6 | loss: 1.4079987
	speed: 0.0104s/iter; left time: 3804.8424s
	iters: 1800, epoch: 6 | loss: 1.2956049
	speed: 0.0104s/iter; left time: 3793.7068s
Epoch: 6 cost time: 19.716253757476807
Epoch: 6, Steps: 1877 | Train Loss: 1.3549296 Vali Loss: 1.5003775 Test Loss: 1.7492636
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems05_all_96_192_DLinear_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 94915
test shape: (9491, 1, 192, 103) (9491, 1, 192, 103)
test shape: (9491, 192, 103) (9491, 192, 103)
mse:1.6329331398010254, mae:1.0451617240905762
>>>>>>>Overall time: 282 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
