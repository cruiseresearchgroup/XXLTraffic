Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=107, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems10_all_common_flow.csv', dec_in=107, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=107, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems10_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_all_96_96_DLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 844551
val 141327
test 141325
	iters: 100, epoch: 1 | loss: 1.5001320
	speed: 0.0102s/iter; left time: 5396.0713s
	iters: 200, epoch: 1 | loss: 1.7430992
	speed: 0.0069s/iter; left time: 3663.7007s
	iters: 300, epoch: 1 | loss: 1.7471435
	speed: 0.0069s/iter; left time: 3617.6035s
	iters: 400, epoch: 1 | loss: 1.4387668
	speed: 0.0069s/iter; left time: 3631.8471s
	iters: 500, epoch: 1 | loss: 1.4799049
	speed: 0.0069s/iter; left time: 3632.0171s
	iters: 600, epoch: 1 | loss: 1.5427442
	speed: 0.0070s/iter; left time: 3671.0076s
	iters: 700, epoch: 1 | loss: 1.3738359
	speed: 0.0069s/iter; left time: 3633.8278s
	iters: 800, epoch: 1 | loss: 1.3989974
	speed: 0.0069s/iter; left time: 3633.1660s
	iters: 900, epoch: 1 | loss: 1.4697526
	speed: 0.0069s/iter; left time: 3644.9962s
	iters: 1000, epoch: 1 | loss: 1.3711770
	speed: 0.0069s/iter; left time: 3649.2468s
	iters: 1100, epoch: 1 | loss: 1.3299996
	speed: 0.0069s/iter; left time: 3646.2008s
	iters: 1200, epoch: 1 | loss: 1.5185611
	speed: 0.0069s/iter; left time: 3645.7608s
	iters: 1300, epoch: 1 | loss: 1.6777058
	speed: 0.0069s/iter; left time: 3641.1094s
	iters: 1400, epoch: 1 | loss: 1.2034463
	speed: 0.0069s/iter; left time: 3642.4861s
	iters: 1500, epoch: 1 | loss: 1.3085032
	speed: 0.0069s/iter; left time: 3638.2142s
	iters: 1600, epoch: 1 | loss: 1.5511727
	speed: 0.0069s/iter; left time: 3640.9567s
	iters: 1700, epoch: 1 | loss: 1.5710322
	speed: 0.0069s/iter; left time: 3627.8633s
	iters: 1800, epoch: 1 | loss: 1.6737576
	speed: 0.0069s/iter; left time: 3630.9334s
	iters: 1900, epoch: 1 | loss: 1.4010583
	speed: 0.0069s/iter; left time: 3626.6747s
	iters: 2000, epoch: 1 | loss: 1.4723516
	speed: 0.0069s/iter; left time: 3636.5003s
	iters: 2100, epoch: 1 | loss: 1.5400522
	speed: 0.0069s/iter; left time: 3639.7155s
	iters: 2200, epoch: 1 | loss: 1.3583200
	speed: 0.0070s/iter; left time: 3681.8438s
	iters: 2300, epoch: 1 | loss: 1.5858450
	speed: 0.0069s/iter; left time: 3624.1180s
	iters: 2400, epoch: 1 | loss: 1.5103328
	speed: 0.0069s/iter; left time: 3628.2673s
	iters: 2500, epoch: 1 | loss: 1.7397110
	speed: 0.0069s/iter; left time: 3617.5737s
	iters: 2600, epoch: 1 | loss: 1.5028746
	speed: 0.0069s/iter; left time: 3623.5253s
Epoch: 1 cost time: 18.643847942352295
Epoch: 1, Steps: 2639 | Train Loss: 1.5699352 Vali Loss: 2.1812468 Test Loss: 1.9771941
Validation loss decreased (inf --> 2.181247).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6534818
	speed: 0.2196s/iter; left time: 115277.9300s
	iters: 200, epoch: 2 | loss: 1.7103202
	speed: 0.0070s/iter; left time: 3685.9399s
	iters: 300, epoch: 2 | loss: 1.5588905
	speed: 0.0069s/iter; left time: 3631.6079s
	iters: 400, epoch: 2 | loss: 1.6233160
	speed: 0.0069s/iter; left time: 3629.6022s
	iters: 500, epoch: 2 | loss: 1.2982061
	speed: 0.0070s/iter; left time: 3673.6662s
	iters: 600, epoch: 2 | loss: 1.5544223
	speed: 0.0069s/iter; left time: 3626.1178s
	iters: 700, epoch: 2 | loss: 1.5067801
	speed: 0.0069s/iter; left time: 3631.2447s
	iters: 800, epoch: 2 | loss: 1.3539890
	speed: 0.0069s/iter; left time: 3637.7771s
	iters: 900, epoch: 2 | loss: 1.7760977
	speed: 0.0070s/iter; left time: 3658.7760s
	iters: 1000, epoch: 2 | loss: 1.9876953
	speed: 0.0070s/iter; left time: 3643.3592s
	iters: 1100, epoch: 2 | loss: 1.5796698
	speed: 0.0070s/iter; left time: 3650.7556s
	iters: 1200, epoch: 2 | loss: 1.3617597
	speed: 0.0070s/iter; left time: 3645.2832s
	iters: 1300, epoch: 2 | loss: 1.4444331
	speed: 0.0070s/iter; left time: 3674.8729s
	iters: 1400, epoch: 2 | loss: 1.5713786
	speed: 0.0069s/iter; left time: 3638.0839s
	iters: 1500, epoch: 2 | loss: 1.6775076
	speed: 0.0069s/iter; left time: 3627.9006s
	iters: 1600, epoch: 2 | loss: 1.6367948
	speed: 0.0069s/iter; left time: 3623.7389s
	iters: 1700, epoch: 2 | loss: 1.6568565
	speed: 0.0069s/iter; left time: 3620.9987s
	iters: 1800, epoch: 2 | loss: 1.5477659
	speed: 0.0070s/iter; left time: 3659.0484s
	iters: 1900, epoch: 2 | loss: 1.3729308
	speed: 0.0070s/iter; left time: 3656.6177s
	iters: 2000, epoch: 2 | loss: 1.4519397
	speed: 0.0069s/iter; left time: 3633.9437s
	iters: 2100, epoch: 2 | loss: 1.5089551
	speed: 0.0070s/iter; left time: 3675.3205s
	iters: 2200, epoch: 2 | loss: 1.6691232
	speed: 0.0069s/iter; left time: 3628.7092s
	iters: 2300, epoch: 2 | loss: 1.6034911
	speed: 0.0070s/iter; left time: 3664.5220s
	iters: 2400, epoch: 2 | loss: 1.6431755
	speed: 0.0069s/iter; left time: 3616.2114s
	iters: 2500, epoch: 2 | loss: 1.3605660
	speed: 0.0069s/iter; left time: 3613.8997s
	iters: 2600, epoch: 2 | loss: 1.7794155
	speed: 0.0070s/iter; left time: 3654.0122s
Epoch: 2 cost time: 18.513973712921143
Epoch: 2, Steps: 2639 | Train Loss: 1.5575579 Vali Loss: 2.2008498 Test Loss: 1.9830209
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 1.6687853
	speed: 0.2192s/iter; left time: 114532.0678s
	iters: 200, epoch: 3 | loss: 2.0086184
	speed: 0.0070s/iter; left time: 3671.0332s
	iters: 300, epoch: 3 | loss: 1.6132057
	speed: 0.0069s/iter; left time: 3581.8838s
	iters: 400, epoch: 3 | loss: 1.4026855
	speed: 0.0069s/iter; left time: 3582.8498s
	iters: 500, epoch: 3 | loss: 1.8099411
	speed: 0.0069s/iter; left time: 3579.1492s
	iters: 600, epoch: 3 | loss: 1.5309644
	speed: 0.0069s/iter; left time: 3578.9825s
	iters: 700, epoch: 3 | loss: 1.4180915
	speed: 0.0069s/iter; left time: 3584.5982s
	iters: 800, epoch: 3 | loss: 1.2656832
	speed: 0.0070s/iter; left time: 3633.8309s
	iters: 900, epoch: 3 | loss: 1.9090849
	speed: 0.0069s/iter; left time: 3600.0571s
	iters: 1000, epoch: 3 | loss: 1.5275927
	speed: 0.0070s/iter; left time: 3647.4732s
	iters: 1100, epoch: 3 | loss: 1.5999396
	speed: 0.0069s/iter; left time: 3591.6429s
	iters: 1200, epoch: 3 | loss: 1.6249167
	speed: 0.0069s/iter; left time: 3583.7066s
	iters: 1300, epoch: 3 | loss: 1.6512095
	speed: 0.0069s/iter; left time: 3589.8652s
	iters: 1400, epoch: 3 | loss: 1.6620724
	speed: 0.0069s/iter; left time: 3579.3523s
	iters: 1500, epoch: 3 | loss: 1.6723484
	speed: 0.0069s/iter; left time: 3582.4518s
	iters: 1600, epoch: 3 | loss: 1.6066444
	speed: 0.0069s/iter; left time: 3578.2283s
	iters: 1700, epoch: 3 | loss: 1.8412930
	speed: 0.0069s/iter; left time: 3612.6366s
	iters: 1800, epoch: 3 | loss: 1.6020343
	speed: 0.0069s/iter; left time: 3575.4267s
	iters: 1900, epoch: 3 | loss: 1.6407413
	speed: 0.0069s/iter; left time: 3596.1693s
	iters: 2000, epoch: 3 | loss: 1.4662274
	speed: 0.0069s/iter; left time: 3601.9840s
	iters: 2100, epoch: 3 | loss: 1.5873228
	speed: 0.0069s/iter; left time: 3603.6470s
	iters: 2200, epoch: 3 | loss: 1.4303126
	speed: 0.0069s/iter; left time: 3606.6154s
	iters: 2300, epoch: 3 | loss: 1.4019948
	speed: 0.0069s/iter; left time: 3606.4394s
	iters: 2400, epoch: 3 | loss: 1.5422034
	speed: 0.0069s/iter; left time: 3608.4347s
	iters: 2500, epoch: 3 | loss: 1.6234112
	speed: 0.0069s/iter; left time: 3607.2970s
	iters: 2600, epoch: 3 | loss: 1.9244384
	speed: 0.0069s/iter; left time: 3605.9513s
Epoch: 3 cost time: 18.378512859344482
Epoch: 3, Steps: 2639 | Train Loss: 1.5576735 Vali Loss: 2.1951299 Test Loss: 1.9870321
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 4 | loss: 1.6424619
	speed: 0.2211s/iter; left time: 114928.4752s
	iters: 200, epoch: 4 | loss: 1.4713084
	speed: 0.0069s/iter; left time: 3600.9298s
	iters: 300, epoch: 4 | loss: 1.3252867
	speed: 0.0070s/iter; left time: 3629.5267s
	iters: 400, epoch: 4 | loss: 1.4598136
	speed: 0.0070s/iter; left time: 3612.1846s
	iters: 500, epoch: 4 | loss: 1.4304242
	speed: 0.0070s/iter; left time: 3611.9796s
	iters: 600, epoch: 4 | loss: 1.7862121
	speed: 0.0069s/iter; left time: 3605.4838s
	iters: 700, epoch: 4 | loss: 1.5040588
	speed: 0.0069s/iter; left time: 3607.4508s
	iters: 800, epoch: 4 | loss: 1.4557571
	speed: 0.0070s/iter; left time: 3616.7013s
	iters: 900, epoch: 4 | loss: 1.4888856
	speed: 0.0070s/iter; left time: 3626.1410s
	iters: 1000, epoch: 4 | loss: 1.7639394
	speed: 0.0070s/iter; left time: 3639.3487s
	iters: 1100, epoch: 4 | loss: 1.3854300
	speed: 0.0070s/iter; left time: 3654.7898s
	iters: 1200, epoch: 4 | loss: 1.4806970
	speed: 0.0069s/iter; left time: 3600.2420s
	iters: 1300, epoch: 4 | loss: 1.5152612
	speed: 0.0069s/iter; left time: 3592.7489s
	iters: 1400, epoch: 4 | loss: 1.4275568
	speed: 0.0069s/iter; left time: 3595.6039s
	iters: 1500, epoch: 4 | loss: 1.2425534
	speed: 0.0069s/iter; left time: 3599.8690s
	iters: 1600, epoch: 4 | loss: 1.6161238
	speed: 0.0069s/iter; left time: 3586.2048s
	iters: 1700, epoch: 4 | loss: 1.8920343
	speed: 0.0069s/iter; left time: 3581.2963s
	iters: 1800, epoch: 4 | loss: 1.8256613
	speed: 0.0069s/iter; left time: 3579.1995s
	iters: 1900, epoch: 4 | loss: 1.7967684
	speed: 0.0069s/iter; left time: 3585.2664s
	iters: 2000, epoch: 4 | loss: 1.4443123
	speed: 0.0069s/iter; left time: 3593.8433s
	iters: 2100, epoch: 4 | loss: 1.5286958
	speed: 0.0069s/iter; left time: 3585.9733s
	iters: 2200, epoch: 4 | loss: 1.5286334
	speed: 0.0069s/iter; left time: 3596.8827s
	iters: 2300, epoch: 4 | loss: 1.3993431
	speed: 0.0071s/iter; left time: 3673.6730s
	iters: 2400, epoch: 4 | loss: 1.2940059
	speed: 0.0069s/iter; left time: 3571.2950s
	iters: 2500, epoch: 4 | loss: 1.7462025
	speed: 0.0069s/iter; left time: 3575.0234s
	iters: 2600, epoch: 4 | loss: 1.6697100
	speed: 0.0069s/iter; left time: 3572.3246s
Epoch: 4 cost time: 18.49582815170288
Epoch: 4, Steps: 2639 | Train Loss: 1.5575134 Vali Loss: 2.2292647 Test Loss: 1.9530548
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 5 | loss: 1.5509114
	speed: 0.2206s/iter; left time: 114087.4959s
	iters: 200, epoch: 5 | loss: 1.8392476
	speed: 0.0069s/iter; left time: 3578.1975s
	iters: 300, epoch: 5 | loss: 1.4643137
	speed: 0.0069s/iter; left time: 3572.5558s
	iters: 400, epoch: 5 | loss: 1.3960664
	speed: 0.0069s/iter; left time: 3568.7027s
	iters: 500, epoch: 5 | loss: 1.8004800
	speed: 0.0069s/iter; left time: 3569.3810s
	iters: 600, epoch: 5 | loss: 1.6563606
	speed: 0.0069s/iter; left time: 3563.8752s
	iters: 700, epoch: 5 | loss: 1.4099655
	speed: 0.0069s/iter; left time: 3551.4624s
	iters: 800, epoch: 5 | loss: 1.5483023
	speed: 0.0069s/iter; left time: 3555.5855s
	iters: 900, epoch: 5 | loss: 1.3781270
	speed: 0.0069s/iter; left time: 3558.5546s
	iters: 1000, epoch: 5 | loss: 1.7410573
	speed: 0.0069s/iter; left time: 3557.5909s
	iters: 1100, epoch: 5 | loss: 1.4777898
	speed: 0.0069s/iter; left time: 3561.9373s
	iters: 1200, epoch: 5 | loss: 1.9893563
	speed: 0.0069s/iter; left time: 3542.4364s
	iters: 1300, epoch: 5 | loss: 1.7990704
	speed: 0.0069s/iter; left time: 3549.7445s
	iters: 1400, epoch: 5 | loss: 1.8130238
	speed: 0.0070s/iter; left time: 3627.0782s
	iters: 1500, epoch: 5 | loss: 1.4921466
	speed: 0.0070s/iter; left time: 3590.4157s
	iters: 1600, epoch: 5 | loss: 1.4045446
	speed: 0.0070s/iter; left time: 3594.6543s
	iters: 1700, epoch: 5 | loss: 1.4131320
	speed: 0.0069s/iter; left time: 3558.8993s
	iters: 1800, epoch: 5 | loss: 1.6600400
	speed: 0.0069s/iter; left time: 3561.1608s
	iters: 1900, epoch: 5 | loss: 1.5607662
	speed: 0.0069s/iter; left time: 3565.6758s
	iters: 2000, epoch: 5 | loss: 1.4022217
	speed: 0.0069s/iter; left time: 3564.1731s
	iters: 2100, epoch: 5 | loss: 1.5006934
	speed: 0.0069s/iter; left time: 3566.3296s
	iters: 2200, epoch: 5 | loss: 1.4170331
	speed: 0.0069s/iter; left time: 3572.4169s
	iters: 2300, epoch: 5 | loss: 1.5082049
	speed: 0.0069s/iter; left time: 3565.6988s
	iters: 2400, epoch: 5 | loss: 1.5084618
	speed: 0.0069s/iter; left time: 3562.2200s
	iters: 2500, epoch: 5 | loss: 1.3268737
	speed: 0.0069s/iter; left time: 3561.5355s
	iters: 2600, epoch: 5 | loss: 1.7229005
	speed: 0.0069s/iter; left time: 3559.4681s
Epoch: 5 cost time: 18.405002117156982
Epoch: 5, Steps: 2639 | Train Loss: 1.5575029 Vali Loss: 2.1820269 Test Loss: 1.9603332
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 6 | loss: 1.4126974
	speed: 0.2205s/iter; left time: 113425.0819s
	iters: 200, epoch: 6 | loss: 1.5643681
	speed: 0.0069s/iter; left time: 3524.2327s
	iters: 300, epoch: 6 | loss: 1.6334080
	speed: 0.0068s/iter; left time: 3519.1529s
	iters: 400, epoch: 6 | loss: 1.7297419
	speed: 0.0068s/iter; left time: 3518.5397s
	iters: 500, epoch: 6 | loss: 1.7893723
	speed: 0.0068s/iter; left time: 3509.5745s
	iters: 600, epoch: 6 | loss: 1.4065424
	speed: 0.0068s/iter; left time: 3512.9016s
	iters: 700, epoch: 6 | loss: 1.7926435
	speed: 0.0068s/iter; left time: 3513.8514s
	iters: 800, epoch: 6 | loss: 1.3993537
	speed: 0.0068s/iter; left time: 3510.4151s
	iters: 900, epoch: 6 | loss: 1.6796091
	speed: 0.0068s/iter; left time: 3512.3394s
	iters: 1000, epoch: 6 | loss: 1.3400283
	speed: 0.0068s/iter; left time: 3506.3082s
	iters: 1100, epoch: 6 | loss: 1.3066617
	speed: 0.0068s/iter; left time: 3500.8899s
	iters: 1200, epoch: 6 | loss: 1.3454306
	speed: 0.0068s/iter; left time: 3498.4920s
	iters: 1300, epoch: 6 | loss: 1.3745160
	speed: 0.0068s/iter; left time: 3504.7472s
	iters: 1400, epoch: 6 | loss: 1.3417970
	speed: 0.0068s/iter; left time: 3494.3064s
	iters: 1500, epoch: 6 | loss: 1.4026603
	speed: 0.0068s/iter; left time: 3493.8604s
	iters: 1600, epoch: 6 | loss: 1.6634088
	speed: 0.0068s/iter; left time: 3497.1068s
	iters: 1700, epoch: 6 | loss: 2.1176662
	speed: 0.0068s/iter; left time: 3494.9418s
	iters: 1800, epoch: 6 | loss: 2.0218921
	speed: 0.0068s/iter; left time: 3494.2176s
	iters: 1900, epoch: 6 | loss: 1.5759380
	speed: 0.0068s/iter; left time: 3492.9372s
	iters: 2000, epoch: 6 | loss: 1.7166398
	speed: 0.0068s/iter; left time: 3490.5254s
	iters: 2100, epoch: 6 | loss: 1.6386145
	speed: 0.0068s/iter; left time: 3493.8010s
	iters: 2200, epoch: 6 | loss: 1.3956796
	speed: 0.0070s/iter; left time: 3580.4920s
	iters: 2300, epoch: 6 | loss: 1.5125577
	speed: 0.0069s/iter; left time: 3548.0714s
	iters: 2400, epoch: 6 | loss: 1.5587770
	speed: 0.0069s/iter; left time: 3536.9511s
	iters: 2500, epoch: 6 | loss: 2.0426364
	speed: 0.0070s/iter; left time: 3572.1359s
	iters: 2600, epoch: 6 | loss: 1.5327610
	speed: 0.0069s/iter; left time: 3538.2055s
Epoch: 6 cost time: 18.231542348861694
Epoch: 6, Steps: 2639 | Train Loss: 1.5577792 Vali Loss: 2.2033699 Test Loss: 1.9559720
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems10_all_96_96_DLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 141325
test shape: (14132, 1, 96, 107) (14132, 1, 96, 107)
test shape: (14132, 96, 107) (14132, 96, 107)
mse:1.9771952629089355, mae:1.11929190158844
>>>>>>>Overall time: 329 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
