Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=130, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems06_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=130, expand=2, factor=1, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems06_all_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=192, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_all_96_192_Mamba_custom_ftM_sl192_ll48_pl192_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 795606
val 195060
test 195058
	iters: 100, epoch: 1 | loss: 1.1634626
	speed: 0.0379s/iter; left time: 937.8918s
	iters: 200, epoch: 1 | loss: 1.1791255
	speed: 0.0182s/iter; left time: 448.1282s
	iters: 300, epoch: 1 | loss: 0.8393654
	speed: 0.0188s/iter; left time: 462.9243s
	iters: 400, epoch: 1 | loss: 0.9177293
	speed: 0.0189s/iter; left time: 462.2208s
	iters: 500, epoch: 1 | loss: 0.6802152
	speed: 0.0183s/iter; left time: 445.1069s
	iters: 600, epoch: 1 | loss: 0.9690949
	speed: 0.0187s/iter; left time: 453.9926s
	iters: 700, epoch: 1 | loss: 0.8183035
	speed: 0.0188s/iter; left time: 453.3923s
	iters: 800, epoch: 1 | loss: 0.7467853
	speed: 0.0199s/iter; left time: 478.8604s
	iters: 900, epoch: 1 | loss: 0.8052545
	speed: 0.0201s/iter; left time: 480.7032s
	iters: 1000, epoch: 1 | loss: 0.6732312
	speed: 0.0186s/iter; left time: 444.7603s
	iters: 1100, epoch: 1 | loss: 0.5871339
	speed: 0.0173s/iter; left time: 409.9526s
	iters: 1200, epoch: 1 | loss: 0.7665032
	speed: 0.0176s/iter; left time: 415.5896s
	iters: 1300, epoch: 1 | loss: 0.6095561
	speed: 0.0164s/iter; left time: 387.0242s
	iters: 1400, epoch: 1 | loss: 0.6057745
	speed: 0.0180s/iter; left time: 422.5434s
	iters: 1500, epoch: 1 | loss: 0.6301577
	speed: 0.0189s/iter; left time: 440.4735s
	iters: 1600, epoch: 1 | loss: 0.5847070
	speed: 0.0173s/iter; left time: 403.4710s
	iters: 1700, epoch: 1 | loss: 0.6567884
	speed: 0.0171s/iter; left time: 396.4929s
	iters: 1800, epoch: 1 | loss: 0.6539287
	speed: 0.0189s/iter; left time: 434.8734s
	iters: 1900, epoch: 1 | loss: 0.6947678
	speed: 0.0168s/iter; left time: 385.3812s
	iters: 2000, epoch: 1 | loss: 0.6156842
	speed: 0.0155s/iter; left time: 354.0430s
	iters: 2100, epoch: 1 | loss: 0.6077733
	speed: 0.0192s/iter; left time: 437.1225s
	iters: 2200, epoch: 1 | loss: 0.7786281
	speed: 0.0171s/iter; left time: 387.5521s
	iters: 2300, epoch: 1 | loss: 0.5423734
	speed: 0.0188s/iter; left time: 424.0303s
	iters: 2400, epoch: 1 | loss: 0.7781574
	speed: 0.0188s/iter; left time: 422.0114s
Epoch: 1 cost time: 47.277902364730835
Epoch: 1, Steps: 2486 | Train Loss: 0.7789542 Vali Loss: 1.5867329 Test Loss: 2.2974367
Validation loss decreased (inf --> 1.586733).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6286345
	speed: 0.8083s/iter; left time: 18005.3972s
	iters: 200, epoch: 2 | loss: 0.7452236
	speed: 0.0177s/iter; left time: 392.5304s
	iters: 300, epoch: 2 | loss: 0.5858607
	speed: 0.0177s/iter; left time: 391.2200s
	iters: 400, epoch: 2 | loss: 0.6658882
	speed: 0.0177s/iter; left time: 389.6716s
	iters: 500, epoch: 2 | loss: 0.5409738
	speed: 0.0177s/iter; left time: 386.4536s
	iters: 600, epoch: 2 | loss: 0.6801502
	speed: 0.0181s/iter; left time: 394.3425s
	iters: 700, epoch: 2 | loss: 0.7057062
	speed: 0.0178s/iter; left time: 384.9136s
	iters: 800, epoch: 2 | loss: 0.6326579
	speed: 0.0180s/iter; left time: 387.6364s
	iters: 900, epoch: 2 | loss: 0.7460302
	speed: 0.0179s/iter; left time: 383.8056s
	iters: 1000, epoch: 2 | loss: 0.5972517
	speed: 0.0177s/iter; left time: 378.1015s
	iters: 1100, epoch: 2 | loss: 0.6329375
	speed: 0.0180s/iter; left time: 382.4467s
	iters: 1200, epoch: 2 | loss: 0.4756948
	speed: 0.0194s/iter; left time: 410.3107s
	iters: 1300, epoch: 2 | loss: 0.6125313
	speed: 0.0180s/iter; left time: 379.2520s
	iters: 1400, epoch: 2 | loss: 0.7683345
	speed: 0.0186s/iter; left time: 389.1233s
	iters: 1500, epoch: 2 | loss: 0.6161515
	speed: 0.0191s/iter; left time: 398.8673s
	iters: 1600, epoch: 2 | loss: 0.5006079
	speed: 0.0181s/iter; left time: 375.5452s
	iters: 1700, epoch: 2 | loss: 0.6711870
	speed: 0.0172s/iter; left time: 354.9618s
	iters: 1800, epoch: 2 | loss: 0.5699782
	speed: 0.0168s/iter; left time: 346.2023s
	iters: 1900, epoch: 2 | loss: 0.4619229
	speed: 0.0168s/iter; left time: 343.5221s
	iters: 2000, epoch: 2 | loss: 0.7025269
	speed: 0.0175s/iter; left time: 357.3377s
	iters: 2100, epoch: 2 | loss: 0.5727489
	speed: 0.0192s/iter; left time: 389.9329s
	iters: 2200, epoch: 2 | loss: 0.6161119
	speed: 0.0193s/iter; left time: 388.7100s
	iters: 2300, epoch: 2 | loss: 0.5796600
	speed: 0.0180s/iter; left time: 360.9995s
	iters: 2400, epoch: 2 | loss: 0.5342177
	speed: 0.0180s/iter; left time: 359.7561s
Epoch: 2 cost time: 45.123265743255615
Epoch: 2, Steps: 2486 | Train Loss: 0.6299173 Vali Loss: 1.5859176 Test Loss: 2.3398523
Validation loss decreased (1.586733 --> 1.585918).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4933068
	speed: 0.5537s/iter; left time: 10957.6418s
	iters: 200, epoch: 3 | loss: 0.6352810
	speed: 0.0178s/iter; left time: 351.4138s
	iters: 300, epoch: 3 | loss: 0.5641258
	speed: 0.0179s/iter; left time: 351.0310s
	iters: 400, epoch: 3 | loss: 0.8366390
	speed: 0.0180s/iter; left time: 351.2750s
	iters: 500, epoch: 3 | loss: 0.4875905
	speed: 0.0179s/iter; left time: 347.9706s
	iters: 600, epoch: 3 | loss: 0.6213282
	speed: 0.0180s/iter; left time: 347.8162s
	iters: 700, epoch: 3 | loss: 0.6125404
	speed: 0.0180s/iter; left time: 345.4000s
	iters: 800, epoch: 3 | loss: 0.5935007
	speed: 0.0180s/iter; left time: 344.2499s
	iters: 900, epoch: 3 | loss: 0.6716818
	speed: 0.0179s/iter; left time: 340.4761s
	iters: 1000, epoch: 3 | loss: 0.5216850
	speed: 0.0179s/iter; left time: 338.5101s
	iters: 1100, epoch: 3 | loss: 0.5849666
	speed: 0.0181s/iter; left time: 340.1210s
	iters: 1200, epoch: 3 | loss: 0.4077747
	speed: 0.0178s/iter; left time: 331.8669s
	iters: 1300, epoch: 3 | loss: 0.5514917
	speed: 0.0178s/iter; left time: 331.1885s
	iters: 1400, epoch: 3 | loss: 0.6279330
	speed: 0.0178s/iter; left time: 328.4504s
	iters: 1500, epoch: 3 | loss: 0.4008774
	speed: 0.0178s/iter; left time: 326.6724s
	iters: 1600, epoch: 3 | loss: 0.5382727
	speed: 0.0181s/iter; left time: 330.6385s
	iters: 1700, epoch: 3 | loss: 0.5528722
	speed: 0.0187s/iter; left time: 340.5318s
	iters: 1800, epoch: 3 | loss: 0.5770251
	speed: 0.0181s/iter; left time: 327.6127s
	iters: 1900, epoch: 3 | loss: 0.5093780
	speed: 0.0193s/iter; left time: 346.9831s
	iters: 2000, epoch: 3 | loss: 0.4468046
	speed: 0.0183s/iter; left time: 327.6714s
	iters: 2100, epoch: 3 | loss: 0.8075275
	speed: 0.0192s/iter; left time: 340.7607s
	iters: 2200, epoch: 3 | loss: 0.4558236
	speed: 0.0184s/iter; left time: 325.4732s
	iters: 2300, epoch: 3 | loss: 0.5398694
	speed: 0.0180s/iter; left time: 316.9158s
	iters: 2400, epoch: 3 | loss: 0.4890677
	speed: 0.0189s/iter; left time: 329.8654s
Epoch: 3 cost time: 45.58998441696167
Epoch: 3, Steps: 2486 | Train Loss: 0.5865417 Vali Loss: 1.5605705 Test Loss: 2.3148661
Validation loss decreased (1.585918 --> 1.560570).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6693543
	speed: 0.5886s/iter; left time: 10184.2756s
	iters: 200, epoch: 4 | loss: 0.5823103
	speed: 0.0178s/iter; left time: 305.5048s
	iters: 300, epoch: 4 | loss: 0.6714096
	speed: 0.0179s/iter; left time: 305.6280s
	iters: 400, epoch: 4 | loss: 0.4525734
	speed: 0.0178s/iter; left time: 303.1274s
	iters: 500, epoch: 4 | loss: 0.5504799
	speed: 0.0179s/iter; left time: 302.0175s
	iters: 600, epoch: 4 | loss: 0.5601702
	speed: 0.0178s/iter; left time: 299.3403s
	iters: 700, epoch: 4 | loss: 0.5277880
	speed: 0.0178s/iter; left time: 297.2332s
	iters: 800, epoch: 4 | loss: 0.5487453
	speed: 0.0178s/iter; left time: 295.7340s
	iters: 900, epoch: 4 | loss: 0.5072907
	speed: 0.0179s/iter; left time: 295.4225s
	iters: 1000, epoch: 4 | loss: 0.7138642
	speed: 0.0178s/iter; left time: 292.3816s
	iters: 1100, epoch: 4 | loss: 0.5061640
	speed: 0.0179s/iter; left time: 292.6129s
	iters: 1200, epoch: 4 | loss: 0.6368473
	speed: 0.0180s/iter; left time: 292.3952s
	iters: 1300, epoch: 4 | loss: 0.5062613
	speed: 0.0180s/iter; left time: 289.7618s
	iters: 1400, epoch: 4 | loss: 0.6891004
	speed: 0.0193s/iter; left time: 308.4566s
	iters: 1500, epoch: 4 | loss: 0.5703576
	speed: 0.0177s/iter; left time: 281.1649s
	iters: 1600, epoch: 4 | loss: 0.5616158
	speed: 0.0191s/iter; left time: 301.6119s
	iters: 1700, epoch: 4 | loss: 0.4470527
	speed: 0.0189s/iter; left time: 297.2863s
	iters: 1800, epoch: 4 | loss: 0.5303785
	speed: 0.0186s/iter; left time: 290.2169s
	iters: 1900, epoch: 4 | loss: 0.5325627
	speed: 0.0183s/iter; left time: 284.0207s
	iters: 2000, epoch: 4 | loss: 0.4645689
	speed: 0.0181s/iter; left time: 279.1153s
	iters: 2100, epoch: 4 | loss: 0.6833291
	speed: 0.0185s/iter; left time: 282.5507s
	iters: 2200, epoch: 4 | loss: 0.5585930
	speed: 0.0193s/iter; left time: 293.1840s
	iters: 2300, epoch: 4 | loss: 0.5206331
	speed: 0.0180s/iter; left time: 271.9780s
	iters: 2400, epoch: 4 | loss: 0.5656453
	speed: 0.0183s/iter; left time: 274.2368s
Epoch: 4 cost time: 45.61883592605591
Epoch: 4, Steps: 2486 | Train Loss: 0.5703349 Vali Loss: 1.5461029 Test Loss: 2.2878501
Validation loss decreased (1.560570 --> 1.546103).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6934774
	speed: 0.7913s/iter; left time: 11725.1173s
	iters: 200, epoch: 5 | loss: 0.7190368
	speed: 0.0177s/iter; left time: 260.1962s
	iters: 300, epoch: 5 | loss: 0.5930920
	speed: 0.0188s/iter; left time: 275.2096s
	iters: 400, epoch: 5 | loss: 0.4037705
	speed: 0.0187s/iter; left time: 271.7938s
	iters: 500, epoch: 5 | loss: 0.6435548
	speed: 0.0193s/iter; left time: 277.7581s
	iters: 600, epoch: 5 | loss: 0.5792907
	speed: 0.0195s/iter; left time: 279.4151s
	iters: 700, epoch: 5 | loss: 0.5761822
	speed: 0.0185s/iter; left time: 262.9188s
	iters: 800, epoch: 5 | loss: 0.4471460
	speed: 0.0169s/iter; left time: 238.8355s
	iters: 900, epoch: 5 | loss: 0.5179210
	speed: 0.0164s/iter; left time: 229.9914s
	iters: 1000, epoch: 5 | loss: 0.4718913
	speed: 0.0170s/iter; left time: 236.9337s
	iters: 1100, epoch: 5 | loss: 0.6091260
	speed: 0.0160s/iter; left time: 220.5050s
	iters: 1200, epoch: 5 | loss: 0.5559554
	speed: 0.0157s/iter; left time: 214.9957s
	iters: 1300, epoch: 5 | loss: 0.7124550
	speed: 0.0158s/iter; left time: 215.0546s
	iters: 1400, epoch: 5 | loss: 0.5586601
	speed: 0.0158s/iter; left time: 213.6406s
	iters: 1500, epoch: 5 | loss: 0.5611243
	speed: 0.0178s/iter; left time: 238.3501s
	iters: 1600, epoch: 5 | loss: 0.5254482
	speed: 0.0163s/iter; left time: 216.8057s
	iters: 1700, epoch: 5 | loss: 0.5184591
	speed: 0.0157s/iter; left time: 207.4434s
	iters: 1800, epoch: 5 | loss: 0.4960500
	speed: 0.0157s/iter; left time: 205.7634s
	iters: 1900, epoch: 5 | loss: 0.5567147
	speed: 0.0156s/iter; left time: 202.9981s
	iters: 2000, epoch: 5 | loss: 0.4363672
	speed: 0.0168s/iter; left time: 216.8013s
	iters: 2100, epoch: 5 | loss: 0.6047748
	speed: 0.0172s/iter; left time: 220.4762s
	iters: 2200, epoch: 5 | loss: 0.5205620
	speed: 0.0174s/iter; left time: 220.7490s
	iters: 2300, epoch: 5 | loss: 0.4908510
	speed: 0.0173s/iter; left time: 217.7979s
	iters: 2400, epoch: 5 | loss: 0.5704292
	speed: 0.0185s/iter; left time: 231.9730s
Epoch: 5 cost time: 43.280219316482544
Epoch: 5, Steps: 2486 | Train Loss: 0.5631278 Vali Loss: 1.5474896 Test Loss: 2.2944541
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5224470
	speed: 0.7167s/iter; left time: 8837.2110s
	iters: 200, epoch: 6 | loss: 0.5471272
	speed: 0.0178s/iter; left time: 217.2120s
	iters: 300, epoch: 6 | loss: 0.4818302
	speed: 0.0177s/iter; left time: 215.1500s
	iters: 400, epoch: 6 | loss: 0.6354986
	speed: 0.0178s/iter; left time: 213.7752s
	iters: 500, epoch: 6 | loss: 0.4715669
	speed: 0.0178s/iter; left time: 212.2641s
	iters: 600, epoch: 6 | loss: 0.4963208
	speed: 0.0178s/iter; left time: 210.3921s
	iters: 700, epoch: 6 | loss: 0.6360166
	speed: 0.0176s/iter; left time: 206.1445s
	iters: 800, epoch: 6 | loss: 0.6109616
	speed: 0.0176s/iter; left time: 204.5606s
	iters: 900, epoch: 6 | loss: 0.7389698
	speed: 0.0176s/iter; left time: 203.1608s
	iters: 1000, epoch: 6 | loss: 0.5089622
	speed: 0.0188s/iter; left time: 214.6135s
	iters: 1100, epoch: 6 | loss: 0.5932239
	speed: 0.0181s/iter; left time: 204.7369s
	iters: 1200, epoch: 6 | loss: 0.5296855
	speed: 0.0181s/iter; left time: 203.6220s
	iters: 1300, epoch: 6 | loss: 0.6203128
	speed: 0.0186s/iter; left time: 207.0907s
	iters: 1400, epoch: 6 | loss: 0.5358104
	speed: 0.0179s/iter; left time: 197.2996s
	iters: 1500, epoch: 6 | loss: 0.4228945
	speed: 0.0176s/iter; left time: 192.2530s
	iters: 1600, epoch: 6 | loss: 0.7126091
	speed: 0.0185s/iter; left time: 200.4079s
	iters: 1700, epoch: 6 | loss: 0.4566368
	speed: 0.0188s/iter; left time: 201.6516s
	iters: 1800, epoch: 6 | loss: 0.6639568
	speed: 0.0181s/iter; left time: 192.0024s
	iters: 1900, epoch: 6 | loss: 0.6136773
	speed: 0.0185s/iter; left time: 194.7703s
	iters: 2000, epoch: 6 | loss: 0.5787156
	speed: 0.0180s/iter; left time: 187.9095s
	iters: 2100, epoch: 6 | loss: 0.8225557
	speed: 0.0173s/iter; left time: 178.6276s
	iters: 2200, epoch: 6 | loss: 0.5792378
	speed: 0.0173s/iter; left time: 176.8514s
	iters: 2300, epoch: 6 | loss: 0.5735075
	speed: 0.0175s/iter; left time: 177.7045s
	iters: 2400, epoch: 6 | loss: 0.5683235
	speed: 0.0193s/iter; left time: 193.3200s
Epoch: 6 cost time: 45.21895980834961
