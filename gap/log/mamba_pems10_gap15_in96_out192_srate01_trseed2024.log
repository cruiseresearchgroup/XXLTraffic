Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=107, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems10_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=107, expand=2, factor=1, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems10_all_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=192, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_all_96_192_Mamba_custom_ftM_sl192_ll48_pl192_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 896775
val 193647
test 193645
	iters: 100, epoch: 1 | loss: 1.0207294
	speed: 0.0295s/iter; left time: 822.5855s
	iters: 200, epoch: 1 | loss: 0.8399042
	speed: 0.0119s/iter; left time: 330.4035s
	iters: 300, epoch: 1 | loss: 0.8404852
	speed: 0.0117s/iter; left time: 325.3363s
	iters: 400, epoch: 1 | loss: 0.8039505
	speed: 0.0110s/iter; left time: 304.9756s
	iters: 500, epoch: 1 | loss: 0.7877629
	speed: 0.0114s/iter; left time: 314.4949s
	iters: 600, epoch: 1 | loss: 0.6873262
	speed: 0.0114s/iter; left time: 313.5939s
	iters: 700, epoch: 1 | loss: 0.6671590
	speed: 0.0114s/iter; left time: 311.5048s
	iters: 800, epoch: 1 | loss: 0.7910727
	speed: 0.0117s/iter; left time: 319.4891s
	iters: 900, epoch: 1 | loss: 0.6567050
	speed: 0.0112s/iter; left time: 305.1109s
	iters: 1000, epoch: 1 | loss: 0.7809361
	speed: 0.0112s/iter; left time: 301.8930s
	iters: 1100, epoch: 1 | loss: 0.7042460
	speed: 0.0115s/iter; left time: 310.8040s
	iters: 1200, epoch: 1 | loss: 0.6610965
	speed: 0.0109s/iter; left time: 293.0968s
	iters: 1300, epoch: 1 | loss: 0.7563391
	speed: 0.0112s/iter; left time: 299.3712s
	iters: 1400, epoch: 1 | loss: 0.6204260
	speed: 0.0109s/iter; left time: 289.0754s
	iters: 1500, epoch: 1 | loss: 0.6731942
	speed: 0.0117s/iter; left time: 311.3795s
	iters: 1600, epoch: 1 | loss: 0.8110917
	speed: 0.0113s/iter; left time: 299.5772s
	iters: 1700, epoch: 1 | loss: 0.6194552
	speed: 0.0112s/iter; left time: 295.7736s
	iters: 1800, epoch: 1 | loss: 0.7297976
	speed: 0.0112s/iter; left time: 294.6362s
	iters: 1900, epoch: 1 | loss: 0.5773136
	speed: 0.0117s/iter; left time: 304.4904s
	iters: 2000, epoch: 1 | loss: 0.6049509
	speed: 0.0113s/iter; left time: 293.7521s
	iters: 2100, epoch: 1 | loss: 0.6275494
	speed: 0.0111s/iter; left time: 287.1208s
	iters: 2200, epoch: 1 | loss: 0.6293905
	speed: 0.0112s/iter; left time: 287.9057s
	iters: 2300, epoch: 1 | loss: 0.6443706
	speed: 0.0113s/iter; left time: 289.9258s
	iters: 2400, epoch: 1 | loss: 0.6568853
	speed: 0.0111s/iter; left time: 285.6564s
	iters: 2500, epoch: 1 | loss: 0.5572160
	speed: 0.0108s/iter; left time: 276.5897s
	iters: 2600, epoch: 1 | loss: 0.5992841
	speed: 0.0112s/iter; left time: 284.9806s
	iters: 2700, epoch: 1 | loss: 0.4924013
	speed: 0.0109s/iter; left time: 276.1543s
	iters: 2800, epoch: 1 | loss: 0.5940012
	speed: 0.0108s/iter; left time: 273.2817s
Epoch: 1 cost time: 33.49219608306885
Epoch: 1, Steps: 2802 | Train Loss: 0.7250284 Vali Loss: 2.2885718 Test Loss: 2.4113643
Validation loss decreased (inf --> 2.288572).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7637235
	speed: 0.4462s/iter; left time: 11206.9594s
	iters: 200, epoch: 2 | loss: 0.5757040
	speed: 0.0112s/iter; left time: 279.4373s
	iters: 300, epoch: 2 | loss: 0.6277627
	speed: 0.0112s/iter; left time: 277.9688s
	iters: 400, epoch: 2 | loss: 0.5769698
	speed: 0.0112s/iter; left time: 277.2055s
	iters: 500, epoch: 2 | loss: 0.6605206
	speed: 0.0112s/iter; left time: 276.0663s
	iters: 600, epoch: 2 | loss: 0.6178439
	speed: 0.0112s/iter; left time: 274.5908s
	iters: 700, epoch: 2 | loss: 0.5264621
	speed: 0.0111s/iter; left time: 272.9965s
	iters: 800, epoch: 2 | loss: 0.5337853
	speed: 0.0111s/iter; left time: 271.8444s
	iters: 900, epoch: 2 | loss: 0.5581905
	speed: 0.0111s/iter; left time: 271.1152s
	iters: 1000, epoch: 2 | loss: 0.6143748
	speed: 0.0111s/iter; left time: 269.8618s
	iters: 1100, epoch: 2 | loss: 0.6327950
	speed: 0.0111s/iter; left time: 268.7840s
	iters: 1200, epoch: 2 | loss: 0.5396370
	speed: 0.0112s/iter; left time: 268.6931s
	iters: 1300, epoch: 2 | loss: 0.5480106
	speed: 0.0112s/iter; left time: 267.4222s
	iters: 1400, epoch: 2 | loss: 0.5738174
	speed: 0.0112s/iter; left time: 265.8943s
	iters: 1500, epoch: 2 | loss: 0.5818340
	speed: 0.0112s/iter; left time: 264.7160s
	iters: 1600, epoch: 2 | loss: 0.5398228
	speed: 0.0112s/iter; left time: 263.7567s
	iters: 1700, epoch: 2 | loss: 0.6325222
	speed: 0.0112s/iter; left time: 263.1487s
	iters: 1800, epoch: 2 | loss: 0.5765381
	speed: 0.0112s/iter; left time: 261.7408s
	iters: 1900, epoch: 2 | loss: 0.5496016
	speed: 0.0112s/iter; left time: 260.6152s
	iters: 2000, epoch: 2 | loss: 0.6999601
	speed: 0.0112s/iter; left time: 260.2929s
	iters: 2100, epoch: 2 | loss: 0.5680724
	speed: 0.0112s/iter; left time: 258.2547s
	iters: 2200, epoch: 2 | loss: 0.6230255
	speed: 0.0112s/iter; left time: 257.4400s
	iters: 2300, epoch: 2 | loss: 0.5427713
	speed: 0.0112s/iter; left time: 256.8818s
	iters: 2400, epoch: 2 | loss: 0.5384210
	speed: 0.0112s/iter; left time: 255.9109s
	iters: 2500, epoch: 2 | loss: 0.5332876
	speed: 0.0112s/iter; left time: 254.2732s
	iters: 2600, epoch: 2 | loss: 0.5557117
	speed: 0.0112s/iter; left time: 252.9857s
	iters: 2700, epoch: 2 | loss: 0.6791459
	speed: 0.0112s/iter; left time: 252.3386s
	iters: 2800, epoch: 2 | loss: 0.5582200
	speed: 0.0112s/iter; left time: 251.1775s
Epoch: 2 cost time: 31.584202527999878
Epoch: 2, Steps: 2802 | Train Loss: 0.5823778 Vali Loss: 2.2495275 Test Loss: 2.4912262
Validation loss decreased (2.288572 --> 2.249527).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5646326
	speed: 0.4437s/iter; left time: 9902.4458s
	iters: 200, epoch: 3 | loss: 0.5735670
	speed: 0.0111s/iter; left time: 245.9874s
	iters: 300, epoch: 3 | loss: 0.5793304
	speed: 0.0111s/iter; left time: 244.4562s
	iters: 400, epoch: 3 | loss: 0.6751720
	speed: 0.0110s/iter; left time: 242.8275s
	iters: 500, epoch: 3 | loss: 0.5341293
	speed: 0.0110s/iter; left time: 241.7129s
	iters: 600, epoch: 3 | loss: 0.5120068
	speed: 0.0110s/iter; left time: 241.0280s
	iters: 700, epoch: 3 | loss: 0.5268164
	speed: 0.0111s/iter; left time: 240.2257s
	iters: 800, epoch: 3 | loss: 0.4795096
	speed: 0.0111s/iter; left time: 239.6905s
	iters: 900, epoch: 3 | loss: 0.6213861
	speed: 0.0111s/iter; left time: 238.3171s
	iters: 1000, epoch: 3 | loss: 0.5309622
	speed: 0.0111s/iter; left time: 236.9019s
	iters: 1100, epoch: 3 | loss: 0.6538398
	speed: 0.0111s/iter; left time: 235.9808s
	iters: 1200, epoch: 3 | loss: 0.5691145
	speed: 0.0111s/iter; left time: 234.5963s
	iters: 1300, epoch: 3 | loss: 0.5832190
	speed: 0.0110s/iter; left time: 233.3111s
	iters: 1400, epoch: 3 | loss: 0.6992320
	speed: 0.0111s/iter; left time: 233.3806s
	iters: 1500, epoch: 3 | loss: 0.5277653
	speed: 0.0111s/iter; left time: 231.8402s
	iters: 1600, epoch: 3 | loss: 0.6052223
	speed: 0.0111s/iter; left time: 230.9879s
	iters: 1700, epoch: 3 | loss: 0.5023578
	speed: 0.0111s/iter; left time: 229.4755s
	iters: 1800, epoch: 3 | loss: 0.5037690
	speed: 0.0111s/iter; left time: 228.3622s
	iters: 1900, epoch: 3 | loss: 0.5074934
	speed: 0.0111s/iter; left time: 227.3806s
	iters: 2000, epoch: 3 | loss: 0.5847662
	speed: 0.0111s/iter; left time: 226.2410s
	iters: 2100, epoch: 3 | loss: 0.6222008
	speed: 0.0111s/iter; left time: 224.9136s
	iters: 2200, epoch: 3 | loss: 0.5728085
	speed: 0.0111s/iter; left time: 223.9627s
	iters: 2300, epoch: 3 | loss: 0.5296575
	speed: 0.0111s/iter; left time: 222.9668s
	iters: 2400, epoch: 3 | loss: 0.5510092
	speed: 0.0111s/iter; left time: 222.0865s
	iters: 2500, epoch: 3 | loss: 0.5073651
	speed: 0.0111s/iter; left time: 220.0845s
	iters: 2600, epoch: 3 | loss: 0.6358307
	speed: 0.0111s/iter; left time: 219.8193s
	iters: 2700, epoch: 3 | loss: 0.5141141
	speed: 0.0111s/iter; left time: 218.6071s
	iters: 2800, epoch: 3 | loss: 0.5916080
	speed: 0.0111s/iter; left time: 217.5920s
Epoch: 3 cost time: 31.298619270324707
Epoch: 3, Steps: 2802 | Train Loss: 0.5428717 Vali Loss: 2.2441978 Test Loss: 2.5253637
Validation loss decreased (2.249527 --> 2.244198).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5828979
	speed: 0.4466s/iter; left time: 8715.7811s
	iters: 200, epoch: 4 | loss: 0.5416601
	speed: 0.0112s/iter; left time: 218.4165s
	iters: 300, epoch: 4 | loss: 0.4869879
	speed: 0.0112s/iter; left time: 216.4403s
	iters: 400, epoch: 4 | loss: 0.5817801
	speed: 0.0113s/iter; left time: 216.2069s
	iters: 500, epoch: 4 | loss: 0.5531672
	speed: 0.0112s/iter; left time: 214.1296s
	iters: 600, epoch: 4 | loss: 0.5650672
	speed: 0.0112s/iter; left time: 213.4922s
	iters: 700, epoch: 4 | loss: 0.4783769
	speed: 0.0112s/iter; left time: 212.1619s
	iters: 800, epoch: 4 | loss: 0.4753754
	speed: 0.0112s/iter; left time: 210.9941s
	iters: 900, epoch: 4 | loss: 0.5536310
	speed: 0.0112s/iter; left time: 210.0782s
	iters: 1000, epoch: 4 | loss: 0.5729964
	speed: 0.0112s/iter; left time: 209.1391s
	iters: 1100, epoch: 4 | loss: 0.5384330
	speed: 0.0113s/iter; left time: 208.3296s
	iters: 1200, epoch: 4 | loss: 0.5592816
	speed: 0.0113s/iter; left time: 207.5977s
	iters: 1300, epoch: 4 | loss: 0.5278615
	speed: 0.0112s/iter; left time: 205.8993s
	iters: 1400, epoch: 4 | loss: 0.5475621
	speed: 0.0113s/iter; left time: 205.0312s
	iters: 1500, epoch: 4 | loss: 0.5631333
	speed: 0.0112s/iter; left time: 203.5519s
	iters: 1600, epoch: 4 | loss: 0.5511002
	speed: 0.0112s/iter; left time: 202.4305s
	iters: 1700, epoch: 4 | loss: 0.4784170
	speed: 0.0112s/iter; left time: 201.0315s
	iters: 1800, epoch: 4 | loss: 0.4492640
	speed: 0.0112s/iter; left time: 199.9794s
	iters: 1900, epoch: 4 | loss: 0.4695027
	speed: 0.0112s/iter; left time: 198.9779s
	iters: 2000, epoch: 4 | loss: 0.5178284
	speed: 0.0112s/iter; left time: 198.1346s
	iters: 2100, epoch: 4 | loss: 0.4999747
	speed: 0.0112s/iter; left time: 195.9274s
	iters: 2200, epoch: 4 | loss: 0.6073331
	speed: 0.0112s/iter; left time: 195.0903s
	iters: 2300, epoch: 4 | loss: 0.4754680
	speed: 0.0112s/iter; left time: 194.0835s
	iters: 2400, epoch: 4 | loss: 0.5049970
	speed: 0.0112s/iter; left time: 192.8858s
	iters: 2500, epoch: 4 | loss: 0.5187078
	speed: 0.0112s/iter; left time: 191.3748s
	iters: 2600, epoch: 4 | loss: 0.4706318
	speed: 0.0112s/iter; left time: 190.8627s
	iters: 2700, epoch: 4 | loss: 0.5609438
	speed: 0.0112s/iter; left time: 189.7494s
	iters: 2800, epoch: 4 | loss: 0.5820646
	speed: 0.0112s/iter; left time: 188.8585s
Epoch: 4 cost time: 31.768311262130737
Epoch: 4, Steps: 2802 | Train Loss: 0.5269514 Vali Loss: 2.2680712 Test Loss: 2.5516291
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4882340
	speed: 0.4416s/iter; left time: 7379.8252s
	iters: 200, epoch: 5 | loss: 0.5044415
	speed: 0.0112s/iter; left time: 185.8753s
	iters: 300, epoch: 5 | loss: 0.5149612
	speed: 0.0111s/iter; left time: 183.6187s
	iters: 400, epoch: 5 | loss: 0.5107561
	speed: 0.0112s/iter; left time: 183.0189s
	iters: 500, epoch: 5 | loss: 0.5095675
	speed: 0.0111s/iter; left time: 181.2839s
	iters: 600, epoch: 5 | loss: 0.4708231
	speed: 0.0111s/iter; left time: 180.4173s
	iters: 700, epoch: 5 | loss: 0.4827842
	speed: 0.0112s/iter; left time: 179.9654s
	iters: 800, epoch: 5 | loss: 0.5312765
	speed: 0.0111s/iter; left time: 178.0512s
	iters: 900, epoch: 5 | loss: 0.5080852
	speed: 0.0115s/iter; left time: 183.1404s
	iters: 1000, epoch: 5 | loss: 0.5153847
	speed: 0.0110s/iter; left time: 174.5730s
	iters: 1100, epoch: 5 | loss: 0.5604551
	speed: 0.0111s/iter; left time: 173.6653s
	iters: 1200, epoch: 5 | loss: 0.6295887
	speed: 0.0111s/iter; left time: 172.6929s
	iters: 1300, epoch: 5 | loss: 0.4612902
	speed: 0.0111s/iter; left time: 171.6075s
	iters: 1400, epoch: 5 | loss: 0.4290794
	speed: 0.0110s/iter; left time: 170.1558s
	iters: 1500, epoch: 5 | loss: 0.5154316
	speed: 0.0111s/iter; left time: 169.4820s
	iters: 1600, epoch: 5 | loss: 0.4581139
	speed: 0.0110s/iter; left time: 167.9998s
	iters: 1700, epoch: 5 | loss: 0.4349751
	speed: 0.0111s/iter; left time: 167.0019s
	iters: 1800, epoch: 5 | loss: 0.4976507
	speed: 0.0111s/iter; left time: 165.9726s
	iters: 1900, epoch: 5 | loss: 0.4206667
	speed: 0.0111s/iter; left time: 165.0016s
	iters: 2000, epoch: 5 | loss: 0.4920706
	speed: 0.0111s/iter; left time: 163.7037s
	iters: 2100, epoch: 5 | loss: 0.5363250
	speed: 0.0111s/iter; left time: 162.6216s
	iters: 2200, epoch: 5 | loss: 0.6024926
	speed: 0.0111s/iter; left time: 161.5308s
	iters: 2300, epoch: 5 | loss: 0.5412983
	speed: 0.0111s/iter; left time: 160.6917s
	iters: 2400, epoch: 5 | loss: 0.5242326
	speed: 0.0111s/iter; left time: 159.9519s
	iters: 2500, epoch: 5 | loss: 0.4903190
	speed: 0.0111s/iter; left time: 158.1799s
	iters: 2600, epoch: 5 | loss: 0.5215683
	speed: 0.0111s/iter; left time: 157.1351s
	iters: 2700, epoch: 5 | loss: 0.5188538
	speed: 0.0111s/iter; left time: 155.9822s
	iters: 2800, epoch: 5 | loss: 0.5230066
	speed: 0.0111s/iter; left time: 154.9241s
Epoch: 5 cost time: 31.368027210235596
Epoch: 5, Steps: 2802 | Train Loss: 0.5197378 Vali Loss: 2.2569652 Test Loss: 2.5081639
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4696607
	speed: 0.4463s/iter; left time: 6207.9717s
	iters: 200, epoch: 6 | loss: 0.5382139
	speed: 0.0113s/iter; left time: 155.5112s
	iters: 300, epoch: 6 | loss: 0.5988449
	speed: 0.0113s/iter; left time: 154.3553s
	iters: 400, epoch: 6 | loss: 0.5087960
	speed: 0.0113s/iter; left time: 153.2967s
	iters: 500, epoch: 6 | loss: 0.4914062
	speed: 0.0112s/iter; left time: 151.8983s
	iters: 600, epoch: 6 | loss: 0.4775100
	speed: 0.0112s/iter; left time: 150.7909s
	iters: 700, epoch: 6 | loss: 0.5652551
	speed: 0.0112s/iter; left time: 149.5513s
	iters: 800, epoch: 6 | loss: 0.7000382
	speed: 0.0112s/iter; left time: 148.2635s
	iters: 900, epoch: 6 | loss: 0.4508740
	speed: 0.0112s/iter; left time: 147.4348s
	iters: 1000, epoch: 6 | loss: 0.5695017
	speed: 0.0113s/iter; left time: 146.5428s
	iters: 1100, epoch: 6 | loss: 0.5347332
	speed: 0.0113s/iter; left time: 145.4357s
	iters: 1200, epoch: 6 | loss: 0.4691263
	speed: 0.0112s/iter; left time: 143.7316s
	iters: 1300, epoch: 6 | loss: 0.5274130
	speed: 0.0112s/iter; left time: 142.6069s
	iters: 1400, epoch: 6 | loss: 0.5173826
	speed: 0.0112s/iter; left time: 141.5022s
	iters: 1500, epoch: 6 | loss: 0.5284613
	speed: 0.0112s/iter; left time: 140.7300s
	iters: 1600, epoch: 6 | loss: 0.4404359
	speed: 0.0112s/iter; left time: 139.3014s
	iters: 1700, epoch: 6 | loss: 0.4242680
	speed: 0.0112s/iter; left time: 138.0539s
	iters: 1800, epoch: 6 | loss: 0.5111258
	speed: 0.0112s/iter; left time: 136.8822s
	iters: 1900, epoch: 6 | loss: 0.4634275
	speed: 0.0112s/iter; left time: 136.1845s
	iters: 2000, epoch: 6 | loss: 0.5943453
	speed: 0.0112s/iter; left time: 134.7533s
	iters: 2100, epoch: 6 | loss: 0.6174265
	speed: 0.0112s/iter; left time: 133.5754s
	iters: 2200, epoch: 6 | loss: 0.5101405
	speed: 0.0112s/iter; left time: 132.5188s
	iters: 2300, epoch: 6 | loss: 0.5798143
	speed: 0.0112s/iter; left time: 131.4915s
	iters: 2400, epoch: 6 | loss: 0.5858644
	speed: 0.0112s/iter; left time: 130.3808s
	iters: 2500, epoch: 6 | loss: 0.5395342
	speed: 0.0112s/iter; left time: 129.2881s
	iters: 2600, epoch: 6 | loss: 0.5499801
	speed: 0.0112s/iter; left time: 128.1679s
	iters: 2700, epoch: 6 | loss: 0.4974095
	speed: 0.0113s/iter; left time: 127.2972s
	iters: 2800, epoch: 6 | loss: 0.5270615
	speed: 0.0112s/iter; left time: 125.8765s
Epoch: 6 cost time: 31.814764738082886
Epoch: 6, Steps: 2802 | Train Loss: 0.5161742 Vali Loss: 2.2795901 Test Loss: 2.5740411
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems10_all_96_192_Mamba_custom_ftM_sl192_ll48_pl192_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 193645
test shape: (19364, 1, 192, 107) (19364, 1, 192, 107)
test shape: (19364, 192, 107) (19364, 192, 107)
mse:2.525373935699463, mae:1.3183484077453613
>>>>>>>Overall time: 561 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
