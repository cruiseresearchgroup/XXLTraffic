Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=107, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems10_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=107, expand=2, factor=1, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems10_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_all_96_96_Mamba_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 896967
val 193743
test 193741
	iters: 100, epoch: 1 | loss: 1.9377973
	speed: 0.0268s/iter; left time: 748.1842s
	iters: 200, epoch: 1 | loss: 1.4879640
	speed: 0.0093s/iter; left time: 258.5258s
	iters: 300, epoch: 1 | loss: 1.5432377
	speed: 0.0087s/iter; left time: 242.5662s
	iters: 400, epoch: 1 | loss: 1.0981624
	speed: 0.0085s/iter; left time: 234.5133s
	iters: 500, epoch: 1 | loss: 1.2080344
	speed: 0.0088s/iter; left time: 243.1818s
	iters: 600, epoch: 1 | loss: 1.1937435
	speed: 0.0087s/iter; left time: 238.2797s
	iters: 700, epoch: 1 | loss: 1.3932209
	speed: 0.0087s/iter; left time: 236.7361s
	iters: 800, epoch: 1 | loss: 1.0110435
	speed: 0.0084s/iter; left time: 228.7097s
	iters: 900, epoch: 1 | loss: 1.0283992
	speed: 0.0085s/iter; left time: 231.3707s
	iters: 1000, epoch: 1 | loss: 0.9203812
	speed: 0.0085s/iter; left time: 230.9342s
	iters: 1100, epoch: 1 | loss: 1.0208747
	speed: 0.0085s/iter; left time: 230.0292s
	iters: 1200, epoch: 1 | loss: 0.8523844
	speed: 0.0085s/iter; left time: 228.8893s
	iters: 1300, epoch: 1 | loss: 0.9716518
	speed: 0.0087s/iter; left time: 232.7395s
	iters: 1400, epoch: 1 | loss: 1.0395699
	speed: 0.0085s/iter; left time: 227.3649s
	iters: 1500, epoch: 1 | loss: 1.0109131
	speed: 0.0085s/iter; left time: 225.5961s
	iters: 1600, epoch: 1 | loss: 1.0943927
	speed: 0.0085s/iter; left time: 225.8150s
	iters: 1700, epoch: 1 | loss: 1.0336748
	speed: 0.0087s/iter; left time: 230.1732s
	iters: 1800, epoch: 1 | loss: 0.9952291
	speed: 0.0087s/iter; left time: 227.9723s
	iters: 1900, epoch: 1 | loss: 1.0834582
	speed: 0.0086s/iter; left time: 224.0831s
	iters: 2000, epoch: 1 | loss: 1.0689110
	speed: 0.0085s/iter; left time: 221.2457s
	iters: 2100, epoch: 1 | loss: 0.8282011
	speed: 0.0085s/iter; left time: 221.1028s
	iters: 2200, epoch: 1 | loss: 0.9097299
	speed: 0.0086s/iter; left time: 221.2352s
	iters: 2300, epoch: 1 | loss: 0.8830930
	speed: 0.0086s/iter; left time: 220.5567s
	iters: 2400, epoch: 1 | loss: 0.9239584
	speed: 0.0086s/iter; left time: 219.1496s
	iters: 2500, epoch: 1 | loss: 0.8390577
	speed: 0.0088s/iter; left time: 225.6501s
	iters: 2600, epoch: 1 | loss: 0.8292415
	speed: 0.0086s/iter; left time: 219.4462s
	iters: 2700, epoch: 1 | loss: 0.8350327
	speed: 0.0091s/iter; left time: 230.4959s
	iters: 2800, epoch: 1 | loss: 0.7641827
	speed: 0.0086s/iter; left time: 216.7325s
Epoch: 1 cost time: 26.110661506652832
Epoch: 1, Steps: 2803 | Train Loss: 1.0553333 Vali Loss: 2.3643255 Test Loss: 2.1807594
Validation loss decreased (inf --> 2.364326).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8968006
	speed: 0.3881s/iter; left time: 9752.8496s
	iters: 200, epoch: 2 | loss: 0.8644332
	speed: 0.0087s/iter; left time: 216.7749s
	iters: 300, epoch: 2 | loss: 0.9012639
	speed: 0.0087s/iter; left time: 215.7523s
	iters: 400, epoch: 2 | loss: 0.8352817
	speed: 0.0087s/iter; left time: 214.7646s
	iters: 500, epoch: 2 | loss: 0.9064277
	speed: 0.0087s/iter; left time: 214.4168s
	iters: 600, epoch: 2 | loss: 0.8194838
	speed: 0.0087s/iter; left time: 213.6547s
	iters: 700, epoch: 2 | loss: 0.9223384
	speed: 0.0087s/iter; left time: 212.8589s
	iters: 800, epoch: 2 | loss: 0.8436545
	speed: 0.0087s/iter; left time: 212.1780s
	iters: 900, epoch: 2 | loss: 0.8169454
	speed: 0.0087s/iter; left time: 211.0390s
	iters: 1000, epoch: 2 | loss: 0.9184684
	speed: 0.0087s/iter; left time: 210.1014s
	iters: 1100, epoch: 2 | loss: 0.9178175
	speed: 0.0087s/iter; left time: 209.1022s
	iters: 1200, epoch: 2 | loss: 0.8598595
	speed: 0.0087s/iter; left time: 209.5554s
	iters: 1300, epoch: 2 | loss: 0.8075728
	speed: 0.0087s/iter; left time: 207.2822s
	iters: 1400, epoch: 2 | loss: 0.8914275
	speed: 0.0087s/iter; left time: 206.7842s
	iters: 1500, epoch: 2 | loss: 0.7807704
	speed: 0.0087s/iter; left time: 205.8200s
	iters: 1600, epoch: 2 | loss: 0.9823887
	speed: 0.0087s/iter; left time: 205.1928s
	iters: 1700, epoch: 2 | loss: 0.7731498
	speed: 0.0087s/iter; left time: 203.7689s
	iters: 1800, epoch: 2 | loss: 0.7879876
	speed: 0.0087s/iter; left time: 203.5951s
	iters: 1900, epoch: 2 | loss: 0.7948876
	speed: 0.0086s/iter; left time: 201.1824s
	iters: 2000, epoch: 2 | loss: 0.8304766
	speed: 0.0086s/iter; left time: 200.6408s
	iters: 2100, epoch: 2 | loss: 0.7821257
	speed: 0.0086s/iter; left time: 199.4631s
	iters: 2200, epoch: 2 | loss: 0.8236547
	speed: 0.0086s/iter; left time: 198.4197s
	iters: 2300, epoch: 2 | loss: 0.8479047
	speed: 0.0086s/iter; left time: 197.6840s
	iters: 2400, epoch: 2 | loss: 0.7684084
	speed: 0.0086s/iter; left time: 196.7026s
	iters: 2500, epoch: 2 | loss: 0.7524501
	speed: 0.0086s/iter; left time: 195.4183s
	iters: 2600, epoch: 2 | loss: 0.7960187
	speed: 0.0086s/iter; left time: 194.8330s
	iters: 2700, epoch: 2 | loss: 0.7306077
	speed: 0.0086s/iter; left time: 193.8630s
	iters: 2800, epoch: 2 | loss: 0.7959421
	speed: 0.0086s/iter; left time: 193.0955s
Epoch: 2 cost time: 24.517995834350586
Epoch: 2, Steps: 2803 | Train Loss: 0.8113683 Vali Loss: 2.3819258 Test Loss: 2.2662680
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7437701
	speed: 0.3881s/iter; left time: 8664.6221s
	iters: 200, epoch: 3 | loss: 0.8218940
	speed: 0.0087s/iter; left time: 192.6351s
	iters: 300, epoch: 3 | loss: 0.6917801
	speed: 0.0086s/iter; left time: 191.3517s
	iters: 400, epoch: 3 | loss: 0.8318934
	speed: 0.0087s/iter; left time: 191.1133s
	iters: 500, epoch: 3 | loss: 0.7448754
	speed: 0.0087s/iter; left time: 191.0445s
	iters: 600, epoch: 3 | loss: 0.6283574
	speed: 0.0087s/iter; left time: 189.2872s
	iters: 700, epoch: 3 | loss: 0.8082413
	speed: 0.0087s/iter; left time: 188.8529s
	iters: 800, epoch: 3 | loss: 0.8545789
	speed: 0.0087s/iter; left time: 187.5144s
	iters: 900, epoch: 3 | loss: 0.5982758
	speed: 0.0087s/iter; left time: 186.8498s
	iters: 1000, epoch: 3 | loss: 0.6815542
	speed: 0.0087s/iter; left time: 185.9754s
	iters: 1100, epoch: 3 | loss: 0.8553857
	speed: 0.0087s/iter; left time: 185.2478s
	iters: 1200, epoch: 3 | loss: 0.7818817
	speed: 0.0086s/iter; left time: 183.5961s
	iters: 1300, epoch: 3 | loss: 0.8158776
	speed: 0.0087s/iter; left time: 183.1975s
	iters: 1400, epoch: 3 | loss: 0.7381359
	speed: 0.0087s/iter; left time: 182.3317s
	iters: 1500, epoch: 3 | loss: 0.7370596
	speed: 0.0087s/iter; left time: 181.3752s
	iters: 1600, epoch: 3 | loss: 0.8334339
	speed: 0.0087s/iter; left time: 181.1330s
	iters: 1700, epoch: 3 | loss: 0.6876165
	speed: 0.0087s/iter; left time: 179.3557s
	iters: 1800, epoch: 3 | loss: 0.7783806
	speed: 0.0087s/iter; left time: 179.6232s
	iters: 1900, epoch: 3 | loss: 0.6893982
	speed: 0.0087s/iter; left time: 178.1725s
	iters: 2000, epoch: 3 | loss: 0.6976184
	speed: 0.0086s/iter; left time: 176.6539s
	iters: 2100, epoch: 3 | loss: 0.7549933
	speed: 0.0087s/iter; left time: 176.0188s
	iters: 2200, epoch: 3 | loss: 0.8657123
	speed: 0.0087s/iter; left time: 175.0479s
	iters: 2300, epoch: 3 | loss: 0.5873396
	speed: 0.0086s/iter; left time: 173.5665s
	iters: 2400, epoch: 3 | loss: 0.7553723
	speed: 0.0087s/iter; left time: 173.2594s
	iters: 2500, epoch: 3 | loss: 0.6557479
	speed: 0.0086s/iter; left time: 171.6750s
	iters: 2600, epoch: 3 | loss: 0.6473233
	speed: 0.0086s/iter; left time: 171.0449s
	iters: 2700, epoch: 3 | loss: 0.7024147
	speed: 0.0086s/iter; left time: 169.8020s
	iters: 2800, epoch: 3 | loss: 0.7864114
	speed: 0.0086s/iter; left time: 168.8011s
Epoch: 3 cost time: 24.556548595428467
Epoch: 3, Steps: 2803 | Train Loss: 0.7438219 Vali Loss: 2.4017022 Test Loss: 2.3668976
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7390970
	speed: 0.3894s/iter; left time: 7602.6580s
	iters: 200, epoch: 4 | loss: 0.7187559
	speed: 0.0087s/iter; left time: 168.8450s
	iters: 300, epoch: 4 | loss: 0.8019994
	speed: 0.0087s/iter; left time: 167.6611s
	iters: 400, epoch: 4 | loss: 0.6007769
	speed: 0.0087s/iter; left time: 167.5072s
	iters: 500, epoch: 4 | loss: 0.5169812
	speed: 0.0087s/iter; left time: 165.9964s
	iters: 600, epoch: 4 | loss: 0.6982070
	speed: 0.0087s/iter; left time: 165.2662s
	iters: 700, epoch: 4 | loss: 0.6979971
	speed: 0.0087s/iter; left time: 164.3593s
	iters: 800, epoch: 4 | loss: 0.9068989
	speed: 0.0087s/iter; left time: 163.3752s
	iters: 900, epoch: 4 | loss: 0.7241929
	speed: 0.0087s/iter; left time: 162.0892s
	iters: 1000, epoch: 4 | loss: 0.7845059
	speed: 0.0087s/iter; left time: 161.8479s
	iters: 1100, epoch: 4 | loss: 0.8129690
	speed: 0.0087s/iter; left time: 160.9843s
	iters: 1200, epoch: 4 | loss: 0.8504829
	speed: 0.0087s/iter; left time: 160.1192s
	iters: 1300, epoch: 4 | loss: 0.7329400
	speed: 0.0087s/iter; left time: 158.9033s
	iters: 1400, epoch: 4 | loss: 0.7168272
	speed: 0.0087s/iter; left time: 158.2592s
	iters: 1500, epoch: 4 | loss: 0.6839153
	speed: 0.0087s/iter; left time: 157.1858s
	iters: 1600, epoch: 4 | loss: 0.8231701
	speed: 0.0087s/iter; left time: 156.2420s
	iters: 1700, epoch: 4 | loss: 0.6163726
	speed: 0.0087s/iter; left time: 155.4751s
	iters: 1800, epoch: 4 | loss: 0.6566176
	speed: 0.0087s/iter; left time: 154.9424s
	iters: 1900, epoch: 4 | loss: 0.8255177
	speed: 0.0087s/iter; left time: 153.6151s
	iters: 2000, epoch: 4 | loss: 0.6961485
	speed: 0.0087s/iter; left time: 152.8507s
	iters: 2100, epoch: 4 | loss: 0.6432003
	speed: 0.0087s/iter; left time: 151.8751s
	iters: 2200, epoch: 4 | loss: 0.6429788
	speed: 0.0087s/iter; left time: 151.9779s
	iters: 2300, epoch: 4 | loss: 0.8015581
	speed: 0.0087s/iter; left time: 150.1847s
	iters: 2400, epoch: 4 | loss: 0.6460207
	speed: 0.0087s/iter; left time: 149.4689s
	iters: 2500, epoch: 4 | loss: 0.6993521
	speed: 0.0087s/iter; left time: 148.6701s
	iters: 2600, epoch: 4 | loss: 0.6857970
	speed: 0.0087s/iter; left time: 147.3001s
	iters: 2700, epoch: 4 | loss: 0.7069343
	speed: 0.0086s/iter; left time: 146.2730s
	iters: 2800, epoch: 4 | loss: 0.7412889
	speed: 0.0086s/iter; left time: 145.4601s
Epoch: 4 cost time: 24.654546976089478
Epoch: 4, Steps: 2803 | Train Loss: 0.7167286 Vali Loss: 2.3991129 Test Loss: 2.3091679
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems10_all_96_96_Mamba_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 193741
test shape: (19374, 1, 96, 107) (19374, 1, 96, 107)
test shape: (19374, 96, 107) (19374, 96, 107)
mse:2.1807491779327393, mae:1.205522060394287
>>>>>>>Overall time: 358 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
