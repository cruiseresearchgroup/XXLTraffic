Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=103, checkpoints='./checkpoints/', d_conv=4, d_ff=16, d_layers=1, d_model=128, data='custom', data_path='pems05_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=103, expand=2, factor=1, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Mamba', model_id='pems05_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_96_Mamba_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 653479
val 147716
test 147715
	iters: 100, epoch: 1 | loss: 1.5038477
	speed: 0.0274s/iter; left time: 557.3682s
	iters: 200, epoch: 1 | loss: 1.4756135
	speed: 0.0086s/iter; left time: 173.7466s
	iters: 300, epoch: 1 | loss: 1.3161503
	speed: 0.0086s/iter; left time: 173.1653s
	iters: 400, epoch: 1 | loss: 1.2753781
	speed: 0.0086s/iter; left time: 171.7985s
	iters: 500, epoch: 1 | loss: 1.1144694
	speed: 0.0086s/iter; left time: 171.0191s
	iters: 600, epoch: 1 | loss: 1.2409856
	speed: 0.0086s/iter; left time: 169.6172s
	iters: 700, epoch: 1 | loss: 1.2364694
	speed: 0.0088s/iter; left time: 172.7100s
	iters: 800, epoch: 1 | loss: 1.1404253
	speed: 0.0091s/iter; left time: 178.1914s
	iters: 900, epoch: 1 | loss: 1.1514044
	speed: 0.0086s/iter; left time: 167.5968s
	iters: 1000, epoch: 1 | loss: 1.1663288
	speed: 0.0086s/iter; left time: 166.5931s
	iters: 1100, epoch: 1 | loss: 1.1101774
	speed: 0.0088s/iter; left time: 170.7712s
	iters: 1200, epoch: 1 | loss: 0.9948332
	speed: 0.0089s/iter; left time: 171.3833s
	iters: 1300, epoch: 1 | loss: 1.1238919
	speed: 0.0091s/iter; left time: 173.9046s
	iters: 1400, epoch: 1 | loss: 1.0353504
	speed: 0.0088s/iter; left time: 167.4452s
	iters: 1500, epoch: 1 | loss: 1.1544399
	speed: 0.0088s/iter; left time: 166.3732s
	iters: 1600, epoch: 1 | loss: 1.0575832
	speed: 0.0090s/iter; left time: 170.1981s
	iters: 1700, epoch: 1 | loss: 1.0036116
	speed: 0.0092s/iter; left time: 171.3940s
	iters: 1800, epoch: 1 | loss: 1.0238503
	speed: 0.0090s/iter; left time: 167.2085s
	iters: 1900, epoch: 1 | loss: 1.1653956
	speed: 0.0091s/iter; left time: 167.9294s
	iters: 2000, epoch: 1 | loss: 0.8675755
	speed: 0.0090s/iter; left time: 165.9548s
Epoch: 1 cost time: 19.97840118408203
Epoch: 1, Steps: 2042 | Train Loss: 1.1829790 Vali Loss: 1.3787363 Test Loss: 1.8900821
Validation loss decreased (inf --> 1.378736).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9943562
	speed: 0.3643s/iter; left time: 6659.2502s
	iters: 200, epoch: 2 | loss: 0.9218104
	speed: 0.0112s/iter; left time: 203.2767s
	iters: 300, epoch: 2 | loss: 1.0714283
	speed: 0.0096s/iter; left time: 173.2871s
	iters: 400, epoch: 2 | loss: 0.9396656
	speed: 0.0130s/iter; left time: 233.1919s
	iters: 500, epoch: 2 | loss: 0.8587837
	speed: 0.0117s/iter; left time: 209.8021s
	iters: 600, epoch: 2 | loss: 1.0094531
	speed: 0.0087s/iter; left time: 154.6943s
	iters: 700, epoch: 2 | loss: 0.9299237
	speed: 0.0087s/iter; left time: 154.5799s
	iters: 800, epoch: 2 | loss: 0.9995635
	speed: 0.0118s/iter; left time: 207.8476s
	iters: 900, epoch: 2 | loss: 0.9100567
	speed: 0.0118s/iter; left time: 205.9750s
	iters: 1000, epoch: 2 | loss: 0.7986718
	speed: 0.0122s/iter; left time: 211.9544s
	iters: 1100, epoch: 2 | loss: 1.0185285
	speed: 0.0116s/iter; left time: 200.2644s
	iters: 1200, epoch: 2 | loss: 0.7578942
	speed: 0.0116s/iter; left time: 199.7758s
	iters: 1300, epoch: 2 | loss: 0.8925010
	speed: 0.0122s/iter; left time: 208.3131s
	iters: 1400, epoch: 2 | loss: 0.9477059
	speed: 0.0100s/iter; left time: 170.3504s
	iters: 1500, epoch: 2 | loss: 0.9146877
	speed: 0.0086s/iter; left time: 145.7295s
	iters: 1600, epoch: 2 | loss: 1.0251018
	speed: 0.0087s/iter; left time: 145.8952s
	iters: 1700, epoch: 2 | loss: 0.8438430
	speed: 0.0086s/iter; left time: 143.8164s
	iters: 1800, epoch: 2 | loss: 0.8712500
	speed: 0.0086s/iter; left time: 142.8700s
	iters: 1900, epoch: 2 | loss: 0.9574228
	speed: 0.0086s/iter; left time: 141.3908s
	iters: 2000, epoch: 2 | loss: 0.9419961
	speed: 0.0099s/iter; left time: 162.5544s
Epoch: 2 cost time: 21.66530132293701
Epoch: 2, Steps: 2042 | Train Loss: 0.9605651 Vali Loss: 1.4185878 Test Loss: 2.0409949
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8919542
	speed: 0.3235s/iter; left time: 5252.1480s
	iters: 200, epoch: 3 | loss: 1.0757376
	speed: 0.0106s/iter; left time: 170.6234s
	iters: 300, epoch: 3 | loss: 0.9662483
	speed: 0.0102s/iter; left time: 163.1423s
	iters: 400, epoch: 3 | loss: 0.8577527
	speed: 0.0097s/iter; left time: 154.2212s
	iters: 500, epoch: 3 | loss: 0.9561580
	speed: 0.0105s/iter; left time: 166.4476s
	iters: 600, epoch: 3 | loss: 0.8412383
	speed: 0.0097s/iter; left time: 152.2058s
	iters: 700, epoch: 3 | loss: 0.9899540
	speed: 0.0093s/iter; left time: 144.7642s
	iters: 800, epoch: 3 | loss: 0.9016690
	speed: 0.0104s/iter; left time: 160.8999s
	iters: 900, epoch: 3 | loss: 0.8910042
	speed: 0.0114s/iter; left time: 175.2617s
	iters: 1000, epoch: 3 | loss: 0.9271560
	speed: 0.0109s/iter; left time: 167.2876s
	iters: 1100, epoch: 3 | loss: 0.8883521
	speed: 0.0111s/iter; left time: 168.9464s
	iters: 1200, epoch: 3 | loss: 0.7263722
	speed: 0.0112s/iter; left time: 170.0202s
	iters: 1300, epoch: 3 | loss: 0.9060075
	speed: 0.0124s/iter; left time: 186.2052s
	iters: 1400, epoch: 3 | loss: 0.8483061
	speed: 0.0113s/iter; left time: 169.1577s
	iters: 1500, epoch: 3 | loss: 0.8807967
	speed: 0.0118s/iter; left time: 175.0044s
	iters: 1600, epoch: 3 | loss: 0.8926734
	speed: 0.0122s/iter; left time: 179.5446s
	iters: 1700, epoch: 3 | loss: 0.7359540
	speed: 0.0114s/iter; left time: 166.2654s
	iters: 1800, epoch: 3 | loss: 0.8939338
	speed: 0.0119s/iter; left time: 172.7055s
	iters: 1900, epoch: 3 | loss: 0.9805908
	speed: 0.0112s/iter; left time: 162.2063s
	iters: 2000, epoch: 3 | loss: 1.0108348
	speed: 0.0114s/iter; left time: 163.8338s
Epoch: 3 cost time: 22.575900077819824
Epoch: 3, Steps: 2042 | Train Loss: 0.9023994 Vali Loss: 1.3687290 Test Loss: 2.0304880
Validation loss decreased (1.378736 --> 1.368729).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7477189
	speed: 0.4438s/iter; left time: 6299.0667s
	iters: 200, epoch: 4 | loss: 0.8440135
	speed: 0.0115s/iter; left time: 161.6556s
	iters: 300, epoch: 4 | loss: 0.8558047
	speed: 0.0120s/iter; left time: 167.6816s
	iters: 400, epoch: 4 | loss: 0.8991591
	speed: 0.0102s/iter; left time: 141.3655s
	iters: 500, epoch: 4 | loss: 0.8186666
	speed: 0.0114s/iter; left time: 157.4634s
	iters: 600, epoch: 4 | loss: 1.0725735
	speed: 0.0115s/iter; left time: 158.1215s
	iters: 700, epoch: 4 | loss: 0.8783461
	speed: 0.0123s/iter; left time: 167.3866s
	iters: 800, epoch: 4 | loss: 0.8768754
	speed: 0.0120s/iter; left time: 161.7029s
	iters: 900, epoch: 4 | loss: 0.8268425
	speed: 0.0123s/iter; left time: 165.3806s
	iters: 1000, epoch: 4 | loss: 0.9861806
	speed: 0.0131s/iter; left time: 173.6517s
	iters: 1100, epoch: 4 | loss: 0.9463850
	speed: 0.0109s/iter; left time: 143.6041s
	iters: 1200, epoch: 4 | loss: 0.9065183
	speed: 0.0110s/iter; left time: 144.0029s
	iters: 1300, epoch: 4 | loss: 0.8916950
	speed: 0.0116s/iter; left time: 150.1754s
	iters: 1400, epoch: 4 | loss: 0.8252732
	speed: 0.0109s/iter; left time: 141.1903s
	iters: 1500, epoch: 4 | loss: 0.9444728
	speed: 0.0089s/iter; left time: 113.4980s
	iters: 1600, epoch: 4 | loss: 0.8892742
	speed: 0.0107s/iter; left time: 136.3634s
	iters: 1700, epoch: 4 | loss: 0.9436637
	speed: 0.0117s/iter; left time: 147.9091s
	iters: 1800, epoch: 4 | loss: 0.9666414
	speed: 0.0127s/iter; left time: 159.1072s
	iters: 1900, epoch: 4 | loss: 0.7660725
	speed: 0.0126s/iter; left time: 155.5875s
	iters: 2000, epoch: 4 | loss: 0.7643616
	speed: 0.0122s/iter; left time: 149.4951s
Epoch: 4 cost time: 23.805514574050903
Epoch: 4, Steps: 2042 | Train Loss: 0.8806440 Vali Loss: 1.3515716 Test Loss: 2.0791125
Validation loss decreased (1.368729 --> 1.351572).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.9005848
	speed: 0.4962s/iter; left time: 6030.7665s
	iters: 200, epoch: 5 | loss: 0.9136313
	speed: 0.0098s/iter; left time: 118.4614s
	iters: 300, epoch: 5 | loss: 0.8732706
	speed: 0.0094s/iter; left time: 112.5608s
	iters: 400, epoch: 5 | loss: 0.8706009
	speed: 0.0094s/iter; left time: 111.9029s
	iters: 500, epoch: 5 | loss: 0.8749840
	speed: 0.0093s/iter; left time: 109.1594s
	iters: 600, epoch: 5 | loss: 0.9276524
	speed: 0.0101s/iter; left time: 118.0974s
	iters: 700, epoch: 5 | loss: 0.8496785
	speed: 0.0094s/iter; left time: 108.5758s
	iters: 800, epoch: 5 | loss: 0.8570750
	speed: 0.0094s/iter; left time: 107.4972s
	iters: 900, epoch: 5 | loss: 0.9115896
	speed: 0.0101s/iter; left time: 114.9610s
	iters: 1000, epoch: 5 | loss: 0.9415305
	speed: 0.0100s/iter; left time: 112.1461s
	iters: 1100, epoch: 5 | loss: 0.9442735
	speed: 0.0108s/iter; left time: 120.2960s
	iters: 1200, epoch: 5 | loss: 0.8157718
	speed: 0.0116s/iter; left time: 128.2833s
	iters: 1300, epoch: 5 | loss: 0.8218244
	speed: 0.0092s/iter; left time: 100.6727s
	iters: 1400, epoch: 5 | loss: 0.8423580
	speed: 0.0093s/iter; left time: 100.9199s
	iters: 1500, epoch: 5 | loss: 0.9113572
	speed: 0.0088s/iter; left time: 95.0907s
	iters: 1600, epoch: 5 | loss: 0.9772603
	speed: 0.0088s/iter; left time: 94.1227s
	iters: 1700, epoch: 5 | loss: 0.8101417
	speed: 0.0093s/iter; left time: 98.2053s
	iters: 1800, epoch: 5 | loss: 0.9024878
	speed: 0.0111s/iter; left time: 115.7815s
	iters: 1900, epoch: 5 | loss: 0.8558450
	speed: 0.0113s/iter; left time: 117.4274s
	iters: 2000, epoch: 5 | loss: 0.9117648
	speed: 0.0103s/iter; left time: 105.3690s
Epoch: 5 cost time: 20.570223569869995
Epoch: 5, Steps: 2042 | Train Loss: 0.8699671 Vali Loss: 1.4113555 Test Loss: 2.1540685
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7590672
	speed: 0.4585s/iter; left time: 4635.7219s
	iters: 200, epoch: 6 | loss: 0.9524683
	speed: 0.0099s/iter; left time: 98.7717s
	iters: 300, epoch: 6 | loss: 0.7996210
	speed: 0.0113s/iter; left time: 112.1729s
	iters: 400, epoch: 6 | loss: 0.8110645
	speed: 0.0106s/iter; left time: 103.6316s
	iters: 500, epoch: 6 | loss: 0.8603685
	speed: 0.0118s/iter; left time: 114.9003s
	iters: 600, epoch: 6 | loss: 0.8994471
	speed: 0.0124s/iter; left time: 118.7260s
	iters: 700, epoch: 6 | loss: 0.8779404
	speed: 0.0113s/iter; left time: 107.6059s
	iters: 800, epoch: 6 | loss: 0.8207686
	speed: 0.0091s/iter; left time: 85.7318s
	iters: 900, epoch: 6 | loss: 0.8846611
	speed: 0.0109s/iter; left time: 101.2489s
	iters: 1000, epoch: 6 | loss: 0.8594453
	speed: 0.0120s/iter; left time: 110.2090s
	iters: 1100, epoch: 6 | loss: 0.8026391
	speed: 0.0125s/iter; left time: 113.8957s
	iters: 1200, epoch: 6 | loss: 0.9900478
	speed: 0.0121s/iter; left time: 108.6447s
	iters: 1300, epoch: 6 | loss: 0.9089013
	speed: 0.0120s/iter; left time: 107.2471s
	iters: 1400, epoch: 6 | loss: 0.7830299
	speed: 0.0111s/iter; left time: 97.5018s
	iters: 1500, epoch: 6 | loss: 0.8477815
	speed: 0.0094s/iter; left time: 82.0536s
	iters: 1600, epoch: 6 | loss: 0.8097904
	speed: 0.0121s/iter; left time: 104.6193s
	iters: 1700, epoch: 6 | loss: 0.8025475
	speed: 0.0120s/iter; left time: 101.9441s
	iters: 1800, epoch: 6 | loss: 0.8090072
	speed: 0.0118s/iter; left time: 99.1740s
	iters: 1900, epoch: 6 | loss: 0.9344175
	speed: 0.0109s/iter; left time: 90.1965s
	iters: 2000, epoch: 6 | loss: 0.9369323
	speed: 0.0114s/iter; left time: 93.7274s
Epoch: 6 cost time: 23.266908884048462
Epoch: 6, Steps: 2042 | Train Loss: 0.8648481 Vali Loss: 1.4116057 Test Loss: 2.1482654
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8168091
	speed: 0.4469s/iter; left time: 3605.9214s
	iters: 200, epoch: 7 | loss: 0.8570466
	speed: 0.0088s/iter; left time: 70.3249s
	iters: 300, epoch: 7 | loss: 0.8631442
	speed: 0.0089s/iter; left time: 69.7848s
	iters: 400, epoch: 7 | loss: 0.8598882
	speed: 0.0094s/iter; left time: 72.8632s
	iters: 500, epoch: 7 | loss: 0.9085380
	speed: 0.0111s/iter; left time: 85.3845s
	iters: 600, epoch: 7 | loss: 0.9413297
	speed: 0.0109s/iter; left time: 82.4957s
	iters: 700, epoch: 7 | loss: 0.7974995
	speed: 0.0095s/iter; left time: 70.7666s
	iters: 800, epoch: 7 | loss: 0.8479991
	speed: 0.0095s/iter; left time: 69.9933s
	iters: 900, epoch: 7 | loss: 0.7821239
	speed: 0.0093s/iter; left time: 67.2723s
	iters: 1000, epoch: 7 | loss: 0.9159239
	speed: 0.0095s/iter; left time: 67.7783s
	iters: 1100, epoch: 7 | loss: 0.9410603
	speed: 0.0089s/iter; left time: 62.6656s
	iters: 1200, epoch: 7 | loss: 0.9670717
	speed: 0.0089s/iter; left time: 61.6837s
	iters: 1300, epoch: 7 | loss: 0.8534274
	speed: 0.0089s/iter; left time: 60.8557s
	iters: 1400, epoch: 7 | loss: 0.9360725
	speed: 0.0089s/iter; left time: 60.0519s
	iters: 1500, epoch: 7 | loss: 0.8985296
	speed: 0.0087s/iter; left time: 58.2663s
	iters: 1600, epoch: 7 | loss: 0.8825122
	speed: 0.0089s/iter; left time: 58.2067s
	iters: 1700, epoch: 7 | loss: 0.9592745
	speed: 0.0088s/iter; left time: 57.1689s
	iters: 1800, epoch: 7 | loss: 0.8496091
	speed: 0.0100s/iter; left time: 63.8449s
	iters: 1900, epoch: 7 | loss: 0.8606717
	speed: 0.0114s/iter; left time: 71.7747s
	iters: 2000, epoch: 7 | loss: 0.7743170
	speed: 0.0112s/iter; left time: 69.0860s
Epoch: 7 cost time: 19.74541997909546
Epoch: 7, Steps: 2042 | Train Loss: 0.8622561 Vali Loss: 1.3968853 Test Loss: 2.1573260
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems05_all_96_96_Mamba_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 147715
test shape: (14771, 1, 96, 103) (14771, 1, 96, 103)
test shape: (14771, 96, 103) (14771, 96, 103)
mse:2.0791053771972656, mae:1.209284782409668
>>>>>>>Overall time: 541 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
